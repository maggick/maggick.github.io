
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="../../theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="../../theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="../../theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="../../theme/pygments/sas.min.css">


  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/solid.css">


    <link href="https://maggick.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="maggick's logs Atom">



  


 

<meta name="author" content="maggick" />
<meta name="description" content="Since January this blog is automatically build using Travis CI. The main advantage is to always use the latest version of Pelican as travis CI always build its environment from scratch. An other advantage is that I am able to update the site just from my browser for minor modifications (spell correction for instance)." />
<meta name="keywords" content="programming, devops">


  <meta property="og:site_name" content="maggick's logs"/>
  <meta property="og:title" content="Building this blog with travis"/>
  <meta property="og:description" content="Since January this blog is automatically build using Travis CI. The main advantage is to always use the latest version of Pelican as travis CI always build its environment from scratch. An other advantage is that I am able to update the site just from my browser for minor modifications (spell correction for instance)."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="../../2017/03/building-this-blog-with-travis.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2017-03-04 09:30:00+01:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="../../author/maggick.html">
  <meta property="article:section" content="programming"/>
  <meta property="article:tag" content="programming"/>
  <meta property="article:tag" content="devops"/>
  <meta property="og:image" content="https://maggick.fr/media/image.png">

  <title>maggick's logs &ndash; Building this blog with travis</title>

</head>
<body >
  <aside>
    <div>
      <a href="../../">
        <img src="https://maggick.fr/media/image.png" alt="maggick's logs" title="maggick's logs">
      </a>

      <h1>
        <a href="../../">maggick's logs</a>
      </h1>

<p>Offensive security tales</p>

      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="../../pages/about.html">
                  About
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/notes.html">
                  Notes
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/tools.html">
                  Tools
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/maggick" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
              <i class="fab fa-stack-overflow"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="../../">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="building-this-blog-with-travis">Building this blog with travis</h1>
    <p>
      Posted on 04 Mar 2017 in <a href="../../category/programming.html">programming</a>

        &#8226; 3 min read
    </p>
  </header>


  <div>
    <p>Since January this blog is automatically build using <a href="https://travis-ci.org/">Travis CI</a>. The
main advantage is to always use the latest version of <a href="https://blog.getpelican.com/">Pelican</a> as
<a href="https://travis-ci.org/">travis CI</a> always build its environment from scratch. An other
advantage is that I am able to update the site just from my browser for minor
modifications (spell correction for instance).</p>


<p>Here is the <code>travis.yml</code> configuration file pass to <a href="https://travis-ci.org/">Travis CI</a>:</p>
<div class="highlight"><pre><span></span><code>language: python

install:
  # https://github.com/wummel/linkchecker/issues/649
  - pip install requests==2.9.1
  - pip install LinkChecker==9.3
  - pip install pelican markdown

  # grab the build theme
  - git clone -b build https://github.com/maggick/maggner-pelican

  # grab the pelican plugins
  - git clone https://github.com/getpelican/pelican-plugins

  # grab the latest published version in order to not erase rss feed
  - git clone https://github.com/maggick/maggick.github.io output

script:
  - linkchecker --check-extern ./content
  - pelican

after_success:
  - cd output
  - git add ./
  - git -c user.name=&quot;Travis CI for maggick&quot; -c user.email=&quot;&lt;redacted&gt;@gmail.com&quot; commit -m &#39;Travis update documentation&#39;
  - git push https://${GH_TOKEN}@github.com/maggick/maggick.github.io.git master
</code></pre></div>

<h2>Declaration</h2>
<p>Let us break it a bit. First the declaration part:</p>
<div class="highlight"><pre><span></span><code><span class="n">language</span><span class="o">:</span><span class="w"> </span><span class="n">python</span><span class="w"></span>
</code></pre></div>

<p>We do not need the root right so <code>sudo</code> is not needed. Moreover we use the
python language.</p>
<h2>install</h2>
<p>The installation part:</p>
<div class="highlight"><pre><span></span><code>install:
  # https://github.com/wummel/linkchecker/issues/649
  - pip install requests==2.9.1
  - pip install LinkChecker==9.3
  - pip install pelican markdown

  # grab the build theme
  - git clone -b build https://github.com/maggick/maggner-pelican

  # grab the pelican plugins
  - git clone https://github.com/getpelican/pelican-plugins

  # grab the latest published version in order to not erase rss feed
  - git clone https://github.com/maggick/maggick.github.io output
</code></pre></div>

<p>We install:</p>
<ul>
<li><a href="http://docs.python-requests.org/en/master/">request</a> in version 2.9.1, this is a python library used by pelican</li>
<li><a href="https://pypi.python.org/pypi/LinkChecker">LinkChecker</a> in version 9.3, this is a tool that will check
   that the link in the different articles give a 200 HTTPÂ response</li>
<li><a href="http://getpelican.com/">pelican</a> which is used to build the site</li>
<li><a href="https://pypi.python.org/pypi/Markdown">mardkown</a> because the articles are wrote in markdown</li>
</ul>
<p>Then we grab the theme used by the site on the build branch directly on
<a href="https://github.com/maggick/maggner-pelican">github</a>, we also download the <a href="https://github.com/getpelican/pelican-plugins">pelican plugins</a>.
We need to get the last build of the site in order to not re publish all the
articles in the RSS feed (it happened once when writing this configuration).</p>
<h2>Script</h2>
<p>The script part is where the magic happen, this part will build the site and
give a red or green status depending of the output of each script. If all of
them exit without error the build is green otherwise the build is red.</p>
<div class="highlight"><pre><span></span><code>script:
  - linkchecker --check-extern ./content
  - pelican
</code></pre></div>

<p>The script part used <a href="https://pypi.python.org/pypi/LinkChecker">LinkChecker</a> on the content directory where
are all articles in the markdown format. This script will test every link on
every file and exit with an error if a link return something else that an HTTP
200 OK.</p>
<p>Then we use <a href="http://getpelican.com/">pelican</a> to build the site. If an error happened during
the build the script will also exit with an error.</p>
<h2>After success</h2>
<p>Finally, after the success of the two script we deploy the site on github pages,
we publish the site on <a href="https://pages.github.com/">github pages</a>:</p>
<div class="highlight"><pre><span></span><code>after_success:
  - cd output
  - git add ./
  - git -c user.name=&quot;Travis CI for maggick&quot; -c user.email=&quot;<span class="nt">&lt;redacted&gt;</span>@gmail.com&quot; commit -m &#39;Travis update documentation&#39;
  - git push https://<span class="cp">${</span><span class="n">GH_TOKEN</span><span class="cp">}</span>@github.com/maggick/maggick.github.io.git master
</code></pre></div>

<p>We go in the <code>output</code> directory of the build, we add everything for git, we
commit everything using a user crafted for the occasion and my public email
address. The commit message is a generic one. Then we push everything on the
branch <code>master</code> of the <a href="https://pages.github.com/">github pages</a> repository.</p>
<p>For this last step I was forced to give a write access to all my repositories to
<a href="https://travis-ci.org/">Travis CI</a> using the <a href="https://github.com">github</a> API. I do not really like
that but as I am monitoring the commit on my own repository I should be able to
detect a hack  or a malicious action of <a href="https://travis-ci.org/">Travis CI</a>. The next
step will be to sign all my commit using GPG but I have not find a suitable
solution yet (mostly for commit from browser).</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="../../tag/programming.html">programming</a>
      <a href="../../tag/devops.html">devops</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="../../2017/01/insomnihack-teaser-2017.html" title="Insomnihack Teaser 2017">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="../../2017/08/breaking-some-homemade-crypto.html" title="Breaking some homemade crypto">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>



</article>

    <footer>
<p>
  &copy; 2022  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.en_US" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="../../theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "https://maggick.fr/media/image.png",
  "description": ""
}
</script>

</body>
</html>