
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="../../theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="../../theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="../../theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="../../theme/pygments/sas.min.css">


  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/solid.css">


    <link href="https://maggick.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="maggick's logs Atom">



  


 

<meta name="author" content="maggick" />
<meta name="description" content="The first of April is always the occasion for some great pranks. 2015 was a great year, as the CERN confirmed the existence of the Force, Google published a mirroring website and gentoo an old fashion one. In France we got a security event call SSTIC for which the tickets are very rare therefore the SSTIC challenge allows the ones with the flag to reserve a ticket. An April prank challenge was post yesterday." />
<meta name="keywords" content="challenge, sstic, security">


  <meta property="og:site_name" content="maggick's logs"/>
  <meta property="og:title" content="First April SSTIC challenge"/>
  <meta property="og:description" content="The first of April is always the occasion for some great pranks. 2015 was a great year, as the CERN confirmed the existence of the Force, Google published a mirroring website and gentoo an old fashion one. In France we got a security event call SSTIC for which the tickets are very rare therefore the SSTIC challenge allows the ones with the flag to reserve a ticket. An April prank challenge was post yesterday."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="../../2015/04/first-april-sstic-challenge.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2015-04-02 00:00:00+02:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="../../author/maggick.html">
  <meta property="article:section" content="Security"/>
  <meta property="article:tag" content="challenge"/>
  <meta property="article:tag" content="sstic"/>
  <meta property="article:tag" content="security"/>
  <meta property="og:image" content="https://maggick.fr/media/image.png">

  <title>maggick's logs &ndash; First April SSTIC challenge</title>

</head>
<body >
  <aside>
    <div>
      <a href="../../">
        <img src="https://maggick.fr/media/image.png" alt="" title="">
      </a>

      <h1>
        <a href="../../"></a>
      </h1>



      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="../../pages/about.html">
                  About
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/notes.html">
                  Notes
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/tools.html">
                  Tools
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/maggick" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
              <i class="fab fa-stack-overflow"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="../../">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="first-april-sstic-challenge">First April SSTIC challenge</h1>
    <p>
      Posted on 02 Apr 2015 in <a href="../../category/security.html">Security</a>

        &#8226; 5 min read
    </p>
  </header>


  <div>
    <p><img class="align-left" src="/media/2015.04/sstic_res_750.PNG"
alt="pixel view, resolution 750" width="172"></p>
<p>The first of April is always the occasion for some great pranks.
2015 was a great year, as the CERN confirmed the existence of the Force, Google
published a mirroring website and gentoo an old fashion one.
In France we got a security event call <a href="https://www.sstic.org">SSTIC</a> for which
the tickets are very rare therefore the SSTIC challenge allows the ones with the
flag to reserve a ticket. An April prank challenge was post yesterday.</p>


<p><br/><br/><br/></p>
<h1>April Pranks</h1>
<p>The first of April is always the occasion for some great pranks:</p>
<ul>
<li><a href="https://twitter.com/CERN/status/583147747710263296">CERN confirm the existence of the Force</a>:</li>
</ul>
<p><img alt="CERN tweet about the Force" src="/media/2015.04/twitter.com_CERN_status_583147747710263296.PNG"></p>
<ul>
<li>Google do some mirroring trick(deadlink):</li>
</ul>
<p><img alt="com.google mirrored" src="/media/2015.04/com.google.PNG"></p>
<ul>
<li><a href="https://www.gentoo.org">gentoo.org adopted a beautiful design</a>:</li>
</ul>
<p><img alt="gentoo.org old school" src="/media/2015.04/gentoo.org.PNG"></p>
<h1>SSTIC Challenge</h1>
<p>But one of them was released by the <a href="https://www.sstic.org">SSTIC</a> an French
security event which give every year a difficult challenge that grant
automatically a place to the event (tickets are sold out in approximately one
minute) for the winners.</p>
<p>We download the challenge <a href="/media/2015.04/chlg-2015">here</a>.</p>
<h2>Strings</h2>
<p>Let's try something like <code>strings</code> to see what appends:</p>
<div class="highlight"><pre><span></span><code><span class="n">maggick</span><span class="p">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~/</span><span class="n">work</span><span class="o">/</span><span class="n">sstic</span>$<span class="w"> </span><span class="nb">strings</span><span class="w"> </span><span class="n">chlg</span><span class="o">-</span><span class="mi">2015</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">wc</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"></span>
<span class="n">10797</span><span class="w"></span>

<span class="s">maggick@debian:~/work/sstic$</span><span class="w"> </span><span class="s">strings</span><span class="w"> </span><span class="s">chlg-2015</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nb">head</span><span class="w"></span>
<span class="n">Salted__D</span><span class="w"></span>
<span class="s">8</span><span class="o">&#39;&lt;</span><span class="n">K</span><span class="w"></span>
<span class="n">vKRbn</span><span class="w"></span>
<span class="s">vKRbn</span><span class="w"></span>
<span class="n">vKRbn</span><span class="w"></span>
<span class="s">vKRbn</span><span class="w"></span>
<span class="n">K5G</span><span class="o">--</span>9<span class="n">S</span><span class="w"></span>
<span class="c">%Pz$</span><span class="w"></span>
<span class="n">vKRbn</span><span class="w"></span>
<span class="s">vKRb</span><span class="w"></span>
</code></pre></div>

<p>No chance coming from here.</p>
<h2>Hexview</h2>
<p>We use radare2 to see the hexcode:</p>
<div class="highlight"><pre><span></span><code>[0x00000000 0% 1008 chlg-2015]&gt; x
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  5361 6c74 6564 5f5f 4419 80b6 425f d4ff  Salted__D...B_..
0x00000010  1e5c 83a1 c4d7 24f5 4697 9aac 2571 5f8e  .\....$.F...%q_.
0x00000020  64e2 52ad 8947 119e c4ad 929b 6505 4de2  d.R..G......e.M.
0x00000030  ff44 0add d438 273c 4b8d 760d 416d c883  .D...8&#39;&lt;K.v.Am..
0x00000040  290e 8014 1ce7 88a2 b6c7 cd00 d8e9 98bd  )...............
0x00000050  e40c cb76 4b52 626e 0ee0 c966 b1c8 c24b  ...vKRbn...f...K
0x00000060  e40c cb76 4b52 626e 0ee0 c966 b1c8 c24b  ...vKRbn...f...K
0x00000070  4915 cd03 153c 5210 abe7 c68f c882 f198  I....&lt;R.........
0x00000080  f153 28d9 ef43 0ecc d38a 8cc7 7cff 5351  .S(..C......|.SQ
0x00000090  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000a0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000b0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000c0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000d0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000e0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000f0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000100  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000110  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000120  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000130  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000140  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000150  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
</code></pre></div>

<p>Yeah that a message encrypt with open ssl and salt. But we do not have any idea
about the key nor the salt. Shall we take a look at the code itself:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">0x00000000 0% 315 chlg-2015</span><span class="o">]&gt;</span><span class="w"> </span><span class="n">pd</span><span class="w"> </span><span class="err">$</span><span class="n">r</span><span class="w"></span>
<span class="w">           </span><span class="mh">0x00000000</span><span class="w">    </span><span class="mi">53</span><span class="w">           </span><span class="n">push</span><span class="w"> </span><span class="n">ebx</span><span class="w"></span>
<span class="w">           </span><span class="mh">0x00000001</span><span class="w">    </span><span class="mi">61</span><span class="w">           </span><span class="n">popal</span><span class="w"></span>
<span class="w">           </span><span class="mh">0x00000002</span><span class="w">    </span><span class="mi">6</span><span class="n">c</span><span class="w">           </span><span class="n">insb</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="nl">es</span><span class="p">:</span><span class="o">[</span><span class="n">edi</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">dx</span><span class="w"></span>
<span class="w">       </span><span class="p">,</span><span class="o">=&lt;</span><span class="w"> </span><span class="mh">0x00000003</span><span class="w">    </span><span class="mi">7465</span><span class="w">         </span><span class="n">je</span><span class="w"> </span><span class="mh">0x6a</span><span class="w">                          </span><span class="p">;</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="mh">0x00000005</span><span class="w">    </span><span class="mi">645</span><span class="n">f</span><span class="w">         </span><span class="n">pop</span><span class="w"> </span><span class="n">edi</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="mh">0x00000007</span><span class="w">    </span><span class="mi">5</span><span class="n">f</span><span class="w">           </span><span class="n">pop</span><span class="w"> </span><span class="n">edi</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="mh">0x00000008</span><span class="w">    </span><span class="mi">44</span><span class="w">           </span><span class="n">inc</span><span class="w"> </span><span class="n">esp</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="mh">0x00000009</span><span class="w">    </span><span class="mi">1980</span><span class="n">b6425fd4</span><span class="w"> </span><span class="n">sbb</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">eax - 0x2ba0bd4a</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">eax</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="mh">0x0000000f</span><span class="w">    </span><span class="n">ff1e</span><span class="w">         </span><span class="n">lcall</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">      </span><span class="n">unk</span><span class="p">()</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="mh">0x00000011</span><span class="w">    </span><span class="mi">5</span><span class="n">c</span><span class="w">           </span><span class="n">pop</span><span class="w"> </span><span class="n">esp</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="mh">0x00000012</span><span class="w">    </span><span class="mi">83</span><span class="n">a1c4d724f</span><span class="p">.</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">ecx - 0xadb283c</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="mh">0x46</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="mh">0x00000019</span><span class="w">    </span><span class="mi">97</span><span class="w">           </span><span class="n">xchg</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">edi</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="mh">0x0000001a</span><span class="w">    </span><span class="mi">9</span><span class="n">aac25715f8</span><span class="p">.</span><span class="w"> </span><span class="n">lcall</span><span class="w"> </span><span class="mh">0x648e</span><span class="err">:</span><span class="mh">0x5f7125ac</span><span class="w">          </span><span class="p">;</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"></span>
<span class="w">       </span><span class="o">|</span><span class="w">      </span><span class="mh">0x0000648e</span><span class="p">()</span><span class="w"></span>
<span class="w">      </span><span class="p">,</span><span class="o">==&lt;</span><span class="w"> </span><span class="mh">0x00000021</span><span class="w">    </span><span class="n">e252</span><span class="w">         </span><span class="n">loop</span><span class="w"> </span><span class="mh">0x75</span><span class="w">                        </span><span class="p">;</span><span class="o">[</span><span class="n">3</span><span class="o">]</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000023</span><span class="w">    </span><span class="n">ad</span><span class="w">           </span><span class="n">lodsd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000024</span><span class="w">    </span><span class="mi">894711</span><span class="w">       </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">edi + 0x11</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">eax</span><span class="w">       </span><span class="p">;</span><span class="w"> </span><span class="o">[</span><span class="n">0x11:4</span><span class="o">]=</span><span class="mh">0xc4a1835c</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000027</span><span class="w">    </span><span class="mi">9</span><span class="n">e</span><span class="w">           </span><span class="n">sahf</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000028</span><span class="w">    </span><span class="n">c4ad929b6505</span><span class="w"> </span><span class="n">les</span><span class="w"> </span><span class="n">ebp</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">ebp + 0x5659b92</span><span class="o">]</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x0000002e</span><span class="w">    </span><span class="mi">4</span><span class="n">d</span><span class="w">           </span><span class="k">dec</span><span class="w"> </span><span class="n">ebp</span><span class="w"></span>
<span class="w">     </span><span class="p">,</span><span class="o">===&lt;</span><span class="w"> </span><span class="mh">0x0000002f</span><span class="w">    </span><span class="n">e2ff</span><span class="w">         </span><span class="n">loop</span><span class="w"> </span><span class="mh">0x30</span><span class="w">                        </span><span class="p">;</span><span class="o">[</span><span class="n">4</span><span class="o">]</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000031</span><span class="w">    </span><span class="mi">44</span><span class="w">           </span><span class="n">inc</span><span class="w"> </span><span class="n">esp</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000032</span><span class="w">    </span><span class="mi">0</span><span class="k">add</span><span class="w">         </span><span class="ow">or</span><span class="w"> </span><span class="n">bl</span><span class="p">,</span><span class="w"> </span><span class="n">ch</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000034</span><span class="w">    </span><span class="n">d438</span><span class="w">         </span><span class="n">aam</span><span class="w"> </span><span class="mh">0x38</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000036</span><span class="w">    </span><span class="mi">27</span><span class="w">           </span><span class="n">daa</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000037</span><span class="w">    </span><span class="mi">3</span><span class="n">c4b</span><span class="w">         </span><span class="n">cmp</span><span class="w"> </span><span class="n">al</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4b</span><span class="w">                     </span><span class="p">;</span><span class="w"> </span><span class="s1">&#39;K&#39;</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000039</span><span class="w">    </span><span class="mi">8</span><span class="n">d760d</span><span class="w">       </span><span class="n">lea</span><span class="w"> </span><span class="n">esi</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">esi + 0xd</span><span class="o">]</span><span class="w">              </span><span class="p">;</span><span class="w"> </span><span class="o">[</span><span class="n">0xd:4</span><span class="o">]=</span><span class="mh">0x1effd45f</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x0000003c</span><span class="w">    </span><span class="mi">41</span><span class="w">           </span><span class="n">inc</span><span class="w"> </span><span class="n">ecx</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x0000003d</span><span class="w">    </span><span class="mi">6</span><span class="n">d</span><span class="w">           </span><span class="n">insd</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="nl">es</span><span class="p">:</span><span class="o">[</span><span class="n">edi</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">dx</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x0000003e</span><span class="w">    </span><span class="n">c883290e</span><span class="w">     </span><span class="n">enter</span><span class="w"> </span><span class="mh">0x2983</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000042</span><span class="w">    </span><span class="mi">80141</span><span class="n">ce7</span><span class="w">     </span><span class="n">adc</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="o">[</span><span class="n">esp + ebx</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mh">0x19</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000046</span><span class="w">    </span><span class="mi">88</span><span class="n">a2b6c7cd00</span><span class="w"> </span><span class="n">mov</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="o">[</span><span class="n">edx + 0xcdc7b6</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">ah</span><span class="w">     </span><span class="p">;</span><span class="w"> </span><span class="o">[</span><span class="n">0xcdc7b6:1</span><span class="o">]=</span><span class="mi">255</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x0000004c</span><span class="w">    </span><span class="n">d8e9</span><span class="w">         </span><span class="n">fsubr</span><span class="w"> </span><span class="n">st</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x0000004e</span><span class="w">    </span><span class="mi">98</span><span class="w">           </span><span class="n">cwde</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x0000004f</span><span class="w">    </span><span class="n">bde40ccb76</span><span class="w">   </span><span class="n">mov</span><span class="w"> </span><span class="n">ebp</span><span class="p">,</span><span class="w"> </span><span class="mh">0x76cb0ce4</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000054</span><span class="w">    </span><span class="mi">4</span><span class="n">b</span><span class="w">           </span><span class="k">dec</span><span class="w"> </span><span class="n">ebx</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000055</span><span class="w">    </span><span class="mi">52</span><span class="w">           </span><span class="n">push</span><span class="w"> </span><span class="n">edx</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000056</span><span class="w">    </span><span class="mf">626e0</span><span class="n">e</span><span class="w">       </span><span class="n">bound</span><span class="w"> </span><span class="n">ebp</span><span class="p">,</span><span class="w"> </span><span class="n">qword</span><span class="w"> </span><span class="o">[</span><span class="n">esi + 0xe</span><span class="o">]</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000059</span><span class="w">    </span><span class="n">e0c9</span><span class="w">         </span><span class="n">loopne</span><span class="w"> </span><span class="mh">0x24</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x0000005b</span><span class="w">    </span><span class="mi">66</span><span class="n">b1c8</span><span class="w">       </span><span class="n">mov</span><span class="w"> </span><span class="n">cl</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mh">0x38</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x0000005e</span><span class="w">    </span><span class="n">c24be4</span><span class="w">       </span><span class="n">ret</span><span class="w"> </span><span class="mh">0xe44b</span><span class="w"></span>
<span class="w">      </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000061</span><span class="w">    </span><span class="mi">0</span><span class="n">ccb</span><span class="w">         </span><span class="ow">or</span><span class="w"> </span><span class="n">al</span><span class="p">,</span><span class="w"> </span><span class="mh">0xffffffcb</span><span class="w"></span>
<span class="w">    </span><span class="p">,</span><span class="o">====&lt;</span><span class="w"> </span><span class="mh">0x00000063</span><span class="w">    </span><span class="mi">764</span><span class="n">b</span><span class="w">         </span><span class="n">jbe</span><span class="w"> </span><span class="mh">0xb0</span><span class="w">                         </span><span class="p">;</span><span class="o">[</span><span class="n">5</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000065</span><span class="w">    </span><span class="mi">52</span><span class="w">           </span><span class="n">push</span><span class="w"> </span><span class="n">edx</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000066</span><span class="w">    </span><span class="mf">626e0</span><span class="n">e</span><span class="w">       </span><span class="n">bound</span><span class="w"> </span><span class="n">ebp</span><span class="p">,</span><span class="w"> </span><span class="n">qword</span><span class="w"> </span><span class="o">[</span><span class="n">esi + 0xe</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="o">||</span><span class="w">   </span><span class="mh">0x00000069</span><span class="w">    </span><span class="n">e0c9</span><span class="w">         </span><span class="n">loopne</span><span class="w"> </span><span class="mh">0x34</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">    </span><span class="mh">0x0000006b</span><span class="w">    </span><span class="mi">66</span><span class="n">b1c8</span><span class="w">       </span><span class="n">mov</span><span class="w"> </span><span class="n">cl</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mh">0x38</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">    </span><span class="mh">0x0000006e</span><span class="w">    </span><span class="n">c24b49</span><span class="w">       </span><span class="n">ret</span><span class="w"> </span><span class="mh">0x494b</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">    </span><span class="mh">0x00000071</span><span class="w">    </span><span class="mi">15</span><span class="n">cd03153c</span><span class="w">   </span><span class="n">adc</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3c1503cd</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000076</span><span class="w">    </span><span class="mi">52</span><span class="w">           </span><span class="n">push</span><span class="w"> </span><span class="n">edx</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000077</span><span class="w">    </span><span class="mi">10</span><span class="n">abe7c68fc8</span><span class="w"> </span><span class="n">adc</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="o">[</span><span class="n">ebx - 0x37703919</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">ch</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x0000007d</span><span class="w">    </span><span class="mi">82</span><span class="n">f198</span><span class="w">       </span><span class="n">xor</span><span class="w"> </span><span class="n">cl</span><span class="p">,</span><span class="w"> </span><span class="mh">0x98</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000080</span><span class="w">    </span><span class="n">f1</span><span class="w">           </span><span class="n">int1</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000081</span><span class="w">    </span><span class="mi">53</span><span class="w">           </span><span class="n">push</span><span class="w"> </span><span class="n">ebx</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000082</span><span class="w">    </span><span class="mi">28</span><span class="n">d9</span><span class="w">         </span><span class="n">sub</span><span class="w"> </span><span class="n">cl</span><span class="p">,</span><span class="w"> </span><span class="n">bl</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000084</span><span class="w">    </span><span class="n">ef</span><span class="w">           </span><span class="k">out</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">eax</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000085</span><span class="w">    </span><span class="mi">43</span><span class="w">           </span><span class="n">inc</span><span class="w"> </span><span class="n">ebx</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000086</span><span class="w">    </span><span class="mi">0</span><span class="n">e</span><span class="w">           </span><span class="n">push</span><span class="w"> </span><span class="n">cs</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000087</span><span class="w">    </span><span class="n">cc</span><span class="w">           </span><span class="n">int3</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000088</span><span class="w">    </span><span class="n">d38a8cc77cff</span><span class="w"> </span><span class="n">ror</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">edx - 0x833874</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">cl</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x0000008e</span><span class="w">    </span><span class="mi">53</span><span class="w">           </span><span class="n">push</span><span class="w"> </span><span class="n">ebx</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x0000008f</span><span class="w">    </span><span class="mi">51</span><span class="w">           </span><span class="n">push</span><span class="w"> </span><span class="n">ecx</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000090</span><span class="w">    </span><span class="n">ad</span><span class="w">           </span><span class="n">lodsd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000091</span><span class="w">    </span><span class="mi">07</span><span class="w">           </span><span class="n">pop</span><span class="w"> </span><span class="n">es</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000092</span><span class="w">    </span><span class="n">b6ef</span><span class="w">         </span><span class="n">mov</span><span class="w"> </span><span class="n">dh</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mh">0x11</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000094</span><span class="w">    </span><span class="n">c462df</span><span class="w">       </span><span class="n">les</span><span class="w"> </span><span class="n">esp</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">edx - 0x21</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000097</span><span class="w">    </span><span class="n">fe</span><span class="w">           </span><span class="n">invalid</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000098</span><span class="w">    </span><span class="n">ad</span><span class="w">           </span><span class="n">lodsd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x00000099</span><span class="w">    </span><span class="mi">318</span><span class="n">a9501a143</span><span class="w"> </span><span class="n">xor</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">edx + 0x43a10195</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">ecx</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x0000009f</span><span class="w">    </span><span class="mi">90</span><span class="w">           </span><span class="n">nop</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000a0</span><span class="w">    </span><span class="n">ad</span><span class="w">           </span><span class="n">lodsd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000a1</span><span class="w">    </span><span class="mi">07</span><span class="w">           </span><span class="n">pop</span><span class="w"> </span><span class="n">es</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000a2</span><span class="w">    </span><span class="n">b6ef</span><span class="w">         </span><span class="n">mov</span><span class="w"> </span><span class="n">dh</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mh">0x11</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000a4</span><span class="w">    </span><span class="n">c462df</span><span class="w">       </span><span class="n">les</span><span class="w"> </span><span class="n">esp</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">edx - 0x21</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000a7</span><span class="w">    </span><span class="n">fe</span><span class="w">           </span><span class="n">invalid</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000a8</span><span class="w">    </span><span class="n">ad</span><span class="w">           </span><span class="n">lodsd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000a9</span><span class="w">    </span><span class="mi">318</span><span class="n">a9501a143</span><span class="w"> </span><span class="n">xor</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">edx + 0x43a10195</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">ecx</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000af</span><span class="w">    </span><span class="mi">90</span><span class="w">           </span><span class="n">nop</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000b0</span><span class="w">    </span><span class="n">ad</span><span class="w">           </span><span class="n">lodsd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000b1</span><span class="w">    </span><span class="mi">07</span><span class="w">           </span><span class="n">pop</span><span class="w"> </span><span class="n">es</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000b2</span><span class="w">    </span><span class="n">b6ef</span><span class="w">         </span><span class="n">mov</span><span class="w"> </span><span class="n">dh</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mh">0x11</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000b4</span><span class="w">    </span><span class="n">c462df</span><span class="w">       </span><span class="n">les</span><span class="w"> </span><span class="n">esp</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">edx - 0x21</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000b7</span><span class="w">    </span><span class="n">fe</span><span class="w">           </span><span class="n">invalid</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000b8</span><span class="w">    </span><span class="n">ad</span><span class="w">           </span><span class="n">lodsd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000b9</span><span class="w">    </span><span class="mi">318</span><span class="n">a9501a143</span><span class="w"> </span><span class="n">xor</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">edx + 0x43a10195</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">ecx</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000bf</span><span class="w">    </span><span class="mi">90</span><span class="w">           </span><span class="n">nop</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000c0</span><span class="w">    </span><span class="n">ad</span><span class="w">           </span><span class="n">lodsd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000c1</span><span class="w">    </span><span class="mi">07</span><span class="w">           </span><span class="n">pop</span><span class="w"> </span><span class="n">es</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000c2</span><span class="w">    </span><span class="n">b6ef</span><span class="w">         </span><span class="n">mov</span><span class="w"> </span><span class="n">dh</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mh">0x11</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000c4</span><span class="w">    </span><span class="n">c462df</span><span class="w">       </span><span class="n">les</span><span class="w"> </span><span class="n">esp</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">edx - 0x21</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000c7</span><span class="w">    </span><span class="n">fe</span><span class="w">           </span><span class="n">invalid</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000c8</span><span class="w">    </span><span class="n">ad</span><span class="w">           </span><span class="n">lodsd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">esi</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="mh">0x000000c9</span><span class="w">    </span><span class="mi">318</span><span class="n">a9501a143</span><span class="w"> </span><span class="n">xor</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="o">[</span><span class="n">edx + 0x43a10195</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">ecx</span><span class="w"></span>
</code></pre></div>

<h2>Pixel</h2>
<p>There seems to be some repetition in this code, let's open it with the <code>dff</code> to
see if this is an
<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_.28ECB.29">ECB image</a>.
We launch the <code>dff hex viewer</code> and look at it as a pixel image:</p>
<p><img alt="SSTIC pixel view, resolution 512 (default)" src="/media/2015.04/sstic_init_res_512.PNG"></p>
<p>With the default resolution of 512 it does not look very pretty, let's variate
the resolution a bit. With a resolution of 563 we got something that encourage
us to persevere in this way:</p>
<p><img alt="SSTIC pixel view, resolution 563" src="/media/2015.04/sstic_res_563.PNG"></p>
<p>At the resolution of 750 we got something pretty:</p>
<p><img alt="SSTIC pixel view, resolution 750" src="/media/2015.04/sstic_res_750.PNG"></p>
<h2>Got you !</h2>
<p>We just need to open it, turn it upside down and mirroring it to get the final
result:</p>
<p><img alt="SSTIC final view, reversed" src="/media/2015.04/sstic_final.PNG"></p>
<p><strong>Very much thanks to anyfun for the big help and the dff hints.</strong></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="../../tag/challenge.html">challenge</a>
      <a href="../../tag/sstic.html">sstic</a>
      <a href="../../tag/security.html">security</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="../../2015/01/compiling-cmus-for-cygwin.html" title="Compiling cmus for cygwin">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="../../2015/04/ctf-ndh-qualifications.html" title="CTF NDH Qualifications">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>



</article>

    <footer>
<p>
  &copy; 2022  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.en_US" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="../../theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "https://maggick.fr/media/image.png",
  "description": ""
}
</script>

</body>
</html>