
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="../../theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="../../theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="../../theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="../../theme/pygments/sas.min.css">


  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/solid.css">


    <link href="https://maggick.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="maggick's logs Atom">



  


 

<meta name="author" content="maggick" />
<meta name="description" content="Building a Kiosk where Google Chrome is running in full screen and user interaction with the system are reduced to the minimum." />
<meta name="keywords" content="programming, security, chrome, kiosk">


  <meta property="og:site_name" content="maggick's logs"/>
  <meta property="og:title" content="Building a kiosk computer with Chrome"/>
  <meta property="og:description" content="Building a Kiosk where Google Chrome is running in full screen and user interaction with the system are reduced to the minimum."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="../../2016/12/building-a-kiosk-computer-with-chrome.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2016-12-26 09:10:00+01:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="../../author/maggick.html">
  <meta property="article:section" content="security"/>
  <meta property="article:tag" content="programming"/>
  <meta property="article:tag" content="security"/>
  <meta property="article:tag" content="chrome"/>
  <meta property="article:tag" content="kiosk"/>
  <meta property="og:image" content="">

  <title>maggick's logs &ndash; Building a kiosk computer with Chrome</title>

</head>
<body >
  <aside>
    <div>
      <a href="../../">
        <img src="../../theme/img/profile.png" alt="" title="">
      </a>

      <h1>
        <a href="../../"></a>
      </h1>



      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="../../pages/about.html">
                  About
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/notes.html">
                  Notes
                </a>
              </li>
              <li>
                <a target="_self"
                   href="../../pages/tools.html">
                  Tools
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/maggick" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
              <i class="fab fa-stack-overflow"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="../../">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="building-a-kiosk-computer-with-chrome">Building a kiosk computer with Chrome</h1>
    <p>
      Posted on 26 Dec 2016 in <a href="../../category/security.html">security</a>

        &#8226; 3 min read
    </p>
  </header>


  <div>
    <p>Building a Kiosk where Google Chrome is running in full screen and user
interaction with the system are reduced to the minimum.</p>


<h2>Debian installation</h2>
<p>This will be pass as most of you should be able to install a basic Debian
system. Just set lvm encryption, strong password for root and for the user and
mostly do not install useless program, check only the program you need (ssh for
instance).</p>
<h2>Installing the packages</h2>
<p>We will need a few more packages to be able to run things:</p>
<ul>
<li>X (display server)</li>
<li>A light window manager able to run Chrome in full screen</li>
<li>Google Chrome</li>
<li>sudo to be able to impersonate the user</li>
</ul>
<p>The first operations will be done using root as the sudo command is not
installed yet.</p>
<p>First we add the Google Chrome repository and the key to check the package
integrity:</p>
<ul>
<li>Edit the file <code>/etc/apt/source.list</code> and add the following repository:</li>
</ul>
<p><code>deb http://dl.google.com/linux/chrome/deb/ stable main</code></p>
<ul>
<li>Execute the following command:</li>
</ul>
<p><code>wget -qO- https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -</code></p>
<p>Then we need to update the package list and install all necessary packages:</p>
<div class="highlight"><pre><span></span><code>apt-get update
apt-get install --no-install-recommends xorg openbox sudo google-chrome-stable
</code></pre></div>

<p>Without the <code>--no-install-recommends</code>parameter some useless packages will be
installed.</p>
<h2>Load Chrome in kiosk at startup</h2>
<p>We need a script that will configure and load Chrome at the X server startup.
As we don't want any data saved between each session we will delete the Chrome
profile each time the script is used. Moreover it is in this script that we
choose the starting page of Chrome.</p>
<p>Create and edit the script:</p>
<div class="highlight"><pre><span></span><code>sudo vi /opt/kiosk.sh
</code></pre></div>

<p>The file content is the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/bin/bash</span>

xset -dpms
xset s off
openbox-session <span class="p">&amp;</span>
<span class="k">while</span> true<span class="p">;</span> <span class="k">do</span> rm -rf ~/.<span class="o">{</span>config,cache<span class="o">}</span>/google-chrome/
  google-chrome --kiosk --no-first-run  <span class="s1">&#39;http://localhost&#39;</span>
<span class="k">done</span>
</code></pre></div></td></tr></table></div>

<p>Give the execution right to the script:</p>
<div class="highlight"><pre><span></span><code>sudo chmod +x /opt/kiosk.sh
</code></pre></div>

<p>In order to start the X server and launch the <code>kiosk.sh</code> script, we need to
create a systemd service.</p>
<p>In order to to that, create and edit the file <code>/etc/systemd/system/kiosk.service</code>:</p>
<div class="highlight"><pre><span></span><code>sudo vi /etc/systemd/system/kiosk.service
</code></pre></div>

<p>The content of the file is the following:</p>
<div class="highlight"><pre><span></span><code><span class="k">[Unit]</span><span class="w"></span>
<span class="na">Description</span><span class="o">=</span><span class="s">Kiosk</span><span class="w"></span>

<span class="k">[Service]</span><span class="w"></span>
<span class="na">Type</span><span class="o">=</span><span class="s">oneshot</span><span class="w"></span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/usr/bin/sudo –u user /usr/bin/startx /etc/X11/Xsession /opt/kiosk.sh --</span><span class="w"></span>

<span class="k">[Install]</span><span class="w"></span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">multi-user.target</span><span class="w"></span>
</code></pre></div>

<p>We need to enable the script with the following command:</p>
<div class="highlight"><pre><span></span><code>systemctl enable kiosk
</code></pre></div>

<p>To run the script use the following command:</p>
<div class="highlight"><pre><span></span><code>systemctl start kiosk »
</code></pre></div>

<p>You can also reboot in order to check that the script is automatically launch at
startup.</p>
<p>If you need a terminal, you can use <ctrl>+<alt>+<F2-9> to get one.</p>
<h2>Automatically mount USB key</h2>
<p>If your users need to copy data from the machine this paragraph is for you.
Otherwise this is just informational.</p>
<p>As our users don't have a shell access they are unable to mount USB key.
Therefore we need to automatically mount them.</p>
<p>We need the <code>usbmount</code> package:</p>
<div class="highlight"><pre><span></span><code>apt-get install --no-install-recommends usbmount
</code></pre></div>

<p>The USB keys will be automatically mount into <code>/mnt/usbX</code>.In order for the user
to have the permissions to right on it we need to add its <code>uid</code> and <code>gid</code> in the
<code>usbmount</code> configuration.</p>
<p>Edit the file <code>/etc/usbmount/usbmount.conf</code> and the user <code>uid</code> and <code>guid</code> to the
following line (the <code>uid</code> and <code>gid</code> can be found in <code>/etc/passwd</code>):</p>
<div class="highlight"><pre><span></span><code>FS_MOUNTOPTIONS=&quot; &quot;
</code></pre></div>

<p>The line would be something like the following:</p>
<div class="highlight"><pre><span></span><code>FS_MOUNTOPTIONS=&quot;uid=1000,gid=1000&quot;
</code></pre></div>

<h2>Sources</h2>
<ul>
<li><a href="https://thepcspy.com/read/building-a-kiosk-computer-ubuntu-1404-chrome/">https://thepcspy.com/read/building-a-kiosk-computer-ubuntu-1404-chrome/</a></li>
<li><a href="https://lukas.zapletalovi.com/2013/08/execute-command-during-start-with-systemd.html">https://lukas.zapletalovi.com/2013/08/execute-command-during-start-with-systemd.html</a></li>
</ul>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="../../tag/programming.html">programming</a>
      <a href="../../tag/security.html">security</a>
      <a href="../../tag/chrome.html">chrome</a>
      <a href="../../tag/kiosk.html">kiosk</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="../../2016/12/cve-2016-5195-dirtycow.html" title="CVE 2016-5195 dirtycow">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="../../2016/12/lets-encrypt-certificate-for-offline-servers-with-ovh-dns.html" title="Let's encrypt certificate for offline servers with OVH DNS">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>



</article>

    <footer>
<p>
  &copy; 2022  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.en_US" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="../../theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "",
  "description": ""
}
</script>

</body>
</html>