
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="True" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="" name="robots"/>
<link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&amp;family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&amp;display=swap" rel="stylesheet"/>
<link href="../../theme/stylesheet/style.min.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/stylesheet/dark-theme.min.css" id="dark-theme-style" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css"/>
<link href="../../theme/pygments/monokai.min.css" id="pygments-dark-theme" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css"/>
<link href="../../theme/pygments/sas.min.css" id="pygments-light-theme" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/fontawesome.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/brands.css" rel="stylesheet" type="text/css"/>
<link href="../../theme/font-awesome/css/solid.css" rel="stylesheet" type="text/css"/>
<link href="https://maggick.fr/feeds/all.atom.xml" rel="alternate" title="maggick's logs Atom" type="application/atom+xml"/>
<meta content="maggick" name="author"/>
<meta content="While browsing on the Internet, I founded a strange functionality forgot username?. Everyone know about the forgot password one that often imply to input the user email address and get a link to reset ones password. So what is that forgot username? thing?" name="description"/>
<meta content="security, osint, phone number" name="keywords"/>
<meta content="maggick's logs" property="og:site_name">
<meta content="Forgot username?" property="og:title"/>
<meta content="While browsing on the Internet, I founded a strange functionality forgot username?. Everyone know about the forgot password one that often imply to input the user email address and get a link to reset ones password. So what is that forgot username? thing?" property="og:description"/>
<meta content="en_US" property="og:locale"/>
<meta content="../../2022/06/forgot-username.html" property="og:url"/>
<meta content="article" property="og:type"/>
<meta content="2022-06-11 09:25:00+02:00" property="article:published_time"/>
<meta content="" property="article:modified_time"/>
<meta content="../../author/maggick.html" property="article:author"/>
<meta content="security" property="article:section">
<meta content="security" property="article:tag"/>
<meta content="osint" property="article:tag"/>
<meta content="phone number" property="article:tag"/>
<meta content="https://maggick.fr/media/image.png" property="og:image"/>
<title>maggick's logs – Forgot username?</title>
</meta></meta></head>
<body>
<aside>
<div>
<a href="../../">
<img alt="maggick's logs" src="https://maggick.fr/media/image.png" title="maggick's logs"/>
</a>
<h1>
<a href="../../">maggick's logs</a>
</h1>
<p>Offensive security tales</p>
<nav>
<ul class="list">
<li>
<a href="../../pages/about.html" target="_self">
                About
              </a>
</li>
<li>
<a href="../../pages/links.html" target="_self">
                Links
              </a>
</li>
<li>
<a href="../../pages/notes.html" target="_self">
                Notes
              </a>
</li>
<li>
<a href="../../pages/tools.html" target="_self">
                Tools
              </a>
</li>
</ul>
</nav>
<ul class="social">
<li>
<a class="sc-github" href="https://github.com/maggick" target="_blank">
<i class="fa-brands fa-github"></i>
</a>
</li>
<li>
<a class="sc-twitter" href="https://twitter.com/maggick_fr" target="_blank">
<i class="fa-brands fa-twitter"></i>
</a>
</li>
<li>
<a class="sc-stack-overflow" href="http://stackoverflow.com/users/1827067/maggick" target="_blank">
<i class="fa-brands fa-stack-overflow"></i>
</a>
</li>
<li>
<a class="sc-rss" href="https://maggick.fr/feeds/all.atom.xml" target="_blank">
<i class="fa-solid fa-rss"></i>
</a>
</li>
</ul>
</div>
</aside>
<main>
<nav>
<a href="../../">Home</a>
<a href="/archives.html">Archives</a>
<a href="/categories.html">Categories</a>
<a href="/tags.html">Tags</a>
<a href="https://maggick.fr/feeds/all.atom.xml">Atom</a>
</nav>
<article class="single">
<header>
<h1 id="forgot-username">Forgot username?</h1>
<p>
      Posted on 11 Jun 2022 in <a href="../../category/security.html">security</a>

        • 4 min read
    </p>
</header>
<div>
<p><img alt="Forgot username" class="align-left" src="/media/2022.06/forgot.jpg" width="262"/></p>
<p>While browsing on the Internet,
I founded a strange functionality <code>forgot username?</code>. Everyone know about the <code>forgot password</code> one that
often imply to input the user email address and get a link to reset ones password. So what is that
<code>forgot username?</code> thing?</p>
<p><strong>Disclaimer:</strong> This was discovered in 2020 and was forgotten on my computer since then.
The attack vectors described bellow might have changed.</p>
<h1>Taking over old accounts</h1>
<h2>Yahoo!</h2>
<p>While browsing on the Internet,
I founded a strange functionality <code>forgot username?</code>. Everyone all know about the <code>forgot password</code> one that
often imply to input the user email address and get a link to reset ones password.</p>
<p><img alt="Forgot username function on Yahoo" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/yahoo_01.png"/></p>
<p>When clinking on the link, the user was prompted to either put its email address - <em>its username right?</em> -
or a phone number.</p>
<p><img alt="Forgot username function on Yahoo" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/yahoo_02.png"/></p>
<p>When putting a phone number there were two outputs cases:</p>
<p>One: the phone number was not recognized and the page display it as an error message.</p>
<p><img alt="Phone number was not recognized" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/yahoo_03.png"/></p>
<p>Two: the phone number was in the database and <code>Yahoo!</code> would ask if I wanted to get a password
reset code on the phone number.</p>
<p><img alt="Phone number was link to an account" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/yahoo_05.png"/></p>
<p>Obviously when clicking <code>yes</code> a text message was sent to the phone number and I was able to
reset its account's password and access the profile data - <em>I only connected that on accounts I owned for ethic and legal reasons.</em></p>
<p><img alt="Resetting the password" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/yahoo_06.png"/></p>
<p>A weird case scenario that happened was triggered when the phone number was linked to two accounts.
In this case, it was possible to reset both account's passwords.</p>
<p>On the picture below <code>lenonfran48</code> was my account but the other one, starting with <code>ism</code>, was not.</p>
<p><img alt="Phone number is link to two accounts?!" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/yahoo_04.png"/></p>
<h2>GAFAM</h2>
<p>Yahoo! was not alone out there and a most of the GAFAM offered this function - <em>Apple allowed to 
retrieve ones Apple ID but using its First name and Last name and email address</em>:</p>
<p><img alt="GAFAM allowed to retrieve account with the phone number" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/gafam_01.png"/></p>
<p><img alt="GAFAM allowed to retrieve account with the phone number" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/gafam_02.png"/></p>
<h3>Twitter specifics</h3>
<p>If there were two accounts link to a phone number, Twitter would not allow the user to reset its password using the
phone number and asked to use the username or email address.</p>
<p><img alt="Phone number was link to two accounts?!" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/twitter_5.png"/></p>
<h3>Google specifics</h3>
<p>Google also allowed to use a phone number instead of an email to login and reset the account
password. But, in order to show that the account really belonged to the person
with the phone number, Google asks for personal information as the user First name and Last name.</p>
<p><img alt="Google asked for personal information" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/google_05.png"/></p>
<h3>Amazon specifics</h3>
<p>As Google, Amazon was asking the credit card last number not before resetting the user password, but when accessing the
"personal" section or putting an order.</p>
<h1>Automation</h1>
<p><img alt="automate all the things!" src="/media/2022.06/automate.jpg"/></p>
<h2>Finding phone number</h2>
<p>I needed a large input of phone number. For that I used three sources:</p>
<ul>
<li>Internal phone number: I extracted the phone number from my company as reaching a coworker on our internal
chat to ask him to send me a text code is perfectly fine (after explaining the situation obviously)</li>
<li>Burner and Google voice: these services allowed to buy a temporary phone number and let you choose from a list
allowing to test the number against the applications and buy the interesting numbers.</li>
</ul>
<p><img alt="Google voice" class="image-process-article-image" src="/media/2022.06/derivatives/article-image/google_voice.png"/></p>
<h2>Scripting</h2>
<p>A little bit of python or even using Burp intruder allowed to quickly retrieved the valid
phone numbers for each platform.
For instance, the <code>python</code> code to validate a phone number against Twitter was the following:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_number_twitter</span><span class="p">(</span><span class="n">phone_number</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">twitter_url</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">authenticity_token</span><span class="o">=</span><span class="s1">''</span>

    <span class="n">soupe</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">'lxml'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">soupe</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">'input'</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span> <span class="o">==</span> <span class="s1">'authenticity_token'</span><span class="p">:</span>
            <span class="n">authenticity_token</span><span class="o">=</span><span class="n">elem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'value'</span><span class="p">)</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'authenticity_token'</span><span class="p">:</span> <span class="n">authenticity_token</span><span class="p">,</span> <span class="s1">'account_identifier'</span><span class="p">:</span> <span class="n">phone_number</span><span class="p">}</span>

    <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">twitter_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'https://twitter.com/account/send_password_reset'</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">'a code to my phone ending'</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Twitter num found: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">phone_number</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'-------------------------------'</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</code></pre></div>
<h2>Results</h2>
<p>The following table present the raw results obtained by running the collected number.</p>
<p>We see that Burner and Google Voice were not interesting sources in term of phone number.
The reason is probably that the number were not really use by users as recuperation device.</p>
<p>Company phone number however were really interesting as they tend to be reuse phone number.</p>
<table>
<thead>
<tr>
<th>Source</th>
<th>numbers</th>
<th>Yahoo</th>
<th>Amazon</th>
<th>Twitter</th>
</tr>
</thead>
<tbody>
<tr>
<td>Company phones</td>
<td>303</td>
<td>77</td>
<td>111</td>
<td>12</td>
</tr>
<tr>
<td>Burner</td>
<td>299</td>
<td>0</td>
<td>6</td>
<td>0</td>
</tr>
<tr>
<td>Google Voice</td>
<td>152</td>
<td>0</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>TOTAL</td>
<td>754</td>
<td>77</td>
<td>117</td>
<td>14</td>
</tr>
</tbody>
</table>
<h1>Fix</h1>
<h2>User side</h2>
<p>A few recommendations for the end user:</p>
<ul>
<li>Renew your phone numbers.</li>
<li>Keep an inventory of your phone number usage and update them as needed.</li>
</ul>
<h2>Application side</h2>
<p>A few recommendations for the applications:</p>
<ul>
<li>Use an anti-brute force mechanism.</li>
<li>Try to show the same message whether the phone number is link to an account or not.</li>
<li>As Google and Amazon were doing ask for personal information before sending the email.</li>
</ul>
<h1>Conclusion</h1>
<p>There is no real vulnerability here as this was mostly a user bad habit. Nonetheless, GAFAM could
implement some simple fixes to protect their users from this kind of "attacks".</p>
</div>
<div class="tag-cloud">
<p>
<a href="../../tag/security.html">security</a>
<a href="../../tag/osint.html">osint</a>
<a href="../../tag/phone-number.html">phone number</a>
</p>
</div>
<div class="neighbors">
<a class="btn float-left" href="../../2022/05/htb-pandora.html" title="HTB: Pandora">
<i class="fa fa-angle-left"></i> Previous Post
    </a>
<a class="btn float-right" href="../../2022/06/htb-meta.html" title="HTB: Meta">
      Next Post <i class="fa fa-angle-right"></i>
</a>
</div>
</article>
<footer>
<p>
  © 2023  - This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US" rel="license" target="_blank">Creative Commons Attribution</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script data-default-theme="light" data-enable-auto-detect-theme="True" id="dark-theme-script" src="../../theme/dark-theme/dark-theme.min.js" type="text/javascript">
</script>
</p><p>
<a href="http://creativecommons.org/licenses/by/4.0/" rel="license" target="_blank">
<img alt="Creative Commons License" height="15" src="https://i.creativecommons.org/l/by/4.0/80x15.png" style="border-width:0" title="Creative Commons License" width="80">
</img></a>
</p></footer> </main>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " maggick's logs ",
  "url" : "../..",
  "image": "https://maggick.fr/media/image.png",
  "description": ""
}
</script>
</body>
</html>